var i_=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var OI=i_((JI,Vw)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();var Cd={exports:{}},ju={};var K0;function o_(){if(K0)return ju;K0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,a,o){var s=null;if(o!==void 0&&(s=""+o),a.key!==void 0&&(s=""+a.key),"key"in a){o={};for(var l in a)l!=="key"&&(o[l]=a[l])}else o=a;return a=o.ref,{$$typeof:r,type:n,key:s,ref:a!==void 0?a:null,props:o}}return ju.Fragment=t,ju.jsx=e,ju.jsxs=e,ju}var Y0;function u_(){return Y0||(Y0=1,Cd.exports=o_()),Cd.exports}var ve=u_(),_d={exports:{}},Fe={};var Q0;function s_(){if(Q0)return Fe;Q0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),m=Symbol.iterator;function y(L){return L===null||typeof L!="object"?null:(L=m&&L[m]||L["@@iterator"],typeof L=="function"?L:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,w={};function C(L,q,ue){this.props=L,this.context=q,this.refs=w,this.updater=ue||x}C.prototype.isReactComponent={},C.prototype.setState=function(L,q){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,q,"setState")},C.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function _(){}_.prototype=C.prototype;function R(L,q,ue){this.props=L,this.context=q,this.refs=w,this.updater=ue||x}var A=R.prototype=new _;A.constructor=R,E(A,C.prototype),A.isPureReactComponent=!0;var T=Array.isArray;function N(){}var M={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(L,q,ue){var pe=ue.ref;return{$$typeof:r,type:L,key:q,ref:pe!==void 0?pe:null,props:ue}}function F(L,q){return k(L.type,q,L.props)}function W(L){return typeof L=="object"&&L!==null&&L.$$typeof===r}function P(L){var q={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ue){return q[ue]})}var oe=/\/+/g;function ee(L,q){return typeof L=="object"&&L!==null&&L.key!=null?P(""+L.key):q.toString(36)}function ae(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(N,N):(L.status="pending",L.then(function(q){L.status==="pending"&&(L.status="fulfilled",L.value=q)},function(q){L.status==="pending"&&(L.status="rejected",L.reason=q)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function z(L,q,ue,pe,me){var ye=typeof L;(ye==="undefined"||ye==="boolean")&&(L=null);var xe=!1;if(L===null)xe=!0;else switch(ye){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(L.$$typeof){case r:case t:xe=!0;break;case p:return xe=L._init,z(xe(L._payload),q,ue,pe,me)}}if(xe)return me=me(L),xe=pe===""?"."+ee(L,0):pe,T(me)?(ue="",xe!=null&&(ue=xe.replace(oe,"$&/")+"/"),z(me,q,ue,"",function(lt){return lt})):me!=null&&(W(me)&&(me=F(me,ue+(me.key==null||L&&L.key===me.key?"":(""+me.key).replace(oe,"$&/")+"/")+xe)),q.push(me)),1;xe=0;var Oe=pe===""?".":pe+":";if(T(L))for(var De=0;De<L.length;De++)pe=L[De],ye=Oe+ee(pe,De),xe+=z(pe,q,ue,ye,me);else if(De=y(L),typeof De=="function")for(L=De.call(L),De=0;!(pe=L.next()).done;)pe=pe.value,ye=Oe+ee(pe,De++),xe+=z(pe,q,ue,ye,me);else if(ye==="object"){if(typeof L.then=="function")return z(ae(L),q,ue,pe,me);throw q=String(L),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return xe}function G(L,q,ue){if(L==null)return L;var pe=[],me=0;return z(L,pe,"","",function(ye){return q.call(ue,ye,me++)}),pe}function K(L){if(L._status===-1){var q=L._result;q=q(),q.then(function(ue){(L._status===0||L._status===-1)&&(L._status=1,L._result=ue)},function(ue){(L._status===0||L._status===-1)&&(L._status=2,L._result=ue)}),L._status===-1&&(L._status=0,L._result=q)}if(L._status===1)return L._result.default;throw L._result}var ie=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},se={map:G,forEach:function(L,q,ue){G(L,function(){q.apply(this,arguments)},ue)},count:function(L){var q=0;return G(L,function(){q++}),q},toArray:function(L){return G(L,function(q){return q})||[]},only:function(L){if(!W(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Fe.Activity=v,Fe.Children=se,Fe.Component=C,Fe.Fragment=e,Fe.Profiler=a,Fe.PureComponent=R,Fe.StrictMode=n,Fe.Suspense=f,Fe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Fe.__COMPILER_RUNTIME={__proto__:null,c:function(L){return M.H.useMemoCache(L)}},Fe.cache=function(L){return function(){return L.apply(null,arguments)}},Fe.cacheSignal=function(){return null},Fe.cloneElement=function(L,q,ue){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var pe=E({},L.props),me=L.key;if(q!=null)for(ye in q.key!==void 0&&(me=""+q.key),q)!I.call(q,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&q.ref===void 0||(pe[ye]=q[ye]);var ye=arguments.length-2;if(ye===1)pe.children=ue;else if(1<ye){for(var xe=Array(ye),Oe=0;Oe<ye;Oe++)xe[Oe]=arguments[Oe+2];pe.children=xe}return k(L.type,me,pe)},Fe.createContext=function(L){return L={$$typeof:s,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:o,_context:L},L},Fe.createElement=function(L,q,ue){var pe,me={},ye=null;if(q!=null)for(pe in q.key!==void 0&&(ye=""+q.key),q)I.call(q,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(me[pe]=q[pe]);var xe=arguments.length-2;if(xe===1)me.children=ue;else if(1<xe){for(var Oe=Array(xe),De=0;De<xe;De++)Oe[De]=arguments[De+2];me.children=Oe}if(L&&L.defaultProps)for(pe in xe=L.defaultProps,xe)me[pe]===void 0&&(me[pe]=xe[pe]);return k(L,ye,me)},Fe.createRef=function(){return{current:null}},Fe.forwardRef=function(L){return{$$typeof:l,render:L}},Fe.isValidElement=W,Fe.lazy=function(L){return{$$typeof:p,_payload:{_status:-1,_result:L},_init:K}},Fe.memo=function(L,q){return{$$typeof:h,type:L,compare:q===void 0?null:q}},Fe.startTransition=function(L){var q=M.T,ue={};M.T=ue;try{var pe=L(),me=M.S;me!==null&&me(ue,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(N,ie)}catch(ye){ie(ye)}finally{q!==null&&ue.types!==null&&(q.types=ue.types),M.T=q}},Fe.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Fe.use=function(L){return M.H.use(L)},Fe.useActionState=function(L,q,ue){return M.H.useActionState(L,q,ue)},Fe.useCallback=function(L,q){return M.H.useCallback(L,q)},Fe.useContext=function(L){return M.H.useContext(L)},Fe.useDebugValue=function(){},Fe.useDeferredValue=function(L,q){return M.H.useDeferredValue(L,q)},Fe.useEffect=function(L,q){return M.H.useEffect(L,q)},Fe.useEffectEvent=function(L){return M.H.useEffectEvent(L)},Fe.useId=function(){return M.H.useId()},Fe.useImperativeHandle=function(L,q,ue){return M.H.useImperativeHandle(L,q,ue)},Fe.useInsertionEffect=function(L,q){return M.H.useInsertionEffect(L,q)},Fe.useLayoutEffect=function(L,q){return M.H.useLayoutEffect(L,q)},Fe.useMemo=function(L,q){return M.H.useMemo(L,q)},Fe.useOptimistic=function(L,q){return M.H.useOptimistic(L,q)},Fe.useReducer=function(L,q,ue){return M.H.useReducer(L,q,ue)},Fe.useRef=function(L){return M.H.useRef(L)},Fe.useState=function(L){return M.H.useState(L)},Fe.useSyncExternalStore=function(L,q,ue){return M.H.useSyncExternalStore(L,q,ue)},Fe.useTransition=function(){return M.H.useTransition()},Fe.version="19.2.4",Fe}var Z0;function Up(){return Z0||(Z0=1,_d.exports=s_()),_d.exports}var $=Up(),Sd={exports:{}},Gu={},Rd={exports:{}},Ad={};var J0;function l_(){return J0||(J0=1,(function(r){function t(z,G){var K=z.length;z.push(G);e:for(;0<K;){var ie=K-1>>>1,se=z[ie];if(0<a(se,G))z[ie]=G,z[K]=se,K=ie;else break e}}function e(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var G=z[0],K=z.pop();if(K!==G){z[0]=K;e:for(var ie=0,se=z.length,L=se>>>1;ie<L;){var q=2*(ie+1)-1,ue=z[q],pe=q+1,me=z[pe];if(0>a(ue,K))pe<se&&0>a(me,ue)?(z[ie]=me,z[pe]=K,ie=pe):(z[ie]=ue,z[q]=K,ie=q);else if(pe<se&&0>a(me,K))z[ie]=me,z[pe]=K,ie=pe;else break e}}return G}function a(z,G){var K=z.sortIndex-G.sortIndex;return K!==0?K:z.id-G.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();r.unstable_now=function(){return s.now()-l}}var f=[],h=[],p=1,v=null,m=3,y=!1,x=!1,E=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function A(z){for(var G=e(h);G!==null;){if(G.callback===null)n(h);else if(G.startTime<=z)n(h),G.sortIndex=G.expirationTime,t(f,G);else break;G=e(h)}}function T(z){if(E=!1,A(z),!x)if(e(f)!==null)x=!0,N||(N=!0,P());else{var G=e(h);G!==null&&ae(T,G.startTime-z)}}var N=!1,M=-1,I=5,k=-1;function F(){return w?!0:!(r.unstable_now()-k<I)}function W(){if(w=!1,N){var z=r.unstable_now();k=z;var G=!0;try{e:{x=!1,E&&(E=!1,_(M),M=-1),y=!0;var K=m;try{t:{for(A(z),v=e(f);v!==null&&!(v.expirationTime>z&&F());){var ie=v.callback;if(typeof ie=="function"){v.callback=null,m=v.priorityLevel;var se=ie(v.expirationTime<=z);if(z=r.unstable_now(),typeof se=="function"){v.callback=se,A(z),G=!0;break t}v===e(f)&&n(f),A(z)}else n(f);v=e(f)}if(v!==null)G=!0;else{var L=e(h);L!==null&&ae(T,L.startTime-z),G=!1}}break e}finally{v=null,m=K,y=!1}G=void 0}}finally{G?P():N=!1}}}var P;if(typeof R=="function")P=function(){R(W)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ee=oe.port2;oe.port1.onmessage=W,P=function(){ee.postMessage(null)}}else P=function(){C(W,0)};function ae(z,G){M=C(function(){z(r.unstable_now())},G)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(z){z.callback=null},r.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<z?Math.floor(1e3/z):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(z){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var K=m;m=G;try{return z()}finally{m=K}},r.unstable_requestPaint=function(){w=!0},r.unstable_runWithPriority=function(z,G){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var K=m;m=z;try{return G()}finally{m=K}},r.unstable_scheduleCallback=function(z,G,K){var ie=r.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ie+K:ie):K=ie,z){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=K+se,z={id:p++,callback:G,priorityLevel:z,startTime:K,expirationTime:se,sortIndex:-1},K>ie?(z.sortIndex=K,t(h,z),e(f)===null&&z===e(h)&&(E?(_(M),M=-1):E=!0,ae(T,K-ie))):(z.sortIndex=se,t(f,z),x||y||(x=!0,N||(N=!0,P()))),z},r.unstable_shouldYield=F,r.unstable_wrapCallback=function(z){var G=m;return function(){var K=m;m=G;try{return z.apply(this,arguments)}finally{m=K}}}})(Ad)),Ad}var $0;function c_(){return $0||($0=1,Rd.exports=l_()),Rd.exports}var Td={exports:{}},rn={};var eb;function f_(){if(eb)return rn;eb=1;var r=Up();function t(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,h,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:h,implementation:p}}var s=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,rn.createPortal=function(f,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return o(f,h,null,p)},rn.flushSync=function(f){var h=s.T,p=n.p;try{if(s.T=null,n.p=2,f)return f()}finally{s.T=h,n.p=p,n.d.f()}},rn.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(f,h))},rn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},rn.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var p=h.as,v=l(p,h.crossOrigin),m=typeof h.integrity=="string"?h.integrity:void 0,y=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:m,fetchPriority:y}):p==="script"&&n.d.X(f,{crossOrigin:v,integrity:m,fetchPriority:y,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},rn.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=l(h.as,h.crossOrigin);n.d.M(f,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(f)},rn.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,v=l(p,h.crossOrigin);n.d.L(f,p,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},rn.preloadModule=function(f,h){if(typeof f=="string")if(h){var p=l(h.as,h.crossOrigin);n.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(f)},rn.requestFormReset=function(f){n.d.r(f)},rn.unstable_batchedUpdates=function(f,h){return f(h)},rn.useFormState=function(f,h,p){return s.H.useFormState(f,h,p)},rn.useFormStatus=function(){return s.H.useHostTransitionStatus()},rn.version="19.2.4",rn}var tb;function h_(){if(tb)return Td.exports;tb=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Td.exports=f_(),Td.exports}var nb;function d_(){if(nb)return Gu;nb=1;var r=c_(),t=Up(),e=h_();function n(i){var u="https://react.dev/errors/"+i;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)u+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var u=i,c=i;if(i.alternate)for(;u.return;)u=u.return;else{i=u;do u=i,(u.flags&4098)!==0&&(c=u.return),i=u.return;while(i)}return u.tag===3?c:null}function s(i){if(i.tag===13){var u=i.memoizedState;if(u===null&&(i=i.alternate,i!==null&&(u=i.memoizedState)),u!==null)return u.dehydrated}return null}function l(i){if(i.tag===31){var u=i.memoizedState;if(u===null&&(i=i.alternate,i!==null&&(u=i.memoizedState)),u!==null)return u.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(n(188))}function h(i){var u=i.alternate;if(!u){if(u=o(i),u===null)throw Error(n(188));return u!==i?null:i}for(var c=i,d=u;;){var g=c.return;if(g===null)break;var b=g.alternate;if(b===null){if(d=g.return,d!==null){c=d;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===c)return f(g),i;if(b===d)return f(g),u;b=b.sibling}throw Error(n(188))}if(c.return!==d.return)c=g,d=b;else{for(var S=!1,D=g.child;D;){if(D===c){S=!0,c=g,d=b;break}if(D===d){S=!0,d=g,c=b;break}D=D.sibling}if(!S){for(D=b.child;D;){if(D===c){S=!0,c=b,d=g;break}if(D===d){S=!0,d=b,c=g;break}D=D.sibling}if(!S)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:u}function p(i){var u=i.tag;if(u===5||u===26||u===27||u===6)return i;for(i=i.child;i!==null;){if(u=p(i),u!==null)return u;i=i.sibling}return null}var v=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),R=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function P(i){return i===null||typeof i!="object"?null:(i=W&&i[W]||i["@@iterator"],typeof i=="function"?i:null)}var oe=Symbol.for("react.client.reference");function ee(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===oe?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case C:return"Profiler";case w:return"StrictMode";case T:return"Suspense";case N:return"SuspenseList";case k:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case x:return"Portal";case R:return i.displayName||"Context";case _:return(i._context.displayName||"Context")+".Consumer";case A:var u=i.render;return i=i.displayName,i||(i=u.displayName||u.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case M:return u=i.displayName||null,u!==null?u:ee(i.type)||"Memo";case I:u=i._payload,i=i._init;try{return ee(i(u))}catch{}}return null}var ae=Array.isArray,z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},ie=[],se=-1;function L(i){return{current:i}}function q(i){0>se||(i.current=ie[se],ie[se]=null,se--)}function ue(i,u){se++,ie[se]=i.current,i.current=u}var pe=L(null),me=L(null),ye=L(null),xe=L(null);function Oe(i,u){switch(ue(ye,u),ue(me,i),ue(pe,null),u.nodeType){case 9:case 11:i=(i=u.documentElement)&&(i=i.namespaceURI)?g0(i):0;break;default:if(i=u.tagName,u=u.namespaceURI)u=g0(u),i=y0(u,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}q(pe),ue(pe,i)}function De(){q(pe),q(me),q(ye)}function lt(i){i.memoizedState!==null&&ue(xe,i);var u=pe.current,c=y0(u,i.type);u!==c&&(ue(me,i),ue(pe,c))}function He(i){me.current===i&&(q(pe),q(me)),xe.current===i&&(q(xe),Pu._currentValue=K)}var Ze,Ye;function nt(i){if(Ze===void 0)try{throw Error()}catch(c){var u=c.stack.trim().match(/\n( *(at )?)/);Ze=u&&u[1]||"",Ye=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ze+i+Ye}var ct=!1;function ft(i,u){if(!i||ct)return"";ct=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(u){var he=function(){throw Error()};if(Object.defineProperty(he.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(he,[])}catch(te){var Z=te}Reflect.construct(i,[],he)}else{try{he.call()}catch(te){Z=te}i.call(he.prototype)}}else{try{throw Error()}catch(te){Z=te}(he=i())&&typeof he.catch=="function"&&he.catch(function(){})}}catch(te){if(te&&Z&&typeof te.stack=="string")return[te.stack,Z.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=d.DetermineComponentFrameRoot(),S=b[0],D=b[1];if(S&&D){var U=S.split(`
`),Q=D.split(`
`);for(g=d=0;d<U.length&&!U[d].includes("DetermineComponentFrameRoot");)d++;for(;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;if(d===U.length||g===Q.length)for(d=U.length-1,g=Q.length-1;1<=d&&0<=g&&U[d]!==Q[g];)g--;for(;1<=d&&0<=g;d--,g--)if(U[d]!==Q[g]){if(d!==1||g!==1)do if(d--,g--,0>g||U[d]!==Q[g]){var le=`
`+U[d].replace(" at new "," at ");return i.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",i.displayName)),le}while(1<=d&&0<=g);break}}}finally{ct=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?nt(c):""}function Xn(i,u){switch(i.tag){case 26:case 27:case 5:return nt(i.type);case 16:return nt("Lazy");case 13:return i.child!==u&&u!==null?nt("Suspense Fallback"):nt("Suspense");case 19:return nt("SuspenseList");case 0:case 15:return ft(i.type,!1);case 11:return ft(i.type.render,!1);case 1:return ft(i.type,!0);case 31:return nt("Activity");default:return""}}function On(i){try{var u="",c=null;do u+=Xn(i,c),c=i,i=i.return;while(i);return u}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Xt=Object.prototype.hasOwnProperty,wr=r.unstable_scheduleCallback,Mn=r.unstable_cancelCallback,Er=r.unstable_shouldYield,cr=r.unstable_requestPaint,Dt=r.unstable_now,fr=r.unstable_getCurrentPriorityLevel,Pi=r.unstable_ImmediatePriority,jr=r.unstable_UserBlockingPriority,hn=r.unstable_NormalPriority,Jo=r.unstable_LowPriority,As=r.unstable_IdlePriority,lf=r.log,cf=r.unstable_setDisableYieldValue,Gr=null,Kt=null;function Kn(i){if(typeof lf=="function"&&cf(i),Kt&&typeof Kt.setStrictMode=="function")try{Kt.setStrictMode(Gr,i)}catch{}}var kn=Math.clz32?Math.clz32:Gw,Ww=Math.log,jw=Math.LN2;function Gw(i){return i>>>=0,i===0?32:31-(Ww(i)/jw|0)|0}var Ts=256,Ds=262144,Ns=4194304;function ai(i){var u=i&42;if(u!==0)return u;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Os(i,u,c){var d=i.pendingLanes;if(d===0)return 0;var g=0,b=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var D=d&134217727;return D!==0?(d=D&~b,d!==0?g=ai(d):(S&=D,S!==0?g=ai(S):c||(c=D&~i,c!==0&&(g=ai(c))))):(D=d&~b,D!==0?g=ai(D):S!==0?g=ai(S):c||(c=d&~i,c!==0&&(g=ai(c)))),g===0?0:u!==0&&u!==g&&(u&b)===0&&(b=g&-g,c=u&-u,b>=c||b===32&&(c&4194048)!==0)?u:g}function $o(i,u){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&u)===0}function qw(i,u){switch(i){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jv(){var i=Ns;return Ns<<=1,(Ns&62914560)===0&&(Ns=4194304),i}function ff(i){for(var u=[],c=0;31>c;c++)u.push(i);return u}function eu(i,u){i.pendingLanes|=u,u!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Xw(i,u,c,d,g,b){var S=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var D=i.entanglements,U=i.expirationTimes,Q=i.hiddenUpdates;for(c=S&~c;0<c;){var le=31-kn(c),he=1<<le;D[le]=0,U[le]=-1;var Z=Q[le];if(Z!==null)for(Q[le]=null,le=0;le<Z.length;le++){var te=Z[le];te!==null&&(te.lane&=-536870913)}c&=~he}d!==0&&$v(i,d,0),b!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=b&~(S&~u))}function $v(i,u,c){i.pendingLanes|=u,i.suspendedLanes&=~u;var d=31-kn(u);i.entangledLanes|=u,i.entanglements[d]=i.entanglements[d]|1073741824|c&261930}function em(i,u){var c=i.entangledLanes|=u;for(i=i.entanglements;c;){var d=31-kn(c),g=1<<d;g&u|i[d]&u&&(i[d]|=u),c&=~g}}function tm(i,u){var c=u&-u;return c=(c&42)!==0?1:hf(c),(c&(i.suspendedLanes|u))!==0?0:c}function hf(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function df(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function nm(){var i=G.p;return i!==0?i:(i=window.event,i===void 0?32:H0(i.type))}function rm(i,u){var c=G.p;try{return G.p=i,u()}finally{G.p=c}}var Ea=Math.random().toString(36).slice(2),Yt="__reactFiber$"+Ea,gn="__reactProps$"+Ea,Hi="__reactContainer$"+Ea,pf="__reactEvents$"+Ea,Kw="__reactListeners$"+Ea,Yw="__reactHandles$"+Ea,am="__reactResources$"+Ea,tu="__reactMarker$"+Ea;function vf(i){delete i[Yt],delete i[gn],delete i[pf],delete i[Kw],delete i[Yw]}function Vi(i){var u=i[Yt];if(u)return u;for(var c=i.parentNode;c;){if(u=c[Hi]||c[Yt]){if(c=u.alternate,u.child!==null||c!==null&&c.child!==null)for(i=S0(i);i!==null;){if(c=i[Yt])return c;i=S0(i)}return u}i=c,c=i.parentNode}return null}function Wi(i){if(i=i[Yt]||i[Hi]){var u=i.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return i}return null}function nu(i){var u=i.tag;if(u===5||u===26||u===27||u===6)return i.stateNode;throw Error(n(33))}function ji(i){var u=i[am];return u||(u=i[am]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Vt(i){i[tu]=!0}var im=new Set,om={};function ii(i,u){Gi(i,u),Gi(i+"Capture",u)}function Gi(i,u){for(om[i]=u,i=0;i<u.length;i++)im.add(u[i])}var Qw=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),um={},sm={};function Zw(i){return Xt.call(sm,i)?!0:Xt.call(um,i)?!1:Qw.test(i)?sm[i]=!0:(um[i]=!0,!1)}function Ms(i,u,c){if(Zw(u))if(c===null)i.removeAttribute(u);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(u);return;case"boolean":var d=u.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){i.removeAttribute(u);return}}i.setAttribute(u,""+c)}}function ks(i,u,c){if(c===null)i.removeAttribute(u);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttribute(u,""+c)}}function qr(i,u,c,d){if(d===null)i.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(u,c,""+d)}}function Yn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function lm(i){var u=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function Jw(i,u,c){var d=Object.getOwnPropertyDescriptor(i.constructor.prototype,u);if(!i.hasOwnProperty(u)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,b=d.set;return Object.defineProperty(i,u,{configurable:!0,get:function(){return g.call(this)},set:function(S){c=""+S,b.call(this,S)}}),Object.defineProperty(i,u,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){i._valueTracker=null,delete i[u]}}}}function mf(i){if(!i._valueTracker){var u=lm(i)?"checked":"value";i._valueTracker=Jw(i,u,""+i[u])}}function cm(i){if(!i)return!1;var u=i._valueTracker;if(!u)return!0;var c=u.getValue(),d="";return i&&(d=lm(i)?i.checked?"true":"false":i.value),i=d,i!==c?(u.setValue(i),!0):!1}function Is(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var $w=/[\n"\\]/g;function Qn(i){return i.replace($w,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function gf(i,u,c,d,g,b,S,D){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),u!=null?S==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+Yn(u)):i.value!==""+Yn(u)&&(i.value=""+Yn(u)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),u!=null?yf(i,S,Yn(u)):c!=null?yf(i,S,Yn(c)):d!=null&&i.removeAttribute("value"),g==null&&b!=null&&(i.defaultChecked=!!b),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?i.name=""+Yn(D):i.removeAttribute("name")}function fm(i,u,c,d,g,b,S,D){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.type=b),u!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||u!=null)){mf(i);return}c=c!=null?""+Yn(c):"",u=u!=null?""+Yn(u):c,D||u===i.value||(i.value=u),i.defaultValue=u}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,i.checked=D?i.checked:!!d,i.defaultChecked=!!d,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S),mf(i)}function yf(i,u,c){u==="number"&&Is(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function qi(i,u,c,d){if(i=i.options,u){u={};for(var g=0;g<c.length;g++)u["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=u.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&d&&(i[c].defaultSelected=!0)}else{for(c=""+Yn(c),u=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,d&&(i[g].defaultSelected=!0);return}u!==null||i[g].disabled||(u=i[g])}u!==null&&(u.selected=!0)}}function hm(i,u,c){if(u!=null&&(u=""+Yn(u),u!==i.value&&(i.value=u),c==null)){i.defaultValue!==u&&(i.defaultValue=u);return}i.defaultValue=c!=null?""+Yn(c):""}function dm(i,u,c,d){if(u==null){if(d!=null){if(c!=null)throw Error(n(92));if(ae(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),u=c}c=Yn(u),i.defaultValue=c,d=i.textContent,d===c&&d!==""&&d!==null&&(i.value=d),mf(i)}function Xi(i,u){if(u){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=u;return}}i.textContent=u}var eE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pm(i,u,c){var d=u.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="":d?i.setProperty(u,c):typeof c!="number"||c===0||eE.has(u)?u==="float"?i.cssFloat=c:i[u]=(""+c).trim():i[u]=c+"px"}function vm(i,u,c){if(u!=null&&typeof u!="object")throw Error(n(62));if(i=i.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||u!=null&&u.hasOwnProperty(d)||(d.indexOf("--")===0?i.setProperty(d,""):d==="float"?i.cssFloat="":i[d]="");for(var g in u)d=u[g],u.hasOwnProperty(g)&&c[g]!==d&&pm(i,g,d)}else for(var b in u)u.hasOwnProperty(b)&&pm(i,b,u[b])}function bf(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bs(i){return nE.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Xr(){}var xf=null;function wf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ki=null,Yi=null;function mm(i){var u=Wi(i);if(u&&(i=u.stateNode)){var c=i[gn]||null;e:switch(i=u.stateNode,u.type){case"input":if(gf(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),u=c.name,c.type==="radio"&&u!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Qn(""+u)+'"][type="radio"]'),u=0;u<c.length;u++){var d=c[u];if(d!==i&&d.form===i.form){var g=d[gn]||null;if(!g)throw Error(n(90));gf(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(u=0;u<c.length;u++)d=c[u],d.form===i.form&&cm(d)}break e;case"textarea":hm(i,c.value,c.defaultValue);break e;case"select":u=c.value,u!=null&&qi(i,!!c.multiple,u,!1)}}}var Ef=!1;function gm(i,u,c){if(Ef)return i(u,c);Ef=!0;try{var d=i(u);return d}finally{if(Ef=!1,(Ki!==null||Yi!==null)&&(El(),Ki&&(u=Ki,i=Yi,Yi=Ki=null,mm(u),i)))for(u=0;u<i.length;u++)mm(i[u])}}function ru(i,u){var c=i.stateNode;if(c===null)return null;var d=c[gn]||null;if(d===null)return null;c=d[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(i=i.type,d=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!d;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,u,typeof c));return c}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cf=!1;if(Kr)try{var au={};Object.defineProperty(au,"passive",{get:function(){Cf=!0}}),window.addEventListener("test",au,au),window.removeEventListener("test",au,au)}catch{Cf=!1}var Ca=null,_f=null,Fs=null;function ym(){if(Fs)return Fs;var i,u=_f,c=u.length,d,g="value"in Ca?Ca.value:Ca.textContent,b=g.length;for(i=0;i<c&&u[i]===g[i];i++);var S=c-i;for(d=1;d<=S&&u[c-d]===g[b-d];d++);return Fs=g.slice(i,1<d?1-d:void 0)}function Ls(i){var u=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&u===13&&(i=13)):i=u,i===10&&(i=13),32<=i||i===13?i:0}function zs(){return!0}function bm(){return!1}function yn(i){function u(c,d,g,b,S){this._reactName=c,this._targetInst=g,this.type=d,this.nativeEvent=b,this.target=S,this.currentTarget=null;for(var D in i)i.hasOwnProperty(D)&&(c=i[D],this[D]=c?c(b):b[D]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?zs:bm,this.isPropagationStopped=bm,this}return v(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=zs)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=zs)},persist:function(){},isPersistent:zs}),u}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Us=yn(oi),iu=v({},oi,{view:0,detail:0}),rE=yn(iu),Sf,Rf,ou,Ps=v({},iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tf,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ou&&(ou&&i.type==="mousemove"?(Sf=i.screenX-ou.screenX,Rf=i.screenY-ou.screenY):Rf=Sf=0,ou=i),Sf)},movementY:function(i){return"movementY"in i?i.movementY:Rf}}),xm=yn(Ps),aE=v({},Ps,{dataTransfer:0}),iE=yn(aE),oE=v({},iu,{relatedTarget:0}),Af=yn(oE),uE=v({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),sE=yn(uE),lE=v({},oi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),cE=yn(lE),fE=v({},oi,{data:0}),wm=yn(fE),hE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vE(i){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(i):(i=pE[i])?!!u[i]:!1}function Tf(){return vE}var mE=v({},iu,{key:function(i){if(i.key){var u=hE[i.key]||i.key;if(u!=="Unidentified")return u}return i.type==="keypress"?(i=Ls(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?dE[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tf,charCode:function(i){return i.type==="keypress"?Ls(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ls(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),gE=yn(mE),yE=v({},Ps,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Em=yn(yE),bE=v({},iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tf}),xE=yn(bE),wE=v({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),EE=yn(wE),CE=v({},Ps,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),_E=yn(CE),SE=v({},oi,{newState:0,oldState:0}),RE=yn(SE),AE=[9,13,27,32],Df=Kr&&"CompositionEvent"in window,uu=null;Kr&&"documentMode"in document&&(uu=document.documentMode);var TE=Kr&&"TextEvent"in window&&!uu,Cm=Kr&&(!Df||uu&&8<uu&&11>=uu),_m=" ",Sm=!1;function Rm(i,u){switch(i){case"keyup":return AE.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Am(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Qi=!1;function DE(i,u){switch(i){case"compositionend":return Am(u);case"keypress":return u.which!==32?null:(Sm=!0,_m);case"textInput":return i=u.data,i===_m&&Sm?null:i;default:return null}}function NE(i,u){if(Qi)return i==="compositionend"||!Df&&Rm(i,u)?(i=ym(),Fs=_f=Ca=null,Qi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Cm&&u.locale!=="ko"?null:u.data;default:return null}}var OE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tm(i){var u=i&&i.nodeName&&i.nodeName.toLowerCase();return u==="input"?!!OE[i.type]:u==="textarea"}function Dm(i,u,c,d){Ki?Yi?Yi.push(d):Yi=[d]:Ki=d,u=Dl(u,"onChange"),0<u.length&&(c=new Us("onChange","change",null,c,d),i.push({event:c,listeners:u}))}var su=null,lu=null;function ME(i){f0(i,0)}function Hs(i){var u=nu(i);if(cm(u))return i}function Nm(i,u){if(i==="change")return u}var Om=!1;if(Kr){var Nf;if(Kr){var Of="oninput"in document;if(!Of){var Mm=document.createElement("div");Mm.setAttribute("oninput","return;"),Of=typeof Mm.oninput=="function"}Nf=Of}else Nf=!1;Om=Nf&&(!document.documentMode||9<document.documentMode)}function km(){su&&(su.detachEvent("onpropertychange",Im),lu=su=null)}function Im(i){if(i.propertyName==="value"&&Hs(lu)){var u=[];Dm(u,lu,i,wf(i)),gm(ME,u)}}function kE(i,u,c){i==="focusin"?(km(),su=u,lu=c,su.attachEvent("onpropertychange",Im)):i==="focusout"&&km()}function IE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Hs(lu)}function BE(i,u){if(i==="click")return Hs(u)}function FE(i,u){if(i==="input"||i==="change")return Hs(u)}function LE(i,u){return i===u&&(i!==0||1/i===1/u)||i!==i&&u!==u}var In=typeof Object.is=="function"?Object.is:LE;function cu(i,u){if(In(i,u))return!0;if(typeof i!="object"||i===null||typeof u!="object"||u===null)return!1;var c=Object.keys(i),d=Object.keys(u);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var g=c[d];if(!Xt.call(u,g)||!In(i[g],u[g]))return!1}return!0}function Bm(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Fm(i,u){var c=Bm(i);i=0;for(var d;c;){if(c.nodeType===3){if(d=i+c.textContent.length,i<=u&&d>=u)return{node:c,offset:u-i};i=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Bm(c)}}function Lm(i,u){return i&&u?i===u?!0:i&&i.nodeType===3?!1:u&&u.nodeType===3?Lm(i,u.parentNode):"contains"in i?i.contains(u):i.compareDocumentPosition?!!(i.compareDocumentPosition(u)&16):!1:!1}function zm(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var u=Is(i.document);u instanceof i.HTMLIFrameElement;){try{var c=typeof u.contentWindow.location.href=="string"}catch{c=!1}if(c)i=u.contentWindow;else break;u=Is(i.document)}return u}function Mf(i){var u=i&&i.nodeName&&i.nodeName.toLowerCase();return u&&(u==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||u==="textarea"||i.contentEditable==="true")}var zE=Kr&&"documentMode"in document&&11>=document.documentMode,Zi=null,kf=null,fu=null,If=!1;function Um(i,u,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;If||Zi==null||Zi!==Is(d)||(d=Zi,"selectionStart"in d&&Mf(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),fu&&cu(fu,d)||(fu=d,d=Dl(kf,"onSelect"),0<d.length&&(u=new Us("onSelect","select",null,u,c),i.push({event:u,listeners:d}),u.target=Zi)))}function ui(i,u){var c={};return c[i.toLowerCase()]=u.toLowerCase(),c["Webkit"+i]="webkit"+u,c["Moz"+i]="moz"+u,c}var Ji={animationend:ui("Animation","AnimationEnd"),animationiteration:ui("Animation","AnimationIteration"),animationstart:ui("Animation","AnimationStart"),transitionrun:ui("Transition","TransitionRun"),transitionstart:ui("Transition","TransitionStart"),transitioncancel:ui("Transition","TransitionCancel"),transitionend:ui("Transition","TransitionEnd")},Bf={},Pm={};Kr&&(Pm=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function si(i){if(Bf[i])return Bf[i];if(!Ji[i])return i;var u=Ji[i],c;for(c in u)if(u.hasOwnProperty(c)&&c in Pm)return Bf[i]=u[c];return i}var Hm=si("animationend"),Vm=si("animationiteration"),Wm=si("animationstart"),UE=si("transitionrun"),PE=si("transitionstart"),HE=si("transitioncancel"),jm=si("transitionend"),Gm=new Map,Ff="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ff.push("scrollEnd");function hr(i,u){Gm.set(i,u),ii(u,[i])}var Vs=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Zn=[],$i=0,Lf=0;function Ws(){for(var i=$i,u=Lf=$i=0;u<i;){var c=Zn[u];Zn[u++]=null;var d=Zn[u];Zn[u++]=null;var g=Zn[u];Zn[u++]=null;var b=Zn[u];if(Zn[u++]=null,d!==null&&g!==null){var S=d.pending;S===null?g.next=g:(g.next=S.next,S.next=g),d.pending=g}b!==0&&qm(c,g,b)}}function js(i,u,c,d){Zn[$i++]=i,Zn[$i++]=u,Zn[$i++]=c,Zn[$i++]=d,Lf|=d,i.lanes|=d,i=i.alternate,i!==null&&(i.lanes|=d)}function zf(i,u,c,d){return js(i,u,c,d),Gs(i)}function li(i,u){return js(i,null,null,u),Gs(i)}function qm(i,u,c){i.lanes|=c;var d=i.alternate;d!==null&&(d.lanes|=c);for(var g=!1,b=i.return;b!==null;)b.childLanes|=c,d=b.alternate,d!==null&&(d.childLanes|=c),b.tag===22&&(i=b.stateNode,i===null||i._visibility&1||(g=!0)),i=b,b=b.return;return i.tag===3?(b=i.stateNode,g&&u!==null&&(g=31-kn(c),i=b.hiddenUpdates,d=i[g],d===null?i[g]=[u]:d.push(u),u.lane=c|536870912),b):null}function Gs(i){if(50<ku)throw ku=0,Xh=null,Error(n(185));for(var u=i.return;u!==null;)i=u,u=i.return;return i.tag===3?i.stateNode:null}var eo={};function VE(i,u,c,d){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(i,u,c,d){return new VE(i,u,c,d)}function Uf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Yr(i,u){var c=i.alternate;return c===null?(c=Bn(i.tag,u,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=u,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,u=i.dependencies,c.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Xm(i,u){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=u,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,u=c.dependencies,i.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),i}function qs(i,u,c,d,g,b){var S=0;if(d=i,typeof i=="function")Uf(i)&&(S=1);else if(typeof i=="string")S=XC(i,c,pe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case k:return i=Bn(31,c,u,g),i.elementType=k,i.lanes=b,i;case E:return ci(c.children,g,b,u);case w:S=8,g|=24;break;case C:return i=Bn(12,c,u,g|2),i.elementType=C,i.lanes=b,i;case T:return i=Bn(13,c,u,g),i.elementType=T,i.lanes=b,i;case N:return i=Bn(19,c,u,g),i.elementType=N,i.lanes=b,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case R:S=10;break e;case _:S=9;break e;case A:S=11;break e;case M:S=14;break e;case I:S=16,d=null;break e}S=29,c=Error(n(130,i===null?"null":typeof i,"")),d=null}return u=Bn(S,c,u,g),u.elementType=i,u.type=d,u.lanes=b,u}function ci(i,u,c,d){return i=Bn(7,i,d,u),i.lanes=c,i}function Pf(i,u,c){return i=Bn(6,i,null,u),i.lanes=c,i}function Km(i){var u=Bn(18,null,null,0);return u.stateNode=i,u}function Hf(i,u,c){return u=Bn(4,i.children!==null?i.children:[],i.key,u),u.lanes=c,u.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},u}var Ym=new WeakMap;function Jn(i,u){if(typeof i=="object"&&i!==null){var c=Ym.get(i);return c!==void 0?c:(u={value:i,source:u,stack:On(u)},Ym.set(i,u),u)}return{value:i,source:u,stack:On(u)}}var to=[],no=0,Xs=null,hu=0,$n=[],er=0,_a=null,Cr=1,_r="";function Qr(i,u){to[no++]=hu,to[no++]=Xs,Xs=i,hu=u}function Qm(i,u,c){$n[er++]=Cr,$n[er++]=_r,$n[er++]=_a,_a=i;var d=Cr;i=_r;var g=32-kn(d)-1;d&=~(1<<g),c+=1;var b=32-kn(u)+g;if(30<b){var S=g-g%5;b=(d&(1<<S)-1).toString(32),d>>=S,g-=S,Cr=1<<32-kn(u)+g|c<<g|d,_r=b+i}else Cr=1<<b|c<<g|d,_r=i}function Vf(i){i.return!==null&&(Qr(i,1),Qm(i,1,0))}function Wf(i){for(;i===Xs;)Xs=to[--no],to[no]=null,hu=to[--no],to[no]=null;for(;i===_a;)_a=$n[--er],$n[er]=null,_r=$n[--er],$n[er]=null,Cr=$n[--er],$n[er]=null}function Zm(i,u){$n[er++]=Cr,$n[er++]=_r,$n[er++]=_a,Cr=u.id,_r=u.overflow,_a=i}var Qt=null,pt=null,Ke=!1,Sa=null,tr=!1,jf=Error(n(519));function Ra(i){var u=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw du(Jn(u,i)),jf}function Jm(i){var u=i.stateNode,c=i.type,d=i.memoizedProps;switch(u[Yt]=i,u[gn]=d,c){case"dialog":je("cancel",u),je("close",u);break;case"iframe":case"object":case"embed":je("load",u);break;case"video":case"audio":for(c=0;c<Bu.length;c++)je(Bu[c],u);break;case"source":je("error",u);break;case"img":case"image":case"link":je("error",u),je("load",u);break;case"details":je("toggle",u);break;case"input":je("invalid",u),fm(u,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":je("invalid",u);break;case"textarea":je("invalid",u),dm(u,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||u.textContent===""+c||d.suppressHydrationWarning===!0||v0(u.textContent,c)?(d.popover!=null&&(je("beforetoggle",u),je("toggle",u)),d.onScroll!=null&&je("scroll",u),d.onScrollEnd!=null&&je("scrollend",u),d.onClick!=null&&(u.onclick=Xr),u=!0):u=!1,u||Ra(i,!0)}function $m(i){for(Qt=i.return;Qt;)switch(Qt.tag){case 5:case 31:case 13:tr=!1;return;case 27:case 3:tr=!0;return;default:Qt=Qt.return}}function ro(i){if(i!==Qt)return!1;if(!Ke)return $m(i),Ke=!0,!1;var u=i.tag,c;if((c=u!==3&&u!==27)&&((c=u===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||sd(i.type,i.memoizedProps)),c=!c),c&&pt&&Ra(i),$m(i),u===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));pt=_0(i)}else if(u===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));pt=_0(i)}else u===27?(u=pt,Pa(i.type)?(i=dd,dd=null,pt=i):pt=u):pt=Qt?rr(i.stateNode.nextSibling):null;return!0}function fi(){pt=Qt=null,Ke=!1}function Gf(){var i=Sa;return i!==null&&(En===null?En=i:En.push.apply(En,i),Sa=null),i}function du(i){Sa===null?Sa=[i]:Sa.push(i)}var qf=L(null),hi=null,Zr=null;function Aa(i,u,c){ue(qf,u._currentValue),u._currentValue=c}function Jr(i){i._currentValue=qf.current,q(qf)}function Xf(i,u,c){for(;i!==null;){var d=i.alternate;if((i.childLanes&u)!==u?(i.childLanes|=u,d!==null&&(d.childLanes|=u)):d!==null&&(d.childLanes&u)!==u&&(d.childLanes|=u),i===c)break;i=i.return}}function Kf(i,u,c,d){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var b=g.dependencies;if(b!==null){var S=g.child;b=b.firstContext;e:for(;b!==null;){var D=b;b=g;for(var U=0;U<u.length;U++)if(D.context===u[U]){b.lanes|=c,D=b.alternate,D!==null&&(D.lanes|=c),Xf(b.return,c,i),d||(S=null);break e}b=D.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(n(341));S.lanes|=c,b=S.alternate,b!==null&&(b.lanes|=c),Xf(S,c,i),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===i){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function ao(i,u,c,d){i=null;for(var g=u,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(n(387));if(S=S.memoizedProps,S!==null){var D=g.type;In(g.pendingProps.value,S.value)||(i!==null?i.push(D):i=[D])}}else if(g===xe.current){if(S=g.alternate,S===null)throw Error(n(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(Pu):i=[Pu])}g=g.return}i!==null&&Kf(u,i,c,d),u.flags|=262144}function Ks(i){for(i=i.firstContext;i!==null;){if(!In(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function di(i){hi=i,Zr=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Zt(i){return eg(hi,i)}function Ys(i,u){return hi===null&&di(i),eg(i,u)}function eg(i,u){var c=u._currentValue;if(u={context:u,memoizedValue:c,next:null},Zr===null){if(i===null)throw Error(n(308));Zr=u,i.dependencies={lanes:0,firstContext:u},i.flags|=524288}else Zr=Zr.next=u;return c}var WE=typeof AbortController<"u"?AbortController:function(){var i=[],u=this.signal={aborted:!1,addEventListener:function(c,d){i.push(d)}};this.abort=function(){u.aborted=!0,i.forEach(function(c){return c()})}},jE=r.unstable_scheduleCallback,GE=r.unstable_NormalPriority,Nt={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new WE,data:new Map,refCount:0}}function pu(i){i.refCount--,i.refCount===0&&jE(GE,function(){i.controller.abort()})}var vu=null,Qf=0,io=0,oo=null;function qE(i,u){if(vu===null){var c=vu=[];Qf=0,io=$h(),oo={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Qf++,u.then(tg,tg),u}function tg(){if(--Qf===0&&vu!==null){oo!==null&&(oo.status="fulfilled");var i=vu;vu=null,io=0,oo=null;for(var u=0;u<i.length;u++)(0,i[u])()}}function XE(i,u){var c=[],d={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){d.status="fulfilled",d.value=u;for(var g=0;g<c.length;g++)(0,c[g])(u)},function(g){for(d.status="rejected",d.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),d}var ng=z.S;z.S=function(i,u){Uy=Dt(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&qE(i,u),ng!==null&&ng(i,u)};var pi=L(null);function Zf(){var i=pi.current;return i!==null?i:ht.pooledCache}function Qs(i,u){u===null?ue(pi,pi.current):ue(pi,u.pool)}function rg(){var i=Zf();return i===null?null:{parent:Nt._currentValue,pool:i}}var uo=Error(n(460)),Jf=Error(n(474)),Zs=Error(n(542)),Js={then:function(){}};function ag(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ig(i,u,c){switch(c=i[c],c===void 0?i.push(u):c!==u&&(u.then(Xr,Xr),u=c),u.status){case"fulfilled":return u.value;case"rejected":throw i=u.reason,ug(i),i;default:if(typeof u.status=="string")u.then(Xr,Xr);else{if(i=ht,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=u,i.status="pending",i.then(function(d){if(u.status==="pending"){var g=u;g.status="fulfilled",g.value=d}},function(d){if(u.status==="pending"){var g=u;g.status="rejected",g.reason=d}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw i=u.reason,ug(i),i}throw mi=u,uo}}function vi(i){try{var u=i._init;return u(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(mi=c,uo):c}}var mi=null;function og(){if(mi===null)throw Error(n(459));var i=mi;return mi=null,i}function ug(i){if(i===uo||i===Zs)throw Error(n(483))}var so=null,mu=0;function $s(i){var u=mu;return mu+=1,so===null&&(so=[]),ig(so,i,u)}function gu(i,u){u=u.props.ref,i.ref=u!==void 0?u:null}function el(i,u){throw u.$$typeof===m?Error(n(525)):(i=Object.prototype.toString.call(u),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":i)))}function sg(i){function u(X,V){if(i){var Y=X.deletions;Y===null?(X.deletions=[V],X.flags|=16):Y.push(V)}}function c(X,V){if(!i)return null;for(;V!==null;)u(X,V),V=V.sibling;return null}function d(X){for(var V=new Map;X!==null;)X.key!==null?V.set(X.key,X):V.set(X.index,X),X=X.sibling;return V}function g(X,V){return X=Yr(X,V),X.index=0,X.sibling=null,X}function b(X,V,Y){return X.index=Y,i?(Y=X.alternate,Y!==null?(Y=Y.index,Y<V?(X.flags|=67108866,V):Y):(X.flags|=67108866,V)):(X.flags|=1048576,V)}function S(X){return i&&X.alternate===null&&(X.flags|=67108866),X}function D(X,V,Y,fe){return V===null||V.tag!==6?(V=Pf(Y,X.mode,fe),V.return=X,V):(V=g(V,Y),V.return=X,V)}function U(X,V,Y,fe){var Ne=Y.type;return Ne===E?le(X,V,Y.props.children,fe,Y.key):V!==null&&(V.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===I&&vi(Ne)===V.type)?(V=g(V,Y.props),gu(V,Y),V.return=X,V):(V=qs(Y.type,Y.key,Y.props,null,X.mode,fe),gu(V,Y),V.return=X,V)}function Q(X,V,Y,fe){return V===null||V.tag!==4||V.stateNode.containerInfo!==Y.containerInfo||V.stateNode.implementation!==Y.implementation?(V=Hf(Y,X.mode,fe),V.return=X,V):(V=g(V,Y.children||[]),V.return=X,V)}function le(X,V,Y,fe,Ne){return V===null||V.tag!==7?(V=ci(Y,X.mode,fe,Ne),V.return=X,V):(V=g(V,Y),V.return=X,V)}function he(X,V,Y){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Pf(""+V,X.mode,Y),V.return=X,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case y:return Y=qs(V.type,V.key,V.props,null,X.mode,Y),gu(Y,V),Y.return=X,Y;case x:return V=Hf(V,X.mode,Y),V.return=X,V;case I:return V=vi(V),he(X,V,Y)}if(ae(V)||P(V))return V=ci(V,X.mode,Y,null),V.return=X,V;if(typeof V.then=="function")return he(X,$s(V),Y);if(V.$$typeof===R)return he(X,Ys(X,V),Y);el(X,V)}return null}function Z(X,V,Y,fe){var Ne=V!==null?V.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Ne!==null?null:D(X,V,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case y:return Y.key===Ne?U(X,V,Y,fe):null;case x:return Y.key===Ne?Q(X,V,Y,fe):null;case I:return Y=vi(Y),Z(X,V,Y,fe)}if(ae(Y)||P(Y))return Ne!==null?null:le(X,V,Y,fe,null);if(typeof Y.then=="function")return Z(X,V,$s(Y),fe);if(Y.$$typeof===R)return Z(X,V,Ys(X,Y),fe);el(X,Y)}return null}function te(X,V,Y,fe,Ne){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return X=X.get(Y)||null,D(V,X,""+fe,Ne);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return X=X.get(fe.key===null?Y:fe.key)||null,U(V,X,fe,Ne);case x:return X=X.get(fe.key===null?Y:fe.key)||null,Q(V,X,fe,Ne);case I:return fe=vi(fe),te(X,V,Y,fe,Ne)}if(ae(fe)||P(fe))return X=X.get(Y)||null,le(V,X,fe,Ne,null);if(typeof fe.then=="function")return te(X,V,Y,$s(fe),Ne);if(fe.$$typeof===R)return te(X,V,Y,Ys(V,fe),Ne);el(V,fe)}return null}function we(X,V,Y,fe){for(var Ne=null,Je=null,_e=V,Ue=V=0,Xe=null;_e!==null&&Ue<Y.length;Ue++){_e.index>Ue?(Xe=_e,_e=null):Xe=_e.sibling;var $e=Z(X,_e,Y[Ue],fe);if($e===null){_e===null&&(_e=Xe);break}i&&_e&&$e.alternate===null&&u(X,_e),V=b($e,V,Ue),Je===null?Ne=$e:Je.sibling=$e,Je=$e,_e=Xe}if(Ue===Y.length)return c(X,_e),Ke&&Qr(X,Ue),Ne;if(_e===null){for(;Ue<Y.length;Ue++)_e=he(X,Y[Ue],fe),_e!==null&&(V=b(_e,V,Ue),Je===null?Ne=_e:Je.sibling=_e,Je=_e);return Ke&&Qr(X,Ue),Ne}for(_e=d(_e);Ue<Y.length;Ue++)Xe=te(_e,X,Ue,Y[Ue],fe),Xe!==null&&(i&&Xe.alternate!==null&&_e.delete(Xe.key===null?Ue:Xe.key),V=b(Xe,V,Ue),Je===null?Ne=Xe:Je.sibling=Xe,Je=Xe);return i&&_e.forEach(function(Ga){return u(X,Ga)}),Ke&&Qr(X,Ue),Ne}function Me(X,V,Y,fe){if(Y==null)throw Error(n(151));for(var Ne=null,Je=null,_e=V,Ue=V=0,Xe=null,$e=Y.next();_e!==null&&!$e.done;Ue++,$e=Y.next()){_e.index>Ue?(Xe=_e,_e=null):Xe=_e.sibling;var Ga=Z(X,_e,$e.value,fe);if(Ga===null){_e===null&&(_e=Xe);break}i&&_e&&Ga.alternate===null&&u(X,_e),V=b(Ga,V,Ue),Je===null?Ne=Ga:Je.sibling=Ga,Je=Ga,_e=Xe}if($e.done)return c(X,_e),Ke&&Qr(X,Ue),Ne;if(_e===null){for(;!$e.done;Ue++,$e=Y.next())$e=he(X,$e.value,fe),$e!==null&&(V=b($e,V,Ue),Je===null?Ne=$e:Je.sibling=$e,Je=$e);return Ke&&Qr(X,Ue),Ne}for(_e=d(_e);!$e.done;Ue++,$e=Y.next())$e=te(_e,X,Ue,$e.value,fe),$e!==null&&(i&&$e.alternate!==null&&_e.delete($e.key===null?Ue:$e.key),V=b($e,V,Ue),Je===null?Ne=$e:Je.sibling=$e,Je=$e);return i&&_e.forEach(function(a_){return u(X,a_)}),Ke&&Qr(X,Ue),Ne}function st(X,V,Y,fe){if(typeof Y=="object"&&Y!==null&&Y.type===E&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case y:e:{for(var Ne=Y.key;V!==null;){if(V.key===Ne){if(Ne=Y.type,Ne===E){if(V.tag===7){c(X,V.sibling),fe=g(V,Y.props.children),fe.return=X,X=fe;break e}}else if(V.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===I&&vi(Ne)===V.type){c(X,V.sibling),fe=g(V,Y.props),gu(fe,Y),fe.return=X,X=fe;break e}c(X,V);break}else u(X,V);V=V.sibling}Y.type===E?(fe=ci(Y.props.children,X.mode,fe,Y.key),fe.return=X,X=fe):(fe=qs(Y.type,Y.key,Y.props,null,X.mode,fe),gu(fe,Y),fe.return=X,X=fe)}return S(X);case x:e:{for(Ne=Y.key;V!==null;){if(V.key===Ne)if(V.tag===4&&V.stateNode.containerInfo===Y.containerInfo&&V.stateNode.implementation===Y.implementation){c(X,V.sibling),fe=g(V,Y.children||[]),fe.return=X,X=fe;break e}else{c(X,V);break}else u(X,V);V=V.sibling}fe=Hf(Y,X.mode,fe),fe.return=X,X=fe}return S(X);case I:return Y=vi(Y),st(X,V,Y,fe)}if(ae(Y))return we(X,V,Y,fe);if(P(Y)){if(Ne=P(Y),typeof Ne!="function")throw Error(n(150));return Y=Ne.call(Y),Me(X,V,Y,fe)}if(typeof Y.then=="function")return st(X,V,$s(Y),fe);if(Y.$$typeof===R)return st(X,V,Ys(X,Y),fe);el(X,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,V!==null&&V.tag===6?(c(X,V.sibling),fe=g(V,Y),fe.return=X,X=fe):(c(X,V),fe=Pf(Y,X.mode,fe),fe.return=X,X=fe),S(X)):c(X,V)}return function(X,V,Y,fe){try{mu=0;var Ne=st(X,V,Y,fe);return so=null,Ne}catch(_e){if(_e===uo||_e===Zs)throw _e;var Je=Bn(29,_e,null,X.mode);return Je.lanes=fe,Je.return=X,Je}}}var gi=sg(!0),lg=sg(!1),Ta=!1;function $f(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eh(i,u){i=i.updateQueue,u.updateQueue===i&&(u.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Da(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Na(i,u,c){var d=i.updateQueue;if(d===null)return null;if(d=d.shared,(et&2)!==0){var g=d.pending;return g===null?u.next=u:(u.next=g.next,g.next=u),d.pending=u,u=Gs(i),qm(i,null,c),u}return js(i,d,u,c),Gs(i)}function yu(i,u,c){if(u=u.updateQueue,u!==null&&(u=u.shared,(c&4194048)!==0)){var d=u.lanes;d&=i.pendingLanes,c|=d,u.lanes=c,em(i,c)}}function th(i,u){var c=i.updateQueue,d=i.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var g=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var S={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?g=b=S:b=b.next=S,c=c.next}while(c!==null);b===null?g=b=u:b=b.next=u}else g=b=u;c={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:d.shared,callbacks:d.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=u:i.next=u,c.lastBaseUpdate=u}var nh=!1;function bu(){if(nh){var i=oo;if(i!==null)throw i}}function xu(i,u,c,d){nh=!1;var g=i.updateQueue;Ta=!1;var b=g.firstBaseUpdate,S=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var U=D,Q=U.next;U.next=null,S===null?b=Q:S.next=Q,S=U;var le=i.alternate;le!==null&&(le=le.updateQueue,D=le.lastBaseUpdate,D!==S&&(D===null?le.firstBaseUpdate=Q:D.next=Q,le.lastBaseUpdate=U))}if(b!==null){var he=g.baseState;S=0,le=Q=U=null,D=b;do{var Z=D.lane&-536870913,te=Z!==D.lane;if(te?(qe&Z)===Z:(d&Z)===Z){Z!==0&&Z===io&&(nh=!0),le!==null&&(le=le.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var we=i,Me=D;Z=u;var st=c;switch(Me.tag){case 1:if(we=Me.payload,typeof we=="function"){he=we.call(st,he,Z);break e}he=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Me.payload,Z=typeof we=="function"?we.call(st,he,Z):we,Z==null)break e;he=v({},he,Z);break e;case 2:Ta=!0}}Z=D.callback,Z!==null&&(i.flags|=64,te&&(i.flags|=8192),te=g.callbacks,te===null?g.callbacks=[Z]:te.push(Z))}else te={lane:Z,tag:D.tag,payload:D.payload,callback:D.callback,next:null},le===null?(Q=le=te,U=he):le=le.next=te,S|=Z;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;te=D,D=te.next,te.next=null,g.lastBaseUpdate=te,g.shared.pending=null}}while(!0);le===null&&(U=he),g.baseState=U,g.firstBaseUpdate=Q,g.lastBaseUpdate=le,b===null&&(g.shared.lanes=0),Ba|=S,i.lanes=S,i.memoizedState=he}}function cg(i,u){if(typeof i!="function")throw Error(n(191,i));i.call(u)}function fg(i,u){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)cg(c[i],u)}var lo=L(null),tl=L(0);function hg(i,u){i=ua,ue(tl,i),ue(lo,u),ua=i|u.baseLanes}function rh(){ue(tl,ua),ue(lo,lo.current)}function ah(){ua=tl.current,q(lo),q(tl)}var Fn=L(null),nr=null;function Oa(i){var u=i.alternate;ue(St,St.current&1),ue(Fn,i),nr===null&&(u===null||lo.current!==null||u.memoizedState!==null)&&(nr=i)}function ih(i){ue(St,St.current),ue(Fn,i),nr===null&&(nr=i)}function dg(i){i.tag===22?(ue(St,St.current),ue(Fn,i),nr===null&&(nr=i)):Ma()}function Ma(){ue(St,St.current),ue(Fn,Fn.current)}function Ln(i){q(Fn),nr===i&&(nr=null),q(St)}var St=L(0);function nl(i){for(var u=i;u!==null;){if(u.tag===13){var c=u.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||fd(c)||hd(c)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var $r=0,ze=null,ot=null,Ot=null,rl=!1,co=!1,yi=!1,al=0,wu=0,fo=null,KE=0;function Et(){throw Error(n(321))}function oh(i,u){if(u===null)return!1;for(var c=0;c<u.length&&c<i.length;c++)if(!In(i[c],u[c]))return!1;return!0}function uh(i,u,c,d,g,b){return $r=b,ze=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,z.H=i===null||i.memoizedState===null?Qg:Eh,yi=!1,b=c(d,g),yi=!1,co&&(b=vg(u,c,d,g)),pg(i),b}function pg(i){z.H=_u;var u=ot!==null&&ot.next!==null;if($r=0,Ot=ot=ze=null,rl=!1,wu=0,fo=null,u)throw Error(n(300));i===null||Mt||(i=i.dependencies,i!==null&&Ks(i)&&(Mt=!0))}function vg(i,u,c,d){ze=i;var g=0;do{if(co&&(fo=null),wu=0,co=!1,25<=g)throw Error(n(301));if(g+=1,Ot=ot=null,i.updateQueue!=null){var b=i.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}z.H=Zg,b=u(c,d)}while(co);return b}function YE(){var i=z.H,u=i.useState()[0];return u=typeof u.then=="function"?Eu(u):u,i=i.useState()[0],(ot!==null?ot.memoizedState:null)!==i&&(ze.flags|=1024),u}function sh(){var i=al!==0;return al=0,i}function lh(i,u,c){u.updateQueue=i.updateQueue,u.flags&=-2053,i.lanes&=~c}function ch(i){if(rl){for(i=i.memoizedState;i!==null;){var u=i.queue;u!==null&&(u.pending=null),i=i.next}rl=!1}$r=0,Ot=ot=ze=null,co=!1,wu=al=0,fo=null}function dn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?ze.memoizedState=Ot=i:Ot=Ot.next=i,Ot}function Rt(){if(ot===null){var i=ze.alternate;i=i!==null?i.memoizedState:null}else i=ot.next;var u=Ot===null?ze.memoizedState:Ot.next;if(u!==null)Ot=u,ot=i;else{if(i===null)throw ze.alternate===null?Error(n(467)):Error(n(310));ot=i,i={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},Ot===null?ze.memoizedState=Ot=i:Ot=Ot.next=i}return Ot}function il(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Eu(i){var u=wu;return wu+=1,fo===null&&(fo=[]),i=ig(fo,i,u),u=ze,(Ot===null?u.memoizedState:Ot.next)===null&&(u=u.alternate,z.H=u===null||u.memoizedState===null?Qg:Eh),i}function ol(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Eu(i);if(i.$$typeof===R)return Zt(i)}throw Error(n(438,String(i)))}function fh(i){var u=null,c=ze.updateQueue;if(c!==null&&(u=c.memoCache),u==null){var d=ze.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(u={data:d.data.map(function(g){return g.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),c===null&&(c=il(),ze.updateQueue=c),c.memoCache=u,c=u.data[u.index],c===void 0)for(c=u.data[u.index]=Array(i),d=0;d<i;d++)c[d]=F;return u.index++,c}function ea(i,u){return typeof u=="function"?u(i):u}function ul(i){var u=Rt();return hh(u,ot,i)}function hh(i,u,c){var d=i.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var g=i.baseQueue,b=d.pending;if(b!==null){if(g!==null){var S=g.next;g.next=b.next,b.next=S}u.baseQueue=g=b,d.pending=null}if(b=i.baseState,g===null)i.memoizedState=b;else{u=g.next;var D=S=null,U=null,Q=u,le=!1;do{var he=Q.lane&-536870913;if(he!==Q.lane?(qe&he)===he:($r&he)===he){var Z=Q.revertLane;if(Z===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),he===io&&(le=!0);else if(($r&Z)===Z){Q=Q.next,Z===io&&(le=!0);continue}else he={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(D=U=he,S=b):U=U.next=he,ze.lanes|=Z,Ba|=Z;he=Q.action,yi&&c(b,he),b=Q.hasEagerState?Q.eagerState:c(b,he)}else Z={lane:he,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(D=U=Z,S=b):U=U.next=Z,ze.lanes|=he,Ba|=he;Q=Q.next}while(Q!==null&&Q!==u);if(U===null?S=b:U.next=D,!In(b,i.memoizedState)&&(Mt=!0,le&&(c=oo,c!==null)))throw c;i.memoizedState=b,i.baseState=S,i.baseQueue=U,d.lastRenderedState=b}return g===null&&(d.lanes=0),[i.memoizedState,d.dispatch]}function dh(i){var u=Rt(),c=u.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var d=c.dispatch,g=c.pending,b=u.memoizedState;if(g!==null){c.pending=null;var S=g=g.next;do b=i(b,S.action),S=S.next;while(S!==g);In(b,u.memoizedState)||(Mt=!0),u.memoizedState=b,u.baseQueue===null&&(u.baseState=b),c.lastRenderedState=b}return[b,d]}function mg(i,u,c){var d=ze,g=Rt(),b=Ke;if(b){if(c===void 0)throw Error(n(407));c=c()}else c=u();var S=!In((ot||g).memoizedState,c);if(S&&(g.memoizedState=c,Mt=!0),g=g.queue,mh(bg.bind(null,d,g,i),[i]),g.getSnapshot!==u||S||Ot!==null&&Ot.memoizedState.tag&1){if(d.flags|=2048,ho(9,{destroy:void 0},yg.bind(null,d,g,c,u),null),ht===null)throw Error(n(349));b||($r&127)!==0||gg(d,u,c)}return c}function gg(i,u,c){i.flags|=16384,i={getSnapshot:u,value:c},u=ze.updateQueue,u===null?(u=il(),ze.updateQueue=u,u.stores=[i]):(c=u.stores,c===null?u.stores=[i]:c.push(i))}function yg(i,u,c,d){u.value=c,u.getSnapshot=d,xg(u)&&wg(i)}function bg(i,u,c){return c(function(){xg(u)&&wg(i)})}function xg(i){var u=i.getSnapshot;i=i.value;try{var c=u();return!In(i,c)}catch{return!0}}function wg(i){var u=li(i,2);u!==null&&Cn(u,i,2)}function ph(i){var u=dn();if(typeof i=="function"){var c=i;if(i=c(),yi){Kn(!0);try{c()}finally{Kn(!1)}}}return u.memoizedState=u.baseState=i,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ea,lastRenderedState:i},u}function Eg(i,u,c,d){return i.baseState=c,hh(i,ot,typeof d=="function"?d:ea)}function QE(i,u,c,d,g){if(cl(i))throw Error(n(485));if(i=u.action,i!==null){var b={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){b.listeners.push(S)}};z.T!==null?c(!0):b.isTransition=!1,d(b),c=u.pending,c===null?(b.next=u.pending=b,Cg(u,b)):(b.next=c.next,u.pending=c.next=b)}}function Cg(i,u){var c=u.action,d=u.payload,g=i.state;if(u.isTransition){var b=z.T,S={};z.T=S;try{var D=c(g,d),U=z.S;U!==null&&U(S,D),_g(i,u,D)}catch(Q){vh(i,u,Q)}finally{b!==null&&S.types!==null&&(b.types=S.types),z.T=b}}else try{b=c(g,d),_g(i,u,b)}catch(Q){vh(i,u,Q)}}function _g(i,u,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){Sg(i,u,d)},function(d){return vh(i,u,d)}):Sg(i,u,c)}function Sg(i,u,c){u.status="fulfilled",u.value=c,Rg(u),i.state=c,u=i.pending,u!==null&&(c=u.next,c===u?i.pending=null:(c=c.next,u.next=c,Cg(i,c)))}function vh(i,u,c){var d=i.pending;if(i.pending=null,d!==null){d=d.next;do u.status="rejected",u.reason=c,Rg(u),u=u.next;while(u!==d)}i.action=null}function Rg(i){i=i.listeners;for(var u=0;u<i.length;u++)(0,i[u])()}function Ag(i,u){return u}function Tg(i,u){if(Ke){var c=ht.formState;if(c!==null){e:{var d=ze;if(Ke){if(pt){t:{for(var g=pt,b=tr;g.nodeType!==8;){if(!b){g=null;break t}if(g=rr(g.nextSibling),g===null){g=null;break t}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){pt=rr(g.nextSibling),d=g.data==="F!";break e}}Ra(d)}d=!1}d&&(u=c[0])}}return c=dn(),c.memoizedState=c.baseState=u,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ag,lastRenderedState:u},c.queue=d,c=Xg.bind(null,ze,d),d.dispatch=c,d=ph(!1),b=wh.bind(null,ze,!1,d.queue),d=dn(),g={state:u,dispatch:null,action:i,pending:null},d.queue=g,c=QE.bind(null,ze,g,b,c),g.dispatch=c,d.memoizedState=i,[u,c,!1]}function Dg(i){var u=Rt();return Ng(u,ot,i)}function Ng(i,u,c){if(u=hh(i,u,Ag)[0],i=ul(ea)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var d=Eu(u)}catch(S){throw S===uo?Zs:S}else d=u;u=Rt();var g=u.queue,b=g.dispatch;return c!==u.memoizedState&&(ze.flags|=2048,ho(9,{destroy:void 0},ZE.bind(null,g,c),null)),[d,b,i]}function ZE(i,u){i.action=u}function Og(i){var u=Rt(),c=ot;if(c!==null)return Ng(u,c,i);Rt(),u=u.memoizedState,c=Rt();var d=c.queue.dispatch;return c.memoizedState=i,[u,d,!1]}function ho(i,u,c,d){return i={tag:i,create:c,deps:d,inst:u,next:null},u=ze.updateQueue,u===null&&(u=il(),ze.updateQueue=u),c=u.lastEffect,c===null?u.lastEffect=i.next=i:(d=c.next,c.next=i,i.next=d,u.lastEffect=i),i}function Mg(){return Rt().memoizedState}function sl(i,u,c,d){var g=dn();ze.flags|=i,g.memoizedState=ho(1|u,{destroy:void 0},c,d===void 0?null:d)}function ll(i,u,c,d){var g=Rt();d=d===void 0?null:d;var b=g.memoizedState.inst;ot!==null&&d!==null&&oh(d,ot.memoizedState.deps)?g.memoizedState=ho(u,b,c,d):(ze.flags|=i,g.memoizedState=ho(1|u,b,c,d))}function kg(i,u){sl(8390656,8,i,u)}function mh(i,u){ll(2048,8,i,u)}function JE(i){ze.flags|=4;var u=ze.updateQueue;if(u===null)u=il(),ze.updateQueue=u,u.events=[i];else{var c=u.events;c===null?u.events=[i]:c.push(i)}}function Ig(i){var u=Rt().memoizedState;return JE({ref:u,nextImpl:i}),function(){if((et&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}function Bg(i,u){return ll(4,2,i,u)}function Fg(i,u){return ll(4,4,i,u)}function Lg(i,u){if(typeof u=="function"){i=i();var c=u(i);return function(){typeof c=="function"?c():u(null)}}if(u!=null)return i=i(),u.current=i,function(){u.current=null}}function zg(i,u,c){c=c!=null?c.concat([i]):null,ll(4,4,Lg.bind(null,u,i),c)}function gh(){}function Ug(i,u){var c=Rt();u=u===void 0?null:u;var d=c.memoizedState;return u!==null&&oh(u,d[1])?d[0]:(c.memoizedState=[i,u],i)}function Pg(i,u){var c=Rt();u=u===void 0?null:u;var d=c.memoizedState;if(u!==null&&oh(u,d[1]))return d[0];if(d=i(),yi){Kn(!0);try{i()}finally{Kn(!1)}}return c.memoizedState=[d,u],d}function yh(i,u,c){return c===void 0||($r&1073741824)!==0&&(qe&261930)===0?i.memoizedState=u:(i.memoizedState=c,i=Hy(),ze.lanes|=i,Ba|=i,c)}function Hg(i,u,c,d){return In(c,u)?c:lo.current!==null?(i=yh(i,c,d),In(i,u)||(Mt=!0),i):($r&42)===0||($r&1073741824)!==0&&(qe&261930)===0?(Mt=!0,i.memoizedState=c):(i=Hy(),ze.lanes|=i,Ba|=i,u)}function Vg(i,u,c,d,g){var b=G.p;G.p=b!==0&&8>b?b:8;var S=z.T,D={};z.T=D,wh(i,!1,u,c);try{var U=g(),Q=z.S;if(Q!==null&&Q(D,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var le=XE(U,d);Cu(i,u,le,Pn(i))}else Cu(i,u,d,Pn(i))}catch(he){Cu(i,u,{then:function(){},status:"rejected",reason:he},Pn())}finally{G.p=b,S!==null&&D.types!==null&&(S.types=D.types),z.T=S}}function $E(){}function bh(i,u,c,d){if(i.tag!==5)throw Error(n(476));var g=Wg(i).queue;Vg(i,g,u,K,c===null?$E:function(){return jg(i),c(d)})}function Wg(i){var u=i.memoizedState;if(u!==null)return u;u={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ea,lastRenderedState:K},next:null};var c={};return u.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ea,lastRenderedState:c},next:null},i.memoizedState=u,i=i.alternate,i!==null&&(i.memoizedState=u),u}function jg(i){var u=Wg(i);u.next===null&&(u=i.alternate.memoizedState),Cu(i,u.next.queue,{},Pn())}function xh(){return Zt(Pu)}function Gg(){return Rt().memoizedState}function qg(){return Rt().memoizedState}function eC(i){for(var u=i.return;u!==null;){switch(u.tag){case 24:case 3:var c=Pn();i=Da(c);var d=Na(u,i,c);d!==null&&(Cn(d,u,c),yu(d,u,c)),u={cache:Yf()},i.payload=u;return}u=u.return}}function tC(i,u,c){var d=Pn();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},cl(i)?Kg(u,c):(c=zf(i,u,c,d),c!==null&&(Cn(c,i,d),Yg(c,u,d)))}function Xg(i,u,c){var d=Pn();Cu(i,u,c,d)}function Cu(i,u,c,d){var g={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(cl(i))Kg(u,g);else{var b=i.alternate;if(i.lanes===0&&(b===null||b.lanes===0)&&(b=u.lastRenderedReducer,b!==null))try{var S=u.lastRenderedState,D=b(S,c);if(g.hasEagerState=!0,g.eagerState=D,In(D,S))return js(i,u,g,0),ht===null&&Ws(),!1}catch{}if(c=zf(i,u,g,d),c!==null)return Cn(c,i,d),Yg(c,u,d),!0}return!1}function wh(i,u,c,d){if(d={lane:2,revertLane:$h(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},cl(i)){if(u)throw Error(n(479))}else u=zf(i,c,d,2),u!==null&&Cn(u,i,2)}function cl(i){var u=i.alternate;return i===ze||u!==null&&u===ze}function Kg(i,u){co=rl=!0;var c=i.pending;c===null?u.next=u:(u.next=c.next,c.next=u),i.pending=u}function Yg(i,u,c){if((c&4194048)!==0){var d=u.lanes;d&=i.pendingLanes,c|=d,u.lanes=c,em(i,c)}}var _u={readContext:Zt,use:ol,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useLayoutEffect:Et,useInsertionEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useSyncExternalStore:Et,useId:Et,useHostTransitionStatus:Et,useFormState:Et,useActionState:Et,useOptimistic:Et,useMemoCache:Et,useCacheRefresh:Et};_u.useEffectEvent=Et;var Qg={readContext:Zt,use:ol,useCallback:function(i,u){return dn().memoizedState=[i,u===void 0?null:u],i},useContext:Zt,useEffect:kg,useImperativeHandle:function(i,u,c){c=c!=null?c.concat([i]):null,sl(4194308,4,Lg.bind(null,u,i),c)},useLayoutEffect:function(i,u){return sl(4194308,4,i,u)},useInsertionEffect:function(i,u){sl(4,2,i,u)},useMemo:function(i,u){var c=dn();u=u===void 0?null:u;var d=i();if(yi){Kn(!0);try{i()}finally{Kn(!1)}}return c.memoizedState=[d,u],d},useReducer:function(i,u,c){var d=dn();if(c!==void 0){var g=c(u);if(yi){Kn(!0);try{c(u)}finally{Kn(!1)}}}else g=u;return d.memoizedState=d.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},d.queue=i,i=i.dispatch=tC.bind(null,ze,i),[d.memoizedState,i]},useRef:function(i){var u=dn();return i={current:i},u.memoizedState=i},useState:function(i){i=ph(i);var u=i.queue,c=Xg.bind(null,ze,u);return u.dispatch=c,[i.memoizedState,c]},useDebugValue:gh,useDeferredValue:function(i,u){var c=dn();return yh(c,i,u)},useTransition:function(){var i=ph(!1);return i=Vg.bind(null,ze,i.queue,!0,!1),dn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,u,c){var d=ze,g=dn();if(Ke){if(c===void 0)throw Error(n(407));c=c()}else{if(c=u(),ht===null)throw Error(n(349));(qe&127)!==0||gg(d,u,c)}g.memoizedState=c;var b={value:c,getSnapshot:u};return g.queue=b,kg(bg.bind(null,d,b,i),[i]),d.flags|=2048,ho(9,{destroy:void 0},yg.bind(null,d,b,c,u),null),c},useId:function(){var i=dn(),u=ht.identifierPrefix;if(Ke){var c=_r,d=Cr;c=(d&~(1<<32-kn(d)-1)).toString(32)+c,u="_"+u+"R_"+c,c=al++,0<c&&(u+="H"+c.toString(32)),u+="_"}else c=KE++,u="_"+u+"r_"+c.toString(32)+"_";return i.memoizedState=u},useHostTransitionStatus:xh,useFormState:Tg,useActionState:Tg,useOptimistic:function(i){var u=dn();u.memoizedState=u.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=c,u=wh.bind(null,ze,!0,c),c.dispatch=u,[i,u]},useMemoCache:fh,useCacheRefresh:function(){return dn().memoizedState=eC.bind(null,ze)},useEffectEvent:function(i){var u=dn(),c={impl:i};return u.memoizedState=c,function(){if((et&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Eh={readContext:Zt,use:ol,useCallback:Ug,useContext:Zt,useEffect:mh,useImperativeHandle:zg,useInsertionEffect:Bg,useLayoutEffect:Fg,useMemo:Pg,useReducer:ul,useRef:Mg,useState:function(){return ul(ea)},useDebugValue:gh,useDeferredValue:function(i,u){var c=Rt();return Hg(c,ot.memoizedState,i,u)},useTransition:function(){var i=ul(ea)[0],u=Rt().memoizedState;return[typeof i=="boolean"?i:Eu(i),u]},useSyncExternalStore:mg,useId:Gg,useHostTransitionStatus:xh,useFormState:Dg,useActionState:Dg,useOptimistic:function(i,u){var c=Rt();return Eg(c,ot,i,u)},useMemoCache:fh,useCacheRefresh:qg};Eh.useEffectEvent=Ig;var Zg={readContext:Zt,use:ol,useCallback:Ug,useContext:Zt,useEffect:mh,useImperativeHandle:zg,useInsertionEffect:Bg,useLayoutEffect:Fg,useMemo:Pg,useReducer:dh,useRef:Mg,useState:function(){return dh(ea)},useDebugValue:gh,useDeferredValue:function(i,u){var c=Rt();return ot===null?yh(c,i,u):Hg(c,ot.memoizedState,i,u)},useTransition:function(){var i=dh(ea)[0],u=Rt().memoizedState;return[typeof i=="boolean"?i:Eu(i),u]},useSyncExternalStore:mg,useId:Gg,useHostTransitionStatus:xh,useFormState:Og,useActionState:Og,useOptimistic:function(i,u){var c=Rt();return ot!==null?Eg(c,ot,i,u):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:fh,useCacheRefresh:qg};Zg.useEffectEvent=Ig;function Ch(i,u,c,d){u=i.memoizedState,c=c(d,u),c=c==null?u:v({},u,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var _h={enqueueSetState:function(i,u,c){i=i._reactInternals;var d=Pn(),g=Da(d);g.payload=u,c!=null&&(g.callback=c),u=Na(i,g,d),u!==null&&(Cn(u,i,d),yu(u,i,d))},enqueueReplaceState:function(i,u,c){i=i._reactInternals;var d=Pn(),g=Da(d);g.tag=1,g.payload=u,c!=null&&(g.callback=c),u=Na(i,g,d),u!==null&&(Cn(u,i,d),yu(u,i,d))},enqueueForceUpdate:function(i,u){i=i._reactInternals;var c=Pn(),d=Da(c);d.tag=2,u!=null&&(d.callback=u),u=Na(i,d,c),u!==null&&(Cn(u,i,c),yu(u,i,c))}};function Jg(i,u,c,d,g,b,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(d,b,S):u.prototype&&u.prototype.isPureReactComponent?!cu(c,d)||!cu(g,b):!0}function $g(i,u,c,d){i=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(c,d),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(c,d),u.state!==i&&_h.enqueueReplaceState(u,u.state,null)}function bi(i,u){var c=u;if("ref"in u){c={};for(var d in u)d!=="ref"&&(c[d]=u[d])}if(i=i.defaultProps){c===u&&(c=v({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}function ey(i){Vs(i)}function ty(i){console.error(i)}function ny(i){Vs(i)}function fl(i,u){try{var c=i.onUncaughtError;c(u.value,{componentStack:u.stack})}catch(d){setTimeout(function(){throw d})}}function ry(i,u,c){try{var d=i.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Sh(i,u,c){return c=Da(c),c.tag=3,c.payload={element:null},c.callback=function(){fl(i,u)},c}function ay(i){return i=Da(i),i.tag=3,i}function iy(i,u,c,d){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var b=d.value;i.payload=function(){return g(b)},i.callback=function(){ry(u,c,d)}}var S=c.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){ry(u,c,d),typeof g!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function nC(i,u,c,d,g){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(u=c.alternate,u!==null&&ao(u,c,g,!0),c=Fn.current,c!==null){switch(c.tag){case 31:case 13:return nr===null?Cl():c.alternate===null&&Ct===0&&(Ct=3),c.flags&=-257,c.flags|=65536,c.lanes=g,d===Js?c.flags|=16384:(u=c.updateQueue,u===null?c.updateQueue=new Set([d]):u.add(d),Qh(i,d,g)),!1;case 22:return c.flags|=65536,d===Js?c.flags|=16384:(u=c.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=u):(c=u.retryQueue,c===null?u.retryQueue=new Set([d]):c.add(d)),Qh(i,d,g)),!1}throw Error(n(435,c.tag))}return Qh(i,d,g),Cl(),!1}if(Ke)return u=Fn.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=g,d!==jf&&(i=Error(n(422),{cause:d}),du(Jn(i,c)))):(d!==jf&&(u=Error(n(423),{cause:d}),du(Jn(u,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,d=Jn(d,c),g=Sh(i.stateNode,d,g),th(i,g),Ct!==4&&(Ct=2)),!1;var b=Error(n(520),{cause:d});if(b=Jn(b,c),Mu===null?Mu=[b]:Mu.push(b),Ct!==4&&(Ct=2),u===null)return!0;d=Jn(d,c),c=u;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=Sh(c.stateNode,d,i),th(c,i),!1;case 1:if(u=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Fa===null||!Fa.has(b))))return c.flags|=65536,g&=-g,c.lanes|=g,g=ay(g),iy(g,i,c,d),th(c,g),!1}c=c.return}while(c!==null);return!1}var Rh=Error(n(461)),Mt=!1;function Jt(i,u,c,d){u.child=i===null?lg(u,null,c,d):gi(u,i.child,c,d)}function oy(i,u,c,d,g){c=c.render;var b=u.ref;if("ref"in d){var S={};for(var D in d)D!=="ref"&&(S[D]=d[D])}else S=d;return di(u),d=uh(i,u,c,S,b,g),D=sh(),i!==null&&!Mt?(lh(i,u,g),ta(i,u,g)):(Ke&&D&&Vf(u),u.flags|=1,Jt(i,u,d,g),u.child)}function uy(i,u,c,d,g){if(i===null){var b=c.type;return typeof b=="function"&&!Uf(b)&&b.defaultProps===void 0&&c.compare===null?(u.tag=15,u.type=b,sy(i,u,b,d,g)):(i=qs(c.type,null,d,u,u.mode,g),i.ref=u.ref,i.return=u,u.child=i)}if(b=i.child,!Ih(i,g)){var S=b.memoizedProps;if(c=c.compare,c=c!==null?c:cu,c(S,d)&&i.ref===u.ref)return ta(i,u,g)}return u.flags|=1,i=Yr(b,d),i.ref=u.ref,i.return=u,u.child=i}function sy(i,u,c,d,g){if(i!==null){var b=i.memoizedProps;if(cu(b,d)&&i.ref===u.ref)if(Mt=!1,u.pendingProps=d=b,Ih(i,g))(i.flags&131072)!==0&&(Mt=!0);else return u.lanes=i.lanes,ta(i,u,g)}return Ah(i,u,c,d,g)}function ly(i,u,c,d){var g=d.children,b=i!==null?i.memoizedState:null;if(i===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((u.flags&128)!==0){if(b=b!==null?b.baseLanes|c:c,i!==null){for(d=u.child=i.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~b}else d=0,u.child=null;return cy(i,u,b,c,d)}if((c&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},i!==null&&Qs(u,b!==null?b.cachePool:null),b!==null?hg(u,b):rh(),dg(u);else return d=u.lanes=536870912,cy(i,u,b!==null?b.baseLanes|c:c,c,d)}else b!==null?(Qs(u,b.cachePool),hg(u,b),Ma(),u.memoizedState=null):(i!==null&&Qs(u,null),rh(),Ma());return Jt(i,u,g,c),u.child}function Su(i,u){return i!==null&&i.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function cy(i,u,c,d,g){var b=Zf();return b=b===null?null:{parent:Nt._currentValue,pool:b},u.memoizedState={baseLanes:c,cachePool:b},i!==null&&Qs(u,null),rh(),dg(u),i!==null&&ao(i,u,d,!0),u.childLanes=g,null}function hl(i,u){return u=pl({mode:u.mode,children:u.children},i.mode),u.ref=i.ref,i.child=u,u.return=i,u}function fy(i,u,c){return gi(u,i.child,null,c),i=hl(u,u.pendingProps),i.flags|=2,Ln(u),u.memoizedState=null,i}function rC(i,u,c){var d=u.pendingProps,g=(u.flags&128)!==0;if(u.flags&=-129,i===null){if(Ke){if(d.mode==="hidden")return i=hl(u,d),u.lanes=536870912,Su(null,i);if(ih(u),(i=pt)?(i=C0(i,tr),i=i!==null&&i.data==="&"?i:null,i!==null&&(u.memoizedState={dehydrated:i,treeContext:_a!==null?{id:Cr,overflow:_r}:null,retryLane:536870912,hydrationErrors:null},c=Km(i),c.return=u,u.child=c,Qt=u,pt=null)):i=null,i===null)throw Ra(u);return u.lanes=536870912,null}return hl(u,d)}var b=i.memoizedState;if(b!==null){var S=b.dehydrated;if(ih(u),g)if(u.flags&256)u.flags&=-257,u=fy(i,u,c);else if(u.memoizedState!==null)u.child=i.child,u.flags|=128,u=null;else throw Error(n(558));else if(Mt||ao(i,u,c,!1),g=(c&i.childLanes)!==0,Mt||g){if(d=ht,d!==null&&(S=tm(d,c),S!==0&&S!==b.retryLane))throw b.retryLane=S,li(i,S),Cn(d,i,S),Rh;Cl(),u=fy(i,u,c)}else i=b.treeContext,pt=rr(S.nextSibling),Qt=u,Ke=!0,Sa=null,tr=!1,i!==null&&Zm(u,i),u=hl(u,d),u.flags|=4096;return u}return i=Yr(i.child,{mode:d.mode,children:d.children}),i.ref=u.ref,u.child=i,i.return=u,i}function dl(i,u){var c=u.ref;if(c===null)i!==null&&i.ref!==null&&(u.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(u.flags|=4194816)}}function Ah(i,u,c,d,g){return di(u),c=uh(i,u,c,d,void 0,g),d=sh(),i!==null&&!Mt?(lh(i,u,g),ta(i,u,g)):(Ke&&d&&Vf(u),u.flags|=1,Jt(i,u,c,g),u.child)}function hy(i,u,c,d,g,b){return di(u),u.updateQueue=null,c=vg(u,d,c,g),pg(i),d=sh(),i!==null&&!Mt?(lh(i,u,b),ta(i,u,b)):(Ke&&d&&Vf(u),u.flags|=1,Jt(i,u,c,b),u.child)}function dy(i,u,c,d,g){if(di(u),u.stateNode===null){var b=eo,S=c.contextType;typeof S=="object"&&S!==null&&(b=Zt(S)),b=new c(d,b),u.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=_h,u.stateNode=b,b._reactInternals=u,b=u.stateNode,b.props=d,b.state=u.memoizedState,b.refs={},$f(u),S=c.contextType,b.context=typeof S=="object"&&S!==null?Zt(S):eo,b.state=u.memoizedState,S=c.getDerivedStateFromProps,typeof S=="function"&&(Ch(u,c,S,d),b.state=u.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(S=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),S!==b.state&&_h.enqueueReplaceState(b,b.state,null),xu(u,d,b,g),bu(),b.state=u.memoizedState),typeof b.componentDidMount=="function"&&(u.flags|=4194308),d=!0}else if(i===null){b=u.stateNode;var D=u.memoizedProps,U=bi(c,D);b.props=U;var Q=b.context,le=c.contextType;S=eo,typeof le=="object"&&le!==null&&(S=Zt(le));var he=c.getDerivedStateFromProps;le=typeof he=="function"||typeof b.getSnapshotBeforeUpdate=="function",D=u.pendingProps!==D,le||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(D||Q!==S)&&$g(u,b,d,S),Ta=!1;var Z=u.memoizedState;b.state=Z,xu(u,d,b,g),bu(),Q=u.memoizedState,D||Z!==Q||Ta?(typeof he=="function"&&(Ch(u,c,he,d),Q=u.memoizedState),(U=Ta||Jg(u,c,U,d,Z,Q,S))?(le||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(u.flags|=4194308)):(typeof b.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=d,u.memoizedState=Q),b.props=d,b.state=Q,b.context=S,d=U):(typeof b.componentDidMount=="function"&&(u.flags|=4194308),d=!1)}else{b=u.stateNode,eh(i,u),S=u.memoizedProps,le=bi(c,S),b.props=le,he=u.pendingProps,Z=b.context,Q=c.contextType,U=eo,typeof Q=="object"&&Q!==null&&(U=Zt(Q)),D=c.getDerivedStateFromProps,(Q=typeof D=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(S!==he||Z!==U)&&$g(u,b,d,U),Ta=!1,Z=u.memoizedState,b.state=Z,xu(u,d,b,g),bu();var te=u.memoizedState;S!==he||Z!==te||Ta||i!==null&&i.dependencies!==null&&Ks(i.dependencies)?(typeof D=="function"&&(Ch(u,c,D,d),te=u.memoizedState),(le=Ta||Jg(u,c,le,d,Z,te,U)||i!==null&&i.dependencies!==null&&Ks(i.dependencies))?(Q||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,te,U),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,te,U)),typeof b.componentDidUpdate=="function"&&(u.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof b.componentDidUpdate!="function"||S===i.memoizedProps&&Z===i.memoizedState||(u.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&Z===i.memoizedState||(u.flags|=1024),u.memoizedProps=d,u.memoizedState=te),b.props=d,b.state=te,b.context=U,d=le):(typeof b.componentDidUpdate!="function"||S===i.memoizedProps&&Z===i.memoizedState||(u.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&Z===i.memoizedState||(u.flags|=1024),d=!1)}return b=d,dl(i,u),d=(u.flags&128)!==0,b||d?(b=u.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:b.render(),u.flags|=1,i!==null&&d?(u.child=gi(u,i.child,null,g),u.child=gi(u,null,c,g)):Jt(i,u,c,g),u.memoizedState=b.state,i=u.child):i=ta(i,u,g),i}function py(i,u,c,d){return fi(),u.flags|=256,Jt(i,u,c,d),u.child}var Th={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dh(i){return{baseLanes:i,cachePool:rg()}}function Nh(i,u,c){return i=i!==null?i.childLanes&~c:0,u&&(i|=Un),i}function vy(i,u,c){var d=u.pendingProps,g=!1,b=(u.flags&128)!==0,S;if((S=b)||(S=i!==null&&i.memoizedState===null?!1:(St.current&2)!==0),S&&(g=!0,u.flags&=-129),S=(u.flags&32)!==0,u.flags&=-33,i===null){if(Ke){if(g?Oa(u):Ma(),(i=pt)?(i=C0(i,tr),i=i!==null&&i.data!=="&"?i:null,i!==null&&(u.memoizedState={dehydrated:i,treeContext:_a!==null?{id:Cr,overflow:_r}:null,retryLane:536870912,hydrationErrors:null},c=Km(i),c.return=u,u.child=c,Qt=u,pt=null)):i=null,i===null)throw Ra(u);return hd(i)?u.lanes=32:u.lanes=536870912,null}var D=d.children;return d=d.fallback,g?(Ma(),g=u.mode,D=pl({mode:"hidden",children:D},g),d=ci(d,g,c,null),D.return=u,d.return=u,D.sibling=d,u.child=D,d=u.child,d.memoizedState=Dh(c),d.childLanes=Nh(i,S,c),u.memoizedState=Th,Su(null,d)):(Oa(u),Oh(u,D))}var U=i.memoizedState;if(U!==null&&(D=U.dehydrated,D!==null)){if(b)u.flags&256?(Oa(u),u.flags&=-257,u=Mh(i,u,c)):u.memoizedState!==null?(Ma(),u.child=i.child,u.flags|=128,u=null):(Ma(),D=d.fallback,g=u.mode,d=pl({mode:"visible",children:d.children},g),D=ci(D,g,c,null),D.flags|=2,d.return=u,D.return=u,d.sibling=D,u.child=d,gi(u,i.child,null,c),d=u.child,d.memoizedState=Dh(c),d.childLanes=Nh(i,S,c),u.memoizedState=Th,u=Su(null,d));else if(Oa(u),hd(D)){if(S=D.nextSibling&&D.nextSibling.dataset,S)var Q=S.dgst;S=Q,d=Error(n(419)),d.stack="",d.digest=S,du({value:d,source:null,stack:null}),u=Mh(i,u,c)}else if(Mt||ao(i,u,c,!1),S=(c&i.childLanes)!==0,Mt||S){if(S=ht,S!==null&&(d=tm(S,c),d!==0&&d!==U.retryLane))throw U.retryLane=d,li(i,d),Cn(S,i,d),Rh;fd(D)||Cl(),u=Mh(i,u,c)}else fd(D)?(u.flags|=192,u.child=i.child,u=null):(i=U.treeContext,pt=rr(D.nextSibling),Qt=u,Ke=!0,Sa=null,tr=!1,i!==null&&Zm(u,i),u=Oh(u,d.children),u.flags|=4096);return u}return g?(Ma(),D=d.fallback,g=u.mode,U=i.child,Q=U.sibling,d=Yr(U,{mode:"hidden",children:d.children}),d.subtreeFlags=U.subtreeFlags&65011712,Q!==null?D=Yr(Q,D):(D=ci(D,g,c,null),D.flags|=2),D.return=u,d.return=u,d.sibling=D,u.child=d,Su(null,d),d=u.child,D=i.child.memoizedState,D===null?D=Dh(c):(g=D.cachePool,g!==null?(U=Nt._currentValue,g=g.parent!==U?{parent:U,pool:U}:g):g=rg(),D={baseLanes:D.baseLanes|c,cachePool:g}),d.memoizedState=D,d.childLanes=Nh(i,S,c),u.memoizedState=Th,Su(i.child,d)):(Oa(u),c=i.child,i=c.sibling,c=Yr(c,{mode:"visible",children:d.children}),c.return=u,c.sibling=null,i!==null&&(S=u.deletions,S===null?(u.deletions=[i],u.flags|=16):S.push(i)),u.child=c,u.memoizedState=null,c)}function Oh(i,u){return u=pl({mode:"visible",children:u},i.mode),u.return=i,i.child=u}function pl(i,u){return i=Bn(22,i,null,u),i.lanes=0,i}function Mh(i,u,c){return gi(u,i.child,null,c),i=Oh(u,u.pendingProps.children),i.flags|=2,u.memoizedState=null,i}function my(i,u,c){i.lanes|=u;var d=i.alternate;d!==null&&(d.lanes|=u),Xf(i.return,u,c)}function kh(i,u,c,d,g,b){var S=i.memoizedState;S===null?i.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:g,treeForkCount:b}:(S.isBackwards=u,S.rendering=null,S.renderingStartTime=0,S.last=d,S.tail=c,S.tailMode=g,S.treeForkCount=b)}function gy(i,u,c){var d=u.pendingProps,g=d.revealOrder,b=d.tail;d=d.children;var S=St.current,D=(S&2)!==0;if(D?(S=S&1|2,u.flags|=128):S&=1,ue(St,S),Jt(i,u,d,c),d=Ke?hu:0,!D&&i!==null&&(i.flags&128)!==0)e:for(i=u.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&my(i,c,u);else if(i.tag===19)my(i,c,u);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===u)break e;for(;i.sibling===null;){if(i.return===null||i.return===u)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(c=u.child,g=null;c!==null;)i=c.alternate,i!==null&&nl(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=u.child,u.child=null):(g=c.sibling,c.sibling=null),kh(u,!1,g,c,b,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=u.child,u.child=null;g!==null;){if(i=g.alternate,i!==null&&nl(i)===null){u.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}kh(u,!0,c,null,b,d);break;case"together":kh(u,!1,null,null,void 0,d);break;default:u.memoizedState=null}return u.child}function ta(i,u,c){if(i!==null&&(u.dependencies=i.dependencies),Ba|=u.lanes,(c&u.childLanes)===0)if(i!==null){if(ao(i,u,c,!1),(c&u.childLanes)===0)return null}else return null;if(i!==null&&u.child!==i.child)throw Error(n(153));if(u.child!==null){for(i=u.child,c=Yr(i,i.pendingProps),u.child=c,c.return=u;i.sibling!==null;)i=i.sibling,c=c.sibling=Yr(i,i.pendingProps),c.return=u;c.sibling=null}return u.child}function Ih(i,u){return(i.lanes&u)!==0?!0:(i=i.dependencies,!!(i!==null&&Ks(i)))}function aC(i,u,c){switch(u.tag){case 3:Oe(u,u.stateNode.containerInfo),Aa(u,Nt,i.memoizedState.cache),fi();break;case 27:case 5:lt(u);break;case 4:Oe(u,u.stateNode.containerInfo);break;case 10:Aa(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,ih(u),null;break;case 13:var d=u.memoizedState;if(d!==null)return d.dehydrated!==null?(Oa(u),u.flags|=128,null):(c&u.child.childLanes)!==0?vy(i,u,c):(Oa(u),i=ta(i,u,c),i!==null?i.sibling:null);Oa(u);break;case 19:var g=(i.flags&128)!==0;if(d=(c&u.childLanes)!==0,d||(ao(i,u,c,!1),d=(c&u.childLanes)!==0),g){if(d)return gy(i,u,c);u.flags|=128}if(g=u.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ue(St,St.current),d)break;return null;case 22:return u.lanes=0,ly(i,u,c,u.pendingProps);case 24:Aa(u,Nt,i.memoizedState.cache)}return ta(i,u,c)}function yy(i,u,c){if(i!==null)if(i.memoizedProps!==u.pendingProps)Mt=!0;else{if(!Ih(i,c)&&(u.flags&128)===0)return Mt=!1,aC(i,u,c);Mt=(i.flags&131072)!==0}else Mt=!1,Ke&&(u.flags&1048576)!==0&&Qm(u,hu,u.index);switch(u.lanes=0,u.tag){case 16:e:{var d=u.pendingProps;if(i=vi(u.elementType),u.type=i,typeof i=="function")Uf(i)?(d=bi(i,d),u.tag=1,u=dy(null,u,i,d,c)):(u.tag=0,u=Ah(null,u,i,d,c));else{if(i!=null){var g=i.$$typeof;if(g===A){u.tag=11,u=oy(null,u,i,d,c);break e}else if(g===M){u.tag=14,u=uy(null,u,i,d,c);break e}}throw u=ee(i)||i,Error(n(306,u,""))}}return u;case 0:return Ah(i,u,u.type,u.pendingProps,c);case 1:return d=u.type,g=bi(d,u.pendingProps),dy(i,u,d,g,c);case 3:e:{if(Oe(u,u.stateNode.containerInfo),i===null)throw Error(n(387));d=u.pendingProps;var b=u.memoizedState;g=b.element,eh(i,u),xu(u,d,null,c);var S=u.memoizedState;if(d=S.cache,Aa(u,Nt,d),d!==b.cache&&Kf(u,[Nt],c,!0),bu(),d=S.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:S.cache},u.updateQueue.baseState=b,u.memoizedState=b,u.flags&256){u=py(i,u,d,c);break e}else if(d!==g){g=Jn(Error(n(424)),u),du(g),u=py(i,u,d,c);break e}else for(i=u.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,pt=rr(i.firstChild),Qt=u,Ke=!0,Sa=null,tr=!0,c=lg(u,null,d,c),u.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(fi(),d===g){u=ta(i,u,c);break e}Jt(i,u,d,c)}u=u.child}return u;case 26:return dl(i,u),i===null?(c=D0(u.type,null,u.pendingProps,null))?u.memoizedState=c:Ke||(c=u.type,i=u.pendingProps,d=Nl(ye.current).createElement(c),d[Yt]=u,d[gn]=i,$t(d,c,i),Vt(d),u.stateNode=d):u.memoizedState=D0(u.type,i.memoizedProps,u.pendingProps,i.memoizedState),null;case 27:return lt(u),i===null&&Ke&&(d=u.stateNode=R0(u.type,u.pendingProps,ye.current),Qt=u,tr=!0,g=pt,Pa(u.type)?(dd=g,pt=rr(d.firstChild)):pt=g),Jt(i,u,u.pendingProps.children,c),dl(i,u),i===null&&(u.flags|=4194304),u.child;case 5:return i===null&&Ke&&((g=d=pt)&&(d=IC(d,u.type,u.pendingProps,tr),d!==null?(u.stateNode=d,Qt=u,pt=rr(d.firstChild),tr=!1,g=!0):g=!1),g||Ra(u)),lt(u),g=u.type,b=u.pendingProps,S=i!==null?i.memoizedProps:null,d=b.children,sd(g,b)?d=null:S!==null&&sd(g,S)&&(u.flags|=32),u.memoizedState!==null&&(g=uh(i,u,YE,null,null,c),Pu._currentValue=g),dl(i,u),Jt(i,u,d,c),u.child;case 6:return i===null&&Ke&&((i=c=pt)&&(c=BC(c,u.pendingProps,tr),c!==null?(u.stateNode=c,Qt=u,pt=null,i=!0):i=!1),i||Ra(u)),null;case 13:return vy(i,u,c);case 4:return Oe(u,u.stateNode.containerInfo),d=u.pendingProps,i===null?u.child=gi(u,null,d,c):Jt(i,u,d,c),u.child;case 11:return oy(i,u,u.type,u.pendingProps,c);case 7:return Jt(i,u,u.pendingProps,c),u.child;case 8:return Jt(i,u,u.pendingProps.children,c),u.child;case 12:return Jt(i,u,u.pendingProps.children,c),u.child;case 10:return d=u.pendingProps,Aa(u,u.type,d.value),Jt(i,u,d.children,c),u.child;case 9:return g=u.type._context,d=u.pendingProps.children,di(u),g=Zt(g),d=d(g),u.flags|=1,Jt(i,u,d,c),u.child;case 14:return uy(i,u,u.type,u.pendingProps,c);case 15:return sy(i,u,u.type,u.pendingProps,c);case 19:return gy(i,u,c);case 31:return rC(i,u,c);case 22:return ly(i,u,c,u.pendingProps);case 24:return di(u),d=Zt(Nt),i===null?(g=Zf(),g===null&&(g=ht,b=Yf(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=c),g=b),u.memoizedState={parent:d,cache:g},$f(u),Aa(u,Nt,g)):((i.lanes&c)!==0&&(eh(i,u),xu(u,null,null,c),bu()),g=i.memoizedState,b=u.memoizedState,g.parent!==d?(g={parent:d,cache:d},u.memoizedState=g,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=g),Aa(u,Nt,d)):(d=b.cache,Aa(u,Nt,d),d!==g.cache&&Kf(u,[Nt],c,!0))),Jt(i,u,u.pendingProps.children,c),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function na(i){i.flags|=4}function Bh(i,u,c,d,g){if((u=(i.mode&32)!==0)&&(u=!1),u){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(Gy())i.flags|=8192;else throw mi=Js,Jf}else i.flags&=-16777217}function by(i,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!I0(u))if(Gy())i.flags|=8192;else throw mi=Js,Jf}function vl(i,u){u!==null&&(i.flags|=4),i.flags&16384&&(u=i.tag!==22?Jv():536870912,i.lanes|=u,go|=u)}function Ru(i,u){if(!Ke)switch(i.tailMode){case"hidden":u=i.tail;for(var c=null;u!==null;)u.alternate!==null&&(c=u),u=u.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?u||i.tail===null?i.tail=null:i.tail.sibling=null:d.sibling=null}}function vt(i){var u=i.alternate!==null&&i.alternate.child===i.child,c=0,d=0;if(u)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=d,i.childLanes=c,u}function iC(i,u,c){var d=u.pendingProps;switch(Wf(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(u),null;case 1:return vt(u),null;case 3:return c=u.stateNode,d=null,i!==null&&(d=i.memoizedState.cache),u.memoizedState.cache!==d&&(u.flags|=2048),Jr(Nt),De(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(ro(u)?na(u):i===null||i.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Gf())),vt(u),null;case 26:var g=u.type,b=u.memoizedState;return i===null?(na(u),b!==null?(vt(u),by(u,b)):(vt(u),Bh(u,g,null,d,c))):b?b!==i.memoizedState?(na(u),vt(u),by(u,b)):(vt(u),u.flags&=-16777217):(i=i.memoizedProps,i!==d&&na(u),vt(u),Bh(u,g,i,d,c)),null;case 27:if(He(u),c=ye.current,g=u.type,i!==null&&u.stateNode!=null)i.memoizedProps!==d&&na(u);else{if(!d){if(u.stateNode===null)throw Error(n(166));return vt(u),null}i=pe.current,ro(u)?Jm(u):(i=R0(g,d,c),u.stateNode=i,na(u))}return vt(u),null;case 5:if(He(u),g=u.type,i!==null&&u.stateNode!=null)i.memoizedProps!==d&&na(u);else{if(!d){if(u.stateNode===null)throw Error(n(166));return vt(u),null}if(b=pe.current,ro(u))Jm(u);else{var S=Nl(ye.current);switch(b){case 1:b=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:b=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":b=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":b=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":b=S.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof d.is=="string"?S.createElement("select",{is:d.is}):S.createElement("select"),d.multiple?b.multiple=!0:d.size&&(b.size=d.size);break;default:b=typeof d.is=="string"?S.createElement(g,{is:d.is}):S.createElement(g)}}b[Yt]=u,b[gn]=d;e:for(S=u.child;S!==null;){if(S.tag===5||S.tag===6)b.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===u)break e;for(;S.sibling===null;){if(S.return===null||S.return===u)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}u.stateNode=b;e:switch($t(b,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&na(u)}}return vt(u),Bh(u,u.type,i===null?null:i.memoizedProps,u.pendingProps,c),null;case 6:if(i&&u.stateNode!=null)i.memoizedProps!==d&&na(u);else{if(typeof d!="string"&&u.stateNode===null)throw Error(n(166));if(i=ye.current,ro(u)){if(i=u.stateNode,c=u.memoizedProps,d=null,g=Qt,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}i[Yt]=u,i=!!(i.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||v0(i.nodeValue,c)),i||Ra(u,!0)}else i=Nl(i).createTextNode(d),i[Yt]=u,u.stateNode=i}return vt(u),null;case 31:if(c=u.memoizedState,i===null||i.memoizedState!==null){if(d=ro(u),c!==null){if(i===null){if(!d)throw Error(n(318));if(i=u.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[Yt]=u}else fi(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;vt(u),i=!1}else c=Gf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return u.flags&256?(Ln(u),u):(Ln(u),null);if((u.flags&128)!==0)throw Error(n(558))}return vt(u),null;case 13:if(d=u.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=ro(u),d!==null&&d.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=u.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[Yt]=u}else fi(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;vt(u),g=!1}else g=Gf(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return u.flags&256?(Ln(u),u):(Ln(u),null)}return Ln(u),(u.flags&128)!==0?(u.lanes=c,u):(c=d!==null,i=i!==null&&i.memoizedState!==null,c&&(d=u.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),b=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==g&&(d.flags|=2048)),c!==i&&c&&(u.child.flags|=8192),vl(u,u.updateQueue),vt(u),null);case 4:return De(),i===null&&rd(u.stateNode.containerInfo),vt(u),null;case 10:return Jr(u.type),vt(u),null;case 19:if(q(St),d=u.memoizedState,d===null)return vt(u),null;if(g=(u.flags&128)!==0,b=d.rendering,b===null)if(g)Ru(d,!1);else{if(Ct!==0||i!==null&&(i.flags&128)!==0)for(i=u.child;i!==null;){if(b=nl(i),b!==null){for(u.flags|=128,Ru(d,!1),i=b.updateQueue,u.updateQueue=i,vl(u,i),u.subtreeFlags=0,i=c,c=u.child;c!==null;)Xm(c,i),c=c.sibling;return ue(St,St.current&1|2),Ke&&Qr(u,d.treeForkCount),u.child}i=i.sibling}d.tail!==null&&Dt()>xl&&(u.flags|=128,g=!0,Ru(d,!1),u.lanes=4194304)}else{if(!g)if(i=nl(b),i!==null){if(u.flags|=128,g=!0,i=i.updateQueue,u.updateQueue=i,vl(u,i),Ru(d,!0),d.tail===null&&d.tailMode==="hidden"&&!b.alternate&&!Ke)return vt(u),null}else 2*Dt()-d.renderingStartTime>xl&&c!==536870912&&(u.flags|=128,g=!0,Ru(d,!1),u.lanes=4194304);d.isBackwards?(b.sibling=u.child,u.child=b):(i=d.last,i!==null?i.sibling=b:u.child=b,d.last=b)}return d.tail!==null?(i=d.tail,d.rendering=i,d.tail=i.sibling,d.renderingStartTime=Dt(),i.sibling=null,c=St.current,ue(St,g?c&1|2:c&1),Ke&&Qr(u,d.treeForkCount),i):(vt(u),null);case 22:case 23:return Ln(u),ah(),d=u.memoizedState!==null,i!==null?i.memoizedState!==null!==d&&(u.flags|=8192):d&&(u.flags|=8192),d?(c&536870912)!==0&&(u.flags&128)===0&&(vt(u),u.subtreeFlags&6&&(u.flags|=8192)):vt(u),c=u.updateQueue,c!==null&&vl(u,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),d=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(d=u.memoizedState.cachePool.pool),d!==c&&(u.flags|=2048),i!==null&&q(pi),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),u.memoizedState.cache!==c&&(u.flags|=2048),Jr(Nt),vt(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function oC(i,u){switch(Wf(u),u.tag){case 1:return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 3:return Jr(Nt),De(),i=u.flags,(i&65536)!==0&&(i&128)===0?(u.flags=i&-65537|128,u):null;case 26:case 27:case 5:return He(u),null;case 31:if(u.memoizedState!==null){if(Ln(u),u.alternate===null)throw Error(n(340));fi()}return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 13:if(Ln(u),i=u.memoizedState,i!==null&&i.dehydrated!==null){if(u.alternate===null)throw Error(n(340));fi()}return i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 19:return q(St),null;case 4:return De(),null;case 10:return Jr(u.type),null;case 22:case 23:return Ln(u),ah(),i!==null&&q(pi),i=u.flags,i&65536?(u.flags=i&-65537|128,u):null;case 24:return Jr(Nt),null;case 25:return null;default:return null}}function xy(i,u){switch(Wf(u),u.tag){case 3:Jr(Nt),De();break;case 26:case 27:case 5:He(u);break;case 4:De();break;case 31:u.memoizedState!==null&&Ln(u);break;case 13:Ln(u);break;case 19:q(St);break;case 10:Jr(u.type);break;case 22:case 23:Ln(u),ah(),i!==null&&q(pi);break;case 24:Jr(Nt)}}function Au(i,u){try{var c=u.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var g=d.next;c=g;do{if((c.tag&i)===i){d=void 0;var b=c.create,S=c.inst;d=b(),S.destroy=d}c=c.next}while(c!==g)}}catch(D){it(u,u.return,D)}}function ka(i,u,c){try{var d=u.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var b=g.next;d=b;do{if((d.tag&i)===i){var S=d.inst,D=S.destroy;if(D!==void 0){S.destroy=void 0,g=u;var U=c,Q=D;try{Q()}catch(le){it(g,U,le)}}}d=d.next}while(d!==b)}}catch(le){it(u,u.return,le)}}function wy(i){var u=i.updateQueue;if(u!==null){var c=i.stateNode;try{fg(u,c)}catch(d){it(i,i.return,d)}}}function Ey(i,u,c){c.props=bi(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(d){it(i,u,d)}}function Tu(i,u){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var d=i.stateNode;break;case 30:d=i.stateNode;break;default:d=i.stateNode}typeof c=="function"?i.refCleanup=c(d):c.current=d}}catch(g){it(i,u,g)}}function Sr(i,u){var c=i.ref,d=i.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(g){it(i,u,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){it(i,u,g)}else c.current=null}function Cy(i){var u=i.type,c=i.memoizedProps,d=i.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(g){it(i,i.return,g)}}function Fh(i,u,c){try{var d=i.stateNode;TC(d,i.type,c,u),d[gn]=u}catch(g){it(i,i.return,g)}}function _y(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Pa(i.type)||i.tag===4}function Lh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||_y(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Pa(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function zh(i,u,c){var d=i.tag;if(d===5||d===6)i=i.stateNode,u?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,u):(u=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,u.appendChild(i),c=c._reactRootContainer,c!=null||u.onclick!==null||(u.onclick=Xr));else if(d!==4&&(d===27&&Pa(i.type)&&(c=i.stateNode,u=null),i=i.child,i!==null))for(zh(i,u,c),i=i.sibling;i!==null;)zh(i,u,c),i=i.sibling}function ml(i,u,c){var d=i.tag;if(d===5||d===6)i=i.stateNode,u?c.insertBefore(i,u):c.appendChild(i);else if(d!==4&&(d===27&&Pa(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(ml(i,u,c),i=i.sibling;i!==null;)ml(i,u,c),i=i.sibling}function Sy(i){var u=i.stateNode,c=i.memoizedProps;try{for(var d=i.type,g=u.attributes;g.length;)u.removeAttributeNode(g[0]);$t(u,d,c),u[Yt]=i,u[gn]=c}catch(b){it(i,i.return,b)}}var ra=!1,kt=!1,Uh=!1,Ry=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function uC(i,u){if(i=i.containerInfo,od=Ll,i=zm(i),Mf(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var g=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var S=0,D=-1,U=-1,Q=0,le=0,he=i,Z=null;t:for(;;){for(var te;he!==c||g!==0&&he.nodeType!==3||(D=S+g),he!==b||d!==0&&he.nodeType!==3||(U=S+d),he.nodeType===3&&(S+=he.nodeValue.length),(te=he.firstChild)!==null;)Z=he,he=te;for(;;){if(he===i)break t;if(Z===c&&++Q===g&&(D=S),Z===b&&++le===d&&(U=S),(te=he.nextSibling)!==null)break;he=Z,Z=he.parentNode}he=te}c=D===-1||U===-1?null:{start:D,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(ud={focusedElem:i,selectionRange:c},Ll=!1,Wt=u;Wt!==null;)if(u=Wt,i=u.child,(u.subtreeFlags&1028)!==0&&i!==null)i.return=u,Wt=i;else for(;Wt!==null;){switch(u=Wt,b=u.alternate,i=u.flags,u.tag){case 0:if((i&4)!==0&&(i=u.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)g=i[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&b!==null){i=void 0,c=u,g=b.memoizedProps,b=b.memoizedState,d=c.stateNode;try{var we=bi(c.type,g);i=d.getSnapshotBeforeUpdate(we,b),d.__reactInternalSnapshotBeforeUpdate=i}catch(Me){it(c,c.return,Me)}}break;case 3:if((i&1024)!==0){if(i=u.stateNode.containerInfo,c=i.nodeType,c===9)cd(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":cd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=u.sibling,i!==null){i.return=u.return,Wt=i;break}Wt=u.return}}function Ay(i,u,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:ia(i,c),d&4&&Au(5,c);break;case 1:if(ia(i,c),d&4)if(i=c.stateNode,u===null)try{i.componentDidMount()}catch(S){it(c,c.return,S)}else{var g=bi(c.type,u.memoizedProps);u=u.memoizedState;try{i.componentDidUpdate(g,u,i.__reactInternalSnapshotBeforeUpdate)}catch(S){it(c,c.return,S)}}d&64&&wy(c),d&512&&Tu(c,c.return);break;case 3:if(ia(i,c),d&64&&(i=c.updateQueue,i!==null)){if(u=null,c.child!==null)switch(c.child.tag){case 27:case 5:u=c.child.stateNode;break;case 1:u=c.child.stateNode}try{fg(i,u)}catch(S){it(c,c.return,S)}}break;case 27:u===null&&d&4&&Sy(c);case 26:case 5:ia(i,c),u===null&&d&4&&Cy(c),d&512&&Tu(c,c.return);break;case 12:ia(i,c);break;case 31:ia(i,c),d&4&&Ny(i,c);break;case 13:ia(i,c),d&4&&Oy(i,c),d&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=mC.bind(null,c),FC(i,c))));break;case 22:if(d=c.memoizedState!==null||ra,!d){u=u!==null&&u.memoizedState!==null||kt,g=ra;var b=kt;ra=d,(kt=u)&&!b?oa(i,c,(c.subtreeFlags&8772)!==0):ia(i,c),ra=g,kt=b}break;case 30:break;default:ia(i,c)}}function Ty(i){var u=i.alternate;u!==null&&(i.alternate=null,Ty(u)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(u=i.stateNode,u!==null&&vf(u)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var gt=null,bn=!1;function aa(i,u,c){for(c=c.child;c!==null;)Dy(i,u,c),c=c.sibling}function Dy(i,u,c){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(Gr,c)}catch{}switch(c.tag){case 26:kt||Sr(c,u),aa(i,u,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:kt||Sr(c,u);var d=gt,g=bn;Pa(c.type)&&(gt=c.stateNode,bn=!1),aa(i,u,c),Lu(c.stateNode),gt=d,bn=g;break;case 5:kt||Sr(c,u);case 6:if(d=gt,g=bn,gt=null,aa(i,u,c),gt=d,bn=g,gt!==null)if(bn)try{(gt.nodeType===9?gt.body:gt.nodeName==="HTML"?gt.ownerDocument.body:gt).removeChild(c.stateNode)}catch(b){it(c,u,b)}else try{gt.removeChild(c.stateNode)}catch(b){it(c,u,b)}break;case 18:gt!==null&&(bn?(i=gt,w0(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),So(i)):w0(gt,c.stateNode));break;case 4:d=gt,g=bn,gt=c.stateNode.containerInfo,bn=!0,aa(i,u,c),gt=d,bn=g;break;case 0:case 11:case 14:case 15:ka(2,c,u),kt||ka(4,c,u),aa(i,u,c);break;case 1:kt||(Sr(c,u),d=c.stateNode,typeof d.componentWillUnmount=="function"&&Ey(c,u,d)),aa(i,u,c);break;case 21:aa(i,u,c);break;case 22:kt=(d=kt)||c.memoizedState!==null,aa(i,u,c),kt=d;break;default:aa(i,u,c)}}function Ny(i,u){if(u.memoizedState===null&&(i=u.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{So(i)}catch(c){it(u,u.return,c)}}}function Oy(i,u){if(u.memoizedState===null&&(i=u.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{So(i)}catch(c){it(u,u.return,c)}}function sC(i){switch(i.tag){case 31:case 13:case 19:var u=i.stateNode;return u===null&&(u=i.stateNode=new Ry),u;case 22:return i=i.stateNode,u=i._retryCache,u===null&&(u=i._retryCache=new Ry),u;default:throw Error(n(435,i.tag))}}function gl(i,u){var c=sC(i);u.forEach(function(d){if(!c.has(d)){c.add(d);var g=gC.bind(null,i,d);d.then(g,g)}})}function xn(i,u){var c=u.deletions;if(c!==null)for(var d=0;d<c.length;d++){var g=c[d],b=i,S=u,D=S;e:for(;D!==null;){switch(D.tag){case 27:if(Pa(D.type)){gt=D.stateNode,bn=!1;break e}break;case 5:gt=D.stateNode,bn=!1;break e;case 3:case 4:gt=D.stateNode.containerInfo,bn=!0;break e}D=D.return}if(gt===null)throw Error(n(160));Dy(b,S,g),gt=null,bn=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)My(u,i),u=u.sibling}var dr=null;function My(i,u){var c=i.alternate,d=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:xn(u,i),wn(i),d&4&&(ka(3,i,i.return),Au(3,i),ka(5,i,i.return));break;case 1:xn(u,i),wn(i),d&512&&(kt||c===null||Sr(c,c.return)),d&64&&ra&&(i=i.updateQueue,i!==null&&(d=i.callbacks,d!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var g=dr;if(xn(u,i),wn(i),d&512&&(kt||c===null||Sr(c,c.return)),d&4){var b=c!==null?c.memoizedState:null;if(d=i.memoizedState,c===null)if(d===null)if(i.stateNode===null){e:{d=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":b=g.getElementsByTagName("title")[0],(!b||b[tu]||b[Yt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(d),g.head.insertBefore(b,g.querySelector("head > title"))),$t(b,d,c),b[Yt]=i,Vt(b),d=b;break e;case"link":var S=M0("link","href",g).get(d+(c.href||""));if(S){for(var D=0;D<S.length;D++)if(b=S[D],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){S.splice(D,1);break t}}b=g.createElement(d),$t(b,d,c),g.head.appendChild(b);break;case"meta":if(S=M0("meta","content",g).get(d+(c.content||""))){for(D=0;D<S.length;D++)if(b=S[D],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){S.splice(D,1);break t}}b=g.createElement(d),$t(b,d,c),g.head.appendChild(b);break;default:throw Error(n(468,d))}b[Yt]=i,Vt(b),d=b}i.stateNode=d}else k0(g,i.type,i.stateNode);else i.stateNode=O0(g,d,i.memoizedProps);else b!==d?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,d===null?k0(g,i.type,i.stateNode):O0(g,d,i.memoizedProps)):d===null&&i.stateNode!==null&&Fh(i,i.memoizedProps,c.memoizedProps)}break;case 27:xn(u,i),wn(i),d&512&&(kt||c===null||Sr(c,c.return)),c!==null&&d&4&&Fh(i,i.memoizedProps,c.memoizedProps);break;case 5:if(xn(u,i),wn(i),d&512&&(kt||c===null||Sr(c,c.return)),i.flags&32){g=i.stateNode;try{Xi(g,"")}catch(we){it(i,i.return,we)}}d&4&&i.stateNode!=null&&(g=i.memoizedProps,Fh(i,g,c!==null?c.memoizedProps:g)),d&1024&&(Uh=!0);break;case 6:if(xn(u,i),wn(i),d&4){if(i.stateNode===null)throw Error(n(162));d=i.memoizedProps,c=i.stateNode;try{c.nodeValue=d}catch(we){it(i,i.return,we)}}break;case 3:if(kl=null,g=dr,dr=Ol(u.containerInfo),xn(u,i),dr=g,wn(i),d&4&&c!==null&&c.memoizedState.isDehydrated)try{So(u.containerInfo)}catch(we){it(i,i.return,we)}Uh&&(Uh=!1,ky(i));break;case 4:d=dr,dr=Ol(i.stateNode.containerInfo),xn(u,i),wn(i),dr=d;break;case 12:xn(u,i),wn(i);break;case 31:xn(u,i),wn(i),d&4&&(d=i.updateQueue,d!==null&&(i.updateQueue=null,gl(i,d)));break;case 13:xn(u,i),wn(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(bl=Dt()),d&4&&(d=i.updateQueue,d!==null&&(i.updateQueue=null,gl(i,d)));break;case 22:g=i.memoizedState!==null;var U=c!==null&&c.memoizedState!==null,Q=ra,le=kt;if(ra=Q||g,kt=le||U,xn(u,i),kt=le,ra=Q,wn(i),d&8192)e:for(u=i.stateNode,u._visibility=g?u._visibility&-2:u._visibility|1,g&&(c===null||U||ra||kt||xi(i)),c=null,u=i;;){if(u.tag===5||u.tag===26){if(c===null){U=c=u;try{if(b=U.stateNode,g)S=b.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{D=U.stateNode;var he=U.memoizedProps.style,Z=he!=null&&he.hasOwnProperty("display")?he.display:null;D.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(we){it(U,U.return,we)}}}else if(u.tag===6){if(c===null){U=u;try{U.stateNode.nodeValue=g?"":U.memoizedProps}catch(we){it(U,U.return,we)}}}else if(u.tag===18){if(c===null){U=u;try{var te=U.stateNode;g?E0(te,!0):E0(U.stateNode,!1)}catch(we){it(U,U.return,we)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===i)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===i)break e;for(;u.sibling===null;){if(u.return===null||u.return===i)break e;c===u&&(c=null),u=u.return}c===u&&(c=null),u.sibling.return=u.return,u=u.sibling}d&4&&(d=i.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,gl(i,c))));break;case 19:xn(u,i),wn(i),d&4&&(d=i.updateQueue,d!==null&&(i.updateQueue=null,gl(i,d)));break;case 30:break;case 21:break;default:xn(u,i),wn(i)}}function wn(i){var u=i.flags;if(u&2){try{for(var c,d=i.return;d!==null;){if(_y(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,b=Lh(i);ml(i,b,g);break;case 5:var S=c.stateNode;c.flags&32&&(Xi(S,""),c.flags&=-33);var D=Lh(i);ml(i,D,S);break;case 3:case 4:var U=c.stateNode.containerInfo,Q=Lh(i);zh(i,Q,U);break;default:throw Error(n(161))}}catch(le){it(i,i.return,le)}i.flags&=-3}u&4096&&(i.flags&=-4097)}function ky(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var u=i;ky(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),i=i.sibling}}function ia(i,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Ay(i,u.alternate,u),u=u.sibling}function xi(i){for(i=i.child;i!==null;){var u=i;switch(u.tag){case 0:case 11:case 14:case 15:ka(4,u,u.return),xi(u);break;case 1:Sr(u,u.return);var c=u.stateNode;typeof c.componentWillUnmount=="function"&&Ey(u,u.return,c),xi(u);break;case 27:Lu(u.stateNode);case 26:case 5:Sr(u,u.return),xi(u);break;case 22:u.memoizedState===null&&xi(u);break;case 30:xi(u);break;default:xi(u)}i=i.sibling}}function oa(i,u,c){for(c=c&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var d=u.alternate,g=i,b=u,S=b.flags;switch(b.tag){case 0:case 11:case 15:oa(g,b,c),Au(4,b);break;case 1:if(oa(g,b,c),d=b,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Q){it(d,d.return,Q)}if(d=b,g=d.updateQueue,g!==null){var D=d.stateNode;try{var U=g.shared.hiddenCallbacks;if(U!==null)for(g.shared.hiddenCallbacks=null,g=0;g<U.length;g++)cg(U[g],D)}catch(Q){it(d,d.return,Q)}}c&&S&64&&wy(b),Tu(b,b.return);break;case 27:Sy(b);case 26:case 5:oa(g,b,c),c&&d===null&&S&4&&Cy(b),Tu(b,b.return);break;case 12:oa(g,b,c);break;case 31:oa(g,b,c),c&&S&4&&Ny(g,b);break;case 13:oa(g,b,c),c&&S&4&&Oy(g,b);break;case 22:b.memoizedState===null&&oa(g,b,c),Tu(b,b.return);break;case 30:break;default:oa(g,b,c)}u=u.sibling}}function Ph(i,u){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(i=u.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&pu(c))}function Hh(i,u){i=null,u.alternate!==null&&(i=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==i&&(u.refCount++,i!=null&&pu(i))}function pr(i,u,c,d){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Iy(i,u,c,d),u=u.sibling}function Iy(i,u,c,d){var g=u.flags;switch(u.tag){case 0:case 11:case 15:pr(i,u,c,d),g&2048&&Au(9,u);break;case 1:pr(i,u,c,d);break;case 3:pr(i,u,c,d),g&2048&&(i=null,u.alternate!==null&&(i=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==i&&(u.refCount++,i!=null&&pu(i)));break;case 12:if(g&2048){pr(i,u,c,d),i=u.stateNode;try{var b=u.memoizedProps,S=b.id,D=b.onPostCommit;typeof D=="function"&&D(S,u.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(U){it(u,u.return,U)}}else pr(i,u,c,d);break;case 31:pr(i,u,c,d);break;case 13:pr(i,u,c,d);break;case 23:break;case 22:b=u.stateNode,S=u.alternate,u.memoizedState!==null?b._visibility&2?pr(i,u,c,d):Du(i,u):b._visibility&2?pr(i,u,c,d):(b._visibility|=2,po(i,u,c,d,(u.subtreeFlags&10256)!==0||!1)),g&2048&&Ph(S,u);break;case 24:pr(i,u,c,d),g&2048&&Hh(u.alternate,u);break;default:pr(i,u,c,d)}}function po(i,u,c,d,g){for(g=g&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var b=i,S=u,D=c,U=d,Q=S.flags;switch(S.tag){case 0:case 11:case 15:po(b,S,D,U,g),Au(8,S);break;case 23:break;case 22:var le=S.stateNode;S.memoizedState!==null?le._visibility&2?po(b,S,D,U,g):Du(b,S):(le._visibility|=2,po(b,S,D,U,g)),g&&Q&2048&&Ph(S.alternate,S);break;case 24:po(b,S,D,U,g),g&&Q&2048&&Hh(S.alternate,S);break;default:po(b,S,D,U,g)}u=u.sibling}}function Du(i,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var c=i,d=u,g=d.flags;switch(d.tag){case 22:Du(c,d),g&2048&&Ph(d.alternate,d);break;case 24:Du(c,d),g&2048&&Hh(d.alternate,d);break;default:Du(c,d)}u=u.sibling}}var Nu=8192;function vo(i,u,c){if(i.subtreeFlags&Nu)for(i=i.child;i!==null;)By(i,u,c),i=i.sibling}function By(i,u,c){switch(i.tag){case 26:vo(i,u,c),i.flags&Nu&&i.memoizedState!==null&&KC(c,dr,i.memoizedState,i.memoizedProps);break;case 5:vo(i,u,c);break;case 3:case 4:var d=dr;dr=Ol(i.stateNode.containerInfo),vo(i,u,c),dr=d;break;case 22:i.memoizedState===null&&(d=i.alternate,d!==null&&d.memoizedState!==null?(d=Nu,Nu=16777216,vo(i,u,c),Nu=d):vo(i,u,c));break;default:vo(i,u,c)}}function Fy(i){var u=i.alternate;if(u!==null&&(i=u.child,i!==null)){u.child=null;do u=i.sibling,i.sibling=null,i=u;while(i!==null)}}function Ou(i){var u=i.deletions;if((i.flags&16)!==0){if(u!==null)for(var c=0;c<u.length;c++){var d=u[c];Wt=d,zy(d,i)}Fy(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ly(i),i=i.sibling}function Ly(i){switch(i.tag){case 0:case 11:case 15:Ou(i),i.flags&2048&&ka(9,i,i.return);break;case 3:Ou(i);break;case 12:Ou(i);break;case 22:var u=i.stateNode;i.memoizedState!==null&&u._visibility&2&&(i.return===null||i.return.tag!==13)?(u._visibility&=-3,yl(i)):Ou(i);break;default:Ou(i)}}function yl(i){var u=i.deletions;if((i.flags&16)!==0){if(u!==null)for(var c=0;c<u.length;c++){var d=u[c];Wt=d,zy(d,i)}Fy(i)}for(i=i.child;i!==null;){switch(u=i,u.tag){case 0:case 11:case 15:ka(8,u,u.return),yl(u);break;case 22:c=u.stateNode,c._visibility&2&&(c._visibility&=-3,yl(u));break;default:yl(u)}i=i.sibling}}function zy(i,u){for(;Wt!==null;){var c=Wt;switch(c.tag){case 0:case 11:case 15:ka(8,c,u);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:pu(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Wt=d;else e:for(c=i;Wt!==null;){d=Wt;var g=d.sibling,b=d.return;if(Ty(d),d===c){Wt=null;break e}if(g!==null){g.return=b,Wt=g;break e}Wt=b}}}var lC={getCacheForType:function(i){var u=Zt(Nt),c=u.data.get(i);return c===void 0&&(c=i(),u.data.set(i,c)),c},cacheSignal:function(){return Zt(Nt).controller.signal}},cC=typeof WeakMap=="function"?WeakMap:Map,et=0,ht=null,We=null,qe=0,at=0,zn=null,Ia=!1,mo=!1,Vh=!1,ua=0,Ct=0,Ba=0,wi=0,Wh=0,Un=0,go=0,Mu=null,En=null,jh=!1,bl=0,Uy=0,xl=1/0,wl=null,Fa=null,Bt=0,La=null,yo=null,sa=0,Gh=0,qh=null,Py=null,ku=0,Xh=null;function Pn(){return(et&2)!==0&&qe!==0?qe&-qe:z.T!==null?$h():nm()}function Hy(){if(Un===0)if((qe&536870912)===0||Ke){var i=Ds;Ds<<=1,(Ds&3932160)===0&&(Ds=262144),Un=i}else Un=536870912;return i=Fn.current,i!==null&&(i.flags|=32),Un}function Cn(i,u,c){(i===ht&&(at===2||at===9)||i.cancelPendingCommit!==null)&&(bo(i,0),za(i,qe,Un,!1)),eu(i,c),((et&2)===0||i!==ht)&&(i===ht&&((et&2)===0&&(wi|=c),Ct===4&&za(i,qe,Un,!1)),Rr(i))}function Vy(i,u,c){if((et&6)!==0)throw Error(n(327));var d=!c&&(u&127)===0&&(u&i.expiredLanes)===0||$o(i,u),g=d?dC(i,u):Yh(i,u,!0),b=d;do{if(g===0){mo&&!d&&za(i,u,0,!1);break}else{if(c=i.current.alternate,b&&!fC(c)){g=Yh(i,u,!1),b=!1;continue}if(g===2){if(b=u,i.errorRecoveryDisabledLanes&b)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){u=S;e:{var D=i;g=Mu;var U=D.current.memoizedState.isDehydrated;if(U&&(bo(D,S).flags|=256),S=Yh(D,S,!1),S!==2){if(Vh&&!U){D.errorRecoveryDisabledLanes|=b,wi|=b,g=4;break e}b=En,En=g,b!==null&&(En===null?En=b:En.push.apply(En,b))}g=S}if(b=!1,g!==2)continue}}if(g===1){bo(i,0),za(i,u,0,!0);break}e:{switch(d=i,b=g,b){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:za(d,u,Un,!Ia);break e;case 2:En=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(g=bl+300-Dt(),10<g)){if(za(d,u,Un,!Ia),Os(d,0,!0)!==0)break e;sa=u,d.timeoutHandle=b0(Wy.bind(null,d,c,En,wl,jh,u,Un,wi,go,Ia,b,"Throttled",-0,0),g);break e}Wy(d,c,En,wl,jh,u,Un,wi,go,Ia,b,null,-0,0)}}break}while(!0);Rr(i)}function Wy(i,u,c,d,g,b,S,D,U,Q,le,he,Z,te){if(i.timeoutHandle=-1,he=u.subtreeFlags,he&8192||(he&16785408)===16785408){he={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Xr},By(u,b,he);var we=(b&62914560)===b?bl-Dt():(b&4194048)===b?Uy-Dt():0;if(we=YC(he,we),we!==null){sa=b,i.cancelPendingCommit=we(Zy.bind(null,i,u,b,c,d,g,S,D,U,le,he,null,Z,te)),za(i,b,S,!Q);return}}Zy(i,u,b,c,d,g,S,D,U)}function fC(i){for(var u=i;;){var c=u.tag;if((c===0||c===11||c===15)&&u.flags&16384&&(c=u.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var g=c[d],b=g.getSnapshot;g=g.value;try{if(!In(b(),g))return!1}catch{return!1}}if(c=u.child,u.subtreeFlags&16384&&c!==null)c.return=u,u=c;else{if(u===i)break;for(;u.sibling===null;){if(u.return===null||u.return===i)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function za(i,u,c,d){u&=~Wh,u&=~wi,i.suspendedLanes|=u,i.pingedLanes&=~u,d&&(i.warmLanes|=u),d=i.expirationTimes;for(var g=u;0<g;){var b=31-kn(g),S=1<<b;d[b]=-1,g&=~S}c!==0&&$v(i,c,u)}function El(){return(et&6)===0?(Iu(0),!1):!0}function Kh(){if(We!==null){if(at===0)var i=We.return;else i=We,Zr=hi=null,ch(i),so=null,mu=0,i=We;for(;i!==null;)xy(i.alternate,i),i=i.return;We=null}}function bo(i,u){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,OC(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),sa=0,Kh(),ht=i,We=c=Yr(i.current,null),qe=u,at=0,zn=null,Ia=!1,mo=$o(i,u),Vh=!1,go=Un=Wh=wi=Ba=Ct=0,En=Mu=null,jh=!1,(u&8)!==0&&(u|=u&32);var d=i.entangledLanes;if(d!==0)for(i=i.entanglements,d&=u;0<d;){var g=31-kn(d),b=1<<g;u|=i[g],d&=~b}return ua=u,Ws(),c}function jy(i,u){ze=null,z.H=_u,u===uo||u===Zs?(u=og(),at=3):u===Jf?(u=og(),at=4):at=u===Rh?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,zn=u,We===null&&(Ct=1,fl(i,Jn(u,i.current)))}function Gy(){var i=Fn.current;return i===null?!0:(qe&4194048)===qe?nr===null:(qe&62914560)===qe||(qe&536870912)!==0?i===nr:!1}function qy(){var i=z.H;return z.H=_u,i===null?_u:i}function Xy(){var i=z.A;return z.A=lC,i}function Cl(){Ct=4,Ia||(qe&4194048)!==qe&&Fn.current!==null||(mo=!0),(Ba&134217727)===0&&(wi&134217727)===0||ht===null||za(ht,qe,Un,!1)}function Yh(i,u,c){var d=et;et|=2;var g=qy(),b=Xy();(ht!==i||qe!==u)&&(wl=null,bo(i,u)),u=!1;var S=Ct;e:do try{if(at!==0&&We!==null){var D=We,U=zn;switch(at){case 8:Kh(),S=6;break e;case 3:case 2:case 9:case 6:Fn.current===null&&(u=!0);var Q=at;if(at=0,zn=null,xo(i,D,U,Q),c&&mo){S=0;break e}break;default:Q=at,at=0,zn=null,xo(i,D,U,Q)}}hC(),S=Ct;break}catch(le){jy(i,le)}while(!0);return u&&i.shellSuspendCounter++,Zr=hi=null,et=d,z.H=g,z.A=b,We===null&&(ht=null,qe=0,Ws()),S}function hC(){for(;We!==null;)Ky(We)}function dC(i,u){var c=et;et|=2;var d=qy(),g=Xy();ht!==i||qe!==u?(wl=null,xl=Dt()+500,bo(i,u)):mo=$o(i,u);e:do try{if(at!==0&&We!==null){u=We;var b=zn;t:switch(at){case 1:at=0,zn=null,xo(i,u,b,1);break;case 2:case 9:if(ag(b)){at=0,zn=null,Yy(u);break}u=function(){at!==2&&at!==9||ht!==i||(at=7),Rr(i)},b.then(u,u);break e;case 3:at=7;break e;case 4:at=5;break e;case 7:ag(b)?(at=0,zn=null,Yy(u)):(at=0,zn=null,xo(i,u,b,7));break;case 5:var S=null;switch(We.tag){case 26:S=We.memoizedState;case 5:case 27:var D=We;if(S?I0(S):D.stateNode.complete){at=0,zn=null;var U=D.sibling;if(U!==null)We=U;else{var Q=D.return;Q!==null?(We=Q,_l(Q)):We=null}break t}}at=0,zn=null,xo(i,u,b,5);break;case 6:at=0,zn=null,xo(i,u,b,6);break;case 8:Kh(),Ct=6;break e;default:throw Error(n(462))}}pC();break}catch(le){jy(i,le)}while(!0);return Zr=hi=null,z.H=d,z.A=g,et=c,We!==null?0:(ht=null,qe=0,Ws(),Ct)}function pC(){for(;We!==null&&!Er();)Ky(We)}function Ky(i){var u=yy(i.alternate,i,ua);i.memoizedProps=i.pendingProps,u===null?_l(i):We=u}function Yy(i){var u=i,c=u.alternate;switch(u.tag){case 15:case 0:u=hy(c,u,u.pendingProps,u.type,void 0,qe);break;case 11:u=hy(c,u,u.pendingProps,u.type.render,u.ref,qe);break;case 5:ch(u);default:xy(c,u),u=We=Xm(u,ua),u=yy(c,u,ua)}i.memoizedProps=i.pendingProps,u===null?_l(i):We=u}function xo(i,u,c,d){Zr=hi=null,ch(u),so=null,mu=0;var g=u.return;try{if(nC(i,g,u,c,qe)){Ct=1,fl(i,Jn(c,i.current)),We=null;return}}catch(b){if(g!==null)throw We=g,b;Ct=1,fl(i,Jn(c,i.current)),We=null;return}u.flags&32768?(Ke||d===1?i=!0:mo||(qe&536870912)!==0?i=!1:(Ia=i=!0,(d===2||d===9||d===3||d===6)&&(d=Fn.current,d!==null&&d.tag===13&&(d.flags|=16384))),Qy(u,i)):_l(u)}function _l(i){var u=i;do{if((u.flags&32768)!==0){Qy(u,Ia);return}i=u.return;var c=iC(u.alternate,u,ua);if(c!==null){We=c;return}if(u=u.sibling,u!==null){We=u;return}We=u=i}while(u!==null);Ct===0&&(Ct=5)}function Qy(i,u){do{var c=oC(i.alternate,i);if(c!==null){c.flags&=32767,We=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!u&&(i=i.sibling,i!==null)){We=i;return}We=i=c}while(i!==null);Ct=6,We=null}function Zy(i,u,c,d,g,b,S,D,U){i.cancelPendingCommit=null;do Sl();while(Bt!==0);if((et&6)!==0)throw Error(n(327));if(u!==null){if(u===i.current)throw Error(n(177));if(b=u.lanes|u.childLanes,b|=Lf,Xw(i,c,b,S,D,U),i===ht&&(We=ht=null,qe=0),yo=u,La=i,sa=c,Gh=b,qh=g,Py=d,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,yC(hn,function(){return n0(),null})):(i.callbackNode=null,i.callbackPriority=0),d=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||d){d=z.T,z.T=null,g=G.p,G.p=2,S=et,et|=4;try{uC(i,u,c)}finally{et=S,G.p=g,z.T=d}}Bt=1,Jy(),$y(),e0()}}function Jy(){if(Bt===1){Bt=0;var i=La,u=yo,c=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||c){c=z.T,z.T=null;var d=G.p;G.p=2;var g=et;et|=4;try{My(u,i);var b=ud,S=zm(i.containerInfo),D=b.focusedElem,U=b.selectionRange;if(S!==D&&D&&D.ownerDocument&&Lm(D.ownerDocument.documentElement,D)){if(U!==null&&Mf(D)){var Q=U.start,le=U.end;if(le===void 0&&(le=Q),"selectionStart"in D)D.selectionStart=Q,D.selectionEnd=Math.min(le,D.value.length);else{var he=D.ownerDocument||document,Z=he&&he.defaultView||window;if(Z.getSelection){var te=Z.getSelection(),we=D.textContent.length,Me=Math.min(U.start,we),st=U.end===void 0?Me:Math.min(U.end,we);!te.extend&&Me>st&&(S=st,st=Me,Me=S);var X=Fm(D,Me),V=Fm(D,st);if(X&&V&&(te.rangeCount!==1||te.anchorNode!==X.node||te.anchorOffset!==X.offset||te.focusNode!==V.node||te.focusOffset!==V.offset)){var Y=he.createRange();Y.setStart(X.node,X.offset),te.removeAllRanges(),Me>st?(te.addRange(Y),te.extend(V.node,V.offset)):(Y.setEnd(V.node,V.offset),te.addRange(Y))}}}}for(he=[],te=D;te=te.parentNode;)te.nodeType===1&&he.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<he.length;D++){var fe=he[D];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}Ll=!!od,ud=od=null}finally{et=g,G.p=d,z.T=c}}i.current=u,Bt=2}}function $y(){if(Bt===2){Bt=0;var i=La,u=yo,c=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||c){c=z.T,z.T=null;var d=G.p;G.p=2;var g=et;et|=4;try{Ay(i,u.alternate,u)}finally{et=g,G.p=d,z.T=c}}Bt=3}}function e0(){if(Bt===4||Bt===3){Bt=0,cr();var i=La,u=yo,c=sa,d=Py;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?Bt=5:(Bt=0,yo=La=null,t0(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(Fa=null),df(c),u=u.stateNode,Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(Gr,u,void 0,(u.current.flags&128)===128)}catch{}if(d!==null){u=z.T,g=G.p,G.p=2,z.T=null;try{for(var b=i.onRecoverableError,S=0;S<d.length;S++){var D=d[S];b(D.value,{componentStack:D.stack})}}finally{z.T=u,G.p=g}}(sa&3)!==0&&Sl(),Rr(i),g=i.pendingLanes,(c&261930)!==0&&(g&42)!==0?i===Xh?ku++:(ku=0,Xh=i):ku=0,Iu(0)}}function t0(i,u){(i.pooledCacheLanes&=u)===0&&(u=i.pooledCache,u!=null&&(i.pooledCache=null,pu(u)))}function Sl(){return Jy(),$y(),e0(),n0()}function n0(){if(Bt!==5)return!1;var i=La,u=Gh;Gh=0;var c=df(sa),d=z.T,g=G.p;try{G.p=32>c?32:c,z.T=null,c=qh,qh=null;var b=La,S=sa;if(Bt=0,yo=La=null,sa=0,(et&6)!==0)throw Error(n(331));var D=et;if(et|=4,Ly(b.current),Iy(b,b.current,S,c),et=D,Iu(0,!1),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(Gr,b)}catch{}return!0}finally{G.p=g,z.T=d,t0(i,u)}}function r0(i,u,c){u=Jn(c,u),u=Sh(i.stateNode,u,2),i=Na(i,u,2),i!==null&&(eu(i,2),Rr(i))}function it(i,u,c){if(i.tag===3)r0(i,i,c);else for(;u!==null;){if(u.tag===3){r0(u,i,c);break}else if(u.tag===1){var d=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Fa===null||!Fa.has(d))){i=Jn(c,i),c=ay(2),d=Na(u,c,2),d!==null&&(iy(c,d,u,i),eu(d,2),Rr(d));break}}u=u.return}}function Qh(i,u,c){var d=i.pingCache;if(d===null){d=i.pingCache=new cC;var g=new Set;d.set(u,g)}else g=d.get(u),g===void 0&&(g=new Set,d.set(u,g));g.has(c)||(Vh=!0,g.add(c),i=vC.bind(null,i,u,c),u.then(i,i))}function vC(i,u,c){var d=i.pingCache;d!==null&&d.delete(u),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,ht===i&&(qe&c)===c&&(Ct===4||Ct===3&&(qe&62914560)===qe&&300>Dt()-bl?(et&2)===0&&bo(i,0):Wh|=c,go===qe&&(go=0)),Rr(i)}function a0(i,u){u===0&&(u=Jv()),i=li(i,u),i!==null&&(eu(i,u),Rr(i))}function mC(i){var u=i.memoizedState,c=0;u!==null&&(c=u.retryLane),a0(i,c)}function gC(i,u){var c=0;switch(i.tag){case 31:case 13:var d=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:d=i.stateNode;break;case 22:d=i.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(u),a0(i,c)}function yC(i,u){return wr(i,u)}var Rl=null,wo=null,Zh=!1,Al=!1,Jh=!1,Ua=0;function Rr(i){i!==wo&&i.next===null&&(wo===null?Rl=wo=i:wo=wo.next=i),Al=!0,Zh||(Zh=!0,xC())}function Iu(i,u){if(!Jh&&Al){Jh=!0;do for(var c=!1,d=Rl;d!==null;){if(i!==0){var g=d.pendingLanes;if(g===0)var b=0;else{var S=d.suspendedLanes,D=d.pingedLanes;b=(1<<31-kn(42|i)+1)-1,b&=g&~(S&~D),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,s0(d,b))}else b=qe,b=Os(d,d===ht?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(b&3)===0||$o(d,b)||(c=!0,s0(d,b));d=d.next}while(c);Jh=!1}}function bC(){i0()}function i0(){Al=Zh=!1;var i=0;Ua!==0&&NC()&&(i=Ua);for(var u=Dt(),c=null,d=Rl;d!==null;){var g=d.next,b=o0(d,u);b===0?(d.next=null,c===null?Rl=g:c.next=g,g===null&&(wo=c)):(c=d,(i!==0||(b&3)!==0)&&(Al=!0)),d=g}Bt!==0&&Bt!==5||Iu(i),Ua!==0&&(Ua=0)}function o0(i,u){for(var c=i.suspendedLanes,d=i.pingedLanes,g=i.expirationTimes,b=i.pendingLanes&-62914561;0<b;){var S=31-kn(b),D=1<<S,U=g[S];U===-1?((D&c)===0||(D&d)!==0)&&(g[S]=qw(D,u)):U<=u&&(i.expiredLanes|=D),b&=~D}if(u=ht,c=qe,c=Os(i,i===u?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),d=i.callbackNode,c===0||i===u&&(at===2||at===9)||i.cancelPendingCommit!==null)return d!==null&&d!==null&&Mn(d),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||$o(i,c)){if(u=c&-c,u===i.callbackPriority)return u;switch(d!==null&&Mn(d),df(c)){case 2:case 8:c=jr;break;case 32:c=hn;break;case 268435456:c=As;break;default:c=hn}return d=u0.bind(null,i),c=wr(c,d),i.callbackPriority=u,i.callbackNode=c,u}return d!==null&&d!==null&&Mn(d),i.callbackPriority=2,i.callbackNode=null,2}function u0(i,u){if(Bt!==0&&Bt!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Sl()&&i.callbackNode!==c)return null;var d=qe;return d=Os(i,i===ht?d:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),d===0?null:(Vy(i,d,u),o0(i,Dt()),i.callbackNode!=null&&i.callbackNode===c?u0.bind(null,i):null)}function s0(i,u){if(Sl())return null;Vy(i,u,!0)}function xC(){MC(function(){(et&6)!==0?wr(Pi,bC):i0()})}function $h(){if(Ua===0){var i=io;i===0&&(i=Ts,Ts<<=1,(Ts&261888)===0&&(Ts=256)),Ua=i}return Ua}function l0(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Bs(""+i)}function c0(i,u){var c=u.ownerDocument.createElement("input");return c.name=u.name,c.value=u.value,i.id&&c.setAttribute("form",i.id),u.parentNode.insertBefore(c,u),i=new FormData(i),c.parentNode.removeChild(c),i}function wC(i,u,c,d,g){if(u==="submit"&&c&&c.stateNode===g){var b=l0((g[gn]||null).action),S=d.submitter;S&&(u=(u=S[gn]||null)?l0(u.formAction):S.getAttribute("formAction"),u!==null&&(b=u,S=null));var D=new Us("action","action",null,d,g);i.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Ua!==0){var U=S?c0(g,S):new FormData(g);bh(c,{pending:!0,data:U,method:g.method,action:b},null,U)}}else typeof b=="function"&&(D.preventDefault(),U=S?c0(g,S):new FormData(g),bh(c,{pending:!0,data:U,method:g.method,action:b},b,U))},currentTarget:g}]})}}for(var ed=0;ed<Ff.length;ed++){var td=Ff[ed],EC=td.toLowerCase(),CC=td[0].toUpperCase()+td.slice(1);hr(EC,"on"+CC)}hr(Hm,"onAnimationEnd"),hr(Vm,"onAnimationIteration"),hr(Wm,"onAnimationStart"),hr("dblclick","onDoubleClick"),hr("focusin","onFocus"),hr("focusout","onBlur"),hr(UE,"onTransitionRun"),hr(PE,"onTransitionStart"),hr(HE,"onTransitionCancel"),hr(jm,"onTransitionEnd"),Gi("onMouseEnter",["mouseout","mouseover"]),Gi("onMouseLeave",["mouseout","mouseover"]),Gi("onPointerEnter",["pointerout","pointerover"]),Gi("onPointerLeave",["pointerout","pointerover"]),ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ii("onBeforeInput",["compositionend","keypress","textInput","paste"]),ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_C=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bu));function f0(i,u){u=(u&4)!==0;for(var c=0;c<i.length;c++){var d=i[c],g=d.event;d=d.listeners;e:{var b=void 0;if(u)for(var S=d.length-1;0<=S;S--){var D=d[S],U=D.instance,Q=D.currentTarget;if(D=D.listener,U!==b&&g.isPropagationStopped())break e;b=D,g.currentTarget=Q;try{b(g)}catch(le){Vs(le)}g.currentTarget=null,b=U}else for(S=0;S<d.length;S++){if(D=d[S],U=D.instance,Q=D.currentTarget,D=D.listener,U!==b&&g.isPropagationStopped())break e;b=D,g.currentTarget=Q;try{b(g)}catch(le){Vs(le)}g.currentTarget=null,b=U}}}}function je(i,u){var c=u[pf];c===void 0&&(c=u[pf]=new Set);var d=i+"__bubble";c.has(d)||(h0(u,i,2,!1),c.add(d))}function nd(i,u,c){var d=0;u&&(d|=4),h0(c,i,d,u)}var Tl="_reactListening"+Math.random().toString(36).slice(2);function rd(i){if(!i[Tl]){i[Tl]=!0,im.forEach(function(c){c!=="selectionchange"&&(_C.has(c)||nd(c,!1,i),nd(c,!0,i))});var u=i.nodeType===9?i:i.ownerDocument;u===null||u[Tl]||(u[Tl]=!0,nd("selectionchange",!1,u))}}function h0(i,u,c,d){switch(H0(u)){case 2:var g=JC;break;case 8:g=$C;break;default:g=yd}c=g.bind(null,u,c,i),g=void 0,!Cf||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(g=!0),d?g!==void 0?i.addEventListener(u,c,{capture:!0,passive:g}):i.addEventListener(u,c,!0):g!==void 0?i.addEventListener(u,c,{passive:g}):i.addEventListener(u,c,!1)}function ad(i,u,c,d,g){var b=d;if((u&1)===0&&(u&2)===0&&d!==null)e:for(;;){if(d===null)return;var S=d.tag;if(S===3||S===4){var D=d.stateNode.containerInfo;if(D===g)break;if(S===4)for(S=d.return;S!==null;){var U=S.tag;if((U===3||U===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;D!==null;){if(S=Vi(D),S===null)return;if(U=S.tag,U===5||U===6||U===26||U===27){d=b=S;continue e}D=D.parentNode}}d=d.return}gm(function(){var Q=b,le=wf(c),he=[];e:{var Z=Gm.get(i);if(Z!==void 0){var te=Us,we=i;switch(i){case"keypress":if(Ls(c)===0)break e;case"keydown":case"keyup":te=gE;break;case"focusin":we="focus",te=Af;break;case"focusout":we="blur",te=Af;break;case"beforeblur":case"afterblur":te=Af;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=xm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=iE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=xE;break;case Hm:case Vm:case Wm:te=sE;break;case jm:te=EE;break;case"scroll":case"scrollend":te=rE;break;case"wheel":te=_E;break;case"copy":case"cut":case"paste":te=cE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=Em;break;case"toggle":case"beforetoggle":te=RE}var Me=(u&4)!==0,st=!Me&&(i==="scroll"||i==="scrollend"),X=Me?Z!==null?Z+"Capture":null:Z;Me=[];for(var V=Q,Y;V!==null;){var fe=V;if(Y=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Y===null||X===null||(fe=ru(V,X),fe!=null&&Me.push(Fu(V,fe,Y))),st)break;V=V.return}0<Me.length&&(Z=new te(Z,we,null,c,le),he.push({event:Z,listeners:Me}))}}if((u&7)===0){e:{if(Z=i==="mouseover"||i==="pointerover",te=i==="mouseout"||i==="pointerout",Z&&c!==xf&&(we=c.relatedTarget||c.fromElement)&&(Vi(we)||we[Hi]))break e;if((te||Z)&&(Z=le.window===le?le:(Z=le.ownerDocument)?Z.defaultView||Z.parentWindow:window,te?(we=c.relatedTarget||c.toElement,te=Q,we=we?Vi(we):null,we!==null&&(st=o(we),Me=we.tag,we!==st||Me!==5&&Me!==27&&Me!==6)&&(we=null)):(te=null,we=Q),te!==we)){if(Me=xm,fe="onMouseLeave",X="onMouseEnter",V="mouse",(i==="pointerout"||i==="pointerover")&&(Me=Em,fe="onPointerLeave",X="onPointerEnter",V="pointer"),st=te==null?Z:nu(te),Y=we==null?Z:nu(we),Z=new Me(fe,V+"leave",te,c,le),Z.target=st,Z.relatedTarget=Y,fe=null,Vi(le)===Q&&(Me=new Me(X,V+"enter",we,c,le),Me.target=Y,Me.relatedTarget=st,fe=Me),st=fe,te&&we)t:{for(Me=SC,X=te,V=we,Y=0,fe=X;fe;fe=Me(fe))Y++;fe=0;for(var Ne=V;Ne;Ne=Me(Ne))fe++;for(;0<Y-fe;)X=Me(X),Y--;for(;0<fe-Y;)V=Me(V),fe--;for(;Y--;){if(X===V||V!==null&&X===V.alternate){Me=X;break t}X=Me(X),V=Me(V)}Me=null}else Me=null;te!==null&&d0(he,Z,te,Me,!1),we!==null&&st!==null&&d0(he,st,we,Me,!0)}}e:{if(Z=Q?nu(Q):window,te=Z.nodeName&&Z.nodeName.toLowerCase(),te==="select"||te==="input"&&Z.type==="file")var Je=Nm;else if(Tm(Z))if(Om)Je=FE;else{Je=IE;var _e=kE}else te=Z.nodeName,!te||te.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?Q&&bf(Q.elementType)&&(Je=Nm):Je=BE;if(Je&&(Je=Je(i,Q))){Dm(he,Je,c,le);break e}_e&&_e(i,Z,Q),i==="focusout"&&Q&&Z.type==="number"&&Q.memoizedProps.value!=null&&yf(Z,"number",Z.value)}switch(_e=Q?nu(Q):window,i){case"focusin":(Tm(_e)||_e.contentEditable==="true")&&(Zi=_e,kf=Q,fu=null);break;case"focusout":fu=kf=Zi=null;break;case"mousedown":If=!0;break;case"contextmenu":case"mouseup":case"dragend":If=!1,Um(he,c,le);break;case"selectionchange":if(zE)break;case"keydown":case"keyup":Um(he,c,le)}var Ue;if(Df)e:{switch(i){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else Qi?Rm(i,c)&&(Xe="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(Xe="onCompositionStart");Xe&&(Cm&&c.locale!=="ko"&&(Qi||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&Qi&&(Ue=ym()):(Ca=le,_f="value"in Ca?Ca.value:Ca.textContent,Qi=!0)),_e=Dl(Q,Xe),0<_e.length&&(Xe=new wm(Xe,i,null,c,le),he.push({event:Xe,listeners:_e}),Ue?Xe.data=Ue:(Ue=Am(c),Ue!==null&&(Xe.data=Ue)))),(Ue=TE?DE(i,c):NE(i,c))&&(Xe=Dl(Q,"onBeforeInput"),0<Xe.length&&(_e=new wm("onBeforeInput","beforeinput",null,c,le),he.push({event:_e,listeners:Xe}),_e.data=Ue)),wC(he,i,Q,c,le)}f0(he,u)})}function Fu(i,u,c){return{instance:i,listener:u,currentTarget:c}}function Dl(i,u){for(var c=u+"Capture",d=[];i!==null;){var g=i,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=ru(i,c),g!=null&&d.unshift(Fu(i,g,b)),g=ru(i,u),g!=null&&d.push(Fu(i,g,b))),i.tag===3)return d;i=i.return}return[]}function SC(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function d0(i,u,c,d,g){for(var b=u._reactName,S=[];c!==null&&c!==d;){var D=c,U=D.alternate,Q=D.stateNode;if(D=D.tag,U!==null&&U===d)break;D!==5&&D!==26&&D!==27||Q===null||(U=Q,g?(Q=ru(c,b),Q!=null&&S.unshift(Fu(c,Q,U))):g||(Q=ru(c,b),Q!=null&&S.push(Fu(c,Q,U)))),c=c.return}S.length!==0&&i.push({event:u,listeners:S})}var RC=/\r\n?/g,AC=/\u0000|\uFFFD/g;function p0(i){return(typeof i=="string"?i:""+i).replace(RC,`
`).replace(AC,"")}function v0(i,u){return u=p0(u),p0(i)===u}function ut(i,u,c,d,g,b){switch(c){case"children":typeof d=="string"?u==="body"||u==="textarea"&&d===""||Xi(i,d):(typeof d=="number"||typeof d=="bigint")&&u!=="body"&&Xi(i,""+d);break;case"className":ks(i,"class",d);break;case"tabIndex":ks(i,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ks(i,c,d);break;case"style":vm(i,d,b);break;case"data":if(u!=="object"){ks(i,"data",d);break}case"src":case"href":if(d===""&&(u!=="a"||c!=="href")){i.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){i.removeAttribute(c);break}d=Bs(""+d),i.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(u!=="input"&&ut(i,u,"name",g.name,g,null),ut(i,u,"formEncType",g.formEncType,g,null),ut(i,u,"formMethod",g.formMethod,g,null),ut(i,u,"formTarget",g.formTarget,g,null)):(ut(i,u,"encType",g.encType,g,null),ut(i,u,"method",g.method,g,null),ut(i,u,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){i.removeAttribute(c);break}d=Bs(""+d),i.setAttribute(c,d);break;case"onClick":d!=null&&(i.onclick=Xr);break;case"onScroll":d!=null&&je("scroll",i);break;case"onScrollEnd":d!=null&&je("scrollend",i);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":i.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){i.removeAttribute("xlink:href");break}c=Bs(""+d),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?i.setAttribute(c,""+d):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":d===!0?i.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?i.setAttribute(c,d):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?i.setAttribute(c,d):i.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?i.removeAttribute(c):i.setAttribute(c,d);break;case"popover":je("beforetoggle",i),je("toggle",i),Ms(i,"popover",d);break;case"xlinkActuate":qr(i,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":qr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":qr(i,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":qr(i,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":qr(i,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":qr(i,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":qr(i,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":qr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":qr(i,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Ms(i,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=tE.get(c)||c,Ms(i,c,d))}}function id(i,u,c,d,g,b){switch(c){case"style":vm(i,d,b);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof d=="string"?Xi(i,d):(typeof d=="number"||typeof d=="bigint")&&Xi(i,""+d);break;case"onScroll":d!=null&&je("scroll",i);break;case"onScrollEnd":d!=null&&je("scrollend",i);break;case"onClick":d!=null&&(i.onclick=Xr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!om.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),u=c.slice(2,g?c.length-7:void 0),b=i[gn]||null,b=b!=null?b[c]:null,typeof b=="function"&&i.removeEventListener(u,b,g),typeof d=="function")){typeof b!="function"&&b!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(u,d,g);break e}c in i?i[c]=d:d===!0?i.setAttribute(c,""):Ms(i,c,d)}}}function $t(i,u,c){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":je("error",i),je("load",i);var d=!1,g=!1,b;for(b in c)if(c.hasOwnProperty(b)){var S=c[b];if(S!=null)switch(b){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:ut(i,u,b,S,c,null)}}g&&ut(i,u,"srcSet",c.srcSet,c,null),d&&ut(i,u,"src",c.src,c,null);return;case"input":je("invalid",i);var D=b=S=g=null,U=null,Q=null;for(d in c)if(c.hasOwnProperty(d)){var le=c[d];if(le!=null)switch(d){case"name":g=le;break;case"type":S=le;break;case"checked":U=le;break;case"defaultChecked":Q=le;break;case"value":b=le;break;case"defaultValue":D=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(n(137,u));break;default:ut(i,u,d,le,c,null)}}fm(i,b,D,U,Q,S,g,!1);return;case"select":je("invalid",i),d=S=b=null;for(g in c)if(c.hasOwnProperty(g)&&(D=c[g],D!=null))switch(g){case"value":b=D;break;case"defaultValue":S=D;break;case"multiple":d=D;default:ut(i,u,g,D,c,null)}u=b,c=S,i.multiple=!!d,u!=null?qi(i,!!d,u,!1):c!=null&&qi(i,!!d,c,!0);return;case"textarea":je("invalid",i),b=g=d=null;for(S in c)if(c.hasOwnProperty(S)&&(D=c[S],D!=null))switch(S){case"value":d=D;break;case"defaultValue":g=D;break;case"children":b=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:ut(i,u,S,D,c,null)}dm(i,d,g,b);return;case"option":for(U in c)c.hasOwnProperty(U)&&(d=c[U],d!=null)&&(U==="selected"?i.selected=d&&typeof d!="function"&&typeof d!="symbol":ut(i,u,U,d,c,null));return;case"dialog":je("beforetoggle",i),je("toggle",i),je("cancel",i),je("close",i);break;case"iframe":case"object":je("load",i);break;case"video":case"audio":for(d=0;d<Bu.length;d++)je(Bu[d],i);break;case"image":je("error",i),je("load",i);break;case"details":je("toggle",i);break;case"embed":case"source":case"link":je("error",i),je("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in c)if(c.hasOwnProperty(Q)&&(d=c[Q],d!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:ut(i,u,Q,d,c,null)}return;default:if(bf(u)){for(le in c)c.hasOwnProperty(le)&&(d=c[le],d!==void 0&&id(i,u,le,d,c,void 0));return}}for(D in c)c.hasOwnProperty(D)&&(d=c[D],d!=null&&ut(i,u,D,d,c,null))}function TC(i,u,c,d){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,S=null,D=null,U=null,Q=null,le=null;for(te in c){var he=c[te];if(c.hasOwnProperty(te)&&he!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":U=he;default:d.hasOwnProperty(te)||ut(i,u,te,null,d,he)}}for(var Z in d){var te=d[Z];if(he=c[Z],d.hasOwnProperty(Z)&&(te!=null||he!=null))switch(Z){case"type":b=te;break;case"name":g=te;break;case"checked":Q=te;break;case"defaultChecked":le=te;break;case"value":S=te;break;case"defaultValue":D=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(137,u));break;default:te!==he&&ut(i,u,Z,te,d,he)}}gf(i,S,D,U,Q,le,b,g);return;case"select":te=S=D=Z=null;for(b in c)if(U=c[b],c.hasOwnProperty(b)&&U!=null)switch(b){case"value":break;case"multiple":te=U;default:d.hasOwnProperty(b)||ut(i,u,b,null,d,U)}for(g in d)if(b=d[g],U=c[g],d.hasOwnProperty(g)&&(b!=null||U!=null))switch(g){case"value":Z=b;break;case"defaultValue":D=b;break;case"multiple":S=b;default:b!==U&&ut(i,u,g,b,d,U)}u=D,c=S,d=te,Z!=null?qi(i,!!c,Z,!1):!!d!=!!c&&(u!=null?qi(i,!!c,u,!0):qi(i,!!c,c?[]:"",!1));return;case"textarea":te=Z=null;for(D in c)if(g=c[D],c.hasOwnProperty(D)&&g!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:ut(i,u,D,null,d,g)}for(S in d)if(g=d[S],b=c[S],d.hasOwnProperty(S)&&(g!=null||b!=null))switch(S){case"value":Z=g;break;case"defaultValue":te=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==b&&ut(i,u,S,g,d,b)}hm(i,Z,te);return;case"option":for(var we in c)Z=c[we],c.hasOwnProperty(we)&&Z!=null&&!d.hasOwnProperty(we)&&(we==="selected"?i.selected=!1:ut(i,u,we,null,d,Z));for(U in d)Z=d[U],te=c[U],d.hasOwnProperty(U)&&Z!==te&&(Z!=null||te!=null)&&(U==="selected"?i.selected=Z&&typeof Z!="function"&&typeof Z!="symbol":ut(i,u,U,Z,d,te));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in c)Z=c[Me],c.hasOwnProperty(Me)&&Z!=null&&!d.hasOwnProperty(Me)&&ut(i,u,Me,null,d,Z);for(Q in d)if(Z=d[Q],te=c[Q],d.hasOwnProperty(Q)&&Z!==te&&(Z!=null||te!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(137,u));break;default:ut(i,u,Q,Z,d,te)}return;default:if(bf(u)){for(var st in c)Z=c[st],c.hasOwnProperty(st)&&Z!==void 0&&!d.hasOwnProperty(st)&&id(i,u,st,void 0,d,Z);for(le in d)Z=d[le],te=c[le],!d.hasOwnProperty(le)||Z===te||Z===void 0&&te===void 0||id(i,u,le,Z,d,te);return}}for(var X in c)Z=c[X],c.hasOwnProperty(X)&&Z!=null&&!d.hasOwnProperty(X)&&ut(i,u,X,null,d,Z);for(he in d)Z=d[he],te=c[he],!d.hasOwnProperty(he)||Z===te||Z==null&&te==null||ut(i,u,he,Z,d,te)}function m0(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function DC(){if(typeof performance.getEntriesByType=="function"){for(var i=0,u=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var g=c[d],b=g.transferSize,S=g.initiatorType,D=g.duration;if(b&&D&&m0(S)){for(S=0,D=g.responseEnd,d+=1;d<c.length;d++){var U=c[d],Q=U.startTime;if(Q>D)break;var le=U.transferSize,he=U.initiatorType;le&&m0(he)&&(U=U.responseEnd,S+=le*(U<D?1:(D-Q)/(U-Q)))}if(--d,u+=8*(b+S)/(g.duration/1e3),i++,10<i)break}}if(0<i)return u/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var od=null,ud=null;function Nl(i){return i.nodeType===9?i:i.ownerDocument}function g0(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function y0(i,u){if(i===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&u==="foreignObject"?0:i}function sd(i,u){return i==="textarea"||i==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var ld=null;function NC(){var i=window.event;return i&&i.type==="popstate"?i===ld?!1:(ld=i,!0):(ld=null,!1)}var b0=typeof setTimeout=="function"?setTimeout:void 0,OC=typeof clearTimeout=="function"?clearTimeout:void 0,x0=typeof Promise=="function"?Promise:void 0,MC=typeof queueMicrotask=="function"?queueMicrotask:typeof x0<"u"?function(i){return x0.resolve(null).then(i).catch(kC)}:b0;function kC(i){setTimeout(function(){throw i})}function Pa(i){return i==="head"}function w0(i,u){var c=u,d=0;do{var g=c.nextSibling;if(i.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(d===0){i.removeChild(g),So(u);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Lu(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,Lu(c);for(var b=c.firstChild;b;){var S=b.nextSibling,D=b.nodeName;b[tu]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&b.rel.toLowerCase()==="stylesheet"||c.removeChild(b),b=S}}else c==="body"&&Lu(i.ownerDocument.body);c=g}while(c);So(u)}function E0(i,u){var c=i;i=0;do{var d=c.nextSibling;if(c.nodeType===1?u?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(u?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=d}while(c)}function cd(i){var u=i.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var c=u;switch(u=u.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":cd(c),vf(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function IC(i,u,c,d){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==u.toLowerCase()){if(!d&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(d){if(!i[tu])switch(u){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(b=i.getAttribute("rel"),b==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(b!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(b=i.getAttribute("src"),(b!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(u==="input"&&i.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===b)return i}else return i;if(i=rr(i.nextSibling),i===null)break}return null}function BC(i,u,c){if(u==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=rr(i.nextSibling),i===null))return null;return i}function C0(i,u){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=rr(i.nextSibling),i===null))return null;return i}function fd(i){return i.data==="$?"||i.data==="$~"}function hd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function FC(i,u){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=u;else if(i.data!=="$?"||c.readyState!=="loading")u();else{var d=function(){u(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),i._reactRetry=d}}function rr(i){for(;i!=null;i=i.nextSibling){var u=i.nodeType;if(u===1||u===3)break;if(u===8){if(u=i.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return i}var dd=null;function _0(i){i=i.nextSibling;for(var u=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(u===0)return rr(i.nextSibling);u--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||u++}i=i.nextSibling}return null}function S0(i){i=i.previousSibling;for(var u=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(u===0)return i;u--}else c!=="/$"&&c!=="/&"||u++}i=i.previousSibling}return null}function R0(i,u,c){switch(u=Nl(c),i){case"html":if(i=u.documentElement,!i)throw Error(n(452));return i;case"head":if(i=u.head,!i)throw Error(n(453));return i;case"body":if(i=u.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Lu(i){for(var u=i.attributes;u.length;)i.removeAttributeNode(u[0]);vf(i)}var ar=new Map,A0=new Set;function Ol(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var la=G.d;G.d={f:LC,r:zC,D:UC,C:PC,L:HC,m:VC,X:jC,S:WC,M:GC};function LC(){var i=la.f(),u=El();return i||u}function zC(i){var u=Wi(i);u!==null&&u.tag===5&&u.type==="form"?jg(u):la.r(i)}var Eo=typeof document>"u"?null:document;function T0(i,u,c){var d=Eo;if(d&&typeof u=="string"&&u){var g=Qn(u);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),A0.has(g)||(A0.add(g),i={rel:i,crossOrigin:c,href:u},d.querySelector(g)===null&&(u=d.createElement("link"),$t(u,"link",i),Vt(u),d.head.appendChild(u)))}}function UC(i){la.D(i),T0("dns-prefetch",i,null)}function PC(i,u){la.C(i,u),T0("preconnect",i,u)}function HC(i,u,c){la.L(i,u,c);var d=Eo;if(d&&i&&u){var g='link[rel="preload"][as="'+Qn(u)+'"]';u==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Qn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Qn(c.imageSizes)+'"]')):g+='[href="'+Qn(i)+'"]';var b=g;switch(u){case"style":b=Co(i);break;case"script":b=_o(i)}ar.has(b)||(i=v({rel:"preload",href:u==="image"&&c&&c.imageSrcSet?void 0:i,as:u},c),ar.set(b,i),d.querySelector(g)!==null||u==="style"&&d.querySelector(zu(b))||u==="script"&&d.querySelector(Uu(b))||(u=d.createElement("link"),$t(u,"link",i),Vt(u),d.head.appendChild(u)))}}function VC(i,u){la.m(i,u);var c=Eo;if(c&&i){var d=u&&typeof u.as=="string"?u.as:"script",g='link[rel="modulepreload"][as="'+Qn(d)+'"][href="'+Qn(i)+'"]',b=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=_o(i)}if(!ar.has(b)&&(i=v({rel:"modulepreload",href:i},u),ar.set(b,i),c.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Uu(b)))return}d=c.createElement("link"),$t(d,"link",i),Vt(d),c.head.appendChild(d)}}}function WC(i,u,c){la.S(i,u,c);var d=Eo;if(d&&i){var g=ji(d).hoistableStyles,b=Co(i);u=u||"default";var S=g.get(b);if(!S){var D={loading:0,preload:null};if(S=d.querySelector(zu(b)))D.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":u},c),(c=ar.get(b))&&pd(i,c);var U=S=d.createElement("link");Vt(U),$t(U,"link",i),U._p=new Promise(function(Q,le){U.onload=Q,U.onerror=le}),U.addEventListener("load",function(){D.loading|=1}),U.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Ml(S,u,d)}S={type:"stylesheet",instance:S,count:1,state:D},g.set(b,S)}}}function jC(i,u){la.X(i,u);var c=Eo;if(c&&i){var d=ji(c).hoistableScripts,g=_o(i),b=d.get(g);b||(b=c.querySelector(Uu(g)),b||(i=v({src:i,async:!0},u),(u=ar.get(g))&&vd(i,u),b=c.createElement("script"),Vt(b),$t(b,"link",i),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(g,b))}}function GC(i,u){la.M(i,u);var c=Eo;if(c&&i){var d=ji(c).hoistableScripts,g=_o(i),b=d.get(g);b||(b=c.querySelector(Uu(g)),b||(i=v({src:i,async:!0,type:"module"},u),(u=ar.get(g))&&vd(i,u),b=c.createElement("script"),Vt(b),$t(b,"link",i),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(g,b))}}function D0(i,u,c,d){var g=(g=ye.current)?Ol(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(u=Co(c.href),c=ji(g).hoistableStyles,d=c.get(u),d||(d={type:"style",instance:null,count:0,state:null},c.set(u,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Co(c.href);var b=ji(g).hoistableStyles,S=b.get(i);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(i,S),(b=g.querySelector(zu(i)))&&!b._p&&(S.instance=b,S.state.loading=5),ar.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},ar.set(i,c),b||qC(g,i,c,S.state))),u&&d===null)throw Error(n(528,""));return S}if(u&&d!==null)throw Error(n(529,""));return null;case"script":return u=c.async,c=c.src,typeof c=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=_o(c),c=ji(g).hoistableScripts,d=c.get(u),d||(d={type:"script",instance:null,count:0,state:null},c.set(u,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Co(i){return'href="'+Qn(i)+'"'}function zu(i){return'link[rel="stylesheet"]['+i+"]"}function N0(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function qC(i,u,c,d){i.querySelector('link[rel="preload"][as="style"]['+u+"]")?d.loading=1:(u=i.createElement("link"),d.preload=u,u.addEventListener("load",function(){return d.loading|=1}),u.addEventListener("error",function(){return d.loading|=2}),$t(u,"link",c),Vt(u),i.head.appendChild(u))}function _o(i){return'[src="'+Qn(i)+'"]'}function Uu(i){return"script[async]"+i}function O0(i,u,c){if(u.count++,u.instance===null)switch(u.type){case"style":var d=i.querySelector('style[data-href~="'+Qn(c.href)+'"]');if(d)return u.instance=d,Vt(d),d;var g=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(i.ownerDocument||i).createElement("style"),Vt(d),$t(d,"style",g),Ml(d,c.precedence,i),u.instance=d;case"stylesheet":g=Co(c.href);var b=i.querySelector(zu(g));if(b)return u.state.loading|=4,u.instance=b,Vt(b),b;d=N0(c),(g=ar.get(g))&&pd(d,g),b=(i.ownerDocument||i).createElement("link"),Vt(b);var S=b;return S._p=new Promise(function(D,U){S.onload=D,S.onerror=U}),$t(b,"link",d),u.state.loading|=4,Ml(b,c.precedence,i),u.instance=b;case"script":return b=_o(c.src),(g=i.querySelector(Uu(b)))?(u.instance=g,Vt(g),g):(d=c,(g=ar.get(b))&&(d=v({},c),vd(d,g)),i=i.ownerDocument||i,g=i.createElement("script"),Vt(g),$t(g,"link",d),i.head.appendChild(g),u.instance=g);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(d=u.instance,u.state.loading|=4,Ml(d,c.precedence,i));return u.instance}function Ml(i,u,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,b=g,S=0;S<d.length;S++){var D=d[S];if(D.dataset.precedence===u)b=D;else if(b!==g)break}b?b.parentNode.insertBefore(i,b.nextSibling):(u=c.nodeType===9?c.head:c,u.insertBefore(i,u.firstChild))}function pd(i,u){i.crossOrigin==null&&(i.crossOrigin=u.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=u.referrerPolicy),i.title==null&&(i.title=u.title)}function vd(i,u){i.crossOrigin==null&&(i.crossOrigin=u.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=u.referrerPolicy),i.integrity==null&&(i.integrity=u.integrity)}var kl=null;function M0(i,u,c){if(kl===null){var d=new Map,g=kl=new Map;g.set(c,d)}else g=kl,d=g.get(c),d||(d=new Map,g.set(c,d));if(d.has(i))return d;for(d.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var b=c[g];if(!(b[tu]||b[Yt]||i==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var S=b.getAttribute(u)||"";S=i+S;var D=d.get(S);D?D.push(b):d.set(S,[b])}}return d}function k0(i,u,c){i=i.ownerDocument||i,i.head.insertBefore(c,u==="title"?i.querySelector("head > title"):null)}function XC(i,u,c){if(c===1||u.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;return u.rel==="stylesheet"?(i=u.disabled,typeof u.precedence=="string"&&i==null):!0;case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function I0(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function KC(i,u,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=Co(d.href),b=u.querySelector(zu(g));if(b){u=b._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(i.count++,i=Il.bind(i),u.then(i,i)),c.state.loading|=4,c.instance=b,Vt(b);return}b=u.ownerDocument||u,d=N0(d),(g=ar.get(g))&&pd(d,g),b=b.createElement("link"),Vt(b);var S=b;S._p=new Promise(function(D,U){S.onload=D,S.onerror=U}),$t(b,"link",d),c.instance=b}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,u),(u=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=Il.bind(i),u.addEventListener("load",c),u.addEventListener("error",c))}}var md=0;function YC(i,u){return i.stylesheets&&i.count===0&&Fl(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var d=setTimeout(function(){if(i.stylesheets&&Fl(i,i.stylesheets),i.unsuspend){var b=i.unsuspend;i.unsuspend=null,b()}},6e4+u);0<i.imgBytes&&md===0&&(md=62500*DC());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Fl(i,i.stylesheets),i.unsuspend)){var b=i.unsuspend;i.unsuspend=null,b()}},(i.imgBytes>md?50:800)+u);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function Il(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fl(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Bl=null;function Fl(i,u){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Bl=new Map,u.forEach(QC,i),Bl=null,Il.call(i))}function QC(i,u){if(!(u.state.loading&4)){var c=Bl.get(i);if(c)var d=c.get(null);else{c=new Map,Bl.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var S=g[b];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(c.set(S.dataset.precedence,S),d=S)}d&&c.set(null,d)}g=u.instance,S=g.getAttribute("data-precedence"),b=c.get(S)||d,b===d&&c.set(null,g),c.set(S,g),this.count++,d=Il.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),b?b.parentNode.insertBefore(g,b.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),u.state.loading|=4}}var Pu={$$typeof:R,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function ZC(i,u,c,d,g,b,S,D,U){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ff(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ff(0),this.hiddenUpdates=ff(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function B0(i,u,c,d,g,b,S,D,U,Q,le,he){return i=new ZC(i,u,c,S,U,Q,le,he,D),u=1,b===!0&&(u|=24),b=Bn(3,null,null,u),i.current=b,b.stateNode=i,u=Yf(),u.refCount++,i.pooledCache=u,u.refCount++,b.memoizedState={element:d,isDehydrated:c,cache:u},$f(b),i}function F0(i){return i?(i=eo,i):eo}function L0(i,u,c,d,g,b){g=F0(g),d.context===null?d.context=g:d.pendingContext=g,d=Da(u),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=Na(i,d,u),c!==null&&(Cn(c,i,u),yu(c,i,u))}function z0(i,u){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<u?c:u}}function gd(i,u){z0(i,u),(i=i.alternate)&&z0(i,u)}function U0(i){if(i.tag===13||i.tag===31){var u=li(i,67108864);u!==null&&Cn(u,i,67108864),gd(i,67108864)}}function P0(i){if(i.tag===13||i.tag===31){var u=Pn();u=hf(u);var c=li(i,u);c!==null&&Cn(c,i,u),gd(i,u)}}var Ll=!0;function JC(i,u,c,d){var g=z.T;z.T=null;var b=G.p;try{G.p=2,yd(i,u,c,d)}finally{G.p=b,z.T=g}}function $C(i,u,c,d){var g=z.T;z.T=null;var b=G.p;try{G.p=8,yd(i,u,c,d)}finally{G.p=b,z.T=g}}function yd(i,u,c,d){if(Ll){var g=bd(d);if(g===null)ad(i,u,d,zl,c),V0(i,d);else if(t_(g,i,u,c,d))d.stopPropagation();else if(V0(i,d),u&4&&-1<e_.indexOf(i)){for(;g!==null;){var b=Wi(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var S=ai(b.pendingLanes);if(S!==0){var D=b;for(D.pendingLanes|=2,D.entangledLanes|=2;S;){var U=1<<31-kn(S);D.entanglements[1]|=U,S&=~U}Rr(b),(et&6)===0&&(xl=Dt()+500,Iu(0))}}break;case 31:case 13:D=li(b,2),D!==null&&Cn(D,b,2),El(),gd(b,2)}if(b=bd(d),b===null&&ad(i,u,d,zl,c),b===g)break;g=b}g!==null&&d.stopPropagation()}else ad(i,u,d,null,c)}}function bd(i){return i=wf(i),xd(i)}var zl=null;function xd(i){if(zl=null,i=Vi(i),i!==null){var u=o(i);if(u===null)i=null;else{var c=u.tag;if(c===13){if(i=s(u),i!==null)return i;i=null}else if(c===31){if(i=l(u),i!==null)return i;i=null}else if(c===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;i=null}else u!==i&&(i=null)}}return zl=i,null}function H0(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fr()){case Pi:return 2;case jr:return 8;case hn:case Jo:return 32;case As:return 268435456;default:return 32}default:return 32}}var wd=!1,Ha=null,Va=null,Wa=null,Hu=new Map,Vu=new Map,ja=[],e_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function V0(i,u){switch(i){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Wa=null;break;case"pointerover":case"pointerout":Hu.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vu.delete(u.pointerId)}}function Wu(i,u,c,d,g,b){return i===null||i.nativeEvent!==b?(i={blockedOn:u,domEventName:c,eventSystemFlags:d,nativeEvent:b,targetContainers:[g]},u!==null&&(u=Wi(u),u!==null&&U0(u)),i):(i.eventSystemFlags|=d,u=i.targetContainers,g!==null&&u.indexOf(g)===-1&&u.push(g),i)}function t_(i,u,c,d,g){switch(u){case"focusin":return Ha=Wu(Ha,i,u,c,d,g),!0;case"dragenter":return Va=Wu(Va,i,u,c,d,g),!0;case"mouseover":return Wa=Wu(Wa,i,u,c,d,g),!0;case"pointerover":var b=g.pointerId;return Hu.set(b,Wu(Hu.get(b)||null,i,u,c,d,g)),!0;case"gotpointercapture":return b=g.pointerId,Vu.set(b,Wu(Vu.get(b)||null,i,u,c,d,g)),!0}return!1}function W0(i){var u=Vi(i.target);if(u!==null){var c=o(u);if(c!==null){if(u=c.tag,u===13){if(u=s(c),u!==null){i.blockedOn=u,rm(i.priority,function(){P0(c)});return}}else if(u===31){if(u=l(c),u!==null){i.blockedOn=u,rm(i.priority,function(){P0(c)});return}}else if(u===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ul(i){if(i.blockedOn!==null)return!1;for(var u=i.targetContainers;0<u.length;){var c=bd(i.nativeEvent);if(c===null){c=i.nativeEvent;var d=new c.constructor(c.type,c);xf=d,c.target.dispatchEvent(d),xf=null}else return u=Wi(c),u!==null&&U0(u),i.blockedOn=c,!1;u.shift()}return!0}function j0(i,u,c){Ul(i)&&c.delete(u)}function n_(){wd=!1,Ha!==null&&Ul(Ha)&&(Ha=null),Va!==null&&Ul(Va)&&(Va=null),Wa!==null&&Ul(Wa)&&(Wa=null),Hu.forEach(j0),Vu.forEach(j0)}function Pl(i,u){i.blockedOn===u&&(i.blockedOn=null,wd||(wd=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,n_)))}var Hl=null;function G0(i){Hl!==i&&(Hl=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Hl===i&&(Hl=null);for(var u=0;u<i.length;u+=3){var c=i[u],d=i[u+1],g=i[u+2];if(typeof d!="function"){if(xd(d||c)===null)continue;break}var b=Wi(c);b!==null&&(i.splice(u,3),u-=3,bh(b,{pending:!0,data:g,method:c.method,action:d},d,g))}}))}function So(i){function u(U){return Pl(U,i)}Ha!==null&&Pl(Ha,i),Va!==null&&Pl(Va,i),Wa!==null&&Pl(Wa,i),Hu.forEach(u),Vu.forEach(u);for(var c=0;c<ja.length;c++){var d=ja[c];d.blockedOn===i&&(d.blockedOn=null)}for(;0<ja.length&&(c=ja[0],c.blockedOn===null);)W0(c),c.blockedOn===null&&ja.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var g=c[d],b=c[d+1],S=g[gn]||null;if(typeof b=="function")S||G0(c);else if(S){var D=null;if(b&&b.hasAttribute("formAction")){if(g=b,S=b[gn]||null)D=S.formAction;else if(xd(g)!==null)continue}else D=S.action;typeof D=="function"?c[d+1]=D:(c.splice(d,3),d-=3),G0(c)}}}function q0(){function i(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function u(){g!==null&&(g(),g=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),g!==null&&(g(),g=null)}}}function Ed(i){this._internalRoot=i}Vl.prototype.render=Ed.prototype.render=function(i){var u=this._internalRoot;if(u===null)throw Error(n(409));var c=u.current,d=Pn();L0(c,d,i,u,null,null)},Vl.prototype.unmount=Ed.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var u=i.containerInfo;L0(i.current,2,null,i,null,null),El(),u[Hi]=null}};function Vl(i){this._internalRoot=i}Vl.prototype.unstable_scheduleHydration=function(i){if(i){var u=nm();i={blockedOn:null,target:i,priority:u};for(var c=0;c<ja.length&&u!==0&&u<ja[c].priority;c++);ja.splice(c,0,i),c===0&&W0(i)}};var X0=t.version;if(X0!=="19.2.4")throw Error(n(527,X0,"19.2.4"));G.findDOMNode=function(i){var u=i._reactInternals;if(u===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=h(u),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var r_={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wl.isDisabled&&Wl.supportsFiber)try{Gr=Wl.inject(r_),Kt=Wl}catch{}}return Gu.createRoot=function(i,u){if(!a(i))throw Error(n(299));var c=!1,d="",g=ey,b=ty,S=ny;return u!=null&&(u.unstable_strictMode===!0&&(c=!0),u.identifierPrefix!==void 0&&(d=u.identifierPrefix),u.onUncaughtError!==void 0&&(g=u.onUncaughtError),u.onCaughtError!==void 0&&(b=u.onCaughtError),u.onRecoverableError!==void 0&&(S=u.onRecoverableError)),u=B0(i,1,!1,null,null,c,d,null,g,b,S,q0),i[Hi]=u.current,rd(i),new Ed(u)},Gu.hydrateRoot=function(i,u,c){if(!a(i))throw Error(n(299));var d=!1,g="",b=ey,S=ty,D=ny,U=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.formState!==void 0&&(U=c.formState)),u=B0(i,1,!0,u,c??null,d,g,U,b,S,D,q0),u.context=F0(null),c=u.current,d=Pn(),d=hf(d),g=Da(d),g.callback=null,Na(c,g,d),c=d,u.current.lanes=c,eu(u,c),Rr(u),i[Hi]=u.current,rd(i),new Vl(u)},Gu.version="19.2.4",Gu}var rb;function p_(){if(rb)return Sd.exports;rb=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Sd.exports=d_(),Sd.exports}var v_=p_();var ab="popstate";function m_(r={}){function t(n,a){let{pathname:o,search:s,hash:l}=n.location;return lp("",{pathname:o,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(n,a){return typeof a=="string"?a:ts(a)}return y_(t,e,null,r)}function xt(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Lr(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function g_(){return Math.random().toString(36).substring(2,10)}function ib(r,t){return{usr:r.state,key:r.key,idx:t}}function lp(r,t,e=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?Xo(t):t,state:e,key:t&&t.key||n||g_()}}function ts({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function Xo(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let n=r.indexOf("?");n>=0&&(t.search=r.substring(n),r=r.substring(0,n)),r&&(t.pathname=r)}return t}function y_(r,t,e,n={}){let{window:a=document.defaultView,v5Compat:o=!1}=n,s=a.history,l="POP",f=null,h=p();h==null&&(h=0,s.replaceState({...s.state,idx:h},""));function p(){return(s.state||{idx:null}).idx}function v(){l="POP";let w=p(),C=w==null?null:w-h;h=w,f&&f({action:l,location:E.location,delta:C})}function m(w,C){l="PUSH";let _=lp(E.location,w,C);h=p()+1;let R=ib(_,h),A=E.createHref(_);try{s.pushState(R,"",A)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;a.location.assign(A)}o&&f&&f({action:l,location:E.location,delta:1})}function y(w,C){l="REPLACE";let _=lp(E.location,w,C);h=p();let R=ib(_,h),A=E.createHref(_);s.replaceState(R,"",A),o&&f&&f({action:l,location:E.location,delta:0})}function x(w){return b_(w)}let E={get action(){return l},get location(){return r(a,s)},listen(w){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(ab,v),f=w,()=>{a.removeEventListener(ab,v),f=null}},createHref(w){return t(a,w)},createURL:x,encodeLocation(w){let C=x(w);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:m,replace:y,go(w){return s.go(w)}};return E}function b_(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),xt(e,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:ts(r);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function N1(r,t,e="/"){return x_(r,t,e,!1)}function x_(r,t,e,n){let a=typeof t=="string"?Xo(t):t,o=pa(a.pathname||"/",e);if(o==null)return null;let s=O1(r);w_(s);let l=null;for(let f=0;l==null&&f<s.length;++f){let h=M_(o);l=N_(s[f],h,n)}return l}function O1(r,t=[],e=[],n="",a=!1){let o=(s,l,f=a,h)=>{let p={relativePath:h===void 0?s.path||"":h,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&f)return;xt(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let v=da([n,p.relativePath]),m=e.concat(p);s.children&&s.children.length>0&&(xt(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),O1(s.children,t,m,v,f)),!(s.path==null&&!s.index)&&t.push({path:v,score:T_(v,s.index),routesMeta:m})};return r.forEach((s,l)=>{if(s.path===""||!s.path?.includes("?"))o(s,l);else for(let f of M1(s.path))o(s,l,!0,f)}),t}function M1(r){let t=r.split("/");if(t.length===0)return[];let[e,...n]=t,a=e.endsWith("?"),o=e.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let s=M1(n.join("/")),l=[];return l.push(...s.map(f=>f===""?o:[o,f].join("/"))),a&&l.push(...s),l.map(f=>r.startsWith("/")&&f===""?"/":f)}function w_(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:D_(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var E_=/^:[\w-]+$/,C_=3,__=2,S_=1,R_=10,A_=-2,ob=r=>r==="*";function T_(r,t){let e=r.split("/"),n=e.length;return e.some(ob)&&(n+=A_),t&&(n+=__),e.filter(a=>!ob(a)).reduce((a,o)=>a+(E_.test(o)?C_:o===""?S_:R_),n)}function D_(r,t){return r.length===t.length&&r.slice(0,-1).every((n,a)=>n===t[a])?r[r.length-1]-t[t.length-1]:0}function N_(r,t,e=!1){let{routesMeta:n}=r,a={},o="/",s=[];for(let l=0;l<n.length;++l){let f=n[l],h=l===n.length-1,p=o==="/"?t:t.slice(o.length)||"/",v=dc({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},p),m=f.route;if(!v&&h&&e&&!n[n.length-1].route.index&&(v=dc({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!v)return null;Object.assign(a,v.params),s.push({params:a,pathname:da([o,v.pathname]),pathnameBase:F_(da([o,v.pathnameBase])),route:m}),v.pathnameBase!=="/"&&(o=da([o,v.pathnameBase]))}return s}function dc(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,n]=O_(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let o=a[0],s=o.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((h,{paramName:p,isOptional:v},m)=>{if(p==="*"){let x=l[m]||"";s=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const y=l[m];return v&&!y?h[p]=void 0:h[p]=(y||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:s,pattern:r}}function O_(r,t=!1,e=!0){Lr(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,f)=>(n.push({paramName:l,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function M_(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Lr(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function pa(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=r.charAt(e);return n&&n!=="/"?null:r.slice(e)||"/"}var k_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function I_(r,t="/"){let{pathname:e,search:n="",hash:a=""}=typeof r=="string"?Xo(r):r,o;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?o=ub(e.substring(1),"/"):o=ub(e,t)):o=t,{pathname:o,search:L_(n),hash:z_(a)}}function ub(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function Dd(r,t,e,n){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function B_(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function k1(r){let t=B_(r);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function I1(r,t,e,n=!1){let a;typeof r=="string"?a=Xo(r):(a={...r},xt(!a.pathname||!a.pathname.includes("?"),Dd("?","pathname","search",a)),xt(!a.pathname||!a.pathname.includes("#"),Dd("#","pathname","hash",a)),xt(!a.search||!a.search.includes("#"),Dd("#","search","hash",a)));let o=r===""||a.pathname==="",s=o?"/":a.pathname,l;if(s==null)l=e;else{let v=t.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),v-=1;a.pathname=m.join("/")}l=v>=0?t[v]:"/"}let f=I_(a,l),h=s&&s!=="/"&&s.endsWith("/"),p=(o||s===".")&&e.endsWith("/");return!f.pathname.endsWith("/")&&(h||p)&&(f.pathname+="/"),f}var da=r=>r.join("/").replace(/\/\/+/g,"/"),F_=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),L_=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,z_=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,U_=class{constructor(r,t,e,n=!1){this.status=r,this.statusText=t||"",this.internal=n,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function P_(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function H_(r){return r.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var B1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function F1(r,t){let e=r;if(typeof e!="string"||!k_.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let n=e,a=!1;if(B1)try{let o=new URL(window.location.href),s=e.startsWith("//")?new URL(o.protocol+e):new URL(e),l=pa(s.pathname,t);s.origin===o.origin&&l!=null?e=l+s.search+s.hash:a=!0}catch{Lr(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:a,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var L1=["POST","PUT","PATCH","DELETE"];new Set(L1);var V_=["GET",...L1];new Set(V_);var Ko=$.createContext(null);Ko.displayName="DataRouter";var zc=$.createContext(null);zc.displayName="DataRouterState";var W_=$.createContext(!1),z1=$.createContext({isTransitioning:!1});z1.displayName="ViewTransition";var j_=$.createContext(new Map);j_.displayName="Fetchers";var G_=$.createContext(null);G_.displayName="Await";var sr=$.createContext(null);sr.displayName="Navigation";var ls=$.createContext(null);ls.displayName="Location";var va=$.createContext({outlet:null,matches:[],isDataRoute:!1});va.displayName="Route";var Pp=$.createContext(null);Pp.displayName="RouteError";var U1="REACT_ROUTER_ERROR",q_="REDIRECT",X_="ROUTE_ERROR_RESPONSE";function K_(r){if(r.startsWith(`${U1}:${q_}:{`))try{let t=JSON.parse(r.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function Y_(r){if(r.startsWith(`${U1}:${X_}:{`))try{let t=JSON.parse(r.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new U_(t.status,t.statusText,t.data)}catch{}}function Q_(r,{relative:t}={}){xt(cs(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=$.useContext(sr),{hash:a,pathname:o,search:s}=fs(r,{relative:t}),l=o;return e!=="/"&&(l=o==="/"?e:da([e,o])),n.createHref({pathname:l,search:s,hash:a})}function cs(){return $.useContext(ls)!=null}function Ii(){return xt(cs(),"useLocation() may be used only in the context of a <Router> component."),$.useContext(ls).location}var P1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function H1(r){$.useContext(sr).static||$.useLayoutEffect(r)}function Z_(){let{isDataRoute:r}=$.useContext(va);return r?cS():J_()}function J_(){xt(cs(),"useNavigate() may be used only in the context of a <Router> component.");let r=$.useContext(Ko),{basename:t,navigator:e}=$.useContext(sr),{matches:n}=$.useContext(va),{pathname:a}=Ii(),o=JSON.stringify(k1(n)),s=$.useRef(!1);return H1(()=>{s.current=!0}),$.useCallback((f,h={})=>{if(Lr(s.current,P1),!s.current)return;if(typeof f=="number"){e.go(f);return}let p=I1(f,JSON.parse(o),a,h.relative==="path");r==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:da([t,p.pathname])),(h.replace?e.replace:e.push)(p,h.state,h)},[t,e,o,a,r])}$.createContext(null);function fs(r,{relative:t}={}){let{matches:e}=$.useContext(va),{pathname:n}=Ii(),a=JSON.stringify(k1(e));return $.useMemo(()=>I1(r,JSON.parse(a),n,t==="path"),[r,a,n,t])}function $_(r,t){return V1(r,t)}function V1(r,t,e,n,a){xt(cs(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=$.useContext(sr),{matches:s}=$.useContext(va),l=s[s.length-1],f=l?l.params:{},h=l?l.pathname:"/",p=l?l.pathnameBase:"/",v=l&&l.route;{let _=v&&v.path||"";j1(h,!v||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let m=Ii(),y;if(t){let _=typeof t=="string"?Xo(t):t;xt(p==="/"||_.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${_.pathname}" was given in the \`location\` prop.`),y=_}else y=m;let x=y.pathname||"/",E=x;if(p!=="/"){let _=p.replace(/^\//,"").split("/");E="/"+x.replace(/^\//,"").split("/").slice(_.length).join("/")}let w=N1(r,{pathname:E});Lr(v||w!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Lr(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=aS(w&&w.map(_=>Object.assign({},_,{params:Object.assign({},f,_.params),pathname:da([p,o.encodeLocation?o.encodeLocation(_.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?p:da([p,o.encodeLocation?o.encodeLocation(_.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathnameBase])})),s,e,n,a);return t&&C?$.createElement(ls.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},C):C}function eS(){let r=lS(),t=P_(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",r),s=$.createElement($.Fragment,null,$.createElement("p",null," Hey developer "),$.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",$.createElement("code",{style:o},"ErrorBoundary")," or"," ",$.createElement("code",{style:o},"errorElement")," prop on your route.")),$.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},t),e?$.createElement("pre",{style:a},e):null,s)}var tS=$.createElement(eS,null),W1=class extends $.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.onError?this.props.onError(r,t):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const e=Y_(r.digest);e&&(r=e)}let t=r!==void 0?$.createElement(va.Provider,{value:this.props.routeContext},$.createElement(Pp.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?$.createElement(nS,{error:r},t):t}};W1.contextType=W_;var Nd=new WeakMap;function nS({children:r,error:t}){let{basename:e}=$.useContext(sr);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let n=K_(t.digest);if(n){let a=Nd.get(t);if(a)throw a;let o=F1(n.location,e);if(B1&&!Nd.get(t))if(o.isExternal||n.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const s=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:n.replace}));throw Nd.set(t,s),s}return $.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return r}function rS({routeContext:r,match:t,children:e}){let n=$.useContext(Ko);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),$.createElement(va.Provider,{value:r},e)}function aS(r,t=[],e=null,n=null,a=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let o=r,s=e?.errors;if(s!=null){let p=o.findIndex(v=>v.route.id&&s?.[v.route.id]!==void 0);xt(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),o=o.slice(0,Math.min(o.length,p+1))}let l=!1,f=-1;if(e)for(let p=0;p<o.length;p++){let v=o[p];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=p),v.route.id){let{loaderData:m,errors:y}=e,x=v.route.loader&&!m.hasOwnProperty(v.route.id)&&(!y||y[v.route.id]===void 0);if(v.route.lazy||x){l=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}let h=e&&n?(p,v)=>{n(p,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:H_(e.matches),errorInfo:v})}:void 0;return o.reduceRight((p,v,m)=>{let y,x=!1,E=null,w=null;e&&(y=s&&v.route.id?s[v.route.id]:void 0,E=v.route.errorElement||tS,l&&(f<0&&m===0?(j1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,w=null):f===m&&(x=!0,w=v.route.hydrateFallbackElement||null)));let C=t.concat(o.slice(0,m+1)),_=()=>{let R;return y?R=E:x?R=w:v.route.Component?R=$.createElement(v.route.Component,null):v.route.element?R=v.route.element:R=p,$.createElement(rS,{match:v,routeContext:{outlet:p,matches:C,isDataRoute:e!=null},children:R})};return e&&(v.route.ErrorBoundary||v.route.errorElement||m===0)?$.createElement(W1,{location:e.location,revalidation:e.revalidation,component:E,error:y,children:_(),routeContext:{outlet:null,matches:C,isDataRoute:!0},onError:h}):_()},null)}function Hp(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iS(r){let t=$.useContext(Ko);return xt(t,Hp(r)),t}function oS(r){let t=$.useContext(zc);return xt(t,Hp(r)),t}function uS(r){let t=$.useContext(va);return xt(t,Hp(r)),t}function Vp(r){let t=uS(r),e=t.matches[t.matches.length-1];return xt(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function sS(){return Vp("useRouteId")}function lS(){let r=$.useContext(Pp),t=oS("useRouteError"),e=Vp("useRouteError");return r!==void 0?r:t.errors?.[e]}function cS(){let{router:r}=iS("useNavigate"),t=Vp("useNavigate"),e=$.useRef(!1);return H1(()=>{e.current=!0}),$.useCallback(async(a,o={})=>{Lr(e.current,P1),e.current&&(typeof a=="number"?await r.navigate(a):await r.navigate(a,{fromRouteId:t,...o}))},[r,t])}var sb={};function j1(r,t,e){!t&&!sb[r]&&(sb[r]=!0,Lr(!1,e))}$.memo(fS);function fS({routes:r,future:t,state:e,onError:n}){return V1(r,void 0,e,n,t)}function G1(r){xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function hS({basename:r="/",children:t=null,location:e,navigationType:n="POP",navigator:a,static:o=!1,unstable_useTransitions:s}){xt(!cs(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),f=$.useMemo(()=>({basename:l,navigator:a,static:o,unstable_useTransitions:s,future:{}}),[l,a,o,s]);typeof e=="string"&&(e=Xo(e));let{pathname:h="/",search:p="",hash:v="",state:m=null,key:y="default"}=e,x=$.useMemo(()=>{let E=pa(h,l);return E==null?null:{location:{pathname:E,search:p,hash:v,state:m,key:y},navigationType:n}},[l,h,p,v,m,y,n]);return Lr(x!=null,`<Router basename="${l}"> is not able to match the URL "${h}${p}${v}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:$.createElement(sr.Provider,{value:f},$.createElement(ls.Provider,{children:t,value:x}))}function dS({children:r,location:t}){return $_(cp(r),t)}function cp(r,t=[]){let e=[];return $.Children.forEach(r,(n,a)=>{if(!$.isValidElement(n))return;let o=[...t,a];if(n.type===$.Fragment){e.push.apply(e,cp(n.props.children,o));return}xt(n.type===G1,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=cp(n.props.children,o)),e.push(s)}),e}var oc="get",uc="application/x-www-form-urlencoded";function Uc(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function pS(r){return Uc(r)&&r.tagName.toLowerCase()==="button"}function vS(r){return Uc(r)&&r.tagName.toLowerCase()==="form"}function mS(r){return Uc(r)&&r.tagName.toLowerCase()==="input"}function gS(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function yS(r,t){return r.button===0&&(!t||t==="_self")&&!gS(r)}var jl=null;function bS(){if(jl===null)try{new FormData(document.createElement("form"),0),jl=!1}catch{jl=!0}return jl}var xS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Od(r){return r!=null&&!xS.has(r)?(Lr(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${uc}"`),null):r}function wS(r,t){let e,n,a,o,s;if(vS(r)){let l=r.getAttribute("action");n=l?pa(l,t):null,e=r.getAttribute("method")||oc,a=Od(r.getAttribute("enctype"))||uc,o=new FormData(r)}else if(pS(r)||mS(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=r.getAttribute("formaction")||l.getAttribute("action");if(n=f?pa(f,t):null,e=r.getAttribute("formmethod")||l.getAttribute("method")||oc,a=Od(r.getAttribute("formenctype"))||Od(l.getAttribute("enctype"))||uc,o=new FormData(l,r),!bS()){let{name:h,type:p,value:v}=r;if(p==="image"){let m=h?`${h}.`:"";o.append(`${m}x`,"0"),o.append(`${m}y`,"0")}else h&&o.append(h,v)}}else{if(Uc(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=oc,n=null,a=uc,s=r}return o&&a==="text/plain"&&(s=o,o=void 0),{action:n,method:e.toLowerCase(),encType:a,formData:o,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Wp(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function ES(r,t,e,n){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${n}`:a.pathname=`${a.pathname}.${n}`:a.pathname==="/"?a.pathname=`_root.${n}`:t&&pa(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}async function CS(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _S(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function SS(r,t,e){let n=await Promise.all(r.map(async a=>{let o=t.routes[a.route.id];if(o){let s=await CS(o,e);return s.links?s.links():[]}return[]}));return DS(n.flat(1).filter(_S).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function lb(r,t,e,n,a,o){let s=(f,h)=>e[h]?f.route.id!==e[h].route.id:!0,l=(f,h)=>e[h].pathname!==f.pathname||e[h].route.path?.endsWith("*")&&e[h].params["*"]!==f.params["*"];return o==="assets"?t.filter((f,h)=>s(f,h)||l(f,h)):o==="data"?t.filter((f,h)=>{let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(s(f,h)||l(f,h))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function RS(r,t,{includeHydrateFallback:e}={}){return AS(r.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function AS(r){return[...new Set(r)]}function TS(r){let t={},e=Object.keys(r).sort();for(let n of e)t[n]=r[n];return t}function DS(r,t){let e=new Set;return new Set(t),r.reduce((n,a)=>{let o=JSON.stringify(TS(a));return e.has(o)||(e.add(o),n.push({key:o,link:a})),n},[])}function q1(){let r=$.useContext(Ko);return Wp(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function NS(){let r=$.useContext(zc);return Wp(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var jp=$.createContext(void 0);jp.displayName="FrameworkContext";function X1(){let r=$.useContext(jp);return Wp(r,"You must render this element inside a <HydratedRouter> element"),r}function OS(r,t){let e=$.useContext(jp),[n,a]=$.useState(!1),[o,s]=$.useState(!1),{onFocus:l,onBlur:f,onMouseEnter:h,onMouseLeave:p,onTouchStart:v}=t,m=$.useRef(null);$.useEffect(()=>{if(r==="render"&&s(!0),r==="viewport"){let E=C=>{C.forEach(_=>{s(_.isIntersecting)})},w=new IntersectionObserver(E,{threshold:.5});return m.current&&w.observe(m.current),()=>{w.disconnect()}}},[r]),$.useEffect(()=>{if(n){let E=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(E)}}},[n]);let y=()=>{a(!0)},x=()=>{a(!1),s(!1)};return e?r!=="intent"?[o,m,{}]:[o,m,{onFocus:qu(l,y),onBlur:qu(f,x),onMouseEnter:qu(h,y),onMouseLeave:qu(p,x),onTouchStart:qu(v,y)}]:[!1,m,{}]}function qu(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function MS({page:r,...t}){let{router:e}=q1(),n=$.useMemo(()=>N1(e.routes,r,e.basename),[e.routes,r,e.basename]);return n?$.createElement(IS,{page:r,matches:n,...t}):null}function kS(r){let{manifest:t,routeModules:e}=X1(),[n,a]=$.useState([]);return $.useEffect(()=>{let o=!1;return SS(r,t,e).then(s=>{o||a(s)}),()=>{o=!0}},[r,t,e]),n}function IS({page:r,matches:t,...e}){let n=Ii(),{future:a,manifest:o,routeModules:s}=X1(),{basename:l}=q1(),{loaderData:f,matches:h}=NS(),p=$.useMemo(()=>lb(r,t,h,o,n,"data"),[r,t,h,o,n]),v=$.useMemo(()=>lb(r,t,h,o,n,"assets"),[r,t,h,o,n]),m=$.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let E=new Set,w=!1;if(t.forEach(_=>{let R=o.routes[_.route.id];!R||!R.hasLoader||(!p.some(A=>A.route.id===_.route.id)&&_.route.id in f&&s[_.route.id]?.shouldRevalidate||R.hasClientLoader?w=!0:E.add(_.route.id))}),E.size===0)return[];let C=ES(r,l,a.unstable_trailingSlashAwareDataRequests,"data");return w&&E.size>0&&C.searchParams.set("_routes",t.filter(_=>E.has(_.route.id)).map(_=>_.route.id).join(",")),[C.pathname+C.search]},[l,a.unstable_trailingSlashAwareDataRequests,f,n,o,p,t,r,s]),y=$.useMemo(()=>RS(v,o),[v,o]),x=kS(v);return $.createElement($.Fragment,null,m.map(E=>$.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...e})),y.map(E=>$.createElement("link",{key:E,rel:"modulepreload",href:E,...e})),x.map(({key:E,link:w})=>$.createElement("link",{key:E,nonce:e.nonce,...w,crossOrigin:w.crossOrigin??e.crossOrigin})))}function BS(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var FS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{FS&&(window.__reactRouterVersion="7.13.0")}catch{}function LS({basename:r,children:t,unstable_useTransitions:e,window:n}){let a=$.useRef();a.current==null&&(a.current=m_({window:n,v5Compat:!0}));let o=a.current,[s,l]=$.useState({action:o.action,location:o.location}),f=$.useCallback(h=>{e===!1?l(h):$.startTransition(()=>l(h))},[e]);return $.useLayoutEffect(()=>o.listen(f),[o,f]),$.createElement(hS,{basename:r,children:t,location:s.location,navigationType:s.action,navigator:o,unstable_useTransitions:e})}var K1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Y1=$.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:a,reloadDocument:o,replace:s,state:l,target:f,to:h,preventScrollReset:p,viewTransition:v,unstable_defaultShouldRevalidate:m,...y},x){let{basename:E,unstable_useTransitions:w}=$.useContext(sr),C=typeof h=="string"&&K1.test(h),_=F1(h,E);h=_.to;let R=Q_(h,{relative:a}),[A,T,N]=OS(n,y),M=HS(h,{replace:s,state:l,target:f,preventScrollReset:p,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:m,unstable_useTransitions:w});function I(F){t&&t(F),F.defaultPrevented||M(F)}let k=$.createElement("a",{...y,...N,href:_.absoluteURL||R,onClick:_.isExternal||o?t:I,ref:BS(x,T),target:f,"data-discover":!C&&e==="render"?"true":void 0});return A&&!C?$.createElement($.Fragment,null,k,$.createElement(MS,{page:R})):k});Y1.displayName="Link";var zS=$.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:a=!1,style:o,to:s,viewTransition:l,children:f,...h},p){let v=fs(s,{relative:h.relative}),m=Ii(),y=$.useContext(zc),{navigator:x,basename:E}=$.useContext(sr),w=y!=null&&qS(v)&&l===!0,C=x.encodeLocation?x.encodeLocation(v).pathname:v.pathname,_=m.pathname,R=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;e||(_=_.toLowerCase(),R=R?R.toLowerCase():null,C=C.toLowerCase()),R&&E&&(R=pa(R,E)||R);const A=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let T=_===C||!a&&_.startsWith(C)&&_.charAt(A)==="/",N=R!=null&&(R===C||!a&&R.startsWith(C)&&R.charAt(C.length)==="/"),M={isActive:T,isPending:N,isTransitioning:w},I=T?t:void 0,k;typeof n=="function"?k=n(M):k=[n,T?"active":null,N?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let F=typeof o=="function"?o(M):o;return $.createElement(Y1,{...h,"aria-current":I,className:k,ref:p,style:F,to:s,viewTransition:l},typeof f=="function"?f(M):f)});zS.displayName="NavLink";var US=$.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:a,state:o,method:s=oc,action:l,onSubmit:f,relative:h,preventScrollReset:p,viewTransition:v,unstable_defaultShouldRevalidate:m,...y},x)=>{let{unstable_useTransitions:E}=$.useContext(sr),w=jS(),C=GS(l,{relative:h}),_=s.toLowerCase()==="get"?"get":"post",R=typeof l=="string"&&K1.test(l),A=T=>{if(f&&f(T),T.defaultPrevented)return;T.preventDefault();let N=T.nativeEvent.submitter,M=N?.getAttribute("formmethod")||s,I=()=>w(N||T.currentTarget,{fetcherKey:t,method:M,navigate:e,replace:a,state:o,relative:h,preventScrollReset:p,viewTransition:v,unstable_defaultShouldRevalidate:m});E&&e!==!1?$.startTransition(()=>I()):I()};return $.createElement("form",{ref:x,method:_,action:C,onSubmit:n?f:A,...y,"data-discover":!R&&r==="render"?"true":void 0})});US.displayName="Form";function PS(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Q1(r){let t=$.useContext(Ko);return xt(t,PS(r)),t}function HS(r,{target:t,replace:e,state:n,preventScrollReset:a,relative:o,viewTransition:s,unstable_defaultShouldRevalidate:l,unstable_useTransitions:f}={}){let h=Z_(),p=Ii(),v=fs(r,{relative:o});return $.useCallback(m=>{if(yS(m,t)){m.preventDefault();let y=e!==void 0?e:ts(p)===ts(v),x=()=>h(r,{replace:y,state:n,preventScrollReset:a,relative:o,viewTransition:s,unstable_defaultShouldRevalidate:l});f?$.startTransition(()=>x()):x()}},[p,h,v,e,n,t,r,a,o,s,l,f])}var VS=0,WS=()=>`__${String(++VS)}__`;function jS(){let{router:r}=Q1("useSubmit"),{basename:t}=$.useContext(sr),e=sS(),n=r.fetch,a=r.navigate;return $.useCallback(async(o,s={})=>{let{action:l,method:f,encType:h,formData:p,body:v}=wS(o,t);if(s.navigate===!1){let m=s.fetcherKey||WS();await n(m,e,s.action||l,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:p,body:v,formMethod:s.method||f,formEncType:s.encType||h,flushSync:s.flushSync})}else await a(s.action||l,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:p,body:v,formMethod:s.method||f,formEncType:s.encType||h,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,a,t,e])}function GS(r,{relative:t}={}){let{basename:e}=$.useContext(sr),n=$.useContext(va);xt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),o={...fs(r||".",{relative:t})},s=Ii();if(r==null){o.search=s.search;let l=new URLSearchParams(o.search),f=l.getAll("index");if(f.some(p=>p==="")){l.delete("index"),f.filter(v=>v).forEach(v=>l.append("index",v));let p=l.toString();o.search=p?`?${p}`:""}}return(!r||r===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(o.pathname=o.pathname==="/"?e:da([e,o.pathname])),ts(o)}function qS(r,{relative:t}={}){let e=$.useContext(z1);xt(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Q1("useViewTransitionState"),a=fs(r,{relative:t});if(!e.isTransitioning)return!1;let o=pa(e.currentLocation.pathname,n)||e.currentLocation.pathname,s=pa(e.nextLocation.pathname,n)||e.nextLocation.pathname;return dc(a.pathname,s)!=null||dc(a.pathname,o)!=null}const XS=$.createContext(void 0),KS=({children:r})=>{const[t]=$.useState(!0),e=()=>{},n=()=>{};return ve.jsx(XS.Provider,{value:{isAuthenticated:t,login:e,logout:n},children:r})};class YS{stream=null;async startCamera(t){if(this.stream)return this.stream;try{return this.stream=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"},audio:!1}),t.srcObject=this.stream,this.stream}catch(e){throw console.error("Error accessing camera:",e),e}}stopCamera(){this.stream&&(this.stream.getTracks().forEach(t=>t.stop()),this.stream=null)}isActive(){return!!this.stream&&this.stream.active}}const cb=new YS;var Z1=function(r,t){return(Z1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])})(r,t)};function yr(r,t){function e(){this.constructor=r}Z1(r,t),r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Ee(r,t,e,n){return new(e||(e=Promise))((function(a,o){function s(h){try{f(n.next(h))}catch(p){o(p)}}function l(h){try{f(n.throw(h))}catch(p){o(p)}}function f(h){h.done?a(h.value):new e((function(p){p(h.value)})).then(s,l)}f((n=n.apply(r,[])).next())}))}function Ce(r,t){var e,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(f){return function(h){return(function(p){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&p[0]?n.return:p[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,p[1])).done)return a;switch(n=0,a&&(p=[2&p[0],a.value]),p[0]){case 0:case 1:a=p;break;case 4:return s.label++,{value:p[1],done:!1};case 5:s.label++,n=p[1],p=[0];continue;case 7:p=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){s=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){s.label=p[1];break}if(p[0]===6&&s.label<a[1]){s.label=a[1],a=p;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(p);break}a[2]&&s.ops.pop(),s.trys.pop();continue}p=t.call(r,s)}catch(v){p=[6,v],n=0}finally{e=a=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}})([f,h])}}}var QS=(function(){function r(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return r.prototype.setPlatform=function(t,e){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},r.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},this.urlFlags[t]!=null){var a=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+a+"."),this.set(t,a)}},r.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},r.prototype.getNumber=function(t){return this.get(t)},r.prototype.getBool=function(t){return this.get(t)},r.prototype.getFlags=function(){return this.flags},Object.defineProperty(r.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),r.prototype.set=function(t,e){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)},r.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},r.prototype.setFlags=function(t){this.flags=Object.assign({},t)},r.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},r.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var e,n,a=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(o){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return ZS(n,s[0],s[1]),s.join("=")})),n);"tfjsflags"in a&&a.tfjsflags.split(",").forEach((function(o){var s=o.split(":"),l=s[0],f=s[1];t.urlFlags[l]=(function(h,p){if((p=p.toLowerCase())==="true"||p==="false")return p==="true";if(""+ +p===p)return+p;throw new Error("Could not parse value flag value "+p+" for flag "+h+".")})(l,f)}))}},r})();function ZS(r,t,e){r[decodeURIComponent(t)]=decodeURIComponent(e||"")}function ce(){return J1}var J1=null,pc=new Map,fp=new Map;function $1(r,t){var e=tx(r,t);return pc.get(e)}function JS(r){return fp.get(r)}function fb(r){for(var t=pc.entries(),e=[];;){var n=t.next(),a=n.done,o=n.value;if(a)break;var s=o[0],l=o[1];s.split("_")[0]===r&&e.push(l)}return e}function ex(r){var t=r.kernelName,e=r.backendName,n=tx(t,e);if(pc.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is already registered");pc.set(n,r)}function $S(r){var t=r.kernelName;fp.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),fp.set(t,r)}function tx(r,t){return t+"_"+r}function hp(r,t,e){return Math.max(r,Math.min(t,e))}function nx(r){return r%2==0?r:r+1}function eR(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t}function B(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function rt(r,t,e){e===void 0&&(e=""),B(Gt(r,t),(function(){return e+" Shapes "+r+" and "+t+" must match"}))}function Yo(r){B(r!=null,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Vo(r,t,e){if(t===void 0&&(t=[]),e===void 0&&(e=!1),t==null&&(t=[]),Array.isArray(r)||Ir(r)&&!e)for(var n=0;n<r.length;++n)Vo(r[n],t,e);else t.push(r);return t}function Se(r){if(r.length===0)return 1;for(var t=r[0],e=1;e<r.length;e++)t*=r[e];return t}function Gt(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function At(r){return r%1==0}function tR(r){if(Math.tanh!=null)return Math.tanh(r);if(r===1/0)return 1;if(r===-1/0)return-1;var t=Math.exp(2*r);return(t-1)/(t+1)}function dp(r){var t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function Io(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function hb(r,t,e){return t===void 0&&(t=function(n){return 0}),new Promise((function(n,a){var o=0,s=function(){if(r())n();else{o++;var l=t(o);e!=null&&o>=e?a():setTimeout(s,l)}};s()}))}function nR(r,t){for(var e=1,n=-1,a=0;a<r.length;++a)if(r[a]>=0)e*=r[a];else if(r[a]===-1){if(n!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+n+" and dim "+a);n=a}else if(r[a]<0)throw Error("Shapes can not be < 0. Found "+r[a]+" at dim "+a);if(n===-1){if(t>0&&t!==e)throw Error("Size("+t+") must match the product of shape "+r);return r}if(e===0)throw Error("Cannot infer the missing size in ["+r+"] when there are 0 elements");if(t%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+e);var o=r.slice();return o[n]=t/e,o}function Ht(r,t){var e=t.length;return B((r=r==null?t.map((function(n,a){return a})):[].concat(r)).every((function(n){return n>=-e&&n<e})),(function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+r})),B(r.every((function(n){return At(n)})),(function(){return"All values in axis param must be integers but got axis "+r})),r.map((function(n){return n<0?e+n:n}))}function Si(r,t){for(var e=[],n=[],a=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||a?null:Ht(t,r).sort(),s=0,l=0;l<r.length;++l){if(o!=null){if(o[s]===l&&r[l]!==1)throw new Error("Can't squeeze axis "+l+" since its dim '"+r[l]+"' is not 1");(o[s]==null||o[s]>l)&&r[l]===1&&(e.push(r[l]),n.push(l)),o[s]<=l&&s++}r[l]!==1&&(e.push(r[l]),n.push(l))}return{newShape:e,keptDims:n}}function ns(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else{if(r!=="bool")throw new Error("Unknown data type "+r);e=new Uint8Array(t)}return e}function vc(r,t){var e=null;if(r==null||r==="float32")e=new Float32Array(t);else if(r==="int32")e=new Int32Array(t);else if(r==="bool")e=new Uint8Array(t);else{if(r!=="string")throw new Error("Unknown data type "+r);e=new Array(t)}return e}function rR(r,t){for(var e=0;e<r.length;e++){var n=r[e];if(isNaN(n)||!isFinite(n))throw Error("A tensor of type "+t+" being uploaded contains "+n+".")}}function aR(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function iR(r,t){return t!=="complex64"&&(t!=="float32"||r==="complex64")&&(t!=="int32"||r==="float32"||r==="complex64")&&(t!=="bool"||r!=="bool")}function Ir(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function rx(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error("Unknown dtype "+r)}function oR(r){if(r==null)return 0;var t=0;return r.forEach((function(e){return t+=e.length})),t}function Gp(r){return typeof r=="string"||r instanceof String}function uR(r){return typeof r=="boolean"}function sR(r){return typeof r=="number"}function hs(r){return Array.isArray(r)?hs(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":sR(r)?"float32":Gp(r)?"string":uR(r)?"bool":"float32"}function pp(r){return!!(r&&r.constructor&&r.call&&r.apply)}function vp(r,t){for(var e=t;e<r;++e)if(r%e==0)return e;return r}function Br(r){var t=r.length;if(t<2)return[];var e=new Array(t-1);e[t-2]=r[t-1];for(var n=t-3;n>=0;--n)e[n]=e[n+1]*r[n+1];return e}function ax(r,t,e){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=Vo(r)),e&&rR(r,t),(function(o,s){return o instanceof Float32Array&&s==="float32"||o instanceof Int32Array&&s==="int32"||o instanceof Uint8Array&&s==="bool"})(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){for(var n=new Uint8Array(r.length),a=0;a<n.length;++a)Math.round(r[a])!==0&&(n[a]=1);return n}throw new Error("Unknown data type "+t)}function db(r,t){if(r.length===0)return t[0];var e=r.reduce((function(n,a){return n*a}));if(e===0)return[];if(e!==t.length)throw new Error("["+r+"] does not match the input size.");return(function n(a,o,s){var l=new Array;if(o.length===1)for(var f=o[0],h=0;h<f;h++)l[h]=s[a+h];else{f=o[0];var p=o.slice(1),v=p.reduce((function(m,y){return m*y}));for(h=0;h<f;h++)l[h]=n(a+h*v,p,s)}return l})(0,r,t)}function ix(r,t){for(var e=ds(r,t),n=0;n<e.length;n++)e[n]=1;return e}function ds(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error("Unknown data type "+t)}function Nr(){return ce().platform.now()}function ox(r){r.forEach((function(t){B(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+r+"]."}))}))}function lR(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ce().platform.encode(r,t)}function mc(r,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",ce().platform.decode(r,t)}function pb(r,t,e){if(t===0)return 0;if(t===1)return r[0];for(var n=r[r.length-1],a=0;a<r.length-1;++a)n+=e[a]*r[a];return n}function cR(r,t,e){if(t===0)return[];if(t===1)return[r];for(var n=new Array(t),a=0;a<n.length-1;++a)n[a]=Math.floor(r/e[a]),r-=n[a]*e[a];return n[n.length-1]=r,n}var fR=(function(){function r(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new hR)}return r.prototype.profileKernel=function(t,e,n){var a,o=this,s=this.backendTimer.time((function(){a=n()}));return a.forEach((function(l){l.data().then((function(f){(function(h,p,v){if(p!=="float32")return!1;for(var m=0;m<h.length;m++){var y=h[m];if(isNaN(y)||!isFinite(y))return console.warn("Found "+y+" in the result of '"+v+"'"),!0}})(f,l.dtype,t),s.then((function(h){var p="";h.getExtraProfileInfo!=null&&(p=h.getExtraProfileInfo()),o.logger.logKernelProfile(t,l,f,h.kernelMs,e,p)}))}))})),a},r})(),hR=(function(){function r(){}return r.prototype.logKernelProfile=function(t,e,n,a,o,s){var l=typeof a=="number"?Io(a+"ms",9):a.error,f=Io(t,25),h=e.rank,p=e.size,v=Io(e.shape.toString(),14),m="";for(var y in o){var x=o[y].shape||e.shape,E=x.length;m+=y+": "+E+"D "+(E>0?x:"")+" "}console.log("%c"+f+"	%c"+l+"	%c"+h+"D "+v+"	%c"+p+"	%c"+m+"	%c"+s,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},r})(),vb=20,Xu=3,Md=7;function dR(r,t,e,n){var a=Br(t),o=(function(h,p,v,m){var y=Se(p),x=m[m.length-1],E=new Array(x).fill(0),w=p.length,C=v==="complex64"?Yu(h):h;if(w>1)for(var _=0;_<y/x;_++)for(var R=_*x,A=0;A<x;A++)E[A]=Math.max(E[A],Ku(C[R+A],0,v).length);return E})(r,t,e,a),s=t.length,l=(function h(p,v,m,y,x,E){E===void 0&&(E=!0);var w=m==="complex64"?2:1,C=v[0],_=v.length;if(_===0)return m==="complex64"?[Ku(Yu(p)[0],0,m)]:m==="bool"?[ux(p[0])]:[p[0].toString()];if(_===1){if(C>vb){var R=Xu*w,A=Array.from(p.slice(0,R)),T=Array.from(p.slice((C-Xu)*w,C*w));return m==="complex64"&&(A=Yu(A),T=Yu(T)),["["+A.map((function(ae,z){return Ku(ae,x[z],m)})).join(", ")+", ..., "+T.map((function(ae,z){return Ku(ae,x[C-Xu+z],m)})).join(", ")+"]"]}return["["+(m==="complex64"?Yu(p):Array.from(p)).map((function(ae,z){return Ku(ae,x[z],m)})).join(", ")+"]"]}var N=v.slice(1),M=y.slice(1),I=y[0]*w,k=[];if(C>vb){for(var F=0;F<Xu;F++){var W=(P=F*I)+I;k.push.apply(k,h(p.slice(P,W),N,m,M,x,!1))}for(k.push("..."),F=C-Xu;F<C;F++)W=(P=F*I)+I,k.push.apply(k,h(p.slice(P,W),N,m,M,x,F===C-1))}else for(F=0;F<C;F++){var P;W=(P=F*I)+I,k.push.apply(k,h(p.slice(P,W),N,m,M,x,F===C-1))}var oe=_===2?",":"";for(k[0]="["+k[0]+oe,F=1;F<k.length-1;F++)k[F]=" "+k[F]+oe;var ee=`,
`;for(F=2;F<_;F++)ee+=`
`;return k[k.length-1]=" "+k[k.length-1]+"]"+(E?"":ee),k})(r,t,e,a,o),f=["Tensor"];return n&&(f.push("  dtype: "+e),f.push("  rank: "+s),f.push("  shape: ["+t+"]"),f.push("  values:")),f.push(l.map((function(h){return"    "+h})).join(`
`)),f.join(`
`)}function Ku(r,t,e){return Io(Array.isArray(r)?parseFloat(r[0].toFixed(Md))+" + "+parseFloat(r[1].toFixed(Md))+"j":Gp(r)?"'"+r+"'":e==="bool"?ux(r):parseFloat(r.toFixed(Md)).toString(),t)}function ux(r){return r===0?"false":"true"}function Yu(r){for(var t=[],e=0;e<r.length;e+=2)t.push([r[e],r[e+1]]);return t}var rs=(function(){function r(t,e,n){var a=this;if(this.dtype=e,this.shape=t.slice(),this.size=Se(t),n!=null){var o=n.length;B(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+a.size+"'."}))}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||vc(e,this.size),this.strides=Br(t)}return r.prototype.set=function(t){for(var e=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];n.length===0&&(n=[0]),B(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var o=this.locToIndex(n);this.values[o]=t},r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.length===0&&(t=[0]);for(var n=0,a=0,o=t;a<o.length;a++){var s=o[a];if(s<0||s>=this.shape[n]){var l="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(l)}n++}for(var f=t[t.length-1],h=0;h<t.length-1;++h)f+=this.strides[h]*t[h];return this.values[f]},r.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},r.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.toTensor=function(){return Or().makeTensor(this.values,this.shape,this.dtype)},r})(),Or=null,re=null,sx=null,yt=(function(){function r(t,e,n,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Se(t),this.strides=Br(t),this.dataId=n,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return r.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},r.prototype.asScalar=function(){return this.throwIfDisposed(),B(this.size===1,(function(){return"The array must have only 1 element."})),this.reshape([])},r.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},r.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},r.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},r.prototype.as4D=function(t,e,n,a){return this.throwIfDisposed(),this.reshape([t,e,n,a])},r.prototype.as5D=function(t,e,n,a,o){return this.throwIfDisposed(),this.reshape([t,e,n,a,o])},r.prototype.asType=function(t){return this.throwIfDisposed(),re.cast(this,t)},Object.defineProperty(r.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),r.prototype.buffer=function(){return Ee(this,void 0,void 0,(function(){var t;return Ce(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,re.buffer(this.shape,this.dtype,t)]}}))}))},r.prototype.bufferSync=function(){return re.buffer(this.shape,this.dtype,this.dataSync())},r.prototype.array=function(){return Ee(this,void 0,void 0,(function(){var t;return Ce(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,db(this.shape,t)]}}))}))},r.prototype.arraySync=function(){return db(this.shape,this.dataSync())},r.prototype.data=function(){return Ee(this,void 0,void 0,(function(){var t,e;return Ce(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=Or().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(a){return mc(a)}))]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},r.prototype.dataSync=function(){this.throwIfDisposed();var t=Or().readSync(this.dataId);if(this.dtype==="string")try{return t.map((function(e){return mc(e)}))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},r.prototype.bytes=function(){return Ee(this,void 0,void 0,(function(){var t;return Ce(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Or().read(this.dataId)];case 1:return t=e.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},r.prototype.dispose=function(){this.isDisposed||(Or().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(r.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),r.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},r.prototype.toFloat=function(){return this.asType("float32")},r.prototype.toInt=function(){return this.asType("int32")},r.prototype.toBool=function(){return this.asType("bool")},r.prototype.print=function(t){return t===void 0&&(t=!1),re.print(this,t)},r.prototype.reshape=function(t){return this.throwIfDisposed(),re.reshape(this,t)},r.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},r.prototype.expandDims=function(t){return t===void 0&&(t=0),re.expandDims(this,t)},r.prototype.cumsum=function(t,e,n){return t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1),re.cumsum(this,t,e,n)},r.prototype.squeeze=function(t){return this.throwIfDisposed(),re.squeeze(this,t)},r.prototype.clone=function(){return this.throwIfDisposed(),re.clone(this)},r.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),re.oneHot(this,t,e,n)},r.prototype.toString=function(t){return t===void 0&&(t=!1),dR(this.dataSync(),this.shape,this.dtype,t)},r.prototype.tile=function(t){return this.throwIfDisposed(),re.tile(this,t)},r.prototype.gather=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),re.gather(this,t,e)},r.prototype.matMul=function(t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!1),this.throwIfDisposed(),re.matMul(this,t,e,n)},r.prototype.dot=function(t){return this.throwIfDisposed(),re.dot(this,t)},r.prototype.norm=function(t,e,n){return t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1),this.throwIfDisposed(),re.norm(this,t,e,n)},r.prototype.slice=function(t,e){return this.throwIfDisposed(),re.slice(this,t,e)},r.prototype.reverse=function(t){return this.throwIfDisposed(),re.reverse(this,t)},r.prototype.concat=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),t instanceof r&&(t=[t]),re.concat([this].concat(t),e)},r.prototype.split=function(t,e){return e===void 0&&(e=0),this.throwIfDisposed(),re.split(this,t,e)},r.prototype.stack=function(t,e){return e===void 0&&(e=0),re.stack([this,t],e)},r.prototype.unstack=function(t){return t===void 0&&(t=0),re.unstack(this,t)},r.prototype.pad=function(t,e){return e===void 0&&(e=0),re.pad(this,t,e)},r.prototype.batchNormalization=function(t,e,n,a,o){return n===void 0&&(n=.001),sx("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,o,a,n)},r.prototype.batchNorm=function(t,e,n,a,o){return o===void 0&&(o=.001),this.throwIfDisposed(),re.batchNorm(this,t,e,n,a,o)},r.prototype.all=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.all(this,t,e)},r.prototype.any=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.any(this,t,e)},r.prototype.logSumExp=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.logSumExp(this,t,e)},r.prototype.sum=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.sum(this,t,e)},r.prototype.prod=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.prod(this,t,e)},r.prototype.mean=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.mean(this,t,e)},r.prototype.min=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.min(this,t,e)},r.prototype.max=function(t,e){return t===void 0&&(t=null),e===void 0&&(e=!1),this.throwIfDisposed(),re.max(this,t,e)},r.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),re.argMin(this,t)},r.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),re.argMax(this,t)},r.prototype.cast=function(t){return this.throwIfDisposed(),re.cast(this,t)},r.prototype.add=function(t){return this.throwIfDisposed(),re.add(this,t)},r.prototype.addStrict=function(t){return this.throwIfDisposed(),re.addStrict(this,t)},r.prototype.atan2=function(t){return this.throwIfDisposed(),re.atan2(this,t)},r.prototype.sub=function(t){return this.throwIfDisposed(),re.sub(this,t)},r.prototype.subStrict=function(t){return this.throwIfDisposed(),re.subStrict(this,t)},r.prototype.pow=function(t){return this.throwIfDisposed(),re.pow(this,t)},r.prototype.powStrict=function(t){return this.throwIfDisposed(),re.powStrict(this,t)},r.prototype.mul=function(t){return this.throwIfDisposed(),re.mul(this,t)},r.prototype.mulStrict=function(t){return this.throwIfDisposed(),re.mulStrict(this,t)},r.prototype.div=function(t){return this.throwIfDisposed(),re.div(this,t)},r.prototype.divNoNan=function(t){return this.throwIfDisposed(),re.divNoNan(this,t)},r.prototype.floorDiv=function(t){return this.throwIfDisposed(),re.floorDiv(this,t)},r.prototype.divStrict=function(t){return this.throwIfDisposed(),re.divStrict(this,t)},r.prototype.minimum=function(t){return this.throwIfDisposed(),re.minimum(this,t)},r.prototype.minimumStrict=function(t){return this.throwIfDisposed(),re.minimumStrict(this,t)},r.prototype.maximum=function(t){return this.throwIfDisposed(),re.maximum(this,t)},r.prototype.maximumStrict=function(t){return this.throwIfDisposed(),re.maximumStrict(this,t)},r.prototype.mod=function(t){return this.throwIfDisposed(),re.mod(this,t)},r.prototype.modStrict=function(t){return this.throwIfDisposed(),re.modStrict(this,t)},r.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),re.squaredDifferenceStrict(this,t)},r.prototype.transpose=function(t){return this.throwIfDisposed(),re.transpose(this,t)},r.prototype.notEqual=function(t){return this.throwIfDisposed(),re.notEqual(this,t)},r.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),re.notEqualStrict(this,t)},r.prototype.less=function(t){return this.throwIfDisposed(),re.less(this,t)},r.prototype.lessStrict=function(t){return this.throwIfDisposed(),re.lessStrict(this,t)},r.prototype.equal=function(t){return this.throwIfDisposed(),re.equal(this,t)},r.prototype.equalStrict=function(t){return this.throwIfDisposed(),re.equalStrict(this,t)},r.prototype.lessEqual=function(t){return this.throwIfDisposed(),re.lessEqual(this,t)},r.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),re.lessEqualStrict(this,t)},r.prototype.greater=function(t){return this.throwIfDisposed(),re.greater(this,t)},r.prototype.greaterStrict=function(t){return this.throwIfDisposed(),re.greaterStrict(this,t)},r.prototype.greaterEqual=function(t){return this.throwIfDisposed(),re.greaterEqual(this,t)},r.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),re.greaterEqualStrict(this,t)},r.prototype.logicalAnd=function(t){return this.throwIfDisposed(),re.logicalAnd(this,t)},r.prototype.logicalOr=function(t){return this.throwIfDisposed(),re.logicalOr(this,t)},r.prototype.logicalNot=function(){return this.throwIfDisposed(),re.logicalNot(this)},r.prototype.logicalXor=function(t){return this.throwIfDisposed(),re.logicalXor(this,t)},r.prototype.where=function(t,e){return this.throwIfDisposed(),re.where(t,this,e)},r.prototype.neg=function(){return this.throwIfDisposed(),re.neg(this)},r.prototype.ceil=function(){return this.throwIfDisposed(),re.ceil(this)},r.prototype.floor=function(){return this.throwIfDisposed(),re.floor(this)},r.prototype.sign=function(){return this.throwIfDisposed(),re.sign(this)},r.prototype.isNaN=function(){return this.throwIfDisposed(),re.isNaN(this)},r.prototype.isInf=function(){return this.throwIfDisposed(),re.isInf(this)},r.prototype.isFinite=function(){return this.throwIfDisposed(),re.isFinite(this)},r.prototype.exp=function(){return this.throwIfDisposed(),re.exp(this)},r.prototype.expm1=function(){return this.throwIfDisposed(),re.expm1(this)},r.prototype.log=function(){return this.throwIfDisposed(),re.log(this)},r.prototype.log1p=function(){return this.throwIfDisposed(),re.log1p(this)},r.prototype.sqrt=function(){return this.throwIfDisposed(),re.sqrt(this)},r.prototype.rsqrt=function(){return this.throwIfDisposed(),re.rsqrt(this)},r.prototype.square=function(){return this.throwIfDisposed(),re.square(this)},r.prototype.reciprocal=function(){return this.throwIfDisposed(),re.reciprocal(this)},r.prototype.abs=function(){return this.throwIfDisposed(),re.abs(this)},r.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),re.clipByValue(this,t,e)},r.prototype.relu=function(){return this.throwIfDisposed(),re.relu(this)},r.prototype.relu6=function(){return this.throwIfDisposed(),re.relu6(this)},r.prototype.elu=function(){return this.throwIfDisposed(),re.elu(this)},r.prototype.selu=function(){return this.throwIfDisposed(),re.selu(this)},r.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),re.leakyRelu(this,t)},r.prototype.prelu=function(t){return this.throwIfDisposed(),re.prelu(this,t)},r.prototype.sigmoid=function(){return this.throwIfDisposed(),re.sigmoid(this)},r.prototype.logSigmoid=function(){return this.throwIfDisposed(),re.logSigmoid(this)},r.prototype.softplus=function(){return this.throwIfDisposed(),re.softplus(this)},r.prototype.zerosLike=function(){return this.throwIfDisposed(),re.zerosLike(this)},r.prototype.onesLike=function(){return this.throwIfDisposed(),re.onesLike(this)},r.prototype.sin=function(){return this.throwIfDisposed(),re.sin(this)},r.prototype.cos=function(){return this.throwIfDisposed(),re.cos(this)},r.prototype.tan=function(){return this.throwIfDisposed(),re.tan(this)},r.prototype.asin=function(){return this.throwIfDisposed(),re.asin(this)},r.prototype.acos=function(){return this.throwIfDisposed(),re.acos(this)},r.prototype.atan=function(){return this.throwIfDisposed(),re.atan(this)},r.prototype.sinh=function(){return this.throwIfDisposed(),re.sinh(this)},r.prototype.cosh=function(){return this.throwIfDisposed(),re.cosh(this)},r.prototype.tanh=function(){return this.throwIfDisposed(),re.tanh(this)},r.prototype.asinh=function(){return this.throwIfDisposed(),re.asinh(this)},r.prototype.acosh=function(){return this.throwIfDisposed(),re.acosh(this)},r.prototype.atanh=function(){return this.throwIfDisposed(),re.atanh(this)},r.prototype.erf=function(){return this.throwIfDisposed(),re.erf(this)},r.prototype.round=function(){return this.throwIfDisposed(),re.round(this)},r.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),re.step(this,t)},r.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),re.softmax(this,t)},r.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),re.logSoftmax(this,t)},r.prototype.resizeBilinear=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),re.image.resizeBilinear(this,t,e)},r.prototype.resizeNearestNeighbor=function(t,e){return e===void 0&&(e=!1),this.throwIfDisposed(),re.image.resizeNearestNeighbor(this,t,e)},r.prototype.conv1d=function(t,e,n,a,o,s){return a===void 0&&(a="NWC"),o===void 0&&(o=1),this.throwIfDisposed(),re.conv1d(this,t,e,n,a,o,s)},r.prototype.conv2d=function(t,e,n,a,o,s){return a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),re.conv2d(this,t,e,n,a,o,s)},r.prototype.conv2dTranspose=function(t,e,n,a,o){return this.throwIfDisposed(),re.conv2dTranspose(this,t,e,n,a,o)},r.prototype.depthwiseConv2D=function(t,e,n,a,o,s){return a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]),this.throwIfDisposed(),re.depthwiseConv2d(this,t,e,n,a,o,s)},r.prototype.separableConv2d=function(t,e,n,a,o,s){return o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC"),this.throwIfDisposed(),re.separableConv2d(this,t,e,n,a,o,s)},r.prototype.avgPool=function(t,e,n,a){return this.throwIfDisposed(),re.avgPool(this,t,e,n,a)},r.prototype.maxPool=function(t,e,n,a){return this.throwIfDisposed(),re.maxPool(this,t,e,n,a)},r.prototype.localResponseNormalization=function(t,e,n,a){return t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5),re.localResponseNormalization(this,t,e,n,a)},r.prototype.pool=function(t,e,n,a,o){return this.throwIfDisposed(),re.pool(this,t,e,n,a,o)},r.prototype.variable=function(t,e,n){return t===void 0&&(t=!0),this.throwIfDisposed(),Or().makeVariable(this,t,e,n)},r.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),re.unsortedSegmentSum(this,t,e)},r.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),re.batchToSpaceND(this,t,e)},r.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),re.spaceToBatchND(this,t,e)},r.prototype.topk=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!0),this.throwIfDisposed(),re.topk(this,t,e)},r.prototype.stridedSlice=function(t,e,n,a,o,s,l,f){return a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=0),f===void 0&&(f=0),this.throwIfDisposed(),re.stridedSlice(this,t,e,n,a,o,s,l,f)},r.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),re.depthToSpace(this,t,e)},r.prototype.fft=function(){return this.throwIfDisposed(),re.spectral.fft(this)},r.prototype.ifft=function(){return this.throwIfDisposed(),re.spectral.ifft(this)},r.prototype.rfft=function(){return this.throwIfDisposed(),re.spectral.rfft(this)},r.prototype.irfft=function(){return this.throwIfDisposed(),re.spectral.irfft(this)},r})();Object.defineProperty(yt,Symbol.hasInstance,{value:function(r){return!!r&&r.dataId!=null&&r.shape!=null&&r.dtype!=null}});var mb,mp,gp,yp,bp,Wo=(function(r){function t(e,n,a,o){var s=r.call(this,e.shape,e.dtype,e.dataId,o)||this;return s.trainable=n,s.name=a,s}return yr(t,r),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!Gt(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Or().disposeTensor(this),this.dataId=e.dataId,Or().incRef(this,null)},t.prototype.dispose=function(){Or().disposeVariable(this),this.isDisposedInternal=!0},t})(yt);Object.defineProperty(Wo,Symbol.hasInstance,{value:function(r){return r instanceof yt&&r.assign!=null&&r.assign instanceof Function}}),(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(mb||(mb={})),(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(mp||(mp={})),(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(gp||(gp={})),(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(yp||(yp={})),(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(bp||(bp={}));var pR={float32:yp,int32:mp,bool:gp,complex64:bp};function tn(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error("Can not upcast "+r+" with "+t)}return pR[r][t]}function kd(r){return tn(r,"int32")}function wt(r,t){if(r.dtype===t.dtype)return[r,t];var e=tn(r.dtype,t.dtype);return[r.cast(e),t.cast(e)]}function vR(r,t){B(r.dtype===t.dtype,(function(){return"The dtypes of the first("+r.dtype+") and second("+t.dtype+") input must match"}))}function lx(r){var t=[];return(function e(n,a,o){if(n!=null){if(n instanceof yt)return void a.push(n);if(s=n,!(!Array.isArray(s)&&typeof s!="object")){var s,l=n;for(var f in l){var h=l[f];o.has(h)||(o.add(h),e(h,a,o))}}}})(r,t,new Set),t}var Id,gb=(function(){function r(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return r.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},r})(),mR=(function(){function r(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new gb}return r.prototype.ready=function(){return Ee(this,void 0,void 0,(function(){var t,e,n;return Ce(this,(function(a){switch(a.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then((function(){}))];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),e=0,a.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return a.sent()?[4,this.setBackend(n)]:[3,4];case 3:return a.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(r.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),r.prototype.backendNames=function(){return Object.keys(this.registryFactory)},r.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},r.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},r.prototype.registerBackend=function(t,e,n){return n===void 0&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},r.prototype.setBackend=function(t){return Ee(this,void 0,void 0,(function(){var e,n,a;return Ce(this,(function(o){switch(o.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return a=o.sent(),[3,3];case 2:a=n,o.label=3;case 3:if(!a)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new fR(this.backendInstance),[2,!0]}}))}))},r.prototype.setupRegisteredKernels=function(){var t=this;fb(this.backendName).forEach((function(e){e.setupFunc!=null&&e.setupFunc(t.backendInstance)}))},r.prototype.disposeRegisteredKernels=function(t){var e=this;fb(t).forEach((function(n){n.disposeFunc!=null&&n.disposeFunc(e.registry[t])}))},r.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(n==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var a=n.factory();if(Promise.resolve(a)===a){var o=++this.pendingBackendInitId,s=a.then((function(l){return!(o<e.pendingBackendInitId)&&(e.registry[t]=l,e.pendingBackendInit=null,!0)})).catch((function(l){return!(o<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),!1)}));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}return this.registry[t]=a,{success:!0,asyncInit:!1}}catch(l){return console.warn("Initialization of backend "+t+" failed"),console.warn(l.stack||l.message),{success:!1,asyncInit:!1}}},r.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},r.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},r.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],a=this.initializeBackend(n),o=a.success,s=a.asyncInit;if(s||o)return{name:n,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")},r.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),a=n.backend,o=this.readSync(e);a.disposeData(e),n.backend=t,t.move(e,o,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},r.prototype.tidy=function(t,e){var n,a=this,o=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=t}return this.scopedRun((function(){return a.startScope(o)}),(function(){return a.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},r.prototype.scopedRun=function(t,e,n){t();try{var a=n();return e(),a}catch(o){throw e(),o}},r.prototype.nextTensorId=function(){return r.nextTensorId++},r.prototype.nextVariableId=function(){return r.nextVariableId++},r.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(a){return{x:function(){return a.toFloat()}}}),[]),e},r.prototype.runKernel=function(t,e,n,a,o){return this.runKernelFunc(null,e,null,t,n,a,o)},r.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},r.prototype.checkKernelForMemLeak=function(t,e,n){var a=this.backend.numDataIds(),o=0;n.forEach((function(f){o+=f.dtype==="complex64"?3:1}));var s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=a-e-o-s;if(l>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+l+" data ids) after running '"+t+"'")},r.prototype.runKernelFunc=function(t,e,n,a,o,s,l){var f,h=this;s===void 0&&(s=[]),l===void 0&&(l=[]);var p=[],v=this.isTapeOn();a==null&&(a=this.state.activeScope!=null?this.state.activeScope.name:"");var m,y=function(_){v&&(p=_.map((function(R){return h.keep(h.clone(R))})))},x=this.state.numBytes,E=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var w,C=$1(a,this.backendName);return m=C!=null?function(){var _=h.backend.numDataIds();w=C.kernelFunc({inputs:e,attrs:o,backend:h.backend});var R=Array.isArray(w)?w:[w];h.shouldCheckForMemLeaks()&&h.checkKernelForMemLeak(a,_,R);var A=R.map((function(N){var M=N.dataId,I=N.shape,k=N.dtype;return h.makeTensorFromDataId(M,I,k)})),T=A.filter((function(N,M){return l[M]}));return y((s||[]).slice().concat(T)),A}:function(){var _=h.backend.numDataIds();w=h.tidy((function(){return t(h.backend,y)}));var R=Array.isArray(w)?w:[w];return h.shouldCheckForMemLeaks()&&h.checkKernelForMemLeak(a,_,R),R},this.scopedRun((function(){return h.state.kernelDepth++}),(function(){return h.state.kernelDepth--}),(function(){f=h.ENV.getBool("DEBUG")?h.profiler.profileKernel(a,e,(function(){return m()})):m()})),v&&this.addTapeNode(a,e,f,n,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:a,bytesAdded:this.state.numBytes-x,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-E,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(_){return e[_].shape})),outputShapes:f.map((function(_){return _.shape}))}),Array.isArray(w)?f:f[0]},r.prototype.makeTensor=function(t,e,n,a){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",a=a||this.backend;var o=t;n==="string"&&Gp(t[0])&&(o=t.map((function(p){return lR(p)})));var s=a.write(o,e,n),l=new yt(e,n,s,this.nextTensorId());if(this.incRef(l,a),n==="string"){var f=this.state.tensorInfo.get(s),h=oR(o);this.state.numBytes+=h-f.bytes,f.bytes=h}return l},r.prototype.makeTensorFromDataId=function(t,e,n,a){var o=new yt(e,n=n||"float32",t,this.nextTensorId());return this.incRef(o,a),o},r.prototype.makeVariable=function(t,e,n,a){e===void 0&&(e=!0),n=n||this.nextVariableId().toString(),a!=null&&a!==t.dtype&&(t=t.asType(a));var o=new Wo(t,e,n,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},r.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,n===0){this.state.numDataBuffers++;var a=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(a=t.size*rx(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:a,refCount:0}),this.state.numBytes+=a}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Wo||this.track(t)},r.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},r.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},r.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},r.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},r.prototype.profile=function(t){return Ee(this,void 0,void 0,(function(){var e,n;return Ce(this,(function(a){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(o){return o.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},r.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},r.prototype.addTapeNode=function(t,e,n,a,o){var s=this,l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:o},f=JS(t);f!=null&&(a=f.gradFunc),a!=null&&(l.gradient=function(h){return h=h.map((function(p,v){if(p==null){var m=n[v],y=ds(m.size,m.dtype);return s.makeTensor(y,m.shape,m.dtype)}return p})),a(h.length>1?h:h[0],o)}),this.state.activeTape.push(l)},r.prototype.keep=function(t){return t.kept=!0,t},r.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},r.prototype.endTape=function(){this.state.gradientDepth--},r.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},r.prototype.endScope=function(t){for(var e=this,n=lx(t),a=new Set(n.map((function(f){return f.id}))),o=0;o<this.state.activeScope.track.length;o++){var s=this.state.activeScope.track[o];s.kept||a.has(s.id)||s.dispose()}var l=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(f){f.kept||f.scopeId!==l.id||e.track(f)}))},r.prototype.gradients=function(t,e,n,a){var o=this;if(a===void 0&&(a=!1),B(e.length>0,(function(){return"gradients() received an empty list of xs."})),n!=null&&n.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var s=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",t)}));B(s instanceof yt,(function(){return"The result y returned by f() must be a tensor."}));var l=(function(f,h,p){for(var v={},m={},y=0;y<h.length;y++)v[h[y].id]=!0;for(y=0;y<f.length;y++){var x=(N=f[y]).inputs;for(var E in x){for(var w=x[E],C=!1,_=0;_<h.length;_++)if(v[w.id]){N.outputs.forEach((function(F){return v[F.id]=!0})),C=!0,m[N.id]=!0;break}if(C)break}}var R={};R[p.id]=!0;var A={};for(y=f.length-1;y>=0;y--)for(x=(N=f[y]).inputs,_=0;_<N.outputs.length;_++)if(R[N.outputs[_].id]){for(var E in x)R[x[E].id]=!0,A[N.id]=!0;break}var T=[];for(y=0;y<f.length;y++){var N;if(m[(N=f[y]).id]&&A[N.id]){var M={};for(var E in N.inputs){var I=N.inputs[E];v[I.id]&&(M[E]=I)}var k=Object.assign({},N);k.inputs=M,k.outputs=N.outputs,T.push(k)}}return T})(this.state.activeTape,e,s);if(!a&&l.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var f,h,p={};p[s.id]=n??(f=s.shape,h=ix(Se(f),"float32"),j.makeTensor(h,f,"float32")),(function(m,y,x){for(var E=function(C){var _=y[C],R=[];if(_.outputs.forEach((function(M){var I=m[M.id];I!=null?R.push(I):R.push(null)})),_.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+_.kernelName+".");var A=_.gradient(R),T=function(M){if(!(M in A))throw new Error("Cannot backprop through input "+M+". Available gradients found: "+Object.keys(A)+".");var I=x((function(){return A[M]()}));if(I.dtype!=="float32")throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input "+M+" must have 'float32' dtype, but has '"+I.dtype+"'");var k=_.inputs[M];if(!Gt(I.shape,k.shape))throw new Error("Error in gradient for op "+_.kernelName+". The gradient of input '"+M+"' has shape '"+I.shape+"', which does not match the shape of the input '"+k.shape+"'");if(m[k.id]==null)m[k.id]=I;else{var F=m[k.id];m[k.id]=F.add(I),F.dispose()}};for(var N in _.inputs)T(N)},w=y.length-1;w>=0;w--)E(w)})(p,l,(function(m){return o.tidy(m)}));var v=e.map((function(m){return p[m.id]}));return o.state.gradientDepth===0&&(o.state.activeTape.forEach((function(m){for(var y=0,x=m.saved;y<x.length;y++)x[y].dispose()})),o.state.activeTape=null),{value:s,grads:v}}))},r.prototype.customGrad=function(t){var e=this;return B(pp(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];B(a.every((function(l){return l instanceof yt})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var s={};return a.forEach((function(l,f){s[f]=l})),e.runKernelFunc((function(l,f){return B((n=t.apply(void 0,a.concat([f]))).value instanceof yt,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),B(pp(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),s,(function(l,f){var h=n.gradFunc(l,f),p=Array.isArray(h)?h:[h];B(p.length===a.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),B(p.every((function(m){return m instanceof yt})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var v={};return p.forEach((function(m,y){v[y]=function(){return m}})),v}))}},r.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},r.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},r.prototype.time=function(t){return Ee(this,void 0,void 0,(function(){var e,n;return Ce(this,(function(a){switch(a.label){case 0:return e=Nr(),[4,this.backend.time(t)];case 1:return(n=a.sent()).wallMs=Nr()-e,[2,n]}}))}))},r.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(r.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),r.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new gb,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},r.nextTensorId=0,r.nextVariableId=0,r})(),j=(function(){var r=(function(){if(Id==null){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}Id=e}return Id})();if(r._tfengine==null){var t=new QS(r);r._tfengine=new mR(t)}return(function(e){J1=e})(r._tfengine.ENV),Or=function(){return r._tfengine},r._tfengine})();function cx(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var ca=ce();ca.registerFlag("DEBUG",(function(){return!1}),(function(r){r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),ca.registerFlag("IS_BROWSER",(function(){return cx()})),ca.registerFlag("IS_NODE",(function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0})),ca.registerFlag("IS_CHROME",(function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),ca.registerFlag("PROD",(function(){return!1})),ca.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return ca.getBool("DEBUG")})),ca.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),ca.registerFlag("IS_TEST",(function(){return!1}));var as,Wn,Vn,Ci={},Bd={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function gR(r,t){Ci[r]=t}function Ur(r){r in Ci||(Ci[r]=(function(e){if(e!==1&&e!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=(function(a){if(typeof OffscreenCanvas<"u"&&a===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")})(e);return n.addEventListener("webglcontextlost",(function(a){a.preventDefault(),delete Ci[e]}),!1),e===1?n.getContext("webgl",Bd)||n.getContext("experimental-webgl",Bd):n.getContext("webgl2",Bd)})(r));var t=Ci[r];return t.isContextLost()?(delete Ci[r],Ur(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Ci[r])}function Pc(r,t){return[t,r]}function Ju(r){var t=Se(r);return dp(Math.ceil(t/4))}function ps(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function qp(r,t){var e,n,a,o,s,l,f,h,p,v=r;return ce().getNumber("WEBGL_VERSION")===2?(e=v.R32F,n=v.R16F,a=v.RGBA16F,o=v.RGBA32F,s=v.RED,l=4,f=1,h=v.HALF_FLOAT,p=v.FLOAT):(e=r.RGBA,n=r.RGBA,a=r.RGBA,o=v.RGBA,s=r.RGBA,l=4,f=4,h=t!=null?t.HALF_FLOAT_OES:null,p=r.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:n,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:r.RGBA,downloadUnpackNumChannels:l,defaultNumChannels:f,textureTypeHalfFloat:h,textureTypeFloat:p}}function Re(r,t,e){var n=e();return t&&(function(a){var o=a.getError();if(o!==a.NO_ERROR)throw new Error("WebGL Error: "+wR(a,o))})(r),n}(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(as||(as={})),(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(Wn||(Wn={})),(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Vn||(Vn={}));var yR=596e-10,bR=65504;function xR(r){return!!(ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||yR<Math.abs(r)&&Math.abs(r)<bR)}function wR(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Gl(r,t,e){return ma(r,t,(function(){return r.getExtension(e)}),'Extension "'+e+'" not supported on this browser.')}function ER(r,t,e){var n=ma(r,t,(function(){return r.createShader(r.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Re(r,t,(function(){return r.shaderSource(n,e)})),Re(r,t,(function(){return r.compileShader(n)})),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function CR(r,t,e){var n=ma(r,t,(function(){return r.createShader(r.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Re(r,t,(function(){return r.shaderSource(n,e)})),Re(r,t,(function(){return r.compileShader(n)})),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw(function(a,o){var s=_R.exec(o);if(s==null)return console.log("Couldn't parse line number in error: "+o),void console.log(a);for(var l=+s[1],f=a.split(`
`),h=f.length.toString().length+2,p=f.map((function(w,C){return Io((C+1).toString(),h)+w})),v=0,m=0;m<p.length;m++)v=Math.max(p[m].length,v);var y=p.slice(0,l-1),x=p.slice(l-1,l),E=p.slice(l);console.log(y.join(`
`)),console.log(o.split(`
`)[0]),console.log("%c "+Io(x[0],v),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(E.join(`
`))})(e,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var Fd,Ld,_R=/ERROR: [0-9]+:([0-9]+):/g;function SR(r,t){return ma(r,t,(function(){return r.createProgram()}),"Unable to create WebGLProgram.")}function RR(r,t,e){if(Re(r,t,(function(){return r.linkProgram(e)})),r.getProgramParameter(e,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function zd(r,t,e){if(Re(r,t,(function(){return r.validateProgram(e)})),r.getProgramParameter(e,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function AR(r,t,e){var n=ma(r,t,(function(){return r.createBuffer()}),"Unable to create WebGLBuffer");return Re(r,t,(function(){return r.bindBuffer(r.ARRAY_BUFFER,n)})),Re(r,t,(function(){return r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)})),n}function TR(r,t,e){var n=ma(r,t,(function(){return r.createBuffer()}),"Unable to create WebGLBuffer");return Re(r,t,(function(){return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)})),Re(r,t,(function(){return r.bufferData(r.ELEMENT_ARRAY_BUFFER,e,r.STATIC_DRAW)})),n}function DR(r,t){return ma(r,t,(function(){return r.createTexture()}),"Unable to create WebGLTexture.")}function NR(r,t){var e=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){var n="["+r+"x"+t+"]";throw new Error("Requested texture size "+n+" is invalid.")}if(r>e||t>e)throw n="["+r+"x"+t+"]",new Error("Requested texture size "+n+" greater than WebGL maximum on this browser / GPU "+("["+e+"x"+e+"]")+".")}function OR(r,t){return ma(r,t,(function(){return r.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function yb(r,t,e,n,a,o,s,l){var f=r.getAttribLocation(e,n);return f!==-1&&(Re(r,t,(function(){return r.bindBuffer(r.ARRAY_BUFFER,a)})),Re(r,t,(function(){return r.vertexAttribPointer(f,o,r.FLOAT,!1,s,l)})),Re(r,t,(function(){return r.enableVertexAttribArray(f)})),!0)}function MR(r,t,e,n){LR(r,n),Re(r,t,(function(){return r.activeTexture(r.TEXTURE0+n)})),Re(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,e)}))}function kR(r,t,e,n){return ma(r,t,(function(){return r.getUniformLocation(e,n)}),'uniform "'+n+'" not present in program.')}function IR(r,t,e){return r.getUniformLocation(t,e)}function BR(r,t,e,n,a,o){Re(r,t,(function(){return MR(r,t,n,o)})),Re(r,t,(function(){return r.uniform1i(a,o)}))}function Ud(r,t,e,n){Re(r,t,(function(){return r.bindFramebuffer(r.FRAMEBUFFER,n)})),Re(r,t,(function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0)}))}function bb(r,t,e){Re(r,t,(function(){return r.bindFramebuffer(r.FRAMEBUFFER,e)})),Re(r,t,(function(){return r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0)}))}function ql(r){var t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+FR(r,t))}function FR(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function ma(r,t,e,n){var a=Re(r,t,(function(){return e()}));if(a==null)throw new Error(n);return a}function LR(r,t){var e=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+r.TEXTURE0;if(n<r.TEXTURE0||n>e)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+e+"]")+".")}function gc(r,t){return t===void 0&&(t=2),Se(r.slice(0,r.length-t))}function yc(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function Pd(r){var t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[gc(r)].concat(yc(r))),t}function zR(r,t){var e;t===void 0&&(t=!1);var n=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,(r=r.map((function(h,p){return p>=r.length-2?nx(r[p]):r[p]}))).length===1&&(r=[2,r[0]])),r.length!==2){var a=Si(r);r=a.newShape}var o=Se(r);if(r.length<=1&&o<=n)return[1,o];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){var s=gc(r),l=2,f=2;return r.length&&(l=(e=yc(r))[0],f=e[1]),dp(o=s*(l/2)*(f/2)).map((function(h){return 2*h}))}return dp(o)}function Xl(r){return r%2==0}function Kl(r,t){if(Gt(r=r.slice(-2),t=t.slice(-2))||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){var e=r.slice(-1)[0],n=t.slice(-1)[0];if(e===n||Xl(e)&&Xl(n)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&Xl(r[0])&&Xl(t[0])}function UR(r){if(Fd==null){var t=Ur(r);Fd=t.getParameter(t.MAX_TEXTURE_SIZE)}return Fd}function PR(r){if(Ld==null){var t=Ur(r);Ld=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ld)}function HR(r){if(r===0)return 0;var t=Ur(r);return ur(t,"EXT_disjoint_timer_query_webgl2")&&r===2?2:ur(t,"EXT_disjoint_timer_query")?1:0}function ur(r,t){return r.getExtension(t)!=null}function xb(r){try{if(Ur(r)!=null)return!0}catch{return!1}return!1}function VR(r){if(r===0)return!1;var t=Ur(r);if(r===1){if(!ur(t,"OES_texture_float"))return!1}else if(!ur(t,"EXT_color_buffer_float"))return!1;return xp(t)}function WR(r){if(r===0)return!1;var t=Ur(r);if(r!==1){if(ur(t,"EXT_color_buffer_float"))return xp(t);if(ur(t,"EXT_color_buffer_half_float")){var e=t.getExtension("EXT_color_buffer_half_float");return(function(n,a){var o=qp(n,a),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,o.internalFormatHalfFloat,1,1,0,o.textureFormatFloat,o.textureTypeHalfFloat,null);var l=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,l),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);var f=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(l),f})(t,e)}return!1}return!!ur(t,"OES_texture_float")&&!!ur(t,"WEBGL_color_buffer_float")&&xp(t)}function xp(r){var t=qp(r),e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e),r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var n=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,n),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(e),r.deleteFramebuffer(n),a}function jR(r){return r===2&&Ur(r).fenceSync!=null}var Ie=ce();function fx(r){ce().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function be(r,t){return j.tidy(r,t)}function Rn(r){lx(r).forEach((function(t){return t.dispose()}))}function GR(r){return j.keep(r)}function bc(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];ce().getBool("IS_TEST")||console.warn.apply(console,r)}function ti(r,t){var e=r;if(Ir(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];for(var n=[];Array.isArray(e)||Ir(e)&&t!=="string";)n.push(e.length),e=e[0];return Array.isArray(r)&&ce().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&(function a(o,s,l){if(l=l||[],!Array.isArray(o)&&!Ir(o))return void B(s.length===0,(function(){return"Element arr["+l.join("][")+"] is a primitive, but should be an array/TypedArray of "+s[0]+" elements"}));B(s.length>0,(function(){return"Element arr["+l.join("][")+"] should be a primitive, but is an array of "+o.length+" elements"})),B(o.length===s[0],(function(){return"Element arr["+l.join("][")+"] should have "+s[0]+" elements, but has "+o.length+" elements"}));for(var f=s.slice(1),h=0;h<o.length;++h)a(o[h],f,l.concat(h))})(r,n,[]),n}function wb(r,t,e,n){if(r!=null&&(r!=="numeric"&&r!==t||r==="numeric"&&t==="string"))throw new Error("Argument '"+e+"' passed to '"+n+"' must be "+r+" tensor, but got "+t+" tensor")}function O(r,t,e,n){if(n===void 0&&(n="numeric"),r instanceof yt)return wb(n,r.dtype,t,e),r;var a=hs(r);if(a!=="string"&&["bool","int32","float32"].indexOf(n)>=0&&(a=n),wb(n,a,t,e),r==null||!Ir(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){var o=r==null?"null":r.constructor.name;throw new Error("Argument '"+t+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+o+"'")}var s=ti(r,a);Ir(r)||Array.isArray(r)||(r=[r]);var l=a!=="string"?ax(r,a,ce().getBool("DEBUG")):Vo(r,[],!0);return j.makeTensor(l,s,a)}function xc(r,t,e,n){if(n===void 0&&(n="numeric"),!Array.isArray(r))throw new Error("Argument "+t+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return r.map((function(a,o){return O(a,t+"["+o+"]",e)}),n)}function hx(r,t){for(var e=0;e<r.length;++e)if(r[r.length-e-1]!==t-1-e)return!1;return!0}function qR(r,t,e){for(var n=r.length+t.length,a=[],o=0,s=0,l=0;l<n;l++)e.indexOf(l)===-1?a.push(r[o++]):a.push(t[s++]);return a}function an(r,t){for(var e=[],n=r.length,a=0;a<n;a++)t.indexOf(a)===-1&&e.push(r[a]);return[e,t.map((function(o){return r[o]}))]}function Dn(r,t){return qR(r,t.map((function(e){return 1})),t)}function Hn(r,t,e){B(hx(t,e),(function(){return r+" supports only inner-most axes for now. Got axes "+t+" and rank-"+e+" input."}))}function Pr(r,t){if(hx(r,t))return null;for(var e=[],n=0;n<t;++n)r.indexOf(n)===-1&&e.push(n);return r.forEach((function(a){return e.push(a)})),e}function Xp(r){return r.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function Hr(r,t){for(var e=[],n=t-r;n<t;++n)e.push(n);return e}function XR(r,t){var e=r[0].length;r.forEach((function(a,o){B(a.length===e,(function(){return"Error in concat"+e+"D: rank of tensors["+o+"] must be the same as the rank of the rest ("+e+")"}))})),B(t>=0&&t<e,(function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."}));var n=r[0];r.forEach((function(a,o){for(var s=0;s<e;s++)B(s===t||a[s]===n[s],(function(){return"Error in concat"+e+"D: Shape of tensors["+o+"] ("+a+") does not match the shape of the rest ("+n+") along the non-concatenated axis "+o+"."}))}))}function jo(r,t){for(var e=r[0].slice(),n=1;n<r.length;n++)e[t]+=r[n][t];return e}function H(r){var t=Object.keys(r);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var e=t[0],n=r[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var a=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];j.startScope(e);try{var l=n.apply(void 0,o);return l instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),j.endScope(l),l}catch(f){throw j.endScope(null),f}};return Object.defineProperty(a,"name",{value:e,configurable:!0}),a}Ie.registerFlag("HAS_WEBGL",(function(){return Ie.getNumber("WEBGL_VERSION")>0})),Ie.registerFlag("WEBGL_VERSION",(function(){return xb(2)?2:xb(1)?1:0})),Ie.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return Ie.get("WEBGL_VERSION")===2})),Ie.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Ie.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Ie.registerFlag("WEBGL_PACK",(function(){return Ie.getBool("HAS_WEBGL")})),Ie.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_PACK_CLIP",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Ie.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_PACK_REDUCE",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_CONV_IM2COL",(function(){return Ie.getBool("WEBGL_PACK")})),Ie.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return UR(Ie.getNumber("WEBGL_VERSION"))})),Ie.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return PR(Ie.getNumber("WEBGL_VERSION"))})),Ie.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var r=Ie.getNumber("WEBGL_VERSION");return r===0?0:HR(r)})),Ie.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Ie.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(r=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))));var r})),Ie.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return VR(Ie.getNumber("WEBGL_VERSION"))})),Ie.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Ie.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ie.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Ie.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return WR(Ie.getNumber("WEBGL_VERSION"))})),Ie.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return jR(Ie.getNumber("WEBGL_VERSION"))})),Ie.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Ie.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),sx=fx;var en=H({complex_:function(r,t){var e=O(r,"real","complex"),n=O(t,"imag","complex");return rt(e.shape,n.shape,"real and imag shapes, "+e.shape+" and "+n.shape+", must match in call to tf.complex()."),j.runKernelFunc((function(a){return a.complex(e,n)}),{$real:e,$imag:n})}}),or=H({real_:function(r){var t=O(r,"input","real");return j.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),Mr=H({imag_:function(r){var t=O(r,"input","imag");return j.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function nn(r,t,e){return ni(r,t,ti(r,e),e)}function ni(r,t,e,n){if(n==null&&(n=hs(r)),n==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ir(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){ox(t);var a=Se(t),o=Se(e);B(a===o,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+o}));for(var s=0;s<e.length;++s){var l=e[s],f=s!==e.length-1||l!==Se(t.slice(s));B(e[s]===t[s]||!f,(function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+t+"). "}))}}return Ir(r)||Array.isArray(r)||(r=[r]),t=t||e,r=n!=="string"?ax(r,n,ce().getBool("DEBUG")):Vo(r,[],!0),j.makeTensor(r,t,n)}function ge(r,t){if((Ir(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ir(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ni(r,[],[],t)}function It(r,t){Yo(r);var e=ti(r,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ni(r,null,e,t)}function Qa(r,t,e){if(Yo(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var n=ti(r,e);if(n.length!==2&&n.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ni(r,t,n,e)}function Kp(r,t,e){if(Yo(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var n=ti(r,e);if(n.length!==3&&n.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ni(r,t,n,e)}function _n(r,t,e){if(Yo(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var n=ti(r,e);if(n.length!==4&&n.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ni(r,t,n,e)}function KR(r,t,e){if(Yo(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var n=ti(r,e);if(n.length!==5&&n.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ni(r,t,n,e)}function YR(r,t,e){if(Yo(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var n=ti(r,e);if(n.length!==6&&n.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(n.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ni(r,t=t||n,n,e)}function QR(r,t,e,n){return t===void 0&&(t=!0),j.makeVariable(r,t,e,n)}function Qo(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=Qo(r,"float32"),n=mt(r,"float32");return en(e,n)}var a=ix(Se(r),t);return j.makeTensor(a,r,t)}function mt(r,t){if(t===void 0&&(t="float32"),t==="complex64"){var e=mt(r,"float32"),n=mt(r,"float32");return en(e,n)}var a=ds(Se(r),t);return j.makeTensor(a,r,t)}function Fr(r,t,e){return j.runKernelFunc((function(n){return n.fill(r,t,e)}),{})}function ZR(r,t,e){if(e<=0)throw new Error("The number of values should be positive.");return j.runKernelFunc((function(n){return n.linspace(r,t,e)}),{})}function wc(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e===0)throw new Error("Cannot have a step of zero");if(r===t||r<t&&e<0||t<r&&e>1)return mt([0],n);var a=ds(Math.abs(Math.ceil((t-r)/e)),n);t<r&&e===1&&(e=-1),a[0]=r;for(var o=1;o<a.length;o++)a[o]=a[o-1]+e;return It(a,n)}var dx=H({onesLike_:function(r){var t=O(r,"x","onesLike");if(t.dtype==="complex64"){var e=dx(or(t)),n=Qe(Mr(t));return en(e,n)}return j.runKernelFunc((function(a){return a.onesLike(t)}),{$x:t},(function(a,o){return{$x:function(){return Qe(a)}}}))}}),Qe=H({zerosLike_:function(r){var t=O(r,"x","zerosLike");return j.runKernelFunc((function(e){return e.zerosLike(t)}),{$x:t},(function(e,n){return{$x:function(){return Qe(e)}}}))}}),Lt=H({concat_:function(r,t){t===void 0&&(t=0),B(r.length>=1,(function(){return"Pass at least one tensor to concat"}));var e=xc(r,"tensors","concat");e[0].dtype==="complex64"&&e.forEach((function(l){if(l.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+l.dtype+". ")})),t=Ht(t,e[0].shape)[0];var n=jo(e.map((function(l){return l.shape})),t);if(Se(n)===0)return nn([],n);if((e=e.filter((function(l){return l.size>0}))).length===1)return e[0];var a=e.map((function(l){return l.shape}));XR(a,t);var o=e,s={axis:t};return j.runKernelFunc((function(l){return l.concat(e,t)}),o,(function(l){var f=a.map((function(h){return h[t]}));return Yp(l,f,t).map((function(h){return function(){return h}}))}),"Concat",s)}}),JR=H({concat1d_:function(r){return Lt(r,0)}}),$R=H({concat2d_:function(r,t){return Lt(r,t)}}),eA=H({concat3d_:function(r,t){return Lt(r,t)}}),tA=H({concat4d_:function(r,t){return Lt(r,t)}}),Yp=H({split_:function(r,t,e){e===void 0&&(e=0);var n,a=O(r,"x","split");return e=Ht(e,a.shape)[0],typeof t=="number"?(B(a.shape[e]%t==0,(function(){return"Number of splits must evenly divide the axis."})),n=new Array(t).fill(a.shape[e]/t)):(B(a.shape[e]===t.reduce((function(o,s){return o+s})),(function(){return"The sum of sizes must match the size of the axis dimension."})),n=t),j.runKernelFunc((function(o){return o.split(a,n,e)}),{$x:a},(function(o){return{$x:function(){return Lt(o,e)}}}))}});function Bi(r,t){return r(t={exports:{}},t.exports),t.exports}var nA=Bi((function(r){(function(t,e,n){function a(l){var f,h=this,p=(f=4022871197,function(v){v=v.toString();for(var m=0;m<v.length;m++){var y=.02519603282416938*(f+=v.charCodeAt(m));y-=f=y>>>0,f=(y*=f)>>>0,f+=4294967296*(y-=f)}return 23283064365386963e-26*(f>>>0)});h.next=function(){var v=2091639*h.s0+23283064365386963e-26*h.c;return h.s0=h.s1,h.s1=h.s2,h.s2=v-(h.c=0|v)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(l),h.s0<0&&(h.s0+=1),h.s1-=p(l),h.s1<0&&(h.s1+=1),h.s2-=p(l),h.s2<0&&(h.s2+=1),p=null}function o(l,f){return f.c=l.c,f.s0=l.s0,f.s1=l.s1,f.s2=l.s2,f}function s(l,f){var h=new a(l),p=f&&f.state,v=h.next;return v.int32=function(){return 4294967296*h.next()|0},v.double=function(){return v()+11102230246251565e-32*(2097152*v()|0)},v.quick=v,p&&(typeof p=="object"&&o(p,h),v.state=function(){return o(h,{})}),v}e&&e.exports?e.exports=s:this.alea=s})(0,r)})),rA=Bi((function(r){(function(t,e,n){function a(l){var f=this,h="";f.x=0,f.y=0,f.z=0,f.w=0,f.next=function(){var v=f.x^f.x<<11;return f.x=f.y,f.y=f.z,f.z=f.w,f.w^=f.w>>>19^v^v>>>8},l===(0|l)?f.x=l:h+=l;for(var p=0;p<h.length+64;p++)f.x^=0|h.charCodeAt(p),f.next()}function o(l,f){return f.x=l.x,f.y=l.y,f.z=l.z,f.w=l.w,f}function s(l,f){var h=new a(l),p=f&&f.state,v=function(){return(h.next()>>>0)/4294967296};return v.double=function(){do var m=((h.next()>>>11)+(h.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=h.next,v.quick=v,p&&(typeof p=="object"&&o(p,h),v.state=function(){return o(h,{})}),v}e&&e.exports?e.exports=s:this.xor128=s})(0,r)})),aA=Bi((function(r){(function(t,e,n){function a(l){var f=this,h="";f.next=function(){var v=f.x^f.x>>>2;return f.x=f.y,f.y=f.z,f.z=f.w,f.w=f.v,(f.d=f.d+362437|0)+(f.v=f.v^f.v<<4^v^v<<1)|0},f.x=0,f.y=0,f.z=0,f.w=0,f.v=0,l===(0|l)?f.x=l:h+=l;for(var p=0;p<h.length+64;p++)f.x^=0|h.charCodeAt(p),p==h.length&&(f.d=f.x<<10^f.x>>>4),f.next()}function o(l,f){return f.x=l.x,f.y=l.y,f.z=l.z,f.w=l.w,f.v=l.v,f.d=l.d,f}function s(l,f){var h=new a(l),p=f&&f.state,v=function(){return(h.next()>>>0)/4294967296};return v.double=function(){do var m=((h.next()>>>11)+(h.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=h.next,v.quick=v,p&&(typeof p=="object"&&o(p,h),v.state=function(){return o(h,{})}),v}e&&e.exports?e.exports=s:this.xorwow=s})(0,r)})),iA=Bi((function(r){(function(t,e,n){function a(l){var f=this;f.next=function(){var h,p,v=f.x,m=f.i;return h=v[m],p=(h^=h>>>7)^h<<24,p^=(h=v[m+1&7])^h>>>10,p^=(h=v[m+3&7])^h>>>3,p^=(h=v[m+4&7])^h<<7,h=v[m+7&7],p^=(h^=h<<13)^h<<9,v[m]=p,f.i=m+1&7,p},(function(h,p){var v,m=[];if(p===(0|p))m[0]=p;else for(p=""+p,v=0;v<p.length;++v)m[7&v]=m[7&v]<<15^p.charCodeAt(v)+m[v+1&7]<<13;for(;m.length<8;)m.push(0);for(v=0;v<8&&m[v]===0;++v);for(v==8?m[7]=-1:m[v],h.x=m,h.i=0,v=256;v>0;--v)h.next()})(f,l)}function o(l,f){return f.x=l.x.slice(),f.i=l.i,f}function s(l,f){l==null&&(l=+new Date);var h=new a(l),p=f&&f.state,v=function(){return(h.next()>>>0)/4294967296};return v.double=function(){do var m=((h.next()>>>11)+(h.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=h.next,v.quick=v,p&&(p.x&&o(p,h),v.state=function(){return o(h,{})}),v}e&&e.exports?e.exports=s:this.xorshift7=s})(0,r)})),oA=Bi((function(r){(function(t,e,n){function a(l){var f=this;f.next=function(){var h,p,v=f.w,m=f.X,y=f.i;return f.w=v=v+1640531527|0,p=m[y+34&127],h=m[y=y+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=m[y]=p^h,f.i=y,p+(v^v>>>16)|0},(function(h,p){var v,m,y,x,E,w=[],C=128;for(p===(0|p)?(m=p,p=null):(p+="\0",m=0,C=Math.max(C,p.length)),y=0,x=-32;x<C;++x)p&&(m^=p.charCodeAt((x+32)%p.length)),x===0&&(E=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,x>=0&&(E=E+1640531527|0,y=(v=w[127&x]^=m+E)==0?y+1:0);for(y>=128&&(w[127&(p&&p.length||0)]=-1),y=127,x=512;x>0;--x)m=w[y+34&127],v=w[y=y+1&127],m^=m<<13,v^=v<<17,m^=m>>>15,v^=v>>>12,w[y]=m^v;h.w=E,h.X=w,h.i=y})(f,l)}function o(l,f){return f.i=l.i,f.w=l.w,f.X=l.X.slice(),f}function s(l,f){l==null&&(l=+new Date);var h=new a(l),p=f&&f.state,v=function(){return(h.next()>>>0)/4294967296};return v.double=function(){do var m=((h.next()>>>11)+(h.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=h.next,v.quick=v,p&&(p.X&&o(p,h),v.state=function(){return o(h,{})}),v}e&&e.exports?e.exports=s:this.xor4096=s})(0,r)})),uA=Bi((function(r){(function(t,e,n){function a(l){var f=this,h="";f.next=function(){var v=f.b,m=f.c,y=f.d,x=f.a;return v=v<<25^v>>>7^m,m=m-y|0,y=y<<24^y>>>8^x,x=x-v|0,f.b=v=v<<20^v>>>12^m,f.c=m=m-y|0,f.d=y<<16^m>>>16^x,f.a=x-v|0},f.a=0,f.b=0,f.c=-1640531527,f.d=1367130551,l===Math.floor(l)?(f.a=l/4294967296|0,f.b=0|l):h+=l;for(var p=0;p<h.length+20;p++)f.b^=0|h.charCodeAt(p),f.next()}function o(l,f){return f.a=l.a,f.b=l.b,f.c=l.c,f.d=l.d,f}function s(l,f){var h=new a(l),p=f&&f.state,v=function(){return(h.next()>>>0)/4294967296};return v.double=function(){do var m=((h.next()>>>11)+(h.next()>>>0)/4294967296)/2097152;while(m===0);return m},v.int32=h.next,v.quick=v,p&&(typeof p=="object"&&o(p,h),v.state=function(){return o(h,{})}),v}e&&e.exports?e.exports=s:this.tychei=s})(0,r)})),_i=Bi((function(r){(function(t,e){var n,a=this,o=256,s=6,l="random",f=e.pow(o,s),h=e.pow(2,52),p=2*h,v=o-1;function m(C,_,R){var A=[],T=E((function I(k,F){var W,P=[],oe=typeof k;if(F&&oe=="object")for(W in k)try{P.push(I(k[W],F-1))}catch{}return P.length?P:oe=="string"?k:k+"\0"})((_=_==1?{entropy:!0}:_||{}).entropy?[C,w(t)]:C??(function(){try{var I;return n&&(I=n.randomBytes)?I=I(o):(I=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(I)),w(I)}catch{var k=a.navigator,F=k&&k.plugins;return[+new Date,a,F,a.screen,w(t)]}})(),3),A),N=new y(A),M=function(){for(var I=N.g(s),k=f,F=0;I<h;)I=(I+F)*o,k*=o,F=N.g(1);for(;I>=p;)I/=2,k/=2,F>>>=1;return(I+F)/k};return M.int32=function(){return 0|N.g(4)},M.quick=function(){return N.g(4)/4294967296},M.double=M,E(w(N.S),t),(_.pass||R||function(I,k,F,W){return W&&(W.S&&x(W,N),I.state=function(){return x(N,{})}),F?(e[l]=I,k):I})(M,T,"global"in _?_.global:this==e,_.state)}function y(C){var _,R=C.length,A=this,T=0,N=A.i=A.j=0,M=A.S=[];for(R||(C=[R++]);T<o;)M[T]=T++;for(T=0;T<o;T++)M[T]=M[N=v&N+C[T%R]+(_=M[T])],M[N]=_;(A.g=function(I){for(var k,F=0,W=A.i,P=A.j,oe=A.S;I--;)k=oe[W=v&W+1],F=F*o+oe[v&(oe[W]=oe[P=v&P+k])+(oe[P]=k)];return A.i=W,A.j=P,F})(o)}function x(C,_){return _.i=C.i,_.j=C.j,_.S=C.S.slice(),_}function E(C,_){for(var R,A=C+"",T=0;T<A.length;)_[v&T]=v&(R^=19*_[v&T])+A.charCodeAt(T++);return w(_)}function w(C){return String.fromCharCode.apply(0,C)}if(e["seed"+l]=m,E(e.random(),t),r.exports){r.exports=m;try{n=require("crypto")}catch{}}})([],Math)}));_i.alea=nA,_i.xor128=rA,_i.xorwow=aA,_i.xorshift7=iA,_i.xor4096=oA,_i.tychei=uA;var Hc=_i.alea,Qp=(function(){function r(t,e,n,a,o){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=o||Math.random();this.random=Hc(s.toString())}return r.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,a=!1;!a;){var o=void 0,s=void 0,l=void 0;do l=(o=2*this.random()-1)*o+(s=2*this.random()-1)*s;while(l>=1||l===0);var f=Math.sqrt(-2*Math.log(l)/l);e=this.mean+this.stdDev*o*f,n=this.mean+this.stdDev*s*f,this.truncated&&!this.isValidTruncated(e)||(a=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},r.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},r.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},r})(),sA=(function(){function r(t,e,n,a){this.alpha=t,this.beta=1/e,this.dtype=n;var o=a||Math.random();this.randu=Hc(o.toString()),this.randn=new Qp(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return r.prototype.nextValue=function(){for(var t,e,n,a,o,s;;){do a=this.randn.nextValue(),s=1+this.c*a;while(s<=0);if(s*=s*s,e=1-.331*(t=a*a)*t,n=.5*t+this.d*(1-s+Math.log(s)),(o=this.randu())<e||Math.log(o)<n)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)},r.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},r})(),lA=(function(){function r(t,e,n,a){var o=this;if(t===void 0&&(t=0),e===void 0&&(e=1),this.canReturnFloat=function(){return o.dtype==null||o.dtype==="float32"},this.min=t,this.range=e-t,this.dtype=n,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Hc(a)}return r.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},r.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},r})();function Le(r,t,e){return t===void 0&&(t="float32"),t=t||"float32",ox(r),new rs(r,t,e)}function cA(r,t){t===void 0&&(t=!1),console.log(r.toString(t))}var px=H({batchToSpaceND_:function(r,t,e){var n=O(r,"x","batchToSpaceND"),a=t.reduce((function(o,s){return o*s}));return B(n.rank>=1+t.length,(function(){return"input rank is "+n.rank+" but should be > than blockShape.length "+t.length})),B(e.length===t.length,(function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+t.length})),B(n.shape[0]%a==0,(function(){return"input tensor batch is "+n.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a})),j.runKernelFunc((function(o){return o.batchToSpaceND(n,t,e)}),{$x:n},(function(o){return{$x:function(){return o.spaceToBatchND(t,e)}}}))}}),fA=H({broadcastTo_:function(r,t){var e=O(r,"broadcastTo","x"),n=e.shape;if(t.some((function(f){return!(f>0)||f%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<e.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+e.rank+".");if(t.length>e.rank){for(var a=e.shape.slice();a.length<t.length;)a.unshift(1);e=e.reshape(a)}for(var o=Array.from(t),s=t.length-1;s>=0;s--)if(e.shape[s]===t[s])o[s]=1;else if(e.shape[s]!==1)throw new Error("broadcastTo(): ["+n+"] cannot be broadcast to ["+t+"].");var l=o.map((function(f,h){return f>1?h:-1})).filter((function(f){return f>=0}));return l.length===0?e.clone():j.runKernelFunc((function(f){return f.tile(e,o)}),{input:e},(function(f){return{input:function(){return f.sum(l,!0)}}}))}}),hA=H({cast_:function(r,t){var e=O(r,"x","cast");if(!aR(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");var n={dtype:t};return j.runKernelFunc((function(a){return a.cast(e,t)}),{x:e},(function(a){return{x:function(){return a.clone()}}}),"Cast",n)}}),dA=H({clone_:function(r){var t=O(r,"x","clone",null);return j.runKernelFunc((function(){return j.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),pA=H({cumsum_:function(r,t,e,n){t===void 0&&(t=0),e===void 0&&(e=!1),n===void 0&&(n=!1);var a=O(r,"x","cumsum"),o=Pr([t|=0],a.rank),s=a;o!=null&&(s=a.transpose(o));var l=Hr(1,a.rank)[0],f=j.runKernelFunc((function(h){return h.cumsum(s,l,e,n)}),{permutedX:s},(function(h){return{permutedX:function(){return h.cumsum(t,e,!n)}}}));return o!=null&&(f=f.transpose(o)),f}}),vA=H({depthToSpace_:function(r,t,e){e===void 0&&(e="NHWC");var n=O(r,"x","depthToSpace"),a=e==="NHWC"?n.shape[1]:n.shape[2],o=e==="NHWC"?n.shape[2]:n.shape[3],s=e==="NHWC"?n.shape[3]:n.shape[1];return B(a*t>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+`  for depthToSpace with input shape
      `+n.shape})),B(o*t>=0,(function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+` for depthToSpace with input shape
          `+n.shape})),B(s%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+s+" for depthToSpace with input shape "+n.shape})),j.runKernelFunc((function(l){return l.depthToSpace(n,t,e)}),{$x:n})}}),ir=H({expandDims_:function(r,t){t===void 0&&(t=0);var e=O(r,"x","expandDims",null);B(t<=e.rank,(function(){return"Axis must be <= rank of the tensor"}));var n=e.shape.slice();return t<0&&(B(-(e.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"})),t=e.rank+t+1),n.splice(t,0,1),mr(e,n)}}),vx=H({eye_:function(r,t,e,n){n===void 0&&(n="float32"),t==null&&(t=r);for(var a=Le([r,t],n),o=r<=t?r:t,s=0;s<o;++s)a.set(1,s,s);var l=a.toTensor().as2D(r,t);if(e==null)return l;if(e.length===1)return Bo(ir(l,0),[e[0],1,1]);if(e.length===2)return Bo(ir(ir(l,0),0),[e[0],e[1],1,1]);if(e.length===3)return Bo(ir(ir(ir(l,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),mA=H({multinomial_:function(r,t,e,n){n===void 0&&(n=!1);var a=O(r,"logits","multinomial"),o=a.size,s=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(s>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+s);e=e||Math.random();var l=s===1?a.as2D(1,-1):a,f=j.runKernelFunc((function(h){return h.multinomial(l,n,t,e)}),{logits2D:l});return s===1?f.as1D():f}}),wp=H({oneHot_:function(r,t,e,n){if(e===void 0&&(e=1),n===void 0&&(n=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=O(r,"indices","oneHot","int32"),o=a.shape.concat([t]);return a=a.flatten(),j.runKernelFunc((function(s){return s.oneHot(a,t,e,n)}),{$indices:a},(function(s){return{$indices:function(){return mt(a.shape,"float32")}}})).reshape(o)}}),Fi=H({pad_:function(r,t,e){e===void 0&&(e=0);var n=O(r,"x","pad");if(n.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:e};return j.runKernelFunc((function(o){return o.pad(n,t,e)}),{x:n},(function(o){var s=t.map((function(l){return l[0]}));return{x:function(){return o.slice(s,n.shape)}}}),"PadV2",a)}}),gA=H({pad1d_:function(r,t,e){return e===void 0&&(e=0),B(t.length===2,(function(){return"Invalid number of paddings. Must be length of 2."})),Fi(r,[t],e)}}),yA=H({pad2d_:function(r,t,e){return e===void 0&&(e=0),B(t.length===2&&t[0].length===2&&t[1].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Fi(r,t,e)}}),bA=H({pad3d_:function(r,t,e){return e===void 0&&(e=0),B(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Fi(r,t,e)}}),xA=H({pad4d_:function(r,t,e){return e===void 0&&(e=0),B(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Fi(r,t,e)}}),wA=H({rand_:function(r,t,e){var n=Se(r),a=null;if(e==null||e==="float32")a=new Float32Array(n);else if(e==="int32")a=new Int32Array(n);else{if(e!=="bool")throw new Error("Unknown data type "+e);a=new Uint8Array(n)}for(var o=0;o<n;o++)a[o]=t();return j.makeTensor(a,r,e)}}),EA=H({randomNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var o=new Qp(t,e,n,!1,a),s=Le(r,n),l=0;l<s.values.length;l++)s.values[l]=o.nextValue();return s.toTensor()}}),CA=H({randomGamma_:function(r,t,e,n,a){if(e===void 0&&(e=1),n===void 0&&(n="float32"),e==null&&(e=1),n==null&&(n="float32"),n!=="float32"&&n!=="int32")throw new Error("Unsupported data type "+n);for(var o=new sA(t,e,n,a),s=Le(r,n),l=0;l<s.values.length;l++)s.values[l]=o.nextValue();return s.toTensor()}}),mx=H({randomUniform_:function(r,t,e,n,a){t===void 0&&(t=0),e===void 0&&(e=1),n===void 0&&(n="float32");for(var o=Le(r,n),s=new lA(t,e,null,a),l=0;l<o.values.length;l++)o.values[l]=s.nextValue();return o.toTensor()}}),mr=H({reshape_:function(r,t){var e=O(r,"x","reshape",null);t=nR(t,e.size),B(e.size===Se(t),(function(){return"new shape and old shape must have the same number of elements."}));var n={shape:t};return j.runKernelFunc((function(a){return a.reshape(e,t)}),{x:e},(function(a){return{x:function(){return a.reshape(e.shape)}}}),"Reshape",n)}}),gx=H({spaceToBatchND_:function(r,t,e){var n=O(r,"x","spaceToBatchND");return B(n.rank>=1+t.length,(function(){return"input rank "+n.rank+" should be > than [blockShape] "+t.length})),B(e.length===t.length,(function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+t.length})),B(n.shape.reduce((function(a,o,s){return s>0&&s<=t.length?a&&(o+e[s-1][0]+e[s-1][1])%t[s-1]==0:a}),!0),(function(){return"input spatial dimensions "+n.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+t.toString()})),j.runKernelFunc((function(a){return a.spaceToBatchND(n,t,e)}),{$x:n},(function(a){return{$x:function(){return a.batchToSpaceND(t,e)}}}))}}),yx=H({squeeze_:function(r,t){var e=O(r,"x","squeeze");return mr(e,Si(e.shape,t).newShape)}}),qn=H({stack_:function(r,t){t===void 0&&(t=0);var e=xc(r,"tensors","stack");if(B(e.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),e.length===1)return e[0].expandDims(t);var n=e[0].rank,a=e[0].shape,o=e[0].dtype;B(t<=n,(function(){return"Axis must be <= rank of the tensor"})),e.forEach((function(l){rt(a,l.shape,"All tensors passed to stack must have matching shapes")})),e.forEach((function(l){B(o===l.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=e.map((function(l){return l.expandDims(t)}));return Lt(s,t)}}),Bo=H({tile_:function(r,t){var e=O(r,"x","tile",null);B(e.rank===t.length,(function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+t+"."}));var n=[e],a={reps:t};return j.runKernelFunc((function(o,s){var l=o.tile(e,t);return s([e]),l}),{x:e},(function(o,s){var l=s[0];return{x:function(){var f=Qe(l);if(l.rank===1)for(var h=0;h<t[0];++h)f=f.add(o.slice([h*l.shape[0]],[l.shape[0]]));else if(l.rank===2)for(h=0;h<t[0];++h)for(var p=0;p<t[1];++p)f=f.add(o.slice([h*l.shape[0],p*l.shape[1]],[l.shape[0],l.shape[1]]));else if(l.rank===3)for(h=0;h<t[0];++h)for(p=0;p<t[1];++p)for(var v=0;v<t[2];++v)f=f.add(o.slice([h*l.shape[0],p*l.shape[1],v*l.shape[2]],[l.shape[0],l.shape[1],l.shape[2]]));else{if(l.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+l.rank+" tensors yet.");for(h=0;h<t[0];++h)for(p=0;p<t[1];++p)for(v=0;v<t[2];++v)for(var m=0;m<t[3];++m)f=f.add(o.slice([h*l.shape[0],p*l.shape[1],v*l.shape[2],m*l.shape[3]],[l.shape[0],l.shape[1],l.shape[2],l.shape[3]]))}return f}}}),"Tile",a,n)}}),_A=H({truncatedNormal_:function(r,t,e,n,a){if(t===void 0&&(t=0),e===void 0&&(e=1),n!=null&&n==="bool")throw new Error("Unsupported data type "+n);for(var o=new Qp(t,e,n,!0,a),s=Le(r,n),l=0;l<s.values.length;l++)s.values[l]=o.nextValue();return s.toTensor()}}),zt=H({unstack_:function(r,t){t===void 0&&(t=0),t=t||0;var e=O(r,"x","unstack");B(t>=-e.shape.length&&t<e.shape.length,(function(){return"Axis = "+t+" is not in [-"+e.shape.length+", "+e.shape.length+")"})),t<0&&(t+=e.shape.length);var n={axis:t};return j.runKernelFunc((function(a){return a.unstack(e,t)}),{x:e},(function(a){return{x:function(){return qn(a,t)}}}),"Unpack",n)}}),SA=function(r,t){return Ee(this,void 0,void 0,(function(){var e,n,a,o,s,l,f,h,p,v;return Ce(this,(function(m){switch(m.label){case 0:return e=O(r,"x","setdiff1d"),n=O(t,"y","setdiff1d"),B(e.dtype===n.dtype,(function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+n.dtype+")."})),B(e.rank===1,(function(){return"x should be 1D tensor, but got x ("+e.shape+")."})),B(n.rank===1,(function(){return"y should be 1D tensor, but got y ("+n.shape+")."})),[4,e.data()];case 1:return a=m.sent(),[4,n.data()];case 2:for(o=m.sent(),s=new Set(o),l=0,p=0;p<a.length;p++)s.has(a[p])||l++;for(f=new rs([l],e.dtype),h=new rs([l],"int32"),p=0,v=0;p<a.length;p++)s.has(a[p])||(f.values[v]=a[p],h.values[v]=p,v++);return[2,[f.toTensor(),h.toTensor()]]}}))}))};function Ec(r,t,e,n){n===void 0&&(n=!0);var a=[];if(n)(a=a.concat(t.slice(0))).push(r[0]/e),a=a.concat(r.slice(1));else{a=a.concat(r[0]);for(var o=t.length,s=0;s<o;++s)a=a.concat([r[s+1]/t[s],t[s]]);a=a.concat(r.slice(o+1))}return a}function Cc(r,t,e){e===void 0&&(e=!0);var n=[];if(e){n.push(t);for(var a=t+1;a<r;++a)a<=2*t?(n.push(a),n.push(a-(t+1))):n.push(a)}else{var o=[],s=[];for(a=1;a<r;++a)a>=2*t+1||a%2==1?s.push(a):o.push(a);n.push.apply(n,o),n.push(0),n.push.apply(n,s)}return n}function _c(r,t,e,n){n===void 0&&(n=!0);var a=[];n?a.push(r[0]/e):a.push(r[0]*e);for(var o=1;o<r.length;++o)o<=t.length?n?a.push(t[o-1]*r[o]):a.push(r[o]/t[o-1]):a.push(r[o]);return a}function bx(r,t){for(var e=[0],n=0;n<t;++n)e.push(r[n][0]);return e}function xx(r,t,e){for(var n=r.slice(0,1),a=0;a<e;++a)n.push(r[a+1]-t[a][0]-t[a][1]);return n}function wx(r,t){if(r.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+r.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>r.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+r.rank);if(r.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+r.shape+".");for(var e=t.shape,n=e[e.length-1],a=1,o=0;o<e.length-1;++o)a*=e[o];var s=r.shape,l=e.slice();l.pop();var f=1;for(o=n;o<r.rank;++o)f*=s[o],l.push(s[o]);var h=Br(r.shape).map((function(p){return p/f})).concat([1]).slice(0,n);return[l,a,f,h]}var Ex=30;function Hd(r){return r<=Ex?r:vp(r,Math.floor(Math.sqrt(r)))}function RA(r,t,e){var n=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+t.shape+", shape: "+r+", sliceDim: "+n+", and batchDim: "+a+".";if(e.rank<a)throw new Error(o+" update.rank < "+a+". ");if(r.length<n+(e.rank-a))throw new Error(o+" Output shape length < "+(n+(e.rank-a)));if(e.rank!==a+r.length-n)throw new Error(o+" update.rank != "+(a+r.length-n));for(var s=0;s<a;++s)if(e.shape[s]!==t.shape[s])throw new Error(o+" updates.shape["+s+"] ("+e.shape[s]+") != indices.shape["+s+"] ("+t.shape[s]+").");for(s=0;s<e.rank-a;++s)if(e.shape[s+a]!==r[s+n])throw new Error(o+" updates.shape["+(s+a)+"] ("+e.shape[s+a]+") != shape["+(s+a)+"] ("+r[s+a]+")")}function AA(r,t,e){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(r.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+r.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(e.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(r.size===0)throw new Error("Updates specified for empty output. updates shape: "+r.shape)}RA(e,t,r)}function Sc(r,t,e){for(var n=t.shape.length,a=n>1?t.shape[n-1]:1,o=e.length,s=1,l=a;l<o;++l)s*=e[l];var f=a<1?1:a;return{sliceRank:a,numUpdates:Se(t.shape)/f,sliceSize:s,strides:Br(e.slice(0,a)).concat([1]),outputSize:Se(e)}}function TA(r,t,e){B(r.rank===t.length,(function(){return"Error in slice"+r.rank+"D: Length of begin "+t+" must match the rank of the array ("+r.rank+")."})),B(r.rank===e.length,(function(){return"Error in slice"+r.rank+"D: Length of size "+e+" must match the rank of the array ("+r.rank+")."}));for(var n=function(o){B(t[o]+e[o]<=r.shape[o],(function(){return"Error in slice"+r.rank+"D: begin["+o+"] + size["+o+"] ("+(t[o]+e[o])+") would overflow input.shape["+o+"] ("+r.shape[o]+")"}))},a=0;a<r.rank;++a)n(a)}function Eb(r){for(var t=[],e=0;r>0;)1&r&&t.push(e),r/=2,e++;return t}function Zp(r,t,e){for(var n=[],a=0;a<r.length;a++)n[a]=Math.ceil((t[a]-r[a])/e[a]);return n}function DA(r,t,e,n,a){var o=t[a],s=e[a]||1;(r&1<<a||o==null)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var l=n[a];return o<0&&(o+=l),o=hp(0,o,l-1)}function NA(r,t,e,n,a){var o=t[a],s=e[a]||1;(r&1<<a||o==null)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var l=n[a];return o<0&&(o+=l),o=s>0?hp(0,o,l):hp(-1,o,l-1)}function Cx(r,t,e){for(var n=e.length,a=0;a<e.length;a++)if(e[a]>1){n=a;break}for(a=n+1;a<e.length;a++)if(t[a]>0||e[a]!==r[a])return!1;return!0}function _x(r,t){for(var e=r.length>0?r[r.length-1]:1,n=0;n<r.length-1;n++)e+=r[n]*t[n];return e}function OA(r,t){B(pp(r),(function(){return"The f passed in variableGrads(f) must be a function"})),B(t==null||Array.isArray(t)&&t.every((function(p){return p instanceof Wo})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var e=t!=null;if(!e)for(var n in t=[],j.registeredVariables)t.push(j.registeredVariables[n]);var a=e?t.filter((function(p){return!p.trainable})):null,o=t.length;B((t=t.filter((function(p){return p.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var s=j.gradients(r,t,null,!0),l=s.value,f=s.grads;B(f.some((function(p){return p!=null})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),B(l.rank===0,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+l.rank+" tensor"}));var h={};return t.forEach((function(p,v){f[v]!=null&&(h[p.name]=f[v])})),a?.forEach((function(p){return h[p.name]=null})),{value:l,grads:h}}function Vc(r){return j.customGrad(r)}var ga=H({softmax_:function(r,t){t===void 0&&(t=-1);var e=O(r,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+t);return j.runKernelFunc((function(n,a){var o=n.softmax(e,t);return a([o]),o}),{logits:e},(function(n,a){var o=a[0],s=n.mul(o);return{logits:function(){return s.sub(s.sum([t],!0).mul(o))}}}),"Softmax",{dim:t},[],[!0])}}),MA=H({logSoftmax_:function(r,t){t===void 0&&(t=-1);var e=O(r,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+t);return Vc((function(n,a){var o=n.max(t,!0),s=n.sub(o),l=s.toFloat().sub(s.exp().sum(t,!0).log());return a([l]),{value:l,gradFunc:function(f,h){var p=h[0].exp();return f.sub(f.sum(t,!0).mul(p))}}}))(e)}}),Sx=(function(){function r(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return r.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},r.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},r.prototype.has=function(t){return this.data.has(t)},r.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},r.prototype.numDataIds=function(){return this.dataIdsCount},r})(),Rx=(function(){function r(){}return r.prototype.time=function(t){return J("time")},r.prototype.read=function(t){return J("read")},r.prototype.readSync=function(t){return J("readSync")},r.prototype.numDataIds=function(){return J("numDataIds")},r.prototype.disposeData=function(t){return J("disposeData")},r.prototype.write=function(t,e,n){return J("write")},r.prototype.move=function(t,e,n,a){return J("move")},r.prototype.memory=function(){return J("memory")},r.prototype.floatPrecision=function(){return J("floatPrecision")},r.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},r.prototype.batchMatMul=function(t,e,n,a){return J("batchMatMul")},r.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,J("fusedBatchMatMul")},r.prototype.slice=function(t,e,n){return J("slice")},r.prototype.stridedSlice=function(t,e,n,a){return J("stridedSlice")},r.prototype.unstack=function(t,e){return J("unstack")},r.prototype.reverse=function(t,e){return J("reverse")},r.prototype.concat=function(t,e){return J("concat")},r.prototype.neg=function(t){return J("neg")},r.prototype.add=function(t,e){return J("add")},r.prototype.addN=function(t){return J("addN")},r.prototype.subtract=function(t,e){return J("subtract")},r.prototype.multiply=function(t,e){return J("multiply")},r.prototype.realDivide=function(t,e){return J("realDivide")},r.prototype.floorDiv=function(t,e){return J("floorDiv")},r.prototype.sum=function(t,e){return J("sum")},r.prototype.prod=function(t,e){return J("prod")},r.prototype.unsortedSegmentSum=function(t,e,n){return J("unsortedSegmentSum")},r.prototype.argMin=function(t,e){return J("argMin")},r.prototype.argMax=function(t,e){return J("argMax")},r.prototype.equal=function(t,e){return J("equal")},r.prototype.notEqual=function(t,e){return J("notEqual")},r.prototype.less=function(t,e){return J("less")},r.prototype.lessEqual=function(t,e){return J("lessEqual")},r.prototype.greater=function(t,e){return J("greater")},r.prototype.greaterEqual=function(t,e){return J("greaterEqual")},r.prototype.logicalNot=function(t){return J("logicalNot")},r.prototype.logicalAnd=function(t,e){return J("logicalAnd")},r.prototype.logicalOr=function(t,e){return J("logicalOr")},r.prototype.where=function(t){return J("where")},r.prototype.select=function(t,e,n){return J("select")},r.prototype.topk=function(t,e,n){return J("topk")},r.prototype.min=function(t,e){return J("min")},r.prototype.minimum=function(t,e){return J("minimum")},r.prototype.mod=function(t,e){return J("mod")},r.prototype.max=function(t,e){return J("max")},r.prototype.maximum=function(t,e){return J("maximum")},r.prototype.all=function(t,e){return J("all")},r.prototype.any=function(t,e){return J("any")},r.prototype.squaredDifference=function(t,e){return J("squaredDifference")},r.prototype.ceil=function(t){return J("ceil")},r.prototype.floor=function(t){return J("floor")},r.prototype.round=function(t){return J("round")},r.prototype.sign=function(t){return J("sign")},r.prototype.isNaN=function(t){return J("isNaN")},r.prototype.isInf=function(t){return J("isInf")},r.prototype.isFinite=function(t){return J("isFinite")},r.prototype.pow=function(t,e){return J("pow")},r.prototype.exp=function(t){return J("exp")},r.prototype.expm1=function(t){return J("expm1")},r.prototype.softmax=function(t,e){return J("softmax")},r.prototype.log=function(t){return J("log")},r.prototype.log1p=function(t){return J("log1p")},r.prototype.sqrt=function(t){return J("sqrt")},r.prototype.rsqrt=function(t){return J("rsqrt")},r.prototype.square=function(t){return J("square")},r.prototype.reciprocal=function(t){return J("reciprocal")},r.prototype.relu=function(t){return J("relu")},r.prototype.relu6=function(t){return J("relu6")},r.prototype.prelu=function(t,e){return J("prelu")},r.prototype.elu=function(t){return J("elu")},r.prototype.eluDer=function(t,e){return J("eluDer")},r.prototype.selu=function(t){return J("selu")},r.prototype.int=function(t){return J("int")},r.prototype.clip=function(t,e,n){return J("clip")},r.prototype.abs=function(t){return J("abs")},r.prototype.complexAbs=function(t){return J("complexAbs")},r.prototype.sigmoid=function(t){return J("sigmoid")},r.prototype.softplus=function(t){return J("softplus")},r.prototype.sin=function(t){return J("sin")},r.prototype.cos=function(t){return J("cos")},r.prototype.tan=function(t){return J("tan")},r.prototype.asin=function(t){return J("asin")},r.prototype.acos=function(t){return J("acos")},r.prototype.atan=function(t){return J("atan")},r.prototype.atan2=function(t,e){return J("atan2")},r.prototype.sinh=function(t){return J("sinh")},r.prototype.cosh=function(t){return J("cosh")},r.prototype.tanh=function(t){return J("tanh")},r.prototype.asinh=function(t){return J("asinh")},r.prototype.acosh=function(t){return J("acosh")},r.prototype.atanh=function(t){return J("atanh")},r.prototype.erf=function(t){return J("erf")},r.prototype.step=function(t,e){return J("step")},r.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,J("fusedConv2d")},r.prototype.conv2d=function(t,e,n){return J("conv2d")},r.prototype.conv2dDerInput=function(t,e,n){return J("conv2dDerInput")},r.prototype.conv2dDerFilter=function(t,e,n){return J("conv2dDerFilter")},r.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,J("fusedDepthwiseConv2D")},r.prototype.depthwiseConv2D=function(t,e,n){return J("depthwiseConv2D")},r.prototype.depthwiseConv2DDerInput=function(t,e,n){return J("depthwiseConv2DDerInput")},r.prototype.depthwiseConv2DDerFilter=function(t,e,n){return J("depthwiseConv2DDerFilter")},r.prototype.conv3d=function(t,e,n){return J("conv3d")},r.prototype.conv3dDerInput=function(t,e,n){return J("conv3dDerInput")},r.prototype.conv3dDerFilter=function(t,e,n){return J("conv3dDerFilter")},r.prototype.maxPool=function(t,e){return J("maxPool")},r.prototype.maxPoolBackprop=function(t,e,n,a){return J("maxPoolBackprop")},r.prototype.avgPool=function(t,e){return J("avgPool")},r.prototype.avgPoolBackprop=function(t,e,n){return J("avgPoolBackprop")},r.prototype.avgPool3d=function(t,e){return J("avgPool3d")},r.prototype.avgPool3dBackprop=function(t,e,n){return J("avgPool3dBackprop")},r.prototype.maxPool3d=function(t,e){return J("maxPool3d")},r.prototype.maxPool3dBackprop=function(t,e,n,a){return J("maxPool3dBackprop")},r.prototype.reshape=function(t,e){return J("reshape")},r.prototype.cast=function(t,e){return J("cast")},r.prototype.tile=function(t,e){return J("tile")},r.prototype.pad=function(t,e,n){return J("pad")},r.prototype.transpose=function(t,e){return J("transpose")},r.prototype.gather=function(t,e,n){return J("gather")},r.prototype.gatherND=function(t,e){return J("gatherND")},r.prototype.scatterND=function(t,e,n){return J("scatterND")},r.prototype.batchToSpaceND=function(t,e,n){return J("batchToSpaceND")},r.prototype.spaceToBatchND=function(t,e,n){return J("spaceToBatchND")},r.prototype.resizeBilinear=function(t,e,n,a){return J("resizeBilinear")},r.prototype.resizeBilinearBackprop=function(t,e,n){return J("resizeBilinearBackprop")},r.prototype.resizeNearestNeighbor=function(t,e,n,a){return J("resizeNearestNeighbor")},r.prototype.resizeNearestNeighborBackprop=function(t,e,n){return J("resizeNearestNeighborBackprop")},r.prototype.batchNormalization=function(t,e,n,a,o,s){return J("batchNormalization")},r.prototype.localResponseNormalization4D=function(t,e,n,a,o){return J("localResponseNormalization4D")},r.prototype.LRNGrad=function(t,e,n,a,o,s,l){return J("LRNGrad")},r.prototype.multinomial=function(t,e,n,a){return J("multinomial")},r.prototype.oneHot=function(t,e,n,a){return J("oneHot")},r.prototype.cumsum=function(t,e,n,a){return J("cumsum")},r.prototype.nonMaxSuppression=function(t,e,n,a,o){return J("nonMaxSuppression")},r.prototype.fft=function(t){return J("fft")},r.prototype.ifft=function(t){return J("ifft")},r.prototype.complex=function(t,e){return J("complex")},r.prototype.real=function(t){return J("real")},r.prototype.imag=function(t){return J("imag")},r.prototype.cropAndResize=function(t,e,n,a,o,s){return J("cropAndResize")},r.prototype.depthToSpace=function(t,e,n){return J("depthToSpace")},r.prototype.split=function(t,e,n){return J("split")},r.prototype.sparseToDense=function(t,e,n,a){return J("sparseToDense")},r.prototype.diag=function(t){return J("diag")},r.prototype.fill=function(t,e,n){return J("fill")},r.prototype.onesLike=function(t){return J("onesLike")},r.prototype.zerosLike=function(t){return J("zerosLike")},r.prototype.linspace=function(t,e,n){return J("linspace")},r.prototype.dispose=function(){return J("dispose")},r})();function J(r){throw new Error("'"+r+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Ka(r,t){for(var e=r.length,n=[],a=0;a<e;a++){var o=e-1-a,s=r[o]||1;(t[t.length-1-a]||1)>1&&s===1&&n.unshift(o)}return n}function Ut(r,t){for(var e=[],n=0;n<t.length;n++){var a=r[r.length-n-1],o=t.length-n-1,s=t[o];(a==null||a===1&&s>1)&&e.unshift(o)}return e}function Ge(r,t){for(var e=[],n=Math.max(r.length,t.length),a=0;a<n;a++){var o=r[r.length-a-1];o==null&&(o=1);var s=t[t.length-a-1];if(s==null&&(s=1),o===1)e.unshift(s);else if(s===1)e.unshift(o);else{if(o!==s)throw Error("Operands could not be broadcast together with shapes "+r+" and "+t+".");e.unshift(o)}}return e}function is(r,t,e,n,a,o,s){s===void 0&&(s="channelsLast");var l,f=Tc(t),h=f[0],p=f[1];if(s==="channelsLast")l=[h,p,r[3],r[3]];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=[h,p,r[1],r[1]]}return Li(r,l,e,n,a,o,!1,s)}function Rc(r,t,e,n,a,o,s){s===void 0&&(s="NDHWC");var l,f,h=Ep(t),p=h[0],v=h[1],m=h[2];if(s==="NDHWC")f="channelsLast",l=[p,v,m,r[4],r[4]];else{if(s!=="NCDHW")throw new Error("Unknown dataFormat "+s);f="channelsFirst",l=[p,v,m,r[1],r[1]]}return Ac(r,l,e,n,a,!1,f,o)}function Li(r,t,e,n,a,o,s,l){s===void 0&&(s=!1),l===void 0&&(l="channelsLast");var f=[-1,-1,-1,-1],h=f[0],p=f[1],v=f[2],m=f[3];if(l==="channelsLast")h=r[0],p=r[1],v=r[2],m=r[3];else{if(l!=="channelsFirst")throw new Error("Unknown dataFormat "+l);h=r[0],m=r[1],p=r[2],v=r[3]}var y,x=t[0],E=t[1],w=t[3],C=Tc(e),_=C[0],R=C[1],A=Tc(n),T=A[0],N=A[1],M=Fo(x,T),I=Fo(E,N),k=(function(ee,ae,z,G,K,ie,se,L){var q,ue,pe;if(typeof ee=="number"){q={top:ee,bottom:ee,left:ee,right:ee,type:ee===0?"VALID":"NUMBER"};var me=(function(He,Ze,Ye,nt,ct){nt==null&&(nt=Ax(He,Ze,Ye));var ft=He[0],Xn=He[1],On=$u((ft-Ze+2*nt)/Ye+1,ct);B(At(On),(function(){return"The output # of rows ("+On+") must be an integer. Change the stride and/or zero pad parameters"}));var Xt=$u((Xn-Ze+2*nt)/Ye+1,ct);return B(At(Xt),(function(){return"The output # of columns ("+Xt+") must be an integer. Change the stride and/or zero pad parameters"})),[On,Xt]})([ae,z],ie,G,ee,L);ue=me[0],pe=me[1]}else if(ee==="same"){ue=Math.ceil(ae/G),pe=Math.ceil(z/K);var ye=Math.max(0,(ue-1)*G+ie-ae),xe=Math.max(0,(pe-1)*K+se-z),Oe=Math.floor(ye/2),De=ye-Oe,lt=Math.floor(xe/2);q={top:Oe,bottom:De,left:lt,right:xe-lt,type:"SAME"}}else{if(ee!=="valid")throw Error("Unknown padding parameter: "+ee);q={top:0,bottom:0,left:0,right:0,type:"VALID"},ue=Math.ceil((ae-ie+1)/G),pe=Math.ceil((z-se+1)/K)}return{padInfo:q,outHeight:ue,outWidth:pe}})(a,p,v,_,R,M,I,o),F=k.padInfo,W=k.outHeight,P=k.outWidth,oe=s?w*m:w;return l==="channelsFirst"?y=[h,oe,W,P]:l==="channelsLast"&&(y=[h,W,P,oe]),{batchSize:h,dataFormat:l,inHeight:p,inWidth:v,inChannels:m,outHeight:W,outWidth:P,outChannels:oe,padInfo:F,strideHeight:_,strideWidth:R,filterHeight:x,filterWidth:E,effectiveFilterHeight:M,effectiveFilterWidth:I,dilationHeight:T,dilationWidth:N,inShape:r,outShape:y,filterShape:t}}function Ac(r,t,e,n,a,o,s,l){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var f=[-1,-1,-1,-1,-1],h=f[0],p=f[1],v=f[2],m=f[3],y=f[4];if(s==="channelsLast")h=r[0],p=r[1],v=r[2],m=r[3],y=r[4];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);h=r[0],y=r[1],p=r[2],v=r[3],m=r[4]}var x,E=t[0],w=t[1],C=t[2],_=t[4],R=Ep(e),A=R[0],T=R[1],N=R[2],M=Ep(n),I=M[0],k=M[1],F=M[2],W=Fo(E,I),P=Fo(w,k),oe=Fo(C,F),ee=(function(se,L,q,ue,pe,me,ye,xe,Oe,De,lt){var He,Ze,Ye,nt;if(typeof se=="number"){He={top:se,bottom:se,left:se,right:se,front:se,back:se,type:se===0?"VALID":"NUMBER"};var ct=(function(Dt,fr,Pi,jr,hn,Jo){hn==null&&(hn=Ax(Dt,fr,jr));var As=Dt[0],lf=Dt[1],cf=Dt[2],Gr=$u((As-fr+2*hn)/jr+1,Jo);B(At(Gr),(function(){return"The output # of depths ("+Gr+") must be an integer. Change the stride and/or zero pad parameters"}));var Kt=$u((lf-fr+2*hn)/jr+1,Jo);B(At(Kt),(function(){return"The output # of rows ("+Kt+") must be an integer. Change the stride and/or zero pad parameters"}));var Kn=$u((cf-fr+2*hn)/jr+1,Jo);return B(At(Kn),(function(){return"The output # of columns ("+Kn+") must be an integer. Change the stride and/or zero pad parameters"})),[Gr,Kt,Kn,Pi]})([L,q,ue,1],xe,1,pe,se,lt);Ze=ct[0],Ye=ct[1],nt=ct[2]}else if(se==="same"){Ze=Math.ceil(L/pe),Ye=Math.ceil(q/me),nt=Math.ceil(ue/ye);var ft=(Ze-1)*pe+xe-L,Xn=(Ye-1)*me+Oe-q,On=(nt-1)*ye+De-ue,Xt=Math.floor(ft/2),wr=ft-Xt,Mn=Math.floor(Xn/2),Er=Xn-Mn,cr=Math.floor(On/2);He={top:Mn,bottom:Er,left:cr,right:On-cr,front:Xt,back:wr,type:"SAME"}}else{if(se!=="valid")throw Error("Unknown padding parameter: "+se);He={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ze=Math.ceil((L-xe+1)/pe),Ye=Math.ceil((q-Oe+1)/me),nt=Math.ceil((ue-De+1)/ye)}return{padInfo:He,outDepth:Ze,outHeight:Ye,outWidth:nt}})(a,p,v,m,A,T,N,W,P,oe,l),ae=ee.padInfo,z=ee.outDepth,G=ee.outHeight,K=ee.outWidth,ie=o?_*y:_;return s==="channelsFirst"?x=[h,ie,z,G,K]:s==="channelsLast"&&(x=[h,z,G,K,ie]),{batchSize:h,dataFormat:s,inDepth:p,inHeight:v,inWidth:m,inChannels:y,outDepth:z,outHeight:G,outWidth:K,outChannels:ie,padInfo:ae,strideDepth:A,strideHeight:T,strideWidth:N,filterDepth:E,filterHeight:w,filterWidth:C,effectiveFilterDepth:W,effectiveFilterHeight:P,effectiveFilterWidth:oe,dilationDepth:I,dilationHeight:k,dilationWidth:F,inShape:r,outShape:x,filterShape:t}}function Ax(r,t,e,n){n===void 0&&(n=1);var a=Fo(t,n);return Math.floor((r[0]*(e-1)-e+a)/2)}function Tc(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Ep(r){return typeof r=="number"?[r,r,r]:r}function Fo(r,t){return t<=1?r:r+(r-1)*(t-1)}function $u(r,t){if(!t)return r;switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error("Unknown roundingMode "+t)}}function Go(r){var t=Tc(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function Nn(r,t){return Go(r)||Go(t)}function Jp(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+r)}function Tx(r,t,e){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();var n=mt(r.shape),a=r.toFloat(),o=e.complex(a,n);return n.dispose(),a.dispose(),o}if(!iR(r.dtype,t))return j.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){var s=e.real(r);return o=s.cast(t),s.dispose(),o}if(t==="int32")return e.int(r);if(t==="bool"){var l=ge(0,r.dtype);return o=e.notEqual(r,l),l.dispose(),o}throw new Error("Error in Cast: failed to cast "+r.dtype+" to "+t)}function Cp(r,t){return j.makeTensorFromDataId(r.dataId,t,r.dtype)}function Dx(r,t,e){var n=(t-r)/(e-1),a=ds(e,"float32");a[0]=r;for(var o=1;o<a.length;o++)a[o]=a[o-1]+n;return It(a,"float32")}function _p(r,t){if(r.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+r.length+", imag: "+t.length+".");for(var e=new Float32Array(2*r.length),n=0;n<e.length;n+=2)e[n]=r[n/2],e[n+1]=t[n/2];return e}function Cb(r,t){return{real:r[2*t],imag:r[2*t+1]}}function kA(r,t,e,n){r[2*n]=t,r[2*n+1]=e}function IA(r,t,e){var n=(e?2:-2)*Math.PI*(r/t);return{real:Math.cos(n),imag:Math.sin(n)}}function BA(r,t,e){var n=(function(o,s,l){return(function(f,h,p){for(var v=0,m=f.length,y=0,x=!1;v<m;){var E=p(h,f[y=v+(m-v>>>1)]);E>0?v=y+1:(m=y,x=!E)}return x?v:-v-1})(o,s,l||FA)})(r,t,e),a=n<0?-(n+1):n;r.splice(a,0,t)}function FA(r,t){return r>t?1:r<t?-1:0}function $p(r,t,e,n,a){return Nx(r,t,e,n,a,0).selectedIndices}function ev(r,t,e,n,a,o){var s=Nx(r,t,e,n,a,o);return s.numValidOutputs.dispose(),{selectedIndices:s.selectedIndices,selectedScores:s.selectedScores}}function Nx(r,t,e,n,a,o,s,l){l===void 0&&(l=!1);for(var f=Array.from(t).map((function(A,T){return{score:A,boxIndex:T,suppressBeginIndex:0}})).filter((function(A){return A.score>a})).sort(_b),h=o>0?-.5/o:0,p=[],v=[];p.length<e&&f.length>0;){var m=f.pop(),y=m.score,x=m.boxIndex,E=m.suppressBeginIndex;if(y<a)break;for(var w=!1,C=p.length-1;C>=E;--C){var _=LA(r,x,p[C]);if(_>=n){w=!0;break}if(m.score=m.score*zA(n,h,_),m.score<=a)break}m.suppressBeginIndex=p.length,w||(m.score===y?(p.push(x),v.push(m.score)):m.score>a&&BA(f,m,_b))}var R=p.length;return l&&(p.fill(0,R),v.fill(0,R)),{selectedIndices:It(p,"int32"),selectedScores:It(v,"float32"),numValidOutputs:ge(R,"int32")}}function LA(r,t,e){var n=r.subarray(4*t,4*t+4),a=r.subarray(4*e,4*e+4),o=Math.min(n[0],n[2]),s=Math.min(n[1],n[3]),l=Math.max(n[0],n[2]),f=Math.max(n[1],n[3]),h=Math.min(a[0],a[2]),p=Math.min(a[1],a[3]),v=Math.max(a[0],a[2]),m=Math.max(a[1],a[3]),y=(l-o)*(f-s),x=(v-h)*(m-p);if(y<=0||x<=0)return 0;var E=Math.max(o,h),w=Math.max(s,p),C=Math.min(l,v),_=Math.min(f,m),R=Math.max(C-E,0)*Math.max(_-w,0);return R/(y+x-R)}function zA(r,t,e){var n=Math.exp(t*e*e);return e<=r?n:0}function _b(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}function Ox(r,t,e){var n=new Array(r.rank).fill(0),a=r.shape.slice();return t.map((function(o){a[e]=o;var s=r.slice(n,a);return n[e]+=o,s}))}function Mx(r,t){for(var e=new Array(r.rank),n=0;n<e.length;n++)e[n]=r.shape[n]*t[n];var a=Le(e,r.dtype);for(n=0;n<a.values.length;++n){for(var o=a.indexToLoc(n),s=new Array(r.rank),l=0;l<s.length;l++)s[l]=o[l]%r.shape[l];var f=r.locToIndex(s);a.values[n]=r.values[f]}return a.toTensor()}function kx(r,t,e,n,a){for(var o=t[t.length-1],s=[r.length/o,o],l=s[0],f=s[1],h=ns(e,l*n),p=ns("int32",l*n),v=0;v<l;v++){for(var m=v*f,y=r.subarray(m,m+f),x=[],E=0;E<y.length;E++)x.push({value:y[E],index:E});x.sort((function(A,T){return T.value-A.value}));var w=v*n,C=h.subarray(w,w+n),_=p.subarray(w,w+n);for(E=0;E<n;E++)C[E]=x[E].value,_[E]=x[E].index}var R=t.slice();return R[R.length-1]=n,[nn(h,R,e),nn(p,R,"int32")]}function tv(r,t){for(var e=[],n=0;n<t.length;n++)t[n]&&e.push(n);var a=Le(r,"int32"),o=Le([e.length,r.length],"int32");for(n=0;n<e.length;n++){var s=a.indexToLoc(e[n]),l=n*r.length;o.values.set(s,l)}return o.toTensor()}var UA=function(r,t){this.outputShape=[],this.outputShape=r,this.variableNames=t.map((function(a,o){return"T"+o}));var e=[];this.variableNames.forEach((function(a){e.push("float v"+a+" = get"+a+"AtOutCoords();")}));var n=this.variableNames.map((function(a){return"v"+a})).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        float result = `+n+`;
        setOutput(result);
      }
    `},PA=function(r,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.variableNames=t.map((function(a,o){return"T"+o}));var e=[];this.variableNames.forEach((function(a){e.push("vec4 v"+a+" = get"+a+"AtOutCoords();")}));var n=this.variableNames.map((function(a){return"v"+a})).join(" + ");this.userCode=`
      void main() {
        `+e.join(`
        `)+`

        vec4 result = `+n+`;
        setOutput(result);
      }
    `},HA=function(r,t,e){this.variableNames=["A"];var n=r.windowSize,a=r.batchSize,o=r.inSize,s=Math.ceil(o/n);e||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];var l=t==="max"?">":"<",f=e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+n+`; i++) {
          int inIdx = `+f+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+l+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function Ix(r,t){return["x","y","z","w","u","v"].slice(0,t).map((function(e){return r+"."+e}))}function Sn(r,t){return t===1?[r]:Ix(r,t)}function un(){var r,t,e,n,a,o,s,l,f,h;return ce().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",e="out",n="in",a="texture",o="outputColor",s="out vec4 outputColor;",l=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,f="",h=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",e="varying",n="varying",a="texture2D",o="gl_FragColor",s="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,f=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,h=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:e,varyingFs:n,texture2D:a,output:o,defineOutput:s,defineSpecialNaN:l,defineSpecialInf:f,defineRound:h}}function Ri(r,t,e){e===void 0&&(e="index");var n=Br(t);return n.map((function(a,o){return"int "+r[o]+" = "+e+" / "+a+"; "+(o===n.length-1?"int "+r[o+1]+" = "+e+" - "+r[o]+" * "+a:"index -= "+r[o]+" * "+a)+";"})).join("")}function nv(r){var t=Br(r).map((function(e){return e.toString()}));return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var Bx=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function VA(r,t,e,n){var a=[];r.forEach((function(y){var x=Se(y.shapeInfo.logicalShape);y.shapeInfo.isUniform?a.push("uniform float "+y.name+(x>1?"["+x+"]":"")+";"):(a.push("uniform sampler2D "+y.name+";"),a.push("uniform int offset"+y.name+";"))}));var o,s,l=a.join(`
`),f=r.map((function(y){return(function(x,E,w){w===void 0&&(w=!1);var C="";C+=w?Fx(x):No(x);var _=x.shapeInfo.logicalShape,R=E.logicalShape;return _.length<=R.length&&(C+=w?(function(A,T){var N,M=A.name,I=M.charAt(0).toUpperCase()+M.slice(1),k="get"+I+"AtOutCoords",F=A.shapeInfo.logicalShape.length,W=T.logicalShape.length,P=Ka(A.shapeInfo.logicalShape,T.logicalShape),oe=dt(W),ee=W-F,ae=["x","y","z","w","u","v"];N=F===0?"":W<2&&P.length>=1?"coords = 0;":P.map((function(q){return"coords."+ae[q+ee]+" = 0;"})).join(`
`);var z="";z=W<2&&F>0?"coords":A.shapeInfo.logicalShape.map((function(q,ue){return"coords."+ae[ue+ee]})).join(", ");var G="return outputValue;",K=Se(A.shapeInfo.logicalShape)===1,ie=Se(T.logicalShape)===1;if(F!==1||K||ie){if(K&&!ie)G=W===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(P.length){var se=F-2,L=F-1;P.indexOf(se)>-1&&P.indexOf(L)>-1?G="return vec4(outputValue.x);":P.indexOf(se)>-1?G="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":P.indexOf(L)>-1&&(G="return vec4(outputValue.xx, outputValue.zz);")}}else G=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+k+`() {
      `+oe+` coords = getOutputCoords();
      `+N+`
      vec4 outputValue = get`+I+"("+z+`);
      `+G+`
    }
  `})(x,E):(function(A,T){var N=A.name,M=N.charAt(0).toUpperCase()+N.slice(1),I="get"+M+"AtOutCoords",k=T.texShape,F=A.shapeInfo.texShape,W=A.shapeInfo.logicalShape.length,P=T.logicalShape.length;if(!A.shapeInfo.isUniform&&W===P&&A.shapeInfo.flatOffset==null&&Gt(F,k))return`
      float `+I+`() {
        return sampleTexture(`+N+`, resultUV);
      }
    `;var oe,ee=dt(P),ae=Ka(A.shapeInfo.logicalShape,T.logicalShape),z=P-W,G=["x","y","z","w","u","v"];oe=W===0?"":P<2&&ae.length>=1?"coords = 0;":ae.map((function(ie){return"coords."+G[ie+z]+" = 0;"})).join(`
`);var K="";return K=P<2&&W>0?"coords":A.shapeInfo.logicalShape.map((function(ie,se){return"coords."+G[se+z]})).join(", "),`
    float `+I+`() {
      `+ee+` coords = getOutputCoords();
      `+oe+`
      return get`+M+"("+K+`);
    }
  `})(x,E)),C})(y,t,n)})).join(`
`),h=t.texShape,p=un(),v=(function(y){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+y.texture2D+`(textureSampler, uv).r;
    }
  `})(p),m=(function(y){return y.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+y.varyingFs+` vec2 resultUV;
    `+y.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+y.defineSpecialNaN+`
    `+y.defineSpecialInf+`
    `+y.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+WA+`
    `+jA+`
    `+GA+`
  `})(p);return t.isPacked?(o=(function(y,x){switch(y.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(A,T){var N=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)];return N[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+N[1]+`.0);
      }
    `:N[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+N[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+N[0]+", "+N[1]+`));
      return 2 * (resTexRC.x * `+N[1]+` + resTexRC.y);
    }
  `})(0,x);case 2:return(function(A,T){var N=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)];if(Gt(A,T))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+N[0]+", "+N[1]+`));
      }
    `;var M=Math.ceil(A[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+N[0]+", "+N[1]+`));

      int index = resTexRC.x * `+N[1]+` + resTexRC.y;
      int r = 2 * (index / `+M+`);
      int c = imod(index, `+M+`) * 2;

      return ivec2(r, c);
    }
  `})(y,x);case 3:return E=y,w=x,C=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],_=Math.ceil(E[2]/2),R=_*Math.ceil(E[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      int b = index / `+R+`;
      index -= b * `+R+`;

      int r = 2 * (index / `+_+`);
      int c = imod(index, `+_+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return(function(A,T){for(var N=[Math.ceil(T[0]/2),Math.ceil(T[1]/2)],M=Math.ceil(A[A.length-1]/2),I=M*Math.ceil(A[A.length-2]/2),k=I,F="",W="b, r, c",P=2;P<A.length-1;P++)k*=A[A.length-P-1],F=`
      int b`+P+" = index / "+k+`;
      index -= b`+P+" * "+k+`;
    `+F,W="b"+P+", "+W;return`
    ivec`+A.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+N[0]+", "+N[1]+`));
      int index = resTexRC.x * `+N[1]+` + resTexRC.y;

      `+F+`

      int b = index / `+I+`;
      index -= b * `+I+`;

      int r = 2 * (index / `+M+`);
      int c = imod(index, `+M+`) * 2;

      return ivec`+A.length+"("+W+`);
    }
  `})(y,x)}var E,w,C,_,R})(t.logicalShape,h),s=(function(y){return`
    void setOutput(vec4 val) {
      `+y.output+` = val;
    }
  `})(p)):(o=(function(y,x){switch(y.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return(function(C,_){return _[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+_[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return resTexRC.x * `+_[1]+` + resTexRC.y;
    }
  `})(0,x);case 2:return(function(C,_){return Gt(C,_)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `:C[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:C[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = index / `+C[1]+`;
      int c = index - r * `+C[1]+`;
      return ivec2(r, c);
    }
  `})(y,x);case 3:return E=x,w=Ri(["r","c","d"],y),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+E[0]+", "+E[1]+`));
      int index = resTexRC.x * `+E[1]+` + resTexRC.y;
      `+w+`
      return ivec3(r, c, d);
    }
  `;case 4:return(function(C,_){var R=Ri(["r","c","d","d2"],C);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      `+R+`
      return ivec4(r, c, d, d2);
    }
  `})(y,x);case 5:return(function(C,_){var R=Ri(["r","c","d","d2","d3"],C);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+_[0]+`,
                             `+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+R+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `})(y,x);case 6:return(function(C,_){var R=Ri(["r","c","d","d2","d3","d4"],C);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+R+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `})(y,x);default:throw new Error(y.length+"-D output sampling is not yet supported")}var E,w})(t.logicalShape,h),s=(function(y){return`
    void setOutput(float val) {
      `+y.output+` = vec4(val, 0, 0, 0);
    }
  `})(p)),n&&(m+=qA),[m,v,s,l,o,f,e].join(`
`)}function No(r){var t=r.shapeInfo.logicalShape;switch(t.length){case 0:return(function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float "+a+"() {return "+n+";}";var o=e.shapeInfo.texShape,s=o[0],l=o[1];if(s===1&&l===1)return`
      float `+a+`() {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var f=e.shapeInfo.texShape,h=f[0],p=f[1],v=Ei(n);return`
    float `+a+`() {
      vec2 uv = uvFromFlat(`+h+", "+p+", "+v+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(r);case 1:return(function(e){var n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float `+a+`(int index) {
        `+Ro(e)+`
      }
    `;var o=e.shapeInfo.texShape,s=o[0],l=o[1];if(l===1&&s===1)return`
      float `+a+`(int index) {
        return sampleTexture(`+n+`, halfCR);
      }
    `;var f=Ei(n);return l===1?`
      float `+a+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+f+") + 0.5) / "+s+`.0);
        return sampleTexture(`+n+`, uv);
      }
    `:s===1?`
      float `+a+`(int index) {
        vec2 uv = vec2((float(index + `+f+") + 0.5) / "+l+`.0, 0.5);
        return sampleTexture(`+n+`, uv);
      }
    `:`
    float `+a+`(int index) {
      vec2 uv = uvFromFlat(`+s+", "+l+", index + "+f+`);
      return sampleTexture(`+n+`, uv);
    }
  `})(r);case 2:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=e.shapeInfo.texShape;if(s!=null&&Gt(n,s)){var l=s[0],f=s[1];return`
    float `+o+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+f+".0, "+l+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `}var h=Si(n),p=h.newShape,v=h.keptDims,m=p;if(m.length<n.length){var y=Oo(e,m);return`
      `+No(y)+`
      float `+o+`(int row, int col) {
        return `+o+"("+Mo(["row","col"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+n[1]+`, 1)));
        `+Ro(e)+`
      }
    `;var x=s[0],E=s[1],w=Ei(a);return E===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+x+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `:x===1?`
    float `+o+`(int row, int col) {
      float index = dot(vec3(row, col, `+w+"), vec3("+n[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+E+`.0, 0.5);
      return sampleTexture(`+a+`, uv);
    }
  `:`
  float `+o+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+n[1]+" + col + "+w+`;
    vec2 uv = uvFromFlat(`+x+", "+E+`, index);
    return sampleTexture(`+a+`, uv);
  }
`})(r);case 3:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[1]*n[2],l=n[2],f=Si(n),h=f.newShape,p=f.keptDims,v=h;if(v.length<n.length){var m=Oo(e,v);return`
        `+No(m)+`
        float `+o+`(int row, int col, int depth) {
          return `+o+"("+Mo(["row","col","depth"],p)+`);
        }
      `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+s+", "+l+`, 1)));
        `+Ro(e)+`
      }
    `;var y=e.shapeInfo.texShape,x=y[0],E=y[1],w=e.shapeInfo.flatOffset;if(E===s&&w==null)return`
        float `+o+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+l+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+E+".0, "+x+`.0);
          return sampleTexture(`+a+`, uv);
        }
      `;if(E===l&&w==null)return`
    float `+o+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+n[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+E+".0, "+x+`.0);
      return sampleTexture(`+a+`, uv);
    }
  `;var C=Ei(a);return`
      float `+o+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+s+" + col * "+l+" + depth + "+C+`;
        vec2 uv = uvFromFlat(`+x+", "+E+`, index);
        return sampleTexture(`+a+`, uv);
      }
  `})(r);case 4:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[3],l=n[2]*s,f=n[1]*l,h=Si(n),p=h.newShape,v=h.keptDims;if(p.length<n.length){var m=Oo(e,p);return`
      `+No(m)+`
      float `+o+`(int row, int col, int depth, int depth2) {
        return `+o+"("+Mo(["row","col","depth","depth2"],v)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+f+", "+l+", "+s+`, 1)));
        `+Ro(e)+`
      }
    `;var y=e.shapeInfo.flatOffset,x=e.shapeInfo.texShape,E=x[0],w=x[1];if(w===f&&y==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+w+".0, "+E+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(w===s&&y==null)return`
      float `+o+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+n[1]*n[2]+", "+n[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+w+".0, "+E+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var C=Ei(a);return`
    float `+o+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+f+" + col * "+l+` +
          depth * `+s+` + depth2;
      vec2 uv = uvFromFlat(`+E+", "+w+", index + "+C+`);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);case 5:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=n[4],l=n[3]*s,f=n[2]*l,h=n[1]*f,p=Si(n),v=p.newShape,m=p.keptDims;if(v.length<n.length){var y=Oo(e,v);return`
      `+No(y)+`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        return `+o+"("+Mo(["row","col","depth","depth2","depth3"],m)+`);
      }
    `}if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+h+", "+f+", "+l+", "+s+`)) +
          depth3;
        `+Ro(e)+`
      }
    `;var x=e.shapeInfo.flatOffset,E=e.shapeInfo.texShape,w=E[0],C=E[1];if(C===h&&x==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+f+", "+l+", "+s+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+C+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(C===s&&x==null)return`
      float `+o+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]+`,
               `+n[2]*n[3]+", "+n[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+C+".0, "+w+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var _=Ei(a);return`
    float `+o+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+h+" + col * "+f+" + depth * "+l+` +
          depth2 * `+s+" + depth3 + "+_+`;
      vec2 uv = uvFromFlat(`+w+", "+C+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);case 6:return(function(e){var n=e.shapeInfo.logicalShape,a=e.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=Si(n),l=s.newShape,f=s.keptDims;if(l.length<n.length){var h=Oo(e,l);return`
      `+No(h)+`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+o+"("+Mo(["row","col","depth","depth2","depth3","depth4"],f)+`);
      }
    `}var p=n[5],v=n[4]*p,m=n[3]*v,y=n[2]*m,x=n[1]*y;if(e.shapeInfo.isUniform)return`
      float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+x+", "+y+", "+m+", "+v+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+p+`, 1)));
        `+Ro(e)+`
      }
    `;var E=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,C=w[0],_=w[1];if(_===x&&E==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+y+", "+m+", "+v+", "+p+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+_+".0, "+C+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;if(_===p&&E==null)return`
      float `+o+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+n[1]*n[2]*n[3]*n[4]+`,
               `+n[2]*n[3]*n[4]+`,
               `+n[3]*n[4]+`,
               `+n[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+_+".0, "+C+`.0);
        return sampleTexture(`+a+`, uv);
      }
    `;var R=Ei(a);return`
    float `+o+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+x+" + col * "+y+" + depth * "+m+` +
          depth2 * `+v+" + depth3 * "+p+" + depth4 + "+R+`;
      vec2 uv = uvFromFlat(`+C+", "+_+`, index);
      return sampleTexture(`+a+`, uv);
    }
  `})(r);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Fx(r){var t,e,n;switch(r.shapeInfo.logicalShape.length){case 0:return t=r.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),n=un(),`
    vec4 `+e+`() {
      return `+n.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return(function(a){var o=a.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),l=a.shapeInfo.texShape,f=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],h=un();return`
    vec4 `+s+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+f[0]+", "+f[1]+`, index);
      return `+h.texture2D+"("+o+`, uv);
    }
  `})(r);case 2:return(function(a){var o=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),f=a.shapeInfo.texShape,h=f[0],p=f[1],v=un();if(f!=null&&Gt(o,f))return`
      vec4 `+l+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+p+".0, "+h+`.0);

        return `+v.texture2D+"("+s+`, uv);
      }
    `;var m=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)],y=Math.ceil(o[1]/2);return`
    vec4 `+l+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+y+", "+m[0]+", "+m[1]+`, row, col);
      return `+v.texture2D+"("+s+`, uv);
    }
  `})(r);case 3:return(function(a){var o=a.shapeInfo.logicalShape,s=a.name,l="get"+s.charAt(0).toUpperCase()+s.slice(1),f=a.shapeInfo.texShape,h=[Math.ceil(f[0]/2),Math.ceil(f[1]/2)];if(o[0]===1){var p=o.slice(1),v=Oo(a,p);return`
        `+Fx(v)+`
        vec4 `+l+`(int b, int row, int col) {
          return `+l+"("+Mo(["b","row","col"],[1,2])+`);
        }
      `}var m=h[0],y=h[1],x=Math.ceil(o[2]/2),E=x*Math.ceil(o[1]/2),w=un();return`
    vec4 `+l+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+m+", "+y+", "+E+", "+x+`, b, row, col);
      return `+w.texture2D+"("+s+`, uv);
    }
  `})(r);default:return(function(a){for(var o=a.shapeInfo.logicalShape,s=o.length,l=a.name,f="get"+l.charAt(0).toUpperCase()+l.slice(1),h=a.shapeInfo.texShape,p=[Math.ceil(h[0]/2),Math.ceil(h[1]/2)],v=p[0],m=p[1],y=Math.ceil(o[s-1]/2),x=y*Math.ceil(o[s-2]/2),E="int b, int row, int col",w="b * "+x+" + (row / 2) * "+y+" + (col / 2)",C=2;C<s-1;C++)E="int b"+C+", "+E,x*=o[s-C-1],w="b"+C+" * "+x+" + "+w;var _=un();return`
    vec4 `+f+"("+E+`) {
      int index = `+w+`;
      int texR = index / `+m+`;
      int texC = index - texR * `+m+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+", "+v+`);
      return `+_.texture2D+"("+l+`, uv);
    }
  `})(r)}}var WA=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jA=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,GA=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qA=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Ei(r){return"offset"+r}function Ro(r){var t=r.name,e=Se(r.shapeInfo.logicalShape);return e<2?"return "+t+";":`
    for (int i = 0; i < `+e+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function dt(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error("GPU for rank "+r+" is not yet supported")}function Oo(r,t){var e=JSON.parse(JSON.stringify(r));return e.shapeInfo.logicalShape=t,e}function Mo(r,t){return t.map((function(e){return r[e]})).join(", ")}var XA=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(r.length>2,(function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."}));var a=r[r.length-1],o=Math.ceil(a/t);this.outputShape=r.slice(0,-1),o>1&&this.outputShape.push(o),n||this.variableNames.push("bestIndicesA");var s,l,f=this.outputShape,h=f.length,p=dt(h),v=Sn("coords",h);if(o===1){var m=dt(l=h+1);s=`
        `+m+" sourceLocR = "+m+"("+v.join()+`, 0);
        ++`+v[h-1]+`;
        `+m+" sourceLocG = "+m+"("+v.join()+`, 0);
        ++`+v[h-2]+`;
        `+m+" sourceLocA = "+m+"("+v.join()+`, 0);
        --`+v[h-1]+`;
        `+m+" sourceLocB = "+m+"("+v.join()+`, 0);
        --`+v[h-2]+";"}else l=h,s=`
        `+p+` sourceLocR = coords;
        ++`+v[h-1]+`;
        `+p+` sourceLocG = coords;
        ++`+v[h-2]+`;
        `+p+` sourceLocA = coords;
        --`+v[h-1]+`;
        `+p+` sourceLocB = coords;
        --`+v[h-2]+";";var y=["x","y","z","w","u","v"].slice(0,l),x="."+y[l-1],E=y.map((function(I){return"int "+I})),w=Sn("sourceLocR",l-1).concat("inIdx.r"),C=Sn("sourceLocG",l-1).concat("inIdx.g"),_=Sn("sourceLocB",l-1).concat("inIdx.b"),R=Sn("sourceLocA",l-1).concat("inIdx.a"),A=e==="max"?"greaterThan":"lessThan",T=n?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+w.join()+`),
                             getBestIndicesAChannel(`+C.join()+`),
                             getBestIndicesAChannel(`+_.join()+`),
                             getBestIndicesAChannel(`+R.join()+")));",N=`vec4(
            getAChannel(`+w.join()+`),
            hasNextCol ? getAChannel(`+C.join()+`) : 0.,
            hasNextRow ? getAChannel(`+_.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+R.join()+") : 0.)",M=n?"":`
      float getBestIndicesAChannel(`+E.join()+`) {
        return getChannel(getBestIndicesA(`+y.join()+`),
                                          vec2(`+y.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+E.join()+`) {
        return getChannel(getA(`+y.join()+`),
                               vec2(`+y.slice(-2).join()+`));
      }
      `+M+`
      void main() {
        `+p+` coords = getOutputCoords();
        bool hasNextCol = `+v[h-1]+" < "+(f[h-1]-1)+`;
        bool hasNextRow = `+v[h-2]+" < "+(f[h-2]-1)+`;
        `+s+`
        ivec4 srcIdx = ivec4(sourceLocR`+x+", sourceLocG"+x+`,
          sourceLocB`+x+", sourceLocA"+x+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+N+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+T+`
          vec4 candidate = `+N+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+A+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},KA=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,o=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterHeight,f=r.effectiveFilterWidth,h=l-1-r.padInfo.top,p=f-1-r.padInfo.left,v=1/(t*e);this.userCode=`
      const ivec2 pads = ivec2(`+h+", "+p+`);
      const float avgMultiplier = float(`+v+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+l+`;
            wR += `+o+`) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+f+`;
            wC+= `+s+`) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},YA=function(r){this.variableNames=["dy"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,f=r.dilationHeight,h=r.dilationWidth,p=r.effectiveFilterDepth,v=r.effectiveFilterHeight,m=r.effectiveFilterWidth,y=p-1-r.padInfo.front,x=v-1-r.padInfo.top,E=m-1-r.padInfo.left,w=1/(t*e*n);this.userCode=`
      const ivec3 pads = ivec3(`+y+", "+x+", "+E+`);
      const float avgMultiplier = float(`+w+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+p+`;
            wD += `+l+`) {
          float dyD = float(dyDCorner + wD) / `+a+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+v+`;
              wR += `+f+`) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+m+`;
                wC += `+h+`) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},QA=function(r,t,e,n,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Ge(r,t),Ge(r,e);var s="0.0";n!=null&&(Ge(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="1.0";a!=null&&(Ge(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+s+`;
        float scale = `+l+`;
        float inv = scale * inversesqrt(variance + float(`+o+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},ZA=function(r,t,e,n,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ge(r,t),Ge(r,e);var s="vec4(0.0)";n!=null&&(Ge(r,n),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var l="vec4(1.0)";a!=null&&(Ge(r,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=r,this.userCode=`
      void main() {
        vec4 offset = `+s+`;
        vec4 scale = `+l+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+o+`));

        setOutput((x - mean) * inv + offset);
      }
    `},JA="return areal * breal - aimag * bimag;",$A="return areal * bimag + aimag * breal;",Sb=function(r,t,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ge(t,e),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+r+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Vd="return a + b;",Wd="return a - b;",Rb="return a * b;",Lx="return (a < 0.) ? b * a : a;",_t=function(r,t,e){this.variableNames=["A","B"],this.outputShape=Ge(t,e),this.userCode=`
      float binaryOperation(float a, float b) {
        `+r+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},zx=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,fa=function(r,t,e,n){n===void 0&&(n=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ge(t,e);var a=this.outputShape.length,o="";if(n)if(a===0||Se(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          `+dt(a)+` coords = getOutputCoords();
        `,a===1)o+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var s=Sn("coords",a);o+=`
            bool nextRowOutOfBounds =
              (`+s[a-2]+" + 1) >= "+this.outputShape[a-2]+`;
            bool nextColOutOfBounds =
              (`+s[a-1]+" + 1) >= "+this.outputShape[a-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+r+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+o+`

        setOutput(result);
      }
    `},eT=(function(){function r(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,o){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(o,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r})(),tT=(function(){function r(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return r.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(a,o){n.minLoc==null&&(n.minLoc=a.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=a.getUniformLocationNoThrow(o,"maxVal")),a.gl.uniform1f(n.minLoc,t),a.gl.uniform1f(n.maxLoc,e)}},r})(),nT=function(r){this.variableNames=["real","imag"],this.outputShape=r,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},rT=function(r){this.outputShape=[],this.outputShape=jo(r,1),this.variableNames=r.map((function(l,f){return"T"+f}));var t=new Array(r.length-1);t[0]=r[0][1];for(var e=1;e<t.length;e++)t[e]=t[e-1]+r[e][1];var n=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<t.length;e++){var a=t[e-1];n.push("else if (yC < "+t[e]+") setOutput(getT"+e+"(yR, yC-"+a+"));")}var o=t.length,s=t[t.length-1];n.push("else setOutput(getT"+o+"(yR, yC-"+s+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+n.join(`
        `)+`
      }
    `},aT=function(r,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=jo(r,t);var e=this.outputShape,n=e.length,a=dt(n),o=Sn("coords",n),s=["x","y","z","w","u","v"].slice(0,n);this.variableNames=r.map((function(w,C){return"T"+C}));var l=new Array(r.length-1);l[0]=r[0][t];for(var f=1;f<l.length;f++)l[f]=l[f-1]+r[f][t];var h=s[t],p=s.slice(-2),v=s.join(),m="if ("+h+" < "+l[0]+`) {
        return getChannel(
            getT0(`+v+"), vec2("+p.join()+`));
        }`;for(f=1;f<l.length;f++){var y=l[f-1];m+=`
        if (`+h+" < "+l[f]+"  && "+h+" >= "+l[f-1]+`) {
          return getChannel(
            getT`+f+"("+Yl(s,h,y)+`),
            vec2(`+Yl(p,h,y)+`));
        }`}var x=l.length,E=l[l.length-1];m+=`
        return getChannel(
          getT`+x+"("+Yl(s,h,E)+`),
          vec2(`+Yl(p,h,E)+"));",this.userCode=`
      float getValue(`+s.map((function(w){return"int "+w}))+`) {
        `+m+`
      }

      void main() {
        `+a+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+o+`), 0., 0., 0.);

        `+o[n-1]+" = "+o[n-1]+` + 1;
        if (`+o[n-1]+" < "+e[n-1]+`) {
          result.g = getValue(`+o+`);
        }

        `+o[n-2]+" = "+o[n-2]+` + 1;
        if (`+o[n-2]+" < "+e[n-2]+`) {
          result.a = getValue(`+o+`);
        }

        `+o[n-1]+" = "+o[n-1]+` - 1;
        if (`+o[n-2]+" < "+e[n-2]+` &&
            `+o[n-1]+" < "+e[n-1]+`) {
          result.b = getValue(`+o+`);
        }
        setOutput(result);
      }
    `};function Yl(r,t,e){var n=r.indexOf(t);return r.map((function(a,o){return o===n?a+" - "+e:a})).join()}var iT=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,o=r.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              if (`+o+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},oT=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,o=r.dataFormat==="channelsLast",s=t-1-r.padInfo.top,l=e-1-r.padInfo.left,f=o?1:2,h=o?2:3,p=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+p+`];

        ivec2 dyCorner = ivec2(coords[`+f+"], coords["+h+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {

              if (`+o+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},uT=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.padInfo.front,o=r.padInfo.top,s=r.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yF = 0; yF < `+r.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+a+`;

            if (xF < 0 || xF >= `+r.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+r.outHeight+`; yR++) {
              int xR = wR + yR * `+e+" - "+o+`;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+r.outWidth+`; yC++) {
                int xC = wC + yC * `+n+" - "+s+`;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},sT=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterDepth,e=r.filterHeight,n=r.filterWidth,a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=t-1-r.padInfo.front,f=e-1-r.padInfo.top,h=n-1-r.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+l+", "+f+", "+h+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+a+`.0;

          if (dyF < 0.0 || dyF >= `+r.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+e+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+o+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+e+` - 1 - wR;

            for (int wC = 0; wC < `+n+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+s+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+n+` - 1 - wC;

              for (int d2 = 0; d2 < `+r.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},lT=function(r){this.variableNames=["x","dy"],this.outputShape=r.filterShape;var t=r.strideHeight,e=r.strideWidth,n=r.padInfo.top,a=r.padInfo.left,o=r.outChannels/r.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+o+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+r.batchSize+`; b++) {
          for (int yR = 0; yR < `+r.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+n+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+r.outWidth+`; yC++) {
              int xC = wC + yC * `+e+" - "+a+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},cT=function(r){this.variableNames=["dy","W"],this.outputShape=r.inShape;var t=r.filterHeight,e=r.filterWidth,n=r.strideHeight,a=r.strideWidth,o=t-1-r.padInfo.top,s=e-1-r.padInfo.left,l=r.outChannels/r.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+n+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+e+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+a+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+e+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+l+`; dm++) {
              int d2 = d1 * `+l+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Ab=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.padInfo.top,o=r.padInfo.left,s=r.strideHeight,l=r.strideWidth,f=r.dilationHeight,h=r.dilationWidth,p=r.filterHeight,v=r.filterWidth,m=4*Math.floor(r.inChannels/4),y=r.inChannels%4,x=r.dataFormat==="channelsLast",E=x?1:2,w=x?2:3,C=x?3:1,_="",R="";e&&(_=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,R="result = activation(result);");var A=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+_+`

      const ivec2 strides = ivec2(`+s+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+C+`];

        ivec2 xRCCorner =
            ivec2(coords[`+E+"], coords["+w+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+p+`; wR++) {
          int xR = xRCorner + wR * `+f+`;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC++) {
            int xC = xCCorner + wC * `+h+`;

            if (xC < 0 || xC >= `+r.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+m+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+x+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(y===1)+`) {

              if (`+x+`) {
                dotProd +=
                    getX(batch, xR, xC, `+m+`) *
                    getW(wR, wC, `+m+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+m+`, xR, xC) *
                    getW(wR, wC, `+m+`, d2);
              }

            } else if (`+(y===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2)
              );

              if (`+x+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(y===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+m+`, d2),
                getW(wR, wC, `+m+` + 1, d2),
                getW(wR, wC, `+m+` + 2, d2)
              );

              if (`+x+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+m+`),
                  getX(batch, xR, xC, `+m+` + 1),
                  getX(batch, xR, xC, `+m+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+m+`, xR, xC),
                  getX(batch, `+m+` + 1, xR, xC),
                  getX(batch, `+m+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+A+`
        `+R+`
        setOutput(result);
      }
    `},fT=function(r){this.variableNames=["x","W"],this.outputShape=r.outShape;var t=r.padInfo.front,e=r.padInfo.top,n=r.padInfo.left,a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,f=r.dilationHeight,h=r.dilationWidth,p=r.filterDepth,v=r.filterHeight,m=r.filterWidth,y=4*Math.floor(r.inChannels/4),x=r.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+a+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+t+", "+e+", "+n+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+p+`; wF++) {
          int xF = xFCorner + wF * `+l+`;

          if (xF < 0 || xF >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`; wR++) {
            int xR = xRCorner + wR * `+f+`;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+m+`; wC++) {
              int xC = xCCorner + wC * `+h+`;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+y+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(x===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+y+`) *
                  getW(wF, wR, wC, `+y+`, d2);
              } else if (`+(x===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+y+`),
                  getX(batch, xF, xR, xC, `+y+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+y+`, d2),
                  getW(wF, wR, wC, `+y+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(x===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+y+`),
                  getX(batch, xF, xR, xC, `+y+` + 1),
                  getX(batch, xF, xR, xC, `+y+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+y+`, d2),
                  getW(wF, wR, wC, `+y+` + 1, d2),
                  getW(wF, wR, wC, `+y+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Tb=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.outputShape=r.outShape;var a=r.inHeight,o=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,f=r.strideHeight,h=r.strideWidth,p=r.dilationHeight,v=r.dilationWidth,m=r.filterHeight,y=r.filterWidth,x=r.outChannels/r.inChannels,E="",w="";e&&(E=n?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`
          float activation(float x) {
            `+e+`
          }
        `,w="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+E+`

      const ivec2 strides = ivec2(`+f+", "+h+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+x+`;
        int q = d2 - d1 * `+x+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+m+`; wR++) {
          int xR = xRCorner + wR * `+p+`;

          if (xR < 0 || xR >= `+a+`) {
            continue;
          }

          for (int wC = 0; wC < `+y+`; wC++) {
            int xC = xCCorner + wC * `+v+`;

            if (xC < 0 || xC >= `+o+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+C+`
        `+w+`
        setOutput(result);
      }
    `},Db=function(r,t,e,n){t===void 0&&(t=!1),e===void 0&&(e=null),n===void 0&&(n=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r.outShape;for(var a=r.inHeight,o=r.inWidth,s=r.padInfo.top,l=r.padInfo.left,f=r.strideHeight,h=r.strideWidth,p=r.dilationHeight,v=r.dilationWidth,m=r.filterHeight,y=r.filterWidth,x=y,E="int xR; int xC; int xCOffset;",w=0;w<m;w++)for(var C=0;C<y;C++)E+=`
          vec4 xTexelR`+w+"C"+2*C+` = vec4(0.);
          vec4 wR`+w+"C"+C+` = vec4(0.);
          vec4 xR`+w+"C"+C+" = vec4(0.);";for(w=0;w<m;w++)for(var _=0;_<x;_++){if(E+=`
          xR = xRCorner + `+w*p+`;
          xC = xCCorner + `+(C=2*_)*v+`;
        `,h===1){if(C<y&&(E+=l%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  xTexelR`+w+"C"+C+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    xTexelR`+w+"C"+C+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+w+"C"+C+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+a+" && xCOffset >= 0 && xCOffset < "+o+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+o+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+w+"C"+C+" = vec4(previous.zw, xTexelR"+w+"C"+C+`.xy);
                } else {
                  xR`+w+"C"+C+" = vec4(0, 0, xTexelR"+w+"C"+C+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+a+" && xC >= 0 && xC < "+o+`) {
                  xTexelR`+w+"C"+C+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+C+` = vec4(0.);
                }

                xR`+w+"C"+C+" = xTexelR"+w+"C"+C+`;
              `,C+1<y)){var R=l%2==0?nx(v):v;v%2==0&&l%2==1||v%2!=0&&l%2!=1?(E+=`
                  xCOffset = xC + `+l%2+" + "+R+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+w+"C"+(C+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,v>1&&(E+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+a+` &&
                      xCOffset >= 0 && xCOffset < `+o+`) {
                      xTexelR`+w+"C"+C+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+w+"C"+C+` = vec4(0.);
                    }
                  `),E+=`
                  xR`+w+"C"+(C+1)+` = vec4(
                    xTexelR`+w+"C"+C+".zw, xTexelR"+w+"C"+(C+2)+`.xy);
                `):E+=`
                  xCOffset = xC + `+R+`;

                  if(xR >= 0 && xR < `+a+` &&
                    xCOffset >= 0 && xCOffset < `+o+`) {
                    xTexelR`+w+"C"+(C+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+w+"C"+(C+1)+" = xTexelR"+w+"C"+(C+2)+`;
                `}}else C<y&&(E+=`
              if(xR >= 0 && xR < `+a+`) {
            `,l%2==1?(E+=`
                xCOffset = xC + 1 - `+h+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+w+"C"+C+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+C+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+o+`) {
                  xTexelR`+w+"C"+(C+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+w+"C"+(C+2)+` = vec4(0.);
                }

                xR`+w+"C"+C+` = vec4(
                  xTexelR`+w+"C"+C+".zw, xTexelR"+w+"C"+(C+2)+`.zw);
              `,C+1<y&&(E+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+h+`;
                  if(xCOffset >= 0 && xCOffset < `+o+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+w+"C"+(C+1)+" = vec4(xTexelR"+w+"C"+(C+2)+`.xy, final.xy);
                `)):(E+=`
                if(xC >= 0 && xC < `+o+`) {
                  xTexelR`+w+"C"+C+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+w+"C"+C+` = vec4(0.);
                }

                xCOffset = xC + `+h+`;
                if(xCOffset >= 0 && xCOffset < `+o+`) {
                  xTexelR`+w+"C"+(C+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+w+"C"+(C+2)+` = vec4(0.);
                }

                xR`+w+"C"+C+` = vec4(
                  xTexelR`+w+"C"+C+".xy, xTexelR"+w+"C"+(C+2)+`.xy);
              `,C+1<y&&(E+=`
                  xR`+w+"C"+(C+1)+` = vec4(
                    xTexelR`+w+"C"+C+".zw, xTexelR"+w+"C"+(C+2)+`.zw);
                `)),E+="}");C<y&&(E+=`
            vec4 wTexelR`+w+"C"+C+" = getW("+w+", "+C+`, d1, q);
            wR`+w+"C"+C+" = vec4(wTexelR"+w+"C"+C+".xz, wTexelR"+w+"C"+C+`.xz);
          `,C+1<y&&(E+=`
              vec4 wTexelR`+w+"C"+(C+1)+" = getW("+w+", "+(C+1)+`, d1, q);
              wR`+w+"C"+(C+1)+` =
                vec4(wTexelR`+w+"C"+(C+1)+".xz, wTexelR"+w+"C"+(C+1)+".xz);"))}for(w=0;w<m;w++)for(C=0;C<y;C++)E+="dotProd += xR"+w+"C"+C+" * wR"+w+"C"+C+";";var A="",T="";e&&(A=n?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+e+`
        }`:`vec4 activation(vec4 x) {
          `+e+`
        }`,T="result = activation(result);");var N=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+A+`

      const ivec2 strides = ivec2(`+f+", "+h+`);
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+E+`

        vec4 result = dotProd;
        `+N+`
        `+T+`
        setOutput(result);
      }
    `},hT=function(r,t,e,n,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=r[0],s=r[1],l=r[2],f=r[3],h=t[0],p=e[0],v=e[1];this.outputShape=[h,p,v,f];var m=n==="bilinear"?1:0,y=[s-1+".0",l-1+".0"],x=y[0],E=y[1],w=p>1?[""+(s-1)/(p-1),"(y2-y1) * height_ratio","y1*"+x+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+x],C=w[0],_=w[1],R=w[2],A=v>1?[""+(l-1)/(v-1),"(x2-x1) * width_ratio","x1*"+E+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+E],T=A[0],N=A[1],M=A[2];this.userCode=`
      const float height_ratio = float(`+C+`);
      const float width_ratio = float(`+T+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+o+`) {
          return;
        }

        float height_scale = `+_+`;
        float width_scale = `+N+`;

        float in_y = `+R+`;
        if( in_y < 0.0 || in_y > `+x+` ) {
          setOutput(float(`+a+`));
          return;
        }
        float in_x = `+M+`;
        if( in_x < 0.0 || in_x > `+E+` ) {
          setOutput(float(`+a+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+m+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},dT=function(r,t,e){this.variableNames=["x"],this.outputShape=r;var n=r.length,a=r[r.length-1],o=e?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(e?"return "+a+" -i - 1;":"return i;")+`
      }

      void main() {
        `+dt(n)+` coords = getOutputCoords();
        int end = `+Nb(n,"coords")+`;
        float val = 0.0;
        for (int i = `+a+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+o+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Nb(n,"coords")+` = idx;
          val += getX(`+(function(s,l){if(s===1)return""+l;if(s===2)return l+".x, "+l+".y";if(s===3)return l+".x, "+l+".y, "+l+".z";if(s===4)return l+".x, "+l+".y, "+l+".z, "+l+".w";throw Error("Cumulative sum for rank "+s+" is not yet supported")})(n,"coords")+`);
        }
        setOutput(val);
      }
    `};function Nb(r,t){if(r===1)return""+t;if(r===2)return t+".y";if(r===3)return t+".z";if(r===4)return t+".w";throw Error("Cumulative sum for rank "+r+" is not yet supported")}var pT=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=as.DENSE;var t=Ju(r),e=un();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ri(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+e.output+` = result;
      }
    `},vT=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=as.DENSE;var t=Ju(r),e=un();this.outputShape=r,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Ri(["r","c","d"],r)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+e.output+` = result;
      }
    `},mT=(function(){function r(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+e+`;
      int offset_h = imod(h, `+e+`);
      int in_w = w / `+e+`;
      int offset_w = imod(w, `+e+`);
      int offset_d = (offset_h * `+e+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return r.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},r.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},r.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},r.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},r.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},r})(),gT=function(r){this.variableNames=["X"],this.outputShape=[r,r],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},yT=function(r){this.variableNames=["A"],this.outTexUsage=Wn.DOWNLOAD;var t=un();this.outputShape=r,this.userCode=`
      `+Bx+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},bT=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Wn.DOWNLOAD;var t=un();this.outputShape=r,this.userCode=`
      `+Bx+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},xT=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"];var n=un(),a=t[0],o=t[1];this.outputShape=r;var s="result";e&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      `+nv(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+o+`;
        int c = imod(flatIndex, `+o+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+a+`.0);
        vec4 values = `+n.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+n.output+" = vec4("+s+`, 0., 0., 0.);
      }
    `},wT=function(r,t,e){e===void 0&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=un(),a=t[0],o=t[1];this.outputShape=r;var s="",l="result";e&&(l="floor(result * 255. + 0.5)");for(var f=0;f<=1;f++)for(var h=0;h<=1;h++){var p=2*f+h;s+=`
          localCoords = coords;
          if(localCoords[2] + `+h+" < "+r[2]+`) {
            localCoords[2] += `+h+`;
            if(localCoords[1] + `+f+" < "+r[1]+`) {
              localCoords[1] += `+f+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+o+`;
              c = imod(flatIndex, `+o+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+o+".0, "+a+`.0);
              values = `+n.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+p+`] = values[0];
              } else if(offset == 1) {
                result[`+p+`] = values[1];
              } else if(offset == 2) {
                result[`+p+`] = values[2];
              } else {
                result[`+p+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+nv(r)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+s+`

        `+n.output+" = "+l+`;
      }
    `},ET="return real * expR - imag * expI;",CT="return real * expI + imag * expR;",Ob=function(r,t,e){this.variableNames=["real","imag"];var n=t[1];this.outputShape=t;var a=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=e?n+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+a+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+r+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+n+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+n+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+o+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},_T=(function(){function r(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.valueLoc==null&&(e.valueLoc=n.getUniformLocationNoThrow(a,"value")),n.gl.uniform1f(e.valueLoc,t)}},r})(),ST=function(r,t,e){this.variableNames=["A","indices"];var n=r.slice();n[e]=t,this.outputShape=n,this.rank=n.length;var a=dt(this.rank),o=(function(s,l){var f=s.length;if(f>4)throw Error("Gather for rank "+f+" is not yet supported");if(f===1)return"int(getIndices(resRC))";for(var h=["resRC.x","resRC.y","resRC.z","resRC.w"],p=[],v=0;v<s.length;v++)v===l?p.push("int(getIndices("+h[v]+"))"):p.push(""+h[v]);return p.join()})(r,e);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},RT=function(r,t,e){this.sliceDim=r,this.strides=t,this.variableNames=["x","indices"],this.outputShape=e;var n=dt(t.length),a=dt(e.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+n+" strides = "+n+"("+this.strides+`);
         void main() {
          `+a+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+o+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function AT(r,t){var e=un();return ER(r,t,e.version+`
    precision highp float;
    `+e.attribute+` vec3 clipSpacePos;
    `+e.attribute+` vec2 uv;
    `+e.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function TT(r,t){return AR(r,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function DT(r,t){return TR(r,t,new Uint16Array([0,1,2,2,1,3]))}function vs(r,t,e,n,a,o,s){NR(e,n);var l=DR(r,t),f=r.TEXTURE_2D;return Re(r,t,(function(){return r.bindTexture(f,l)})),Re(r,t,(function(){return r.texParameteri(f,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)})),Re(r,t,(function(){return r.texParameteri(f,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)})),Re(r,t,(function(){return r.texParameteri(f,r.TEXTURE_MIN_FILTER,r.NEAREST)})),Re(r,t,(function(){return r.texParameteri(f,r.TEXTURE_MAG_FILTER,r.NEAREST)})),Re(r,t,(function(){return r.texImage2D(f,0,a,e,n,0,o,s,null)})),Re(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,null)})),l}function NT(r,t,e,n,a){var o=Pc(e,n);return vs(r,t,o[0],o[1],a.internalFormatFloat,a.textureFormatFloat,r.FLOAT)}function OT(r,t,e,n,a){var o=Pc(e,n);return vs(r,t,o[0],o[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function MT(r,t,e,n,a){var o=Pc(e,n);return vs(r,t,o[0],o[1],r.RGBA,r.RGBA,r.UNSIGNED_BYTE)}function kT(r,t,e,n,a){var o=ps(e,n);return vs(r,t,o[0],o[1],a.internalFormatPackedFloat,r.RGBA,r.FLOAT)}function IT(r,t,e,n,a){var o=ps(e,n);return vs(r,t,o[0],o[1],a.internalFormatPackedHalfFloat,r.RGBA,a.textureTypeHalfFloat)}function BT(r,t,e,n){return Re(r,t,(function(){return r.bindBuffer(r.ARRAY_BUFFER,n)})),yb(r,t,e,"clipSpacePos",n,3,20,0)&&yb(r,t,e,"uv",n,2,20,12)}function FT(r,t,e,n,a,o,s){var l,f,h;Re(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,e)})),o instanceof Uint8Array?(l=new Uint8Array(n*a*4),f=r.UNSIGNED_BYTE,h=r.RGBA):(l=new Float32Array(n*a*4),f=r.FLOAT,h=s.internalFormatPackedFloat),l.set(o),Re(r,t,(function(){return r.texImage2D(r.TEXTURE_2D,0,h,n,a,0,r.RGBA,f,l)})),Re(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,null)}))}function LT(r,t,e,n){Re(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,e)})),n.data instanceof Uint8Array?Re(r,t,(function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)})):Re(r,t,(function(){return r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)})),Re(r,t,(function(){return r.bindTexture(r.TEXTURE_2D,null)}))}function zT(r,t,e,n,a){var o=r.createBuffer();Re(r,t,(function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,o)}));var s=16*e*n;return Re(r,t,(function(){return r.bufferData(r.PIXEL_PACK_BUFFER,s,r.STREAM_READ)})),Re(r,t,(function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,0)})),Re(r,t,(function(){return r.bindBuffer(r.PIXEL_PACK_BUFFER,null)})),o}function UT(r,t,e){var n=r,a=new Float32Array(e);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,a),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),a}function PT(r,t,e,n,a){var o=Pc(e,n),s=o[0],l=o[1],f=new Uint8Array(e*n*4);return Re(r,t,(function(){return r.readPixels(0,0,s,l,a.downloadTextureFormat,r.UNSIGNED_BYTE,f)})),new Float32Array(f.buffer)}function HT(r,t,e,n,a,o,s,l){var f=r,h=new Float32Array((function(p,v){var m=ps(p,v);return m[0]*m[1]*4})(o,s));return f.bindBuffer(f.PIXEL_PACK_BUFFER,t),f.getBufferSubData(f.PIXEL_PACK_BUFFER,0,h),f.bindBuffer(f.PIXEL_PACK_BUFFER,null),h}function VT(r,t,e,n){var a=new Float32Array(e*n*4);return Re(r,t,(function(){return r.readPixels(0,0,n,e,r.RGBA,r.FLOAT,a)})),a}var WT=(function(){function r(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=ce().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,gR(e,t)):this.gl=Ur(e);var n="WEBGL_color_buffer_float";if(ce().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Gl(this.gl,this.debug,"OES_texture_float"),ur(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Gl(this.gl,this.debug,"OES_texture_half_float");else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),ur(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Gl(this.gl,this.debug,"EXT_color_buffer_half_float");else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",ur(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!ur(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=TT(this.gl,this.debug),this.indexBuffer=DT(this.gl,this.debug),this.framebuffer=OR(this.gl,this.debug),this.textureConfig=qp(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(r.prototype,"debug",{get:function(){return ce().getBool("DEBUG")},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Re(e,this.debug,(function(){return e.finish()})),Re(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Re(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Re(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Re(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Re(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},r.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),NT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),OT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),MT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),LT(this.gl,this.debug,t,e)},r.prototype.uploadDenseMatrixToTexture=function(t,e,n,a){this.throwIfDisposed(),FT(this.gl,this.debug,t,e,n,a,this.textureConfig)},r.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),IT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),kT(this.gl,this.debug,t,e,this.textureConfig)},r.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(bb(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Re(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},r.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,(function(){return PT(a.gl,a.debug,e,n,a.textureConfig)}))},r.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,a,o,s){return HT(this.gl,t,0,0,0,o,s,this.textureConfig)},r.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return UT(this.gl,t,e)},r.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var a=zT(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),a},r.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},r.prototype.createFence=function(t){var e,n,a=this;if(ce().getBool("WEBGL_FENCE_API_ENABLED")){var o=t,s=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var l=o.clientWaitSync(s,0,0);return l===o.ALREADY_SIGNALED||l===o.CONDITION_SATISFIED},e=s}else ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return a.isQueryAvailable(e,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},r.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var a=this;return this.downloadMatrixDriver(t,(function(){return VT(a.gl,a.debug,e,n)}))},r.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=CR(e,this.debug,t),a=AT(e,this.debug),o=SR(e,this.debug);return Re(e,this.debug,(function(){return e.attachShader(o,a)})),Re(e,this.debug,(function(){return e.attachShader(o,n)})),RR(e,this.debug,o),this.debug&&zd(e,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=BT(e,this.debug,this.program,this.vertexBuffer)),o},r.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Re(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},r.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&zd(this.gl,this.debug,this.program),Re(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},r.prototype.getUniformLocation=function(t,e,n){return n===void 0&&(n=!0),this.throwIfDisposed(),n?kR(this.gl,this.debug,t,e):IR(this.gl,t,e)},r.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Re(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},r.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},r.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),BR(this.gl,this.debug,this.program,t,e,n)},r.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},r.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var a=ps(e,n),o=a[0],s=a[1];this.setOutputMatrixTextureDriver(t,o,s)},r.prototype.setOutputMatrixWriteRegion=function(t,e,n,a){this.setOutputMatrixWriteRegionDriver(n,t,a,e)},r.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},r.prototype.debugValidate=function(){this.program!=null&&zd(this.gl,this.debug,this.program),ql(this.gl)},r.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Re(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},r.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Re(this.gl,this.debug,(function(){return t.gl.finish()}))},r.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Gl(this.gl,this.debug,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},r.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},r.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},r.prototype.beginQuery=function(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var a=this.getQueryTimerExtensionWebGL1(),o=a.createQueryEXT();return a.beginQueryEXT(a.TIME_ELAPSED_EXT,o),o},r.prototype.endQuery=function(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},r.prototype.waitForQueryAndGetTime=function(t){return Ee(this,void 0,void 0,(function(){var e=this;return Ce(this,(function(n){switch(n.label){case 0:return[4,hb((function(){return e.disposed||e.isQueryAvailable(t,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},r.prototype.getQueryTime=function(t,e){if(e===0)return null;if(e===2){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var a=this.getQueryTimerExtensionWebGL1();return a.getQueryObjectEXT(t,a.QUERY_RESULT_EXT)/1e6},r.prototype.isQueryAvailable=function(t,e){if(e===0)return!0;if(e===2){var n=this.gl,a=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(a=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,a.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),o&&!this.disjoint},r.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},r.prototype.pollItems=function(){for(var t=(function(n){for(var a=0;a<n.length&&n[a]();++a);return a-1})(this.itemsToPoll.map((function(n){return n.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},r.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||hb((function(){return n.pollItems(),n.itemsToPoll.length===0}))},r.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Ud(this.gl,this.debug,t,this.framebuffer),this.debug&&ql(this.gl)},r.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Ud(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&ql(this.gl)):bb(this.gl,this.debug,this.framebuffer)},r.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},r.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var a=this.gl;Ud(a,this.debug,t,this.framebuffer),this.debug&&ql(a),this.outputTexture=t,Re(a,this.debug,(function(){return a.viewport(0,0,e,n)})),Re(a,this.debug,(function(){return a.scissor(0,0,e,n)}))},r.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,a){var o=this;this.throwIfDisposed(),Re(this.gl,this.debug,(function(){return o.gl.scissor(t,e,n,a)}))},r.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},r.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},r})();function Mb(r,t){if(r.length!==t.length)throw Error("Binary was compiled with "+r.length+" inputs, but was executed with "+t.length+" inputs");r.forEach((function(e,n){var a=e.logicalShape,o=t[n],s=o.shape;if(!Gt(a,s))throw Error("Binary was compiled with different shapes than the current args. Shapes "+a+" and "+s+" must match");if(!e.isUniform||!o.isUniform){var l=e.texShape,f=o.isUniform?null:o.texData.texShape;if(!Gt(l,f))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+l+" and "+f+" must match")}}))}var jT=function(r,t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var n=e.filterWidth,a=e.inChannels,o=e.strideWidth,s=e.strideHeight,l=e.padInfo,f=e.outWidth,h=e.dilationWidth,p=e.dilationHeight,v=e.dataFormat,m=l.left,y=l.top,x=a*n,E=un(),w=v==="channelsLast",C=w?0:1,_=w?1:2,R="",A=0;A<=1;A++)for(var T=0;T<=1;T++)R+=`
          blockIndex = rc.y + `+T+`;
          pos = rc.x + `+A+`;

          if(blockIndex < `+r[1]+" && pos < "+r[0]+`) {
            offsetY = int(blockIndex / (`+f+")) * "+s+" - "+y+`;
            d0 = offsetY + `+p+" * (pos / "+x+`);

            if(d0 < `+t[C]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+f+".) * "+o+". - "+m+`.);
              d1 = offsetX + `+h+" * (int(mod(float(pos), "+x+".) / "+a+`.));

              if(d1 < `+t[_]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+a+`.));

                if (`+w+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*A+T)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*A+T)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+R+`

        `+E.output+` = result;
      }
    `},GT=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[];var o,s=t,l=r[3]-1;this.outputShape=r;var f="float("+e+") + float("+n+") * sum";o=a===.5?"inversesqrt("+f+")":a===1?"1.0/("+f+")":"exp(log("+f+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+s+"; j <= "+s+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+l+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+o+`;
        setOutput(val);
      }
    `},qT=function(r,t,e,n,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=r,this.depth=r[3],this.depthRadius=t,this.bias=e,this.alpha=n,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+n+") * norm + float("+e+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+n+`)
                * float(`+a+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+a+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},XT=function(r,t,e,n,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=t,l=r[3]-1;this.outputShape=r;var f="float("+e+") + float("+n+") * sum";o=a===.5?"inversesqrt("+f+")":a===1?"1.0/("+f+")":"exp(log("+f+") * float(-"+a+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+s+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+s+"; j <= "+s+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+l+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+o+`;
        setOutput(result);
      }
    `},KT=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideHeight,e=r.strideWidth,n=r.dilationHeight,a=r.effectiveFilterHeight,o=r.effectiveFilterWidth,s=a-1-r.padInfo.top,l=o-1-r.padInfo.left,f=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(`+s+", "+l+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+a+`;
          wR += `+n+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+o+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+e+`.0;

            if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+f+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+o+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},YT=function(r){this.variableNames=["dy","maxPos"],this.outputShape=r.inShape;var t=r.strideDepth,e=r.strideHeight,n=r.strideWidth,a=r.dilationDepth,o=r.dilationHeight,s=r.dilationWidth,l=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=l-1-r.padInfo.front,v=f-1-r.padInfo.top,m=h-1-r.padInfo.left,y=l*f*h-1;this.userCode=`
      const ivec3 pads = ivec3(`+p+", "+v+", "+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+l+`;
           wD += `+a+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+r.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+o+`) {
            float dyR = float(dyRCorner + wR) / `+e+`.0;

            if (dyR < 0.0 || dyR >= `+r.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+h+`;
                wC += `+s+`) {
              float dyC = float(dyCCorner + wC) / `+n+`.0;

              if (dyC < 0.0 || dyC >= `+r.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+y+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+f+" * "+h+` +
                  wR * `+h+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},jd=function(r,t,e,n,a,o,s){e===void 0&&(e=!1),n===void 0&&(n=!1),a===void 0&&(a=!1),o===void 0&&(o=null),s===void 0&&(s=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var l=e?r[1]:r[2],f=Math.ceil(l/2),h=e?"i * 2, rc.y":"rc.y, i * 2",p=n?"rc.z, i * 2":"i * 2, rc.z",v=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=n?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],y="",x="";o&&(y=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+o+`
        }`:`vec4 activation(vec4 x) {
          `+o+`
        }`,x="result = activation(result);");var E=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const float sharedDimension = `+f+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+f+`; i++) {
          vec4 a = getMatrixA(rc.x, `+h+`);
          vec4 b = getMatrixB(rc.x, `+p+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+v[0]+" * "+m[0]+`);
          result += (`+v[1]+" * "+m[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+E+`

        `+x+`

        setOutput(result);
      }
    `},QT=(function(){function r(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(e-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(e-1)+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,a){e.seedLoc==null&&(e.seedLoc=n.getUniformLocation(a,"seed")),n.gl.uniform1f(e.seedLoc,t)}},r})(),ZT=function(r,t,e,n){this.variableNames=["indices"],this.outputShape=[r,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+n+"), float("+e+`),
                      float(index == coords.y)));
      }
    `},JT=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=r;var t=r.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var e=Sn("rc",t),n=dt(t),a=(function(l,f,h){if(l===1)return"rc > "+f[0];for(var p="",v=l-2;v<l;v++)p+=h[v]+" >= "+f[v],v<l-1&&(p+="||");return p})(t,r,e),o=(function(l,f,h,p){if(l===1)return"";var v=p.slice(-2);return`
    int r = `+v[0]+`;
    int c = `+v[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+f+`;
    bool rEdge = rp1 >= `+h+`;
  `})(t,r[r.length-1],r[r.length-2],e),s=(function(l,f){var h=l.length,p=(function(v,m){for(var y=[],x=0;x<=1;x++)for(var E=0;E<=1;E++){for(var w=(x===0?"r":"rp1")+", "+(E===0?"c":"cp1"),C=2;C<v;C++)w=m[m.length-1-C]+","+w;y.push(w)}return y})(h,f);return h===1?`getA(rc),
            rc + 1 >= `+l[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+p[0]+`),
          cEdge ? 0. : getA(`+p[1]+`),
          rEdge ? 0. : getA(`+p[2]+`),
          rEdge || cEdge ? 0. : getA(`+p[3]+")"})(r,e);this.userCode=`
        void main() {
          `+n+` rc = getOutputCoords();

          if(`+a+`) {
            setOutput(vec4(0));
          } else {
            `+o+`

            setOutput(vec4(`+s+`));
          }
        }
      `}},$T=function(r,t,e){this.variableNames=["x"],this.outputShape=t.map((function(f,h){return f[0]+r[h]+f[1]}));var n=r.length,a=dt(n),o=t.map((function(f){return f[0]})).join(","),s=t.map((function(f,h){return f[0]+r[h]})).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=n!==1?`
      `+a+" start = "+a+"("+o+`);
      `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+e+`));
        } else {
          `+a+` coords = outC - start;
          setOutput(getX(`+l+`));
        }
      }
    `:`
        int start = `+o+`;
        int end = `+s+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+e+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},eD=function(r,t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(w,C){return w[0]+r[C]+w[1]}));for(var n=r.length,a=dt(n),o=t.map((function(w){return w[0]})).join(","),s=t.map((function(w,C){return w[0]+r[C]})).join(","),l=Sn("rc",n),f=Sn("source",n),h=l[n-1]+" < "+this.outputShape[n-1],p=n===1?"source":"vec2("+f.slice(-2).join()+")",v=[a+" rc = outputLoc;",l[n-1]+` += 1;
       if(`+h+`) {
      `,n===1?"":`}
       rc = outputLoc;
       `+l[n-2]+` += 1;
       if(`+l[n-2]+" < "+this.outputShape[n-2]+") {",n===1?"":"  "+l[n-1]+` += 1;
         if(`+h+") {"],m=n===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",y="",x=0,E=n===1?2:4;x<E;x++)y+=`
        `+v[x]+`
        if (`+m+`) {
          result[`+x+"] = float("+e+`);
        } else {
          `+a+` source = rc - start;
          result[`+x+"] = getChannel(getX("+f.join()+"), "+p+`);
        }
      `;y+=n===1?"} ":"}}",this.userCode=`
      const `+a+" start = "+a+"("+o+`);
      const `+a+" end = "+a+"("+s+`);

      void main() {
        `+a+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+y+`
        setOutput(result);
      }
    `},Gd=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideHeight,o=r.strideWidth,s=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,v=r.padInfo.left;this.outputShape=r.outShape;var m=t==="avg",y="0.0";if(m||(y="-1.0 / 1e-20"),e)this.userCode=`
        const ivec2 strides = ivec2(`+a+", "+o+`);
        const ivec2 pads = ivec2(`+p+", "+v+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+f+`;
              wR += `+s+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+h+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+r.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+h+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var E=4*Math.floor(n/4),w=n%4,C=`
      if (`+m+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+a+", "+o+`);
      const ivec2 pads = ivec2(`+p+", "+v+`);
      const float initializationValue = `+y+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+y+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+f+`;
            wR += `+s+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+r.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+E+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+C+`
          }

          int xC = xCCorner + `+E+`;
          if (`+(w===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+C+`
          } else if (`+(w===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+C+`
          } else if (`+(w===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+C+`
          }
        }
        setOutput(`+x+`);
      }
    `}},qd=function(r,t,e){if(this.variableNames=["x"],t==="avg"&&e)throw new Error("Cannot compute positions for average pool.");var n=r.filterWidth,a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,f=r.dilationHeight,h=r.dilationWidth,p=r.effectiveFilterDepth,v=r.effectiveFilterHeight,m=r.effectiveFilterWidth,y=r.padInfo.front,x=r.padInfo.top,E=r.padInfo.left;this.outputShape=r.outShape;var w=t==="avg",C="0.0";if(w||(C="-1.0 / 1e-20"),e)this.userCode=`
        const ivec3 strides =
            ivec3(`+a+", "+o+", "+s+`);
        const ivec3 pads = ivec3(`+y+", "+x+", "+E+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+p+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+r.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+v+`;
                wR += `+f+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+r.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+m+`;
                  wC += `+h+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+r.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+v+" * "+m+` +
                      wR * `+m+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var _=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(_="avgValue / count");var R=4*Math.floor(n/4),A=n%4,T=`
      if (`+w+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+a+", "+o+", "+s+`);
      const ivec3 pads = ivec3(`+y+", "+x+", "+E+`);
      const float initializationValue = `+C+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+r.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+C+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+p+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+r.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+v+`;
            wR += `+f+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+r.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+R+`; wC += 4) {
              int xC = xCCorner + wC * `+h+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+h+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+h+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+h+`, ch)
              );

              `+T+`
            }

            int xC = xCCorner + `+R+`;
            if (`+(A===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+T+`
            } else if (`+(A===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+h+`, ch),
                initializationValue,
                initializationValue
              );

              `+T+`
            } else if (`+(A===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+h+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+h+`, ch),
                initializationValue
              );

              `+T+`
            }
          }
          setOutput(`+_+`);
        }
      }
    `}},tD=function(r,t){this.variableNames=["x"];var e=r.windowSize,n=r.batchSize,a=r.inSize,o=Math.ceil(a/e);this.outputShape=[n,o];var s="0.0",l="";t==="prod"?s="1.0":t==="min"?(s="1.0 / 1e-20",l="min"):t==="max"&&(s="-1.0 / 1e-20",l="max");var f=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?f="sumValue":t==="prod"?f="prodValue":t==="all"?f="allValue":t==="any"&&(f="anyValue");var h=4*Math.floor(e/4),p=e%4,v=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+l+`(values, minMaxValue);
      }
    `,m="vec4";t==="all"?(s="1.0",v=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(s="0.0",v=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");var y="";a%e>0&&(y=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+s+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+y+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+e+`;

        vec4 minMaxValue = vec4(`+s+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+h+`; i += 4) {
          int inIdx = inOffset + i;
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+v+`
        }

        int inIdx = inOffset + `+h+`;
        if (`+(p===1)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(p===2)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+v+`
        } else if (`+(p===3)+`) {
          `+m+" values = "+m+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+v+`
        }
        setOutput(`+f+`);
      }
    `},nD=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;for(var e="",n=0;n<4;n++){var a="thisRC = rc;";n%2==1&&(a+="thisRC.z += 1;"),n>1&&(a+="thisRC.y += 1;"),e+=`
        `+a+`
        `+(n>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+n+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(n>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Ri(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+nv(r)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+r[1]+`;
        int cols = `+r[2]+`;

        `+e+`

        setOutput(result);
      }
    `},rD=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],o=n[2],s=r.shape,l=s[1],f=s[2],h=[e&&l>1?a-1:a,e&&f>1?o-1:o],p=[e&&l>1?l-1:l,e&&f>1?f-1:f],v=h[0]/p[0],m=h[1]/p[1],y=1/v,x=1/m,E=2*Math.ceil(y)+2,w=2*Math.ceil(x)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+y+`);
        const float invWidthScale = float(`+x+`);

        const int winHeight = int(`+E+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+f+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(a-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(o-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},aD=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],o=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var f=[n&&t>1?o-1:o,n&&e>1?s-1:s],h=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+f[0]/h[0]+`,
          `+f[1]/h[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},iD=function(r,t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=r[0],o=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var f=[n&&t>1?o-1:o,n&&e>1?s-1:s],h=[n&&t>1?t-1:t,n&&e>1?e-1:e];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+f[0]/h[0]+`,
          `+f[1]/h[1]+`,
          `+f[1]/h[1]+`);
      const vec3 inputShapeRC = vec3(`+o+".0, "+s+`.0,
                                     `+s+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(l-1)+`;
        bool hasNextRow = coords.z < `+(e-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},oD=function(r,t,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var n=t.shape,a=n[1],o=n[2],s=r.shape,l=s[1],f=s[2],h=[e&&l>1?a-1:a,e&&f>1?o-1:o],p=[e&&l>1?l-1:l,e&&f>1?f-1:f],v=h[0]/p[0],m=h[1]/p[1],y=1/v,x=1/m,E=2*Math.ceil(y)+2,w=2*Math.ceil(x)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+v+`);
        const float widthScale = float(`+m+`);

        const float invHeightScale = float(`+y+`);
        const float invWidthScale = float(`+x+`);

        const int winHeight = int(`+E+`);
        const int winWidth = int(`+w+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+l+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+f+`) {
              continue;
            }

            float sourceFracRow =
              float(`+h[0]+`) *
                (float(dyR) / float(`+p[0]+`));

            float sourceFracCol =
                float(`+h[1]+`) *
                  (float(dyC) / float(`+p[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+a+`) - 1),
                `+e+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+o+`) - 1),
                `+e+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},uD=function(r,t,e,n){this.variableNames=["A"],this.outputShape=[];var a=r[0],o=r[1],s=r[2],l=r[3];this.outputShape=[a,t,e,l];var f=[n&&t>1?o-1:o,n&&e>1?s-1:s],h=[n&&t>1?t-1:t,n&&e>1?e-1:e],p=n?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+f[0]/h[0]+`,
          `+f[1]/h[1]+`);
      const vec2 inputShapeRC = vec2(`+o+".0, "+s+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+p+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},sD=function(r,t){this.variableNames=["x"];var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=r,e!==1){var n=r.map((function(o,s){return(function(l){return t.indexOf(l)!==-1&&r[l]!==1?r[l]+" - coords["+l+"] - 1":"coords["+l+"]"})(s)})).join(","),a=dt(e);this.userCode=`
      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+n+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+r[0]+` - coord - 1));
        }
      `},lD=function(r,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=r.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=r;var n=Sn("rc",e),a=n[e-1]+" + 1 < "+this.outputShape[e-1],o=n[e-2]+" + 1 < "+this.outputShape[e-2],s=dt(e);function l(f){var h=r.map((function(p,v){return(function(m,y){return t.indexOf(m)!==-1&&r[m]!==1?r[m]+" - "+y[m]+" - 1":""+y[m]})(v,f)}));return"getChannel(getX("+h.join(",")+"), vec2("+h.slice(-2).join(",")+"))"}this.userCode=e===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+r[0]+` - rc - 1),
            `+r[0]+` - rc - 1);
          if(`+a+`){
              result.g = getChannel(getX(`+r[0]+` - (rc  + 1) - 1),
                `+r[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+s+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+(function(f){return l(f)})(n.slice())+`;
          if(`+a+`){
            result.g = `+(function(f){return f[e-1]="("+f[e-1]+" + 1)",l(f)})(n.slice())+`;
          }
          if(`+o+`) {
            result.b = `+(function(f){return f[e-2]="("+f[e-2]+" + 1)",l(f)})(n.slice())+`;
            if(`+a+`) {
              result.a = `+(function(f){return f[e-1]="("+f[e-1]+" + 1)",f[e-2]="("+f[e-2]+" + 1)",l(f)})(n.slice())+`;
            }
          }
          setOutput(result);
        }
    `},kb=function(r,t,e,n,a,o,s){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var l=dt(a.length),f=dt(o.length),h="";e===1?h="i":e===2&&(h="i, j");var p="getIndices("+h+")",v="";n===1?v="i":n===2&&(v="i, coords[1]");var m="getUpdates("+v+")",y=t>1?"strides[j]":"strides";this.userCode=`
        `+l+" strides = "+l+"("+a+`);

        void main() {
          `+f+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+r+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+p+`);
              flattenedIndex += index * `+y+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+m+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},cD=function(r,t){this.variableNames=["x","segmentIds"];var e=r.windowSize,n=r.batchSize,a=r.inSize,o=r.numSegments,s=o*Math.ceil(a/e);this.outputShape=[n,s];var l=4*Math.floor(e/4),f=e%4,h=`
        sumValue += dot(values, segFilter);
    `,p="";a%e>0&&(p=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return initializationValue;
        }
      `);var v="";a%e>0&&(v=`
        if (inIdx < 0 || inIdx >= `+a+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+p+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+v+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+o+")) * float("+e+`));
        int currentSeg = int(mod(float(outIdx), float(`+o+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+h+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(f===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+h+`
        } else if (`+(f===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+h+`
        } else if (`+(f===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+h+`
        }
        setOutput(sumValue);
      }
    `},fD=function(r,t,e){var n,a;if(this.variableNames=["c","a","b"],this.outputShape=t,e>4)throw Error("Where for rank "+e+" is not yet supported");if(e===1)a="resRC",n="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],l=[],f=0;f<t.length;f++)l.push(""+o[f]),f<r&&s.push(""+o[f]);n=s.join(),a=l.join()}var h=dt(e);this.userCode=`
      void main() {
        `+h+` resRC = getOutputCoords();
        float cVal = getC(`+n+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+a+`));
        } else {
          setOutput(getB(`+a+`));
        }
      }
    `},hD=(function(){function r(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=dt(this.rank),a="uniform int start["+this.rank+"];",o=(function(s){if(s===1)return"sourceLoc";if(s<=6)return Xd.slice(0,s).map((function(l){return"sourceLoc."+l})).join(",");throw Error("Slicing for rank "+s+" is not yet supported")})(this.rank);e=`
        `+n+` sourceLoc;
        `+n+` coords = getOutputCoords();
        `+t.map((function(s,l){return"sourceLoc."+Xd[l]+" = start["+l+"] + coords."+Xd[l]+";"})).join(`
`)+`
      `,this.userCode=`
      `+a+`
      void main() {
        `+e+`
        setOutput(getSource(`+o+`));
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r})(),Xd=["x","y","z","w","u","v"],dD=(function(){function r(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=dt(this.rank),n=Sn("coords",this.rank),a=Sn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":"vec2("+a.slice(-2).join()+")",s="getChannel(getSource("+a.join()+"), "+o+")",l=`
      result.x = `+s+`;
      if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+a[this.rank-1]+`;
        result.y = `+s+`;
        --`+a[this.rank-1]+`;
      }
    `,f=this.rank===1?"":`
      --`+n[this.rank-1]+`;
      if (++`+n[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+a[this.rank-2]+`;
        result.z = `+s+`;
        if (++`+n[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+a[this.rank-1]+`;
          result.w = `+s+`;
        }
      }
    `,h=this.rank<=4?`sourceLoc = coords +
            `+e+"("+t.map((function(p,v){return"start["+v+"]"})).join()+");":t.map((function(p,v){return a[v]+" = "+n[v]+" + start["+v+"];"})).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+e+` coords = getOutputCoords();
        `+e+` sourceLoc;
        `+h+`
        vec4 result = vec4(0.);
        `+l+`
        `+f+`
        setOutput(result);
      }
    `}return r.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,a){e.startLoc==null&&(e.startLoc=n.getUniformLocationNoThrow(a,"start"),e.startLoc==null)||n.gl.uniform1iv(e.startLoc,t)}},r})(),pD=function(r,t,e){this.variableNames=["x"],this.outputShape=e;var n=e.length,a=dt(e.length),o=dt(e.length),s="";if(n===1)s="coords * strides + begin";else{var l=0;s=e.map((function(f,h){return l++,e.length===1?"coords * strides["+h+"] + begin["+h+"]":"coords["+(l-1)+"] * strides["+h+"] + begin["+h+"]"})).join(",")}this.userCode=`
      `+a+" begin = "+a+"("+r+`);
      `+a+" strides = "+a+"("+t+`);

      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+s+`));
      }
    `},vD=(function(){function r(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return r.prototype.acquireTexture=function(t,e,n){var a,o=Ib(e,n),s=Bb(t,o,n);if(s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]),this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var l=this.freeTextures[s].shift();return this.usedTextures[s].push(l),l}return this.numUsedTextures++,this.log(),o===Vn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):o===Vn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):o===Vn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):o===Vn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):o===Vn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[s].push(a),a},r.prototype.releaseTexture=function(t,e,n,a){if(this.freeTextures!=null){var o=Bb(e,Ib(n,a),a);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(t),this.numFreeTextures++,this.numUsedTextures--;var s=this.usedTextures[o],l=s.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(l,1),this.log()}},r.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},r.prototype.getNumUsedTextures=function(){return this.numUsedTextures},r.prototype.getNumFreeTextures=function(){return this.numFreeTextures},r.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(n){t.gpgpu.deleteMatrixTexture(n)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(a){t.gpgpu.deleteMatrixTexture(a)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},r})();function Ib(r,t){if(r===Wn.UPLOAD)return Vn.PACKED_2X2_FLOAT32;if(r===Wn.RENDER||r==null)return(function(e){return ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Vn.PACKED_2X2_FLOAT32:Vn.UNPACKED_FLOAT32:e?Vn.PACKED_2X2_FLOAT16:Vn.UNPACKED_FLOAT16})(t);if(r===Wn.DOWNLOAD||r===Wn.PIXELS)return Vn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+r)}function Bb(r,t,e){return r[0]+"_"+r[1]+"_"+t+"_"+e}var mD=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[n]*t[n];this.outputShape=e,this.rank=e.length;var a=dt(this.rank),o=(function(s){var l=s.length;if(l>5)throw Error("Tile for rank "+l+" is not yet supported");if(l===1)return"imod(resRC, "+s[0]+")";for(var f=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],h=[],p=0;p<s.length;p++)h.push("imod("+f[p]+", "+s[p]+")");return h.join()})(r);this.userCode=`
      void main() {
        `+a+` resRC = getOutputCoords();
        setOutput(getA(`+o+`));
      }
    `},gD=function(r,t){this.variableNames=["A"];for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];this.outputShape=e,this.rank=e.length;var a=dt(this.rank),o=(function(s){var l=s.length;if(l>6)throw Error("Transpose for rank "+l+" is not yet supported");for(var f=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],h=new Array(l),p=0;p<s.length;p++)h[s[p]]=f[p];return h.join()})(t);this.userCode=`
    void main() {
      `+a+` resRC = getOutputCoords();
      setOutput(getA(`+o+`));
    }
    `},yD=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(r.length),n=0;n<e.length;n++)e[n]=r[t[n]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=dt(this.rank),o=Ix("rc",this.rank),s=new Array(this.rank);for(n=0;n<t.length;n++)s[t[n]]=o[n];var l="vec2("+s.slice(-2).join()+")",f="++"+o[this.rank-1]+" < "+e[this.rank-1],h="getChannel(getA("+s.join()+"), "+l+")";this.userCode=`
    void main() {
      `+a+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+h+`;
      if(`+f+`) {
        result[1] = `+h+`;
      }
      --`+o[this.rank-1]+`;
      if(++`+o[this.rank-2]+" < "+e[this.rank-2]+`) {
        result[2] = `+h+`;
        if(`+f+`) {
          result[3] = `+h+`;
        }
      }
      setOutput(result);
    }
    `},rv=1.7580993408473768,av=1.0507009873554805,Pe=function(r,t){this.variableNames=["A"],this.outputShape=r,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},br="if (isnan(x)) return x;",bD="return x;",Fb="return abs(x);",Ux=br+`
  return (x < 0.0) ? 0.0 : x;
`,Px=br+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Hx="return (x >= 0.0) ? x : (exp(x) - 1.0);",xD=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+rv+`;
  float scale = `+av+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Lb="return -x;",zb="return ceil(x);",Ub="return floor(x);",Pb="return exp(x);",Hb="return exp(x) - 1.0;",wD=br+`
  return sin(x);
`,ED=br+`
  return cos(x);
`,CD=br+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,_D=br+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,SD=br+`
  return atan(x);
`,RD=br+"return log(x + sqrt(x * x + 1.0));",AD=br+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,TD=br+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Ql="return x;",DD="return x;",Vx=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Wx=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jx=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Qu=function(r,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},ND=function(r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=r;var t=r.length,e=Sn("rc",t),n=dt(t),a=(function(l,f){if(l===1)return"rc";for(var h="",p=0;p<l;p++)h+=f[p],p<l-1&&(h+=",");return h})(t,e),o=e.slice(-2),s=t<=1?"rc":"vec2("+o.join(",")+")";this.userCode=`
      void main() {
        `+n+` rc = getOutputCoords();
        vec4 packedInput = getA(`+a+`);

        setOutput(getChannel(packedInput, `+s+`));
      }
    `},Zl={};function Jl(r,t){if(t===void 0&&(t=!1),r==="linear")return t?DD:bD;if(r==="relu")return t?Vx:Ux;if(r==="elu")return t?jx:Hx;if(r==="relu6")return t?Wx:Px;if(r==="prelu")return t?zx:Lx;throw new Error("Activation "+r+" has not been implemented for the WebGL backend.")}var OD=600,MD=(function(r){function t(e){var n,a=r.call(this)||this;if(a.pendingRead=new WeakMap,a.pendingDisposal=new WeakSet,a.dataRefCount=new WeakMap,a.numBytesInGPU=0,a.uploadWaitMs=0,a.downloadWaitMs=0,a.warnedAboutMemory=!1,a.pendingDeletes=0,a.disposed=!1,!ce().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(e==null){var o=Ur(ce().getNumber("WEBGL_VERSION"));a.binaryCache=((n=ce().getNumber("WEBGL_VERSION"))in Zl||(Zl[n]={}),Zl[n]),a.gpgpu=new WT(o),a.canvas=o.canvas,a.gpgpuCreatedLocally=!0}else a.gpgpu=e,a.binaryCache={},a.gpgpuCreatedLocally=!1,a.canvas=e.gl.canvas;return a.textureManager=new vD(a.gpgpu),a.numMBBeforeWarning=ce().global.screen==null?1024:ce().global.screen.height*ce().global.screen.width*window.devicePixelRatio*OD/1024/1024,a.texData=new Sx(a,j),a}return yr(t,r),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,n,a){if(ce().getBool("DEBUG")&&this.checkNumericalProblems(e),a==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var o={};return this.texData.set(o,{shape:n,dtype:a,values:e,usage:Wn.UPLOAD}),o},t.prototype.move=function(e,n,a,o){if(ce().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:a,dtype:o,values:n,usage:Wn.UPLOAD})},t.prototype.readSync=function(e){var n=this.texData.get(e),a=n.values,o=n.dtype,s=n.complexTensors,l=n.slice,f=n.shape,h=n.isPacked;if(l!=null){var p=void 0;p=h?new Qu(f,Ql):new Pe(f,Ql);var v=this.runWebGLProgram(p,[{dataId:e,shape:f,dtype:o}],o),m=this.readSync(v.dataId);return this.disposeData(v.dataId),m}if(a!=null)return this.convertAndCacheOnCPU(e);if(o==="string")return a;var y,x,E=this.activeTimers!=null;return E&&(y=Nr()),o==="complex64"?x=_p(s.real.dataSync(),s.imag.dataSync()):x=this.getValuesFromTexture(e),E&&(this.downloadWaitMs+=Nr()-y),this.convertAndCacheOnCPU(e,x)},t.prototype.read=function(e){return Ee(this,void 0,void 0,(function(){var n,a,o,s,l,f,h,p,v,m,y,x,E,w,C,_,R,A,T,N,M,I;return Ce(this,(function(k){switch(k.label){case 0:if(this.pendingRead.has(e))return n=this.pendingRead.get(e),[2,new Promise((function(F){return n.push(F)}))];if(a=this.texData.get(e),o=a.values,s=a.shape,l=a.slice,f=a.dtype,h=a.complexTensors,p=a.isPacked,l!=null)return v=void 0,v=p?new Qu(s,Ql):new Pe(s,Ql),m=this.runWebGLProgram(v,[{dataId:e,shape:s,dtype:f}],f),y=this.read(m.dataId),this.disposeData(m.dataId),[2,y];if(o!=null)return[2,this.convertAndCacheOnCPU(e)];if(!ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ce().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return x=null,f!=="complex64"&&ce().get("WEBGL_BUFFER_SUPPORTED")&&(E=this.decode(e),w=this.texData.get(E.dataId),x=(I=this.gpgpu).createBufferFromTexture.apply(I,[w.texture].concat(Ju(s)))),this.pendingRead.set(e,[]),f==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:k.sent(),k.label=2;case 2:return f!=="complex64"?[3,4]:[4,Promise.all([h.real.data(),h.imag.data()])];case 3:return _=k.sent(),R=_[0],A=_[1],C=_p(R,A),[3,5];case 4:x==null?C=this.getValuesFromTexture(e):(T=Se(s),C=this.gpgpu.downloadFloat32MatrixFromBuffer(x,T)),k.label=5;case 5:return E!=null&&this.disposeData(E.dataId),N=this.convertAndCacheOnCPU(e,C),M=this.pendingRead.get(e),this.pendingRead.delete(e),M.forEach((function(F){return F(N)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,N]}}))}))},t.prototype.checkNumericalProblems=function(e){if(e!=null)for(var n=0;n<e.length;n++){var a=e[n];if(!xR(a))throw ce().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+a+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+a+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(e){var n,a=this.texData.get(e),o=a.shape,s=a.dtype,l=a.isPacked,f=Se(o);if(ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var h=this.decode(e),p=this.texData.get(h.dataId),v=(n=this.gpgpu).downloadMatrixFromPackedTexture.apply(n,[p.texture].concat(Ju(o))).subarray(0,f);return this.disposeData(h.dataId),v}var m=ce().getBool("WEBGL_PACK")&&l===!0,y=m?Pd(o):o,x=m?new bT(y):new yT(y),E=this.runWebGLProgram(x,[{shape:y,dtype:s,dataId:e}],"float32"),w=this.texData.get(E.dataId),C=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(w.texture,w.texShape[0],w.texShape[1]).subarray(0,f);return this.disposeData(E.dataId),C},t.prototype.time=function(e){return Ee(this,void 0,void 0,(function(){var n,a,o,s,l,f,h;return Ce(this,(function(p){switch(p.label){case 0:return n=this.activeTimers,a=[],o=!1,this.programTimersStack==null?(this.programTimersStack=a,o=!0):this.activeTimers.push(a),this.activeTimers=a,e(),s=Vo(this.activeTimers.map((function(v){return v.query}))).filter((function(v){return v!=null})),l=Vo(this.activeTimers.map((function(v){return v.name}))).filter((function(v){return v!=null})),this.activeTimers=n,o&&(this.programTimersStack=null),f={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(s)]:[3,2];case 1:return h=p.sent(),f.kernelMs=eR(h),f.getExtraProfileInfo=function(){return h.map((function(v,m){return{name:l[m],ms:v}})).map((function(v){return v.name+": "+v.ms})).join(", ")},[3,3];case 2:f.kernelMs={error:"WebGL query timers are not supported in this environment."},p.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,f]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Nr(),endMs:null}},t.prototype.endTimer=function(e){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Nr(),e)},t.prototype.getQueryTime=function(e){return Ee(this,void 0,void 0,(function(){var n;return Ce(this,(function(a){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(n=e).endMs-n.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var n=this.texData.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var n=this.texData.get(e),a=n.texture,o=n.dtype,s=n.texShape,l=n.usage,f=n.isPacked,h=n.slice,p=h&&h.origDataId||e,v=this.dataRefCount.get(p);v>1?this.dataRefCount.set(p,v-1):(this.dataRefCount.delete(p),a!=null&&(this.numBytesInGPU-=this.computeBytes(s,o),this.textureManager.releaseTexture(a,s,l,f)));var m=this.texData.get(e);m.texture=null,m.texShape=null,m.isPacked=!1,m.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return ce().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=j.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,n){var a=this;return n===void 0&&(n=128),this.getCPUBackend()!=null&&e.every((function(o){return a.texData.get(o.dataId).texture==null&&o.size<n}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,n){var a=this.makeOutput(e.shape,"complex64");return this.texData.get(a.dataId).complexTensors={real:j.keep(e.clone()),imag:j.keep(n.clone())},a},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,n,a);if(Se(a)===0)return nn([],a,e.dtype);var o=this.texData.get(e.dataId).isPacked,s=Cx(e.shape,n,a);if(o||!s){var l=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dD(a):new hD(a),f=l.getCustomSetupFunc(n);return this.compileAndRun(l,[e],null,f)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,n,a)},t.prototype.shallowSlice=function(e,n,a){var o=this.texData.get(e.dataId),s=this.makeOutput(a,e.dtype),l=this.texData.get(s.dataId);Object.assign(l,o),l.shape=a,l.dtype=e.dtype;var f=_x(n,e.strides);o.slice&&(f+=o.slice.flatOffset),l.slice={flatOffset:f,origDataId:o.slice&&o.slice.origDataId||e.dataId};var h=this.dataRefCount.get(l.slice.origDataId)||1;return this.dataRefCount.set(l.slice.origDataId,h+1),s},t.prototype.stridedSlice=function(e,n,a,o){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,n,a,o);var s=Zp(n,a,o);if(s.some((function(f){return f===0})))return nn([],s);var l=new pD(n,o,s);return this.compileAndRun(l,[e])},t.prototype.reverse=function(e,n){var a=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lD(e.shape,n):new sD(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.concat=function(e,n){if(e[0].dtype==="complex64"){var a=e.map((function(y){return or(y)})),o=e.map((function(y){return Mr(y)}));return en(this.concat(a,n),this.concat(o,n))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,n);if(e.length===1)return e[0];if(e.length>ce().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var s=Math.floor(e.length/2),l=this.concat(e.slice(0,s),n),f=this.concat(e.slice(s),n);return this.concat([l,f],n)}if(ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var h=new aT(e.map((function(y){return y.shape})),n);return this.compileAndRun(h,e)}var p=jo(e.map((function(y){return y.shape})),n),v=e.map((function(y){return y.as2D(-1,Se(y.shape.slice(n)))})),m=new rT(v.map((function(y){return y.shape})));return this.compileAndRun(m,v).reshape(p)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Lb,e.dtype);var n=new Pe(e.shape,Lb);return this.compileAndRun(n,[e])},t.prototype.batchMatMul=function(e,n,a,o){var s=a?e.shape[2]:e.shape[1],l=o?n.shape[1]:n.shape[2],f=a?e.shape[1]:e.shape[2],h=e.shape[0];if((s===1||l===1)&&f>1e3){a&&(e=e.transpose([0,2,1])),o&&(n=n.transpose([0,2,1]));var p=l===1?e:e.as3D(h,f,1),v=l===1?2:1,m=l===1?n.as3D(h,1,f):n;return this.multiply(p,m).sum(v,!0)}var y=tn(e.dtype,n.dtype),x=new jd(e.shape,[h,s,l],a,o);return this.compileAndRun(x,[e,n],y)},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,o=e.transposeA,s=e.transposeB,l=e.bias,f=e.activation,h=e.preluActivationWeights,p=o?n.shape[2]:n.shape[1],v=s?a.shape[1]:a.shape[2],m=n.shape[0],y=tn(n.dtype,a.dtype),x=l!=null,E=h!=null,w=f?Jl(f,!0):null,C=new jd(n.shape,[m,p,v],o,s,x,w,E),_=[n,a];return l&&_.push(l),h&&_.push(h),this.compileAndRun(C,_,y)},t.prototype.multiply=function(e,n){if(e.dtype==="complex64"){var a=this.texData.get(e.dataId),o=this.texData.get(n.dataId),s=new Sb(JA,e.shape,n.shape),l=new Sb($A,e.shape,n.shape),f=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag),this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],h=this.compileAndRun(s,f),p=this.compileAndRun(l,f),v=this.complex(h,p);return h.dispose(),p.dispose(),v}if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.multiply(e,n);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,Rb,e.dtype);var m=new _t(Rb,e.shape,n.shape);return this.compileAndRun(m,[e,n],e.dtype)},t.prototype.batchNormalization=function(e,n,a,o,s,l){var f=[e,n,a],h=null;l!=null&&(h=l.shape,f.push(l));var p=null;if(s!=null&&(p=s.shape,f.push(s)),ce().getBool("WEBGL_PACK_NORMALIZATION")){var v=new ZA(e.shape,n.shape,a.shape,h,p,o);return this.compileAndRun(v,f)}var m=new QA(e.shape,n.shape,a.shape,h,p,o);return this.compileAndRun(m,f)},t.prototype.localResponseNormalization4D=function(e,n,a,o,s){var l=ce().getBool("WEBGL_PACK_NORMALIZATION")?new XT(e.shape,n,a,o,s):new GT(e.shape,n,a,o,s);return this.compileAndRun(l,[e])},t.prototype.LRNGrad=function(e,n,a,o,s,l,f){var h=new qT(n.shape,o,s,l,f);return this.compileAndRun(h,[n,a,e])},t.prototype.tile=function(e,n){if(e.dtype==="string"){var a=this.readSync(e.dataId).map((function(s){return mc(s)}));return Mx(Le(e.shape,e.dtype,a),n)}var o=new mD(e.shape,n);return this.compileAndRun(o,[e])},t.prototype.pad=function(e,n,a){var o=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new eD(e.shape,n,a):new $T(e.shape,n,a);return this.compileAndRun(o,[e])},t.prototype.transpose=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,n);var a=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yD(e.shape,n):new gD(e.shape,n);return this.compileAndRun(a,[e])},t.prototype.gather=function(e,n,a){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.gather(e,n,a);var o=new ST(e.shape,n.size,a);return this.compileAndRun(o,[e,n])},t.prototype.batchToSpaceND=function(e,n,a){B(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var o=n.reduce((function(v,m){return v*m})),s=Ec(e.shape,n,o),l=Cc(s.length,n.length),f=_c(e.shape,n,o),h=bx(a,n.length),p=xx(f,a,n.length);return e.reshape(s).transpose(l).reshape(f).slice(h,p)},t.prototype.spaceToBatchND=function(e,n,a){B(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var o=n.reduce((function(m,y){return m*y})),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var f=e.pad(s),h=Ec(f.shape,n,o,!1),p=Cc(h.length,n.length,!1),v=_c(f.shape,n,o,!1);return f.reshape(h).transpose(p).reshape(v)},t.prototype.reduce=function(e,n,a){var o=e.shape[0],s=e.shape[1],l=Hd(s),f=new tD({windowSize:l,inSize:s,batchSize:o},n),h=this.compileAndRun(f,[e],a);return h.shape[1]===1?h:this.reduce(h,n,a)},t.prototype.argReduce=function(e,n,a){a===void 0&&(a=null);var o=e.shape[0],s=e.shape[1];a!=null&&(o=a.shape[0],s=a.shape[1]);var l=Hd(s),f=new HA({windowSize:l,inSize:s,batchSize:o},n,a==null),h=[e];a!=null&&h.push(a);var p=this.compileAndRun(f,h,"int32");return p.shape[1]===1?p:this.argReduce(e,n,p)},t.prototype.argReducePacked=function(e,n,a){a===void 0&&(a=null);var o=a!=null?a.shape:e.shape,s=Hd(o[o.length-1]),l=new XA(o,s,n,a==null),f=a==null?[e]:[e,a],h=this.compileAndRun(l,f,"int32");return h.rank===e.rank?this.argReducePacked(e,n,h):h},t.prototype.sum=function(e,n){Hn("sum",n,e.rank);var a=an(e.shape,n),o=a[0],s=Se(a[1]),l=e.as2D(-1,s),f=kd(e.dtype);return this.reduce(l,"sum",f).reshape(o)},t.prototype.prod=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,n);var a=an(e.shape,n),o=a[0],s=Se(a[1]),l=e.as2D(-1,s),f=kd(e.dtype);return this.reduce(l,"prod",f).reshape(o)},t.prototype.unsortedSegmentSum=function(e,n,a){var o=0,s=Pr([o],e.rank),l=e;s!=null&&(l=e.transpose(s),o=Hr(1,e.rank)[0]);var f=(function(y,x,E){for(var w=[],C=y.length,_=0;_<C;_++)_!==x?w.push(y[_]):w.push(E);return w})(l.shape,o,a),h=Se([l.shape[o]]),p=l.as2D(-1,h),v=kd(e.dtype),m=this.segOpCompute(p,"unsortedSegmentSum",n,v,a).reshape(f);return s!=null&&(m=m.transpose(Xp(s))),m},t.prototype.segOpCompute=function(e,n,a,o,s){var l=e.shape[0],f=e.shape[1],h=(function(m,y){var x,E=!1;for(m<=Ex?(x=m,E=!0):x=vp(m,Math.floor(Math.sqrt(m)));!E;)x>y||x===m?E=!0:x=vp(m,x+1);return x})(f,s),p=new cD({windowSize:h,inSize:f,batchSize:l,numSegments:s}),v=this.compileAndRun(p,[e,a],o);return v.shape[1]===s?v:(a=wc(0,s).tile([f/h]),this.segOpCompute(v,n,a,o,s))},t.prototype.argMinMaxReduce=function(e,n,a){var o=[n];if(Hn("arg"+a.charAt(0).toUpperCase()+a.slice(1),o,e.rank),!ce().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var s=an(e.shape,o),l=s[0],f=Se(s[1]),h=e.as2D(-1,f);return this.argReduce(h,a).reshape(l)}return this.argReducePacked(e,a)},t.prototype.argMin=function(e,n){return this.argMinMaxReduce(e,n,"min")},t.prototype.argMax=function(e,n){return this.argMinMaxReduce(e,n,"max")},t.prototype.cumsum=function(e,n,a,o){if(n!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+n);var s=new dT(e.shape,a,o);return this.compileAndRun(s,[e])},t.prototype.equal=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(equal(a, b));
`,"bool");var a=new _t("return float(a == b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.notEqual=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(notEqual(a, b));
`,"bool");var a=new _t("return float(a != b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.less=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.less(e,n);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThan(a, b));
`,"bool");var a=new _t("return float(a < b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.lessEqual=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(lessThanEqual(a, b));
`,"bool");var a=new _t("return float(a <= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greater=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.greater(e,n);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThan(a, b));
`,"bool");var a=new _t("return float(a > b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.greaterEqual=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var a=new _t("return float(a >= b);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalNot=function(e){var n=new Pe(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(n,[e])},t.prototype.logicalAnd=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var a=new _t("return float(a >= 1.0 && b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.logicalOr=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var a=new _t("return float(a >= 1.0 || b >= 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n],"bool")},t.prototype.select=function(e,n,a){var o=new fD(e.rank,n.shape,n.rank);return this.compileAndRun(o,[e,n,a],tn(n.dtype,a.dtype))},t.prototype.where=function(e){bc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var n=e.dataSync();return tv(e.shape,n)},t.prototype.topk=function(e,n,a){return kx(e.dataSync(),e.shape,e.dtype,n)},t.prototype.min=function(e,n){Hn("min",n,e.rank);var a=an(e.shape,n),o=a[0],s=Se(a[1]),l=e.as2D(-1,s);return this.reduce(l,"min",l.dtype).reshape(o)},t.prototype.minimum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.minimum(e,n);var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new _t(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.mod=function(e,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new _t(`if (b == 0.0) return NAN;
  return mod(a, b);`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.max=function(e,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,n);Hn("max",n,e.rank);var a=an(e.shape,n),o=a[0],s=Se(a[1]),l=e.as2D(-1,s);return this.reduce(l,"max",l.dtype).reshape(o)},t.prototype.maximum=function(e,n){if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.maximum(e,n);var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new _t(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.all=function(e,n){Hn("all",n,e.rank);var a=an(e.shape,n),o=a[0],s=Se(a[1]),l=e.as2D(-1,s);return this.reduce(l,"all",l.dtype).reshape(o)},t.prototype.any=function(e,n){Hn("any",n,e.rank);var a=an(e.shape,n),o=a[0],s=Se(a[1]),l=e.as2D(-1,s);return this.reduce(l,"any",l.dtype).reshape(o)},t.prototype.realDivide=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var a=new _t(`
if (a == b) {
  return 1.0;
};
return a / b;`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"float32")},t.prototype.floorDiv=function(e,n){if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var a=new _t(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,e.shape,n.shape);return this.compileAndRun(a,[e,n],"int32")},t.prototype.add=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,Vd);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.add(e,n);var a=tn(e.dtype,n.dtype);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,Vd,a);var o=new _t(Vd,e.shape,n.shape);return this.compileAndRun(o,[e,n],a)},t.prototype.packedUnaryOp=function(e,n,a){var o=new Qu(e.shape,n);return this.compileAndRun(o,[e],a)},t.prototype.packedBinaryOp=function(e,n,a,o,s){s===void 0&&(s=!1);var l=new fa(a,e.shape,n.shape,s);return this.compileAndRun(l,[e,n],o)},t.prototype.complexSeparableBinaryOp=function(e,n,a){var o=this,s=this.texData.get(e.dataId),l=this.texData.get(n.dataId),f=[[s.complexTensors.real,l.complexTensors.real],[s.complexTensors.imag,l.complexTensors.imag]].map((function(m){var y=m[0],x=m[1],E=o.makeComplexComponentTensorInfo(e,y),w=o.makeComplexComponentTensorInfo(n,x),C=new _t(a,e.shape,n.shape);return o.compileAndRun(C,[E,w],tn(y.dtype,x.dtype))})),h=f[0],p=f[1],v=this.complex(h,p);return h.dispose(),p.dispose(),v},t.prototype.makeComplexComponentTensorInfo=function(e,n){return{dataId:n.dataId,dtype:n.dtype,shape:e.shape}},t.prototype.addN=function(e){if(e.length===1)return e[0];if(e.length>ce().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var n=Math.floor(e.length/2),a=this.addN(e.slice(0,n)),o=this.addN(e.slice(n));return this.addN([a,o])}var s=e.map((function(h){return h.dtype})).reduce((function(h,p){return tn(h,p)})),l=e.map((function(h){return h.shape})),f=ce().getBool("WEBGL_PACK")?new PA(e[0].shape,l):new UA(e[0].shape,l);return this.compileAndRun(f,e,s)},t.prototype.subtract=function(e,n){if(e.dtype==="complex64"&&n.dtype==="complex64")return this.complexSeparableBinaryOp(e,n,Wd);if(this.shouldExecuteOnCPU([e,n]))return this.cpuBackend.subtract(e,n);var a=tn(e.dtype,n.dtype);if(ce().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,n,Wd,e.dtype);var o=new _t(Wd,e.shape,n.shape);return this.compileAndRun(o,[e,n],a)},t.prototype.pow=function(e,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new _t(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,e.shape,n.shape),o=tn(e.dtype,n.dtype);return this.compileAndRun(a,[e,n],o)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,zb,e.dtype);var n=new Pe(e.shape,zb);return this.compileAndRun(n,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ub,e.dtype);var n=new Pe(e.shape,Ub);return this.compileAndRun(n,[e])},t.prototype.sign=function(e){var n=new Pe(e.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(n,[e])},t.prototype.isNaN=function(e){var n=new Pe(e.shape,"return float(isnan(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isInf=function(e){var n=new Pe(e.shape,"return float(isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.isFinite=function(e){var n=new Pe(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(n,[e],"bool")},t.prototype.round=function(e){var n=new Pe(e.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(n,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Pb,e.dtype);var n=new Pe(e.shape,Pb);return this.compileAndRun(n,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Hb,e.dtype);var n=new Pe(e.shape,Hb);return this.compileAndRun(n,[e])},t.prototype.softmax=function(e,n){var a=Ht([n],e.shape),o=this.max(e,a),s=Dn(o.shape,a),l=this.subtract(e,o.reshape(s)),f=this.exp(l),h=this.sum(f,a).reshape(s);return this.realDivide(f,h)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,e.dtype);var n=new Pe(e.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(n,[e])},t.prototype.log1p=function(e){var n=new Pe(e.shape,"return log(1.0 + x);");return this.compileAndRun(n,[e])},t.prototype.sqrt=function(e){var n=new Pe(e.shape,"return sqrt(x);");return this.compileAndRun(n,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var n=new Pe(e.shape,"return inversesqrt(x);");return this.compileAndRun(n,[e])},t.prototype.reciprocal=function(e){var n=new Pe(e.shape,"return 1.0 / x;");return this.compileAndRun(n,[e])},t.prototype.relu=function(e){var n;return n=ce().getBool("WEBGL_PACK")?new Qu(e.shape,Vx):new Pe(e.shape,Ux),this.compileAndRun(n,[e])},t.prototype.relu6=function(e){var n;return n=ce().getBool("WEBGL_PACK")?new Qu(e.shape,Wx):new Pe(e.shape,Px),this.compileAndRun(n,[e])},t.prototype.prelu=function(e,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(zx,e.shape,n.shape):new _t(Lx,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.elu=function(e){if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,jx,e.dtype);var n=new Pe(e.shape,Hx);return this.compileAndRun(n,[e])},t.prototype.eluDer=function(e,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,e.shape,n.shape):new _t("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.selu=function(e){var n=new Pe(e.shape,xD);return this.compileAndRun(n,[e])},t.prototype.int=function(e){var n=new Pe(e.shape,"return float(int(x));");return this.compileAndRun(n,[e],"int32")},t.prototype.clip=function(e,n,a){var o,s=(o=ce().getBool("WEBGL_PACK_CLIP")?new tT(e.shape):new eT(e.shape)).getCustomSetupFunc(n,a);return this.compileAndRun(o,[e],null,s)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Fb,e.dtype);var n=new Pe(e.shape,Fb);return this.compileAndRun(n,[e])},t.prototype.complexAbs=function(e){var n=this.texData.get(e.dataId),a=new nT(e.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)];return this.compileAndRun(a,o)},t.prototype.sigmoid=function(e){var n=new Pe(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(n,[e])},t.prototype.softplus=function(e){var n=new Pe(e.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(n,[e])},t.prototype.sin=function(e){var n=new Pe(e.shape,wD);return this.compileAndRun(n,[e])},t.prototype.cos=function(e){var n=new Pe(e.shape,ED);return this.compileAndRun(n,[e])},t.prototype.tan=function(e){var n=new Pe(e.shape,"return tan(x);");return this.compileAndRun(n,[e])},t.prototype.asin=function(e){var n=new Pe(e.shape,CD);return this.compileAndRun(n,[e])},t.prototype.acos=function(e){var n=new Pe(e.shape,_D);return this.compileAndRun(n,[e])},t.prototype.atan=function(e){var n=new Pe(e.shape,SD);return this.compileAndRun(n,[e])},t.prototype.atan2=function(e,n){var a=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,e.shape,n.shape):new _t(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,e.shape,n.shape);return this.compileAndRun(a,[e,n])},t.prototype.sinh=function(e){var n=new Pe(e.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.cosh=function(e){var n=new Pe(e.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(n,[e])},t.prototype.tanh=function(e){var n=new Pe(e.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(n,[e])},t.prototype.asinh=function(e){var n=new Pe(e.shape,RD);return this.compileAndRun(n,[e])},t.prototype.acosh=function(e){var n=new Pe(e.shape,AD);return this.compileAndRun(n,[e])},t.prototype.atanh=function(e){var n=new Pe(e.shape,TD);return this.compileAndRun(n,[e])},t.prototype.erf=function(e){var n=new Pe(e.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(n,[e])},t.prototype.step=function(e,n){var a=new Pe(e.shape,(function(o){return o===void 0&&(o=0),br+`
    return x > 0.0 ? 1.0 : float(`+o+`);
  `})(n));return this.compileAndRun(a,[e])},t.prototype.conv2dByMatMul=function(e,n,a,o,s,l){var f=e.shape,h=this.texData.get(e.dataId),p=a.inChannels,v=f[0]*f[1]*f[2],m=a.outChannels,y=a.dataFormat==="channelsLast",x=(v===1||m===1)&&p>1e3,E=f[2]%2!=0&&!!h.isPacked;if(x||!ce().getBool("WEBGL_LAZILY_UNPACK")||!ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!E){var w=y?f[0]*f[1]*f[2]:f[0]*f[2]*f[3],C=this.reshape(e,[1,w,a.inChannels]),_=this.reshape(n,[1,a.inChannels,a.outChannels]);return this.reshape(this.fusedBatchMatMul({a:C,b:_,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:l}),a.outShape)}var R=y?f[0]*f[1]*(f[2]+1):f[0]*f[2]*(f[3]+1),A={dataId:e.dataId,shape:[1,R,a.inChannels],dtype:e.dtype},T=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,B(Kl(h.shape,A.shape),(function(){return"packed reshape "+h.shape+" to "+A.shape+" isn't free"}));var N=this.reshape(n,[1,a.inChannels,a.outChannels]),M=this.fusedBatchMatMul({a:A,b:N,transposeA:!1,transposeB:!1,bias:o,activation:s,preluActivationWeights:l}),I=this.texData.get(M.dataId);return B(I.isPacked,(function(){return"batchMatMul result is expected to be packed"})),h.shape=T,I.shape=a.outShape,j.makeTensorFromDataId(M.dataId,a.outShape,M.dtype)},t.prototype.conv2dWithIm2Row=function(e,n,a,o,s,l){var f=a.filterWidth,h=a.filterHeight,p=a.inChannels,v=a.outWidth,m=a.outHeight,y=a.dataFormat==="channelsLast",x=f*h*p,E=m*v,w=[x,E],C=e.squeeze([0]),_=n.reshape([1,x,-1]),R=new jT(w,C.shape,a),A=this.compileAndRun(R,[C]).reshape([1,w[0],w[1]]),T=o!=null,N=l!=null,M=s?Jl(s,!0):null,I=new jd(A.shape,[1,E,a.outChannels],!0,!1,T,M,N),k=[A,_];o&&k.push(o),N&&k.push(l);var F=this.compileAndRun(I,k);return y?F.reshape([1,m,v,a.outChannels]):F.reshape([1,a.outChannels,m,v])},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,o=e.convInfo,s=e.bias,l=e.activation,f=e.preluActivationWeights;if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,a,o,s,l,f);if(ce().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,a,o,s,l,f);var h=s!=null,p=f!=null,v=l?Jl(l,!1):null,m=new Ab(o,h,v,p),y=[n,a];return s&&y.push(s),f&&y.push(f),this.compileAndRun(m,y)},t.prototype.conv2d=function(e,n,a){if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(e,n,a);if(ce().getBool("WEBGL_CONV_IM2COL")&&e.shape[0]===1)return this.conv2dWithIm2Row(e,n,a);var o=new Ab(a);return this.compileAndRun(o,[e,n])},t.prototype.conv2dDerInput=function(e,n,a){var o=new oT(a);return this.compileAndRun(o,[e,n])},t.prototype.conv2dDerFilter=function(e,n,a){var o=new iT(a);return this.compileAndRun(o,[e,n])},t.prototype.fusedDepthwiseConv2D=function(e){var n,a=e.input,o=e.filter,s=e.convInfo,l=e.bias,f=e.activation,h=e.preluActivationWeights,p=ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&s.strideWidth<=2&&s.outChannels/s.inChannels==1,v=f?Jl(f,p):null,m=[a,o],y=l!=null,x=h!=null;return y&&m.push(l),x&&m.push(h),p?(n=new Db(s,y,v,x),this.compileAndRun(n,m)):(n=new Tb(s,y,v,x),this.compileAndRun(n,m))},t.prototype.depthwiseConv2D=function(e,n,a){var o;return ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1?(o=new Db(a),this.compileAndRun(o,[e,n])):(o=new Tb(a),this.compileAndRun(o,[e,n]))},t.prototype.depthwiseConv2DDerInput=function(e,n,a){var o=new cT(a);return this.compileAndRun(o,[e,n])},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){var o=new lT(a);return this.compileAndRun(o,[e,n])},t.prototype.conv3d=function(e,n,a){var o=new fT(a);return this.compileAndRun(o,[e,n])},t.prototype.conv3dDerInput=function(e,n,a){var o=new sT(a);return this.compileAndRun(o,[e,n])},t.prototype.conv3dDerFilter=function(e,n,a){var o=new uT(a);return this.compileAndRun(o,[e,n])},t.prototype.maxPool=function(e,n){var a=new Gd(n,"max",!1);return this.compileAndRun(a,[e])},t.prototype.avgPool=function(e,n){var a=new Gd(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPoolBackprop=function(e,n,a,o){var s=new Gd(o,"max",!0),l=this.compileAndRun(s,[n]),f=new KT(o),h=this.compileAndRun(f,[e,l],n.dtype);return l.dispose(),h},t.prototype.avgPoolBackprop=function(e,n,a){var o=new KA(a);return this.compileAndRun(o,[e],n.dtype)},t.prototype.cast=function(e,n){return Tx(e,n,this)},t.prototype.unstack=function(e,n){for(var a=e.shape[n],o=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(o[s++]=e.shape[l]);var f=new Array(e.rank).fill(0),h=e.shape.slice();h[n]=1;var p=new Array(a);for(l=0;l<p.length;l++)f[n]=l,p[l]=this.slice(e,f,h).reshape(o);return p},t.prototype.avgPool3d=function(e,n){var a=new qd(n,"avg",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,n,a){var o=new YA(a);return this.compileAndRun(o,[e],n.dtype)},t.prototype.maxPool3d=function(e,n){var a=new qd(n,"max",!1);return this.compileAndRun(a,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,n,a,o){var s=new qd(o,"max",!0),l=this.compileAndRun(s,[n]),f=new YT(o),h=this.compileAndRun(f,[e,l],n.dtype);return l.dispose(),h},t.prototype.reshape=function(e,n){var a=this.texData.get(e.dataId);if(a.isPacked&&!Kl(e.shape,n)&&(a.texture===null||!Kl(a.shape,n))){var o=this.packedReshape(e,n);return j.makeTensorFromDataId(o.dataId,o.shape,o.dtype)}return Cp(e,n)},t.prototype.resizeBilinear=function(e,n,a,o){var s=ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new iD(e.shape,n,a,o):new aD(e.shape,n,a,o);return this.compileAndRun(s,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,n,a){var o=new rD(e,n,a);return this.compileAndRun(o,[e])},t.prototype.resizeNearestNeighbor=function(e,n,a,o){var s=new uD(e.shape,n,a,o);return this.compileAndRun(s,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){var o=new oD(e,n,a);return this.compileAndRun(o,[e])},t.prototype.multinomial=function(e,n,a,o){var s=n?e:ga(e),l=s.shape[0],f=s.shape[1],h=new QT(l,f,a),p=h.getCustomSetupFunc(o);return this.compileAndRun(h,[s],"int32",p)},t.prototype.oneHot=function(e,n,a,o){var s=new ZT(e.size,n,a,o);return this.compileAndRun(s,[e])},t.prototype.diag=function(e){var n=new gT(e.size);return this.compileAndRun(n,[e])},t.prototype.nonMaxSuppression=function(e,n,a,o,s){return bc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),$p(e.dataSync(),n.dataSync(),a,o,s)},t.prototype.cropAndResize=function(e,n,a,o,s,l){var f=new hT(e.shape,n.shape,o,s,l);return this.compileAndRun(f,[e,n,a],"float32")},t.prototype.depthToSpace=function(e,n,a){B(n>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+n}));var o=e.shape[0],s=a==="NHWC"?e.shape[1]:e.shape[2],l=a==="NHWC"?e.shape[2]:e.shape[3],f=a==="NHWC"?e.shape[3]:e.shape[1],h=s*n,p=l*n,v=f/(n*n),m=new mT(a==="NHWC"?[o,h,p,v]:[o,v,h,p],n,a);return this.compileAndRun(m,[e])},t.prototype.split=function(e,n,a){return Ox(e,n,a)},t.prototype.scatterND=function(e,n,a){var o=Sc(0,e,a),s=o.sliceRank,l=o.numUpdates,f=o.sliceSize,h=o.strides,p=o.outputSize,v=[p/f,f],m=e.reshape([l,s]),y=n.reshape([l,f]);if(p===0)return Cp(nn([]),a);var x=ge(0),E=new kb(l,s,m.rank,y.rank,h,v);return this.compileAndRun(E,[y,m,x]).reshape(a)},t.prototype.sparseToDense=function(e,n,a,o){var s=Sc(0,e,a),l=s.sliceRank,f=s.numUpdates,h=s.strides,p=s.outputSize,v=new kb(f,l,e.rank,n.rank,h,[p,1]);return this.compileAndRun(v,[n,e,o]).reshape(a)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,n){var a=this.texData.get(e.dataId),o=new Ob(ET,e.shape,n),s=new Ob(CT,e.shape,n),l=[this.makeComplexComponentTensorInfo(e,a.complexTensors.real),this.makeComplexComponentTensorInfo(e,a.complexTensors.imag)],f=this.compileAndRun(o,l),h=this.compileAndRun(s,l),p=this.complex(f,h).as2D(e.shape[0],e.shape[1]);return f.dispose(),h.dispose(),p},t.prototype.gatherND=function(e,n){var a=n.shape,o=a[a.length-1],s=wx(e,n),l=s[0],f=s[1],h=s[2],p=s[3],v=n.reshape([f,o]),m=e.reshape([e.size/h,h]),y=new RT(o,p,[f,h]);return this.compileAndRun(y,[m,v]).reshape(l)},t.prototype.fill=function(e,n,a){if((a=a||hs(n))==="string"){var o=vc(a,Se(e));return o.fill(n),j.makeTensor(o,e,a,this)}var s=new _T(e,n),l=s.getCustomSetupFunc(n);return this.compileAndRun(s,[],a,l)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,e.dtype==="string"?"":0,e.dtype)},t.prototype.linspace=function(e,n,a){return Dx(e,n,a)},t.prototype.makeTensorInfo=function(e,n){var a=this.write(null,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}},t.prototype.makeOutput=function(e,n){var a=this.makeTensorInfo(e,n).dataId;return j.makeTensorFromDataId(a,e,n,this)},t.prototype.unpackTensor=function(e){var n=new ND(e.shape);return this.runWebGLProgram(n,[e],e.dtype)},t.prototype.packTensor=function(e){var n=new JT(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,n){var a=[gc(e.shape)].concat(yc(e.shape)),o={dtype:e.dtype,shape:a,dataId:e.dataId},s=[gc(n)].concat(yc(n)),l=new nD(s,a),f=this.runWebGLProgram(l,[o],e.dtype,null,!0);return{dataId:f.dataId,shape:n,dtype:f.dtype}},t.prototype.decode=function(e){var n,a=this.texData.get(e),o=a.isPacked,s=a.shape,l=a.dtype,f=Pd(s);return n=o?new vT(f):new pT(f),{dtype:l,shape:s,dataId:this.runWebGLProgram(n,[{shape:f,dtype:l,dataId:e}],l,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,n,a,o,s){var l=this;s===void 0&&(s=!1);var f=this.makeTensorInfo(e.outputShape,a),h=this.texData.get(f.dataId);if(e.packedOutput&&(h.isPacked=!0),e.outPackingScheme===as.DENSE){var p=Ju(e.outputShape);h.texShape=p.map((function(R){return 2*R}))}if(e.outTexUsage!=null&&(h.usage=e.outTexUsage),Se(f.shape)===0)return h.values=ns(f.dtype,0),f;var v=[],m=n.map((function(R){if(R.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var A=l.texData.get(R.dataId);if(A.texture==null){if(!e.packedInputs&&Se(R.shape)<=ce().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:R.shape,texData:null,isUniform:!0,uniformValues:A.values};e.packedInputs&&(A.isPacked=!0,A.shape=R.shape)}else if(!!A.isPacked!=!!e.packedInputs)R=A.isPacked?l.unpackTensor(R):l.packTensor(R),v.push(R),A=l.texData.get(R.dataId);else if(A.isPacked&&!Kl(A.shape,R.shape)){var T=R,N=R.shape;R.shape=A.shape,R=l.packedReshape(R,N),v.push(R),A=l.texData.get(R.dataId),T.shape=N}return l.uploadToGPU(R.dataId),{shape:R.shape,texData:A,isUniform:!1}}));this.uploadToGPU(f.dataId);var y,x={shape:f.shape,texData:h,isUniform:!1},E=(function(R,A,T){var N="";A.concat(T).forEach((function(k){var F=k.texData!=null&&k.texData.slice!=null&&k.texData.slice.flatOffset>0,W=k.isUniform?"uniform":k.texData.texShape;N+=k.shape+"_"+W+"_"+F}));var M=R.userCode,I=R.constructor.name;return I+="_"+N+"_"+M})(e,m,x),w=this.getAndSaveBinary(E,(function(){return(function(R,A,T,N){var M=A.userCode,I=T.map((function(K,ie){var se={logicalShape:K.shape,texShape:K.isUniform?null:K.texData.texShape,isUniform:K.isUniform,isPacked:!K.isUniform&&K.texData.isPacked,flatOffset:null};return K.texData!=null&&K.texData.slice!=null&&K.texData.slice.flatOffset>0&&(se.flatOffset=K.texData.slice.flatOffset),{name:A.variableNames[ie],shapeInfo:se}})),k=I.map((function(K){return K.shapeInfo})),F={logicalShape:N.shape,texShape:N.texData.texShape,isUniform:!1,isPacked:N.texData.isPacked,flatOffset:null},W=VA(I,F,M,A.packedInputs),P=R.createProgram(W),oe=null,ee=R.getUniformLocation(P,"NAN",!1);ce().getNumber("WEBGL_VERSION")===1&&(oe=R.getUniformLocation(P,"INFINITY",!1));for(var ae={},z=0;z<A.variableNames.length;z++){var G=A.variableNames[z];ae[G]=R.getUniformLocation(P,G,!1),ae["offset"+G]=R.getUniformLocation(P,"offset"+G,!1)}return{program:A,source:W,webGLProgram:P,uniformLocations:ae,inShapeInfos:k,outShapeInfo:F,infLoc:oe,nanLoc:ee}})(l.gpgpu,e,m,x)})),C=this.activeTimers!=null;if(C&&(y=this.startTimer()),(function(R,A,T,N,M){Mb(A.inShapeInfos,T),Mb([A.outShapeInfo],[N]);var I=N.texData.texture,k=N.texData.texShape;N.texData.isPacked?R.setOutputPackedMatrixTexture(I,k[0],k[1]):R.setOutputMatrixTexture(I,k[0],k[1]),R.setProgram(A.webGLProgram),ce().getNumber("WEBGL_VERSION")===1&&A.infLoc!==null&&R.gl.uniform1f(A.infLoc,1/0),A.nanLoc!==null&&R.gl.uniform1f(A.nanLoc,NaN),T.forEach((function(F,W){var P=A.program.variableNames[W],oe=A.uniformLocations[P],ee=A.uniformLocations["offset"+P];if(oe!=null)if(F.isUniform)if(Se(F.shape)<2)R.gl.uniform1f(oe,F.uniformValues[0]);else{var ae=F.uniformValues;ae instanceof Float32Array||(ae=new Float32Array(ae)),R.gl.uniform1fv(oe,ae)}else F.texData.slice!=null&&ee!=null&&R.gl.uniform1i(ee,F.texData.slice.flatOffset),R.setInputMatrixTexture(F.texData.texture,oe,W)})),M?.(R,A.webGLProgram),R.executeProgram()})(this.gpgpu,w,m,x,o),v.forEach((function(R){return l.disposeData(R.dataId)})),C&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)})),!ce().getBool("WEBGL_LAZILY_UNPACK")&&h.isPacked&&s===!1){var _=this.unpackTensor(f);return this.disposeData(f.dataId),_}return f},t.prototype.compileAndRun=function(e,n,a,o,s){s===void 0&&(s=!1),a=a||n[0].dtype;var l=this.runWebGLProgram(e,n,a,o,s);return j.makeTensorFromDataId(l.dataId,l.shape,l.dtype)},t.prototype.getAndSaveBinary=function(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(ce().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(n){e.gpgpu.deleteProgram(e.binaryCache[n].webGLProgram),delete e.binaryCache[n]})),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=be((function(){if(!ce().get("WEBGL_RENDER_FLOAT32_ENABLED")){var n=ce().getBool("DEBUG");ce().set("DEBUG",!1);var a=e.abs(ge(1e-8)).dataSync()[0];if(ce().set("DEBUG",n),a>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var n,a=this.texData.get(e),o=a.shape,s=a.dtype,l=a.values,f=a.texture,h=a.usage,p=a.isPacked;if(f==null){var v,m=this.activeTimers!=null;m&&(v=Nr());var y=a.texShape;if(y==null&&(y=zR(o,p),a.texShape=y),l!=null){var x=Pd(o),E=void 0,w=y[1],C=y[0],_=l instanceof Uint8Array;p?(w=(n=ps(y[0],y[1]))[0],C=n[1],E=new wT(x,[C,w],_)):E=new xT(x,[C,w],_);var R=this.makeTensorInfo([C,w],s);this.texData.get(R.dataId).usage=_?Wn.PIXELS:Wn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(R.dataId),w,C,l);var A=this.runWebGLProgram(E,[R],s,null,!0),T=this.texData.get(A.dataId);a.texture=T.texture,a.texShape=T.texShape,a.isPacked=T.isPacked,a.usage=T.usage,this.disposeData(R.dataId),this.texData.delete(A.dataId),a.values=null,m&&(this.uploadWaitMs+=Nr()-v)}else{var N=this.acquireTexture(y,h,s,p);a.texture=N}}},t.prototype.convertAndCacheOnCPU=function(e,n){var a=this.texData.get(e),o=a.dtype;return this.releaseGPUData(e),n!=null&&(a.values=(function(s,l){if(l==="float32"||l==="complex64")return s;if(l==="int32"||l==="bool"){for(var f=l==="int32"?new Int32Array(s.length):new Uint8Array(s.length),h=0;h<f.length;++h)f[h]=Math.round(s[h]);return f}throw new Error("Unknown dtype "+l)})(n,o)),a.values},t.prototype.acquireTexture=function(e,n,a,o){if(this.numBytesInGPU+=this.computeBytes(e,a),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+s+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,n,o)},t.prototype.computeBytes=function(e,n){return e[0]*e[1]*rx(n)},t})(Rx);cx()&&j.registerBackend("webgl",(function(){return new MD}),2);var kD=H({square_:function(r){var t=O(r,"x","square"),e=[t];return j.runKernelFunc((function(n,a){return a([t]),n.square(t)}),{x:t},null,"Square",{},e,[])}}),os="SquaredDifference",Gx=H({squaredDifference_:function(r,t){var e,n=O(r,"a","squaredDifference"),a=O(t,"b","squaredDifference");e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape);var o={a:n,b:a},s=[n,a];return j.runKernelFunc((function(l,f){var h=l.squaredDifference(n,a);return f([n,a]),h}),o,(function(l,f){var h=f[0],p=f[1],v=ge(2);return{a:function(){return l.mul(h.sub(p).mul(v))},b:function(){return l.mul(p.sub(h).mul(v))}}}),os,{},s,[])}}),ID=H({abs_:function(r){var t=O(r,"x","abs");return t.dtype==="complex64"?j.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):j.runKernelFunc((function(e,n){var a=e.abs(t);return n([t]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return e.mul(a.toFloat().step(-1))}}}),"Abs")}}),BD=H({acos_:function(r){var t=O(r,"x","acos");return j.runKernelFunc((function(e,n){var a=e.acos(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ge(1).sub(a.toFloat().square()).sqrt()).neg()}}}))}}),FD=H({acosh_:function(r){var t=O(r,"x","acosh");return j.runKernelFunc((function(e,n){var a=e.acosh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(a.toFloat().square().sub(1).sqrt())}}}))}}),LD=H({asin_:function(r){var t=O(r,"x","asin");return j.runKernelFunc((function(e,n){var a=e.asin(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ge(1).sub(a.toFloat().square()).sqrt())}}}))}}),zD=H({asinh_:function(r){var t=O(r,"x","asinh");return j.runKernelFunc((function(e,n){var a=e.asinh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.divStrict(ge(1).add(a.toFloat().square()).sqrt())}}}))}}),UD=H({atan_:function(r){var t=O(r,"x","atan");return j.runKernelFunc((function(e,n){var a=e.atan(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().square().add(1))}}}))}}),PD=H({atanh_:function(r){var t=O(r,"x","atanh");return j.runKernelFunc((function(e,n){var a=e.atanh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(ge(1).sub(a.toFloat().square()))}}}))}}),HD=H({ceil_:function(r){var t=O(r,"x","ceil");return j.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),iv=H({clipByValue_:function(r,t,e){var n=O(r,"x","clipByValue");B(t<=e,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+e+")."}));var a=[n],o={min:t,max:e};return j.runKernelFunc((function(s,l){var f=s.clip(n,t,e);return l([n]),f}),{x:n},(function(s,l){var f=l[0];return{x:function(){return s.where(f.greaterEqual(t).logicalAnd(f.lessEqual(e)),Qe(s))}}}),"ClipByValue",o,a)}}),VD=H({cos_:function(r){var t=O(r,"x","cos"),e=[t];return j.runKernelFunc((function(n,a){var o=n.cos(t);return a([t]),o}),{x:t},(function(n,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(n)}}}),"Cos",{},e)}}),WD=H({cosh_:function(r){var t=O(r,"x","cosh");return j.runKernelFunc((function(e,n){var a=e.cosh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return a.toFloat().sinh().mulStrict(e)}}}))}}),jD=H({erf_:function(r){var t=O(r,"x","erf");return B(t.dtype==="int32"||t.dtype==="float32",(function(){return"Input dtype must be `int32` or `float32`."})),t.dtype==="int32"&&(t=t.toFloat()),j.runKernelFunc((function(e,n){var a=e.erf(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Sp=H({exp_:function(r){var t=O(r,"x","exp");return j.runKernelFunc((function(e,n){var a=e.exp(t);return n([a]),a}),{x:t},(function(e,n){return{x:function(){return e.mulStrict(n[0])}}}),"Exp",{},[],[!0])}}),GD=H({expm1_:function(r){var t=O(r,"x","expm1");return j.runKernelFunc((function(e,n){var a=e.expm1(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.exp())}}}))}}),qD=H({floor_:function(r){var t=O(r,"x","floor");return j.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),XD=H({log_:function(r){var t=O(r,"x","log"),e=[t];return j.runKernelFunc((function(n,a){var o=n.log(t);return a([t]),o}),{x:t},(function(n,a){var o=a[0];return{x:function(){return n.div(o.toFloat())}}}),"Log",{},e)}}),KD=H({log1p_:function(r){var t=O(r,"x","log1p");return j.runKernelFunc((function(e,n){var a=e.log1p(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.add(1))}}}))}}),YD=H({logSigmoid_:function(r){var t=O(r,"x","logSigmoid");return j.runKernelFunc((function(e,n){var a=e.softplus(t.neg()).neg();return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.neg().sigmoid())}}}))}}),Dc=H({neg_:function(r){var t=O(r,"x","neg"),e=[t];return j.runKernelFunc((function(n){return n.neg(t)}),{x:t},(function(n){return{x:function(){return n.neg()}}}),"Neg",{},e)}}),QD=H({reciprocal_:function(r){var t=O(r,"x","reciprocal");return j.runKernelFunc((function(e,n){var a=e.reciprocal(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.square().neg())}}}))}}),ZD=H({round_:function(r){var t=O(r,"x","round");return j.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),qx=H({rsqrt_:function(r){var t=O(r,"x","rsqrt"),e=[t];return j.runKernelFunc((function(n,a){var o=n.rsqrt(t);return a([t]),o}),{x:t},(function(n,a){var o=a[0];return{x:function(){return n.div(o.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},e)}}),Xx=H({sigmoid_:function(r){var t=O(r,"x","sigmoid");return j.runKernelFunc((function(e,n){var a=e.sigmoid(t);return n([a]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return e.mul(a.mul(ge(1).sub(a)))}}}),"Sigmoid")}}),JD=H({sign_:function(r){var t=O(r,"x","sign");return j.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),$D=H({isNaN_:function(r){var t=O(r,"x","isNaN");return j.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),e3=H({isInf_:function(r){var t=O(r,"x","isInf");return j.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),t3=H({isFinite_:function(r){var t=O(r,"x","isFinite");return j.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return Qe(e)}}}))}}),n3=H({sin_:function(r){var t=O(r,"x","sin"),e=[t];return j.runKernelFunc((function(n,a){var o=n.sin(t);return a([t]),o}),{x:t},(function(n,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(n)}}}),"Sin",{},e)}}),r3=H({sinh_:function(r){var t=O(r,"x","sinh");return j.runKernelFunc((function(e,n){var a=e.sinh(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return a.toFloat().cosh().mulStrict(e)}}}))}}),a3=H({softplus_:function(r){var t=O(r,"x","softplus");return j.runKernelFunc((function(e,n){var a=e.softplus(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.mul(a.sigmoid())}}}))}}),i3=H({sqrt_:function(r){var t=O(r,"x","sqrt");return j.runKernelFunc((function(e,n){var a=e.sqrt(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.toFloat().sqrt().mul(2))}}}))}}),o3=H({step_:function(r,t){t===void 0&&(t=0);var e=O(r,"x","step");return j.runKernelFunc((function(n){return n.step(e,t)}),{$x:e},(function(n){return{$x:function(){return Qe(n)}}}))}}),u3=H({tan_:function(r){var t=O(r,"x","tan");return j.runKernelFunc((function(e,n){var a=e.tan(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return e.div(a.cos().square())}}}))}}),s3=H({tanh_:function(r){var t=O(r,"x","tanh");return j.runKernelFunc((function(e,n){var a=e.tanh(t);return n([a]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return ge(1).sub(a.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}});function Kx(r,t,e,n,a,o){var s,l,f=O(r,"x","batchNorm"),h=O(t,"mean","batchNorm"),p=O(e,"variance","batchNorm");return a!=null&&(s=O(a,"scale","batchNorm")),n!=null&&(l=O(n,"offset","batchNorm")),B(f.rank===2,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+f.rank+"."})),B(h.rank===2||h.rank===1,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+h.rank+"."})),B(p.rank===2||p.rank===1,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+p.rank+"."})),s!=null&&B(s.rank===2||s.rank===1,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+s.rank+"."})),l!=null&&B(l.rank===2||l.rank===1,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+l.rank+"."})),ms(f,h,p,l,s,o)}function Yx(r,t,e,n,a,o){var s,l,f=O(r,"x","batchNorm"),h=O(t,"mean","batchNorm"),p=O(e,"variance","batchNorm");return a!=null&&(s=O(a,"scale","batchNorm")),n!=null&&(l=O(n,"offset","batchNorm")),B(f.rank===3,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+f.rank+"."})),B(h.rank===3||h.rank===1,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+h.rank+"."})),B(p.rank===3||p.rank===1,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+p.rank+"."})),s!=null&&B(s.rank===3||s.rank===1,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+s.rank+"."})),l!=null&&B(l.rank===3||l.rank===1,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+l.rank+"."})),ms(f,h,p,l,s,o)}function Qx(r,t,e,n,a,o){var s,l,f=O(r,"x","batchNorm"),h=O(t,"mean","batchNorm"),p=O(e,"variance","batchNorm");return a!=null&&(s=O(a,"scale","batchNorm")),n!=null&&(l=O(n,"offset","batchNorm")),B(f.rank===4,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+f.rank+"."})),B(h.rank===4||h.rank===1,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+h.rank+"."})),B(p.rank===4||p.rank===1,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+p.rank+"."})),s!=null&&B(s.rank===4||s.rank===1,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+s.rank+"."})),l!=null&&B(l.rank===4||l.rank===1,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+l.rank+"."})),ms(f,h,p,l,s,o)}function ms(r,t,e,n,a,o){o==null&&(o=.001);var s,l,f,h=O(r,"x","batchNorm"),p=O(t,"mean","batchNorm"),v=O(e,"variance","batchNorm");a!=null&&(s=O(a,"scale","batchNorm")),n!=null&&(l=O(n,"offset","batchNorm")),B(p.rank===v.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),B(l==null||p.rank===l.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),B(s==null||p.rank===s.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),f=h.rank===0||h.rank===1?h.as4D(1,1,1,h.size):h.rank===2?h.as4D(1,1,h.shape[0],h.shape[1]):h.rank===3?h.as4D(1,h.shape[0],h.shape[1],h.shape[2]):h;var m=[h,p,v,s];return j.runKernelFunc((function(y,x){var E=y.batchNormalization(f,$l(p),$l(v),o,$l(s),$l(l));return x([h,p,v,s]),E}),{x:h,mean:p,variance:v,scale:s,offset:l},(function(y,x){var E=x,w=E[0],C=E[1],_=E[2],R=E[3],A=R??ge(1),T=Ut(C.shape,f.shape),N=[];if(C.rank===1){for(var M=0;M<f.shape.length-1;++M)N.push(f.shape[M]);N.push(1)}var I=w.sub(C),k=y.mul(A),F=qx(_.add(ge(o))),W=F.mul(F).mul(F).mul(ge(-.5));return{x:function(){return C.rank===1?y.mul(Bo(F.as4D(1,1,1,C.shape[0]),N)).mul(A).reshape(w.shape):y.mul(F).mul(A).reshape(w.shape)},mean:function(){var P=F.mul(ge(-1)).mul(k);return C.rank===1&&(P=P.sum(T)),P.reshape(C.shape)},variance:function(){var P=W.mul(I).mul(k);return C.rank===1&&(P=P.sum(T)),P.reshape(C.shape)},scale:function(){var P=I.mul(F),oe=y.mul(P);return C.rank===1&&(oe=oe.sum(T)),oe.reshape(C.shape)},offset:function(){var P=y;return C.rank===1&&(P=P.sum(T)),P.reshape(C.shape)}}}),"BatchNormalization",{varianceEpsilon:o},m).reshape(h.shape)}function $l(r){return r==null?null:r.rank===0?r.as1D():r.rank===1?r:r.rank===2?r.as4D(1,1,r.shape[0],r.shape[1]):r.rank===3?r.as4D(1,r.shape[0],r.shape[1],r.shape[2]):r}function Wc(){fx("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var l3=H({batchNormalization2d_:function(r,t,e,n,a,o){return n===void 0&&(n=.001),Wc(),Kx(r,t,e,o,a,n)}}),c3=H({batchNormalization3d_:function(r,t,e,n,a,o){return n===void 0&&(n=.001),Wc(),Yx(r,t,e,o,a,n)}}),f3=H({batchNormalization4d_:function(r,t,e,n,a,o){return n===void 0&&(n=.001),Wc(),Qx(r,t,e,o,a,n)}}),h3=H({batchNormalization_:function(r,t,e,n,a,o){return n===void 0&&(n=.001),Wc(),ms(r,t,e,o,a,n)}}),Zx=H({batchNorm_:ms}),d3=H({batchNorm2d_:Kx}),p3=H({batchNorm3d_:Yx}),v3=H({batchNorm4d_:Qx}),jc=H({logicalAnd_:function(r,t){var e=O(r,"a","logicalAnd","bool"),n=O(t,"b","logicalAnd","bool");return Ge(e.shape,n.shape),j.runKernelFunc((function(a){return a.logicalAnd(e,n)}),{a:e,b:n},null,"LogicalAnd")}}),m3=H({logicalNot_:function(r){var t=O(r,"x","logicalNot","bool");return j.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),Jx=H({logicalOr_:function(r,t){var e=O(r,"a","logicalOr","bool"),n=O(t,"b","logicalOr","bool");return Ge(e.shape,n.shape),j.runKernelFunc((function(a){return a.logicalOr(e,n)}),{$a:e,$b:n})}}),g3=H({logicalXor_:function(r,t){var e=O(r,"a","logicalXor","bool"),n=O(t,"b","logicalXor","bool");return Ge(e.shape,n.shape),Jx(r,t).logicalAnd(jc(r,t).logicalNot())}}),Oi=H({where_:function(r,t,e){var n=O(t,"a","where"),a=O(e,"b","where"),o=O(r,"condition","where","bool");return rt(n.shape,a.shape,"Error in where: "),o.rank===1?B(o.shape[0]===n.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):rt(o.shape,a.shape,"Error in where: "),j.runKernelFunc((function(s,l){var f=s.select(o,n,a);return l([o]),f}),{$condition:o,$a:n,$b:a},(function(s,l){var f=l[0];return{$condition:function(){return Qe(f).toFloat()},$a:function(){return s.mul(f.cast(s.dtype))},$b:function(){return s.mul(f.logicalNot().cast(s.dtype))}}}))}}),$x=function(r){return Ee(this,void 0,void 0,(function(){var t,e,n;return Ce(this,(function(a){switch(a.label){case 0:return[4,(t=O(r,"condition","whereAsync","bool")).data()];case 1:return e=a.sent(),n=tv(t.shape,e),r!==t&&t.dispose(),[2,n]}}))}))},Ve=H({add_:function(r,t){var e,n=O(r,"a","add"),a=O(t,"b","add");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s){return s.add(n,a)}),{a:n,b:a},(function(s){return{a:function(){var l=s,f=Ut(n.shape,o);return f.length>0&&(l=l.sum(f)),l.reshape(n.shape)},b:function(){var l=s,f=Ut(a.shape,o);return f.length>0&&(l=l.sum(f)),l.reshape(a.shape)}}}),"Add")}}),y3=H({addN_:function(r){B(Array.isArray(r),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),B(r.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+r.length}));var t=r.map((function(a,o){return O(a,"tensors"+o,"addN")})),e=t[0];t.forEach((function(a){if(a.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(a){if(!Gt(a.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var n=t;return j.runKernelFunc((function(a){return a.addN(t)}),n,(function(a){var o={};return t.forEach((function(s,l){o[l]=function(){return a.clone()}})),o}),"AddN")}}),b3=H({addStrict_:function(r,t){var e=O(r,"a","addStrict"),n=O(t,"b","addStrict");return rt(e.shape,n.shape,"Error in addStrict: "),e.add(n)}}),x3=H({atan2_:function(r,t){var e,n=O(r,"a","atan2"),a=O(t,"b","atan2");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s,l){var f=s.atan2(n,a);return l([n,a]),f}),{$a:n,$b:a},(function(s,l){var f=l[0],h=l[1];return{$a:function(){var p=Ve(f.square(),h.square()),v=s.mul(h.div(p)),m=Ut(f.shape,o);return m.length>0&&(v=v.sum(m)),v.reshape(f.shape)},$b:function(){var p=Ve(f.square(),h.square()),v=Dc(s.mul(f.div(p))),m=Ut(h.shape,o);return m.length>0&&(v=v.sum(m)),v.reshape(h.shape)}}}))}}),vr=H({div_:function(r,t){var e,n=O(r,"a","div"),a=O(t,"b","div");if(e=wt(n,a),n=e[0],a=e[1],n.dtype==="int32"&&a.dtype==="int32")return e2(n,a);var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s,l){var f=s.realDivide(n,a);return l([n,a]),f}),{a:n,b:a},(function(s,l){var f=l[0],h=l[1];return{a:function(){var p=s.div(h.toFloat()),v=Ut(f.shape,o);return v.length>0?p.sum(v).reshape(f.shape):p},b:function(){var p=s.mul(f.toFloat()),v=Ut(h.shape,o);v.length>0&&(p=p.sum(v).reshape(h.shape));var m=h.square();return p.div(m.toFloat()).neg()}}}),"Div")}}),w3=H({divNoNan_:function(r,t){var e,n=O(r,"a","div"),a=O(t,"b","div");n=(e=wt(n,a))[0],a=e[1];var o=vr(n,a),s=Qe(o),l=a.equal(s);return Oi(l,s,o)}}),E3=H({divStrict_:function(r,t){var e=O(r,"a","div"),n=O(t,"b","div");return rt(e.shape,n.shape,"Error in divideStrict: "),e.div(n)}}),e2=H({floorDiv_:function(r,t){var e,n=O(r,"a","floorDiv"),a=O(t,"b","floorDiv");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s,l){var f=s.floorDiv(n,a);return l([n,a]),f}),{a:n,b:a},(function(s,l){var f=l[0],h=l[1];return{a:function(){var p=s.div(h.toFloat()),v=Ut(f.shape,o);return v.length>0?p.sum(v).reshape(f.shape):p},b:function(){var p=s.mul(f.toFloat()),v=Ut(h.shape,o);v.length>0&&(p=p.sum(v).reshape(h.shape));var m=h.square();return p.div(m.toFloat()).neg()}}}),"FloorDiv")}}),ov=H({maximum_:function(r,t){var e,n=O(r,"a","maximum"),a=O(t,"b","maximum");return e=wt(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),Ge(n.shape,a.shape),j.runKernelFunc((function(o,s){var l=o.maximum(n,a);return s([n,a]),l}),{a:n,b:a},(function(o,s){var l=s[0],f=s[1];return{a:function(){return o.mul(l.greaterEqual(f).toFloat())},b:function(){return o.mul(l.less(f).toFloat())}}}),"Maximum")}}),C3=H({maximumStrict_:function(r,t){var e=O(r,"a","maximumStrict"),n=O(t,"b","maximumStrict");return rt(e.shape,n.shape,"Error in maximumStrict: "),e.maximum(n)}}),t2=H({minimum_:function(r,t){var e,n=O(r,"a","minimum"),a=O(t,"b","minimum");return e=wt(n,a),n=e[0],a=e[1],n.dtype==="bool"&&(n=n.toInt(),a=a.toInt()),Ge(n.shape,a.shape),j.runKernelFunc((function(o,s){var l=o.minimum(n,a);return s([n,a]),l}),{a:n,b:a},(function(o,s){var l=s[0],f=s[1];return{a:function(){return o.mul(l.lessEqual(f).toFloat())},b:function(){return o.mul(l.greater(f).toFloat())}}}),"Minimum")}}),_3=H({minimumStrict_:function(r,t){var e=O(r,"a","minimumStrict"),n=O(t,"b","minimumStrict");return rt(e.shape,n.shape,"Error in minimumStrict: "),e.minimum(n)}}),S3=H({mod_:function(r,t){var e,n=O(r,"a","mod"),a=O(t,"b","mod");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s,l){var f=s.mod(n,a);return l([n,a]),f}),{$a:n,$b:a},(function(s,l){var f=l[0],h=l[1];return{$a:function(){var p=Ut(f.shape,o);return p.length>0?s.sum(p).reshape(f.shape):s},$b:function(){var p=s.mul(f.div(h).floor().neg()),v=Ut(h.shape,o);return v.length>0?p.sum(v).reshape(h.shape):p}}}))}}),R3=H({modStrict_:function(r,t){var e=O(r,"a","modStrict"),n=O(t,"b","modStrict");return rt(e.shape,n.shape,"Error in modStrict: "),e.mod(n)}}),cn=H({mul_:function(r,t){var e,n=O(r,"a","mul"),a=O(t,"b","mul");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s,l){var f=s.multiply(n,a);return l([n,a]),f}),{a:n,b:a},(function(s,l){var f=l[0],h=l[1];return{a:function(){var p=s.mul(h.toFloat()),v=Ut(f.shape,o);return v.length>0?p.sum(v).reshape(f.shape):p},b:function(){var p=s.mul(f.toFloat()),v=Ut(h.shape,o);return v.length>0?p.sum(v).reshape(h.shape):p}}}),"Mul")}}),A3=H({mulStrict_:function(r,t){var e=O(r,"a","mul"),n=O(t,"b","mul");return rt(e.shape,n.shape,"Error in multiplyStrict: "),e.mul(n)}}),Nc=H({pow_:function(r,t){var e,n=O(r,"base","pow"),a=O(t,"exp","pow");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape),s=[n,a];return j.runKernelFunc((function(l,f){var h=l.pow(n,a);return f([n,a,h]),h}),{a:n,b:a},(function(l,f){var h=f[0],p=f[1],v=f[2];return{a:function(){var m=p.toFloat(),y=l.mul(m.mul(h.pow(m.sub(ge(1))))),x=Ut(h.shape,o);return x.length>0&&(y=y.sum(x)),y.reshape(h.shape)},b:function(){var m=h.greater(0),y=h.log().where(m,Qe(h)),x=l.mul(v.mul(y)),E=Ut(p.shape,o);return E.length>0&&(x=x.sum(E)),x.reshape(p.shape)}}}),"Pow",{},s,[!0])}}),T3=H({powStrict_:function(r,t){return rt(r.shape,t.shape,"Error in powStrict: "),r.pow(t)}}),D3=H({squaredDifferenceStrict_:function(r,t){var e=O(r,"a","squaredDifferenceStrict"),n=O(t,"b","squaredDifferenceStrict");return rt(e.shape,n.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(n)}}),Pt=H({sub_:function(r,t){var e,n=O(r,"a","sub"),a=O(t,"b","sub");e=wt(n,a),n=e[0],a=e[1];var o=Ge(n.shape,a.shape);return j.runKernelFunc((function(s){return s.subtract(n,a)}),{a:n,b:a},(function(s){return{a:function(){var l=s,f=Ut(n.shape,o);return f.length>0&&(l=l.sum(f)),l.reshape(n.shape)},b:function(){var l=s,f=Ut(a.shape,o);return f.length>0&&(l=l.sum(f)),l.neg().reshape(a.shape)}}}),"Sub")}}),N3=H({subStrict_:function(r,t){var e=O(r,"a","subStrict"),n=O(t,"b","subStrict");return rt(e.shape,n.shape,"Error in subStrict: "),e.sub(n)}}),n2=H({equal_:function(r,t){var e,n=O(r,"a","equal"),a=O(t,"b","equal");return e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape),j.runKernelFunc((function(o){return o.equal(n,a)}),{$a:n,$b:a})}}),O3=H({equalStrict_:function(r,t){var e=O(r,"a","equalStrict"),n=O(t,"b","equalStrict");return rt(e.shape,n.shape,"Error in equalStrict: "),e.equal(n)}}),M3=H({greater_:function(r,t){var e,n=O(r,"a","greater"),a=O(t,"b","greater");return e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape),j.runKernelFunc((function(o){return o.greater(n,a)}),{a:n,b:a},null,"Greater")}}),r2=H({greaterEqual_:function(r,t){var e,n=O(r,"a","greaterEqual"),a=O(t,"b","greaterEqual");return e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape),j.runKernelFunc((function(o,s){var l=o.greaterEqual(n,a);return s([n,a]),l}),{a:n,b:a},(function(o,s){var l=s[0],f=s[1];return{a:function(){return Qe(l)},b:function(){return Qe(f)}}}),"GreaterEqual")}}),k3=H({greaterEqualStrict_:function(r,t){var e=O(r,"a","greaterEqualStrict"),n=O(t,"b","greaterEqualStrict");return rt(e.shape,n.shape,"Error in greaterEqualStrict: "),e.greaterEqual(n)}}),I3=H({greaterStrict_:function(r,t){var e=O(r,"a","greaterStrict"),n=O(t,"b","greaterStrict");return rt(e.shape,n.shape,"Error in greaterStrict: "),e.greater(n)}}),B3=H({less_:function(r,t){var e,n=O(r,"a","less"),a=O(t,"b","less");return e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape),j.runKernelFunc((function(o){return o.less(n,a)}),{a:n,b:a},null,"Less")}}),F3=H({lessEqual_:function(r,t){var e,n=O(r,"a","lessEqual"),a=O(t,"b","lessEqual");return e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape),j.runKernelFunc((function(o,s){var l=o.lessEqual(n,a);return s([n,a]),l}),{a:n,b:a},null,"LessEqual")}}),L3=H({lessEqualStrict_:function(r,t){var e=O(r,"a","lessEqualStrict"),n=O(t,"b","lessEqualStrict");return rt(e.shape,n.shape,"Error in lessEqualStrict: "),e.lessEqual(n)}}),z3=H({lessStrict_:function(r,t){var e=O(r,"a","lessStrict"),n=O(t,"b","lessStrict");return rt(e.shape,n.shape,"Error in lessStrict: "),e.less(n)}}),U3=H({notEqual_:function(r,t){var e,n=O(r,"a","notEqual"),a=O(t,"b","notEqual");return e=wt(n,a),n=e[0],a=e[1],Ge(n.shape,a.shape),j.runKernelFunc((function(o){return o.notEqual(n,a)}),{a:n,b:a},null,"NotEqual")}}),P3=H({notEqualStrict_:function(r,t){var e=O(r,"a","notEqualStrict"),n=O(t,"b","notEqualStrict");return rt(e.shape,n.shape,"Error in notEqualStrict: "),e.notEqual(n)}});function Vb(r,t){for(var e=[],n=r;n<t;++n)e.push(n);return e}function Wb(r){for(var t=[],e=0;e<r.length;++e)for(var n=0;n<r[e].length;++n)t.push(r[e][n]);return t}var uv=H({gather_:function(r,t,e){e===void 0&&(e=0);var n=O(r,"x","gather"),a=O(t,"indices","gather","int32");e=Ht(e,n.shape)[0];var o=(function(s,l,f){for(var h=s.shape[f],p=[],v=1,m=1,y=0;y<f;y++)p.push(s.shape[y]),v*=s.shape[y];for(y=0;y<l.rank;y++)p.push(l.shape[y]);for(y=f+1;y<s.rank;y++)p.push(s.shape[y]),m*=s.shape[y];return{batchSize:v,sliceSize:m,dimSize:h,outputShape:p}})(n,a,e);return j.runKernelFunc((function(s,l){var f=s.gather(n,a.flatten(),e);return l([a]),f}),{x:n,indices:a},(function(s,l){var f=l[0];return{x:function(){var h=n.shape,p=f.size,v=h.slice(0,e),m=v.length,y=h.slice(e,h.length).slice(1),x=y.length,E=Vb(0,m),w=Vb(m+1,m+1+x),C=Wb([v,[p],y]),_=s.reshape(C),R=f.reshape([p]),A=Wb([[m],E,w]),T=_.transpose(A),N=a2(T,R,n.shape[e]),M=Xp(A);return N=N.transpose(M)},indices:function(){return f}}}),"Gather",{axis:e}).reshape(o.outputShape)}}),a2=H({unsortedSegmentSum_:function(r,t,e){var n=O(r,"x","unsortedSegmentSum"),a=O(t,"segmentIds","unsortedSegmentSum","int32");return B(At(e),(function(){return"numSegments must be of dtype int"})),j.runKernelFunc((function(o,s){var l=o.unsortedSegmentSum(n,a,e);return s([a]),l}),{$x:n},(function(o,s){var l=s[0];return{$x:function(){return(function(f,h){for(var p=ov(h,Qe(h)),v=uv(f,p),m=r2(h,ge(0,"int32")),y=v.rank-m.rank,x=0;x<y;++x)m=ir(m,x+1);m=jc(m,Qo(v.shape,"bool"));var E=Qe(v);return Oi(m,v,E)})(o,l)}}}))}}),H3=function(r,t,e){return Ee(this,void 0,void 0,(function(){var n,a,o,s,l,f,h,p,v,m,y,x,E;return Ce(this,(function(w){switch(w.label){case 0:for(n=O(r,"tensor","boolMask"),a=O(t,"mask","boolMask","bool"),o=e??0,s=a.rank,l=n.shape,B(s>0,(function(){return"mask cannot be scalar"})),rt(l.slice(o,o+s),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),f=1,h=o;h<o+s;h++)f*=l[h];return p=l.slice(0,o).concat([f],l.slice(o+s)),v=n.reshape(p),m=a.reshape([-1]),[4,$x(m)];case 1:return y=w.sent(),x=y.squeeze([1]),E=uv(v,x,o),r!==n&&n.dispose(),t!==a&&a.dispose(),x.dispose(),v.dispose(),m.dispose(),y.dispose(),[2,E]}}))}))};function i2(r,t,e,n,a,o,s){o===void 0&&(o="NHWC"),B(r.length===t.rank,(function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"}));var l=r,f=t,h=!1;t.rank===3&&(h=!0,f=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=[1,r[0],r[1],r[2]]),B(l.length===4,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+l.length+"."})),B(f.rank===4,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+f.rank})),B(e.rank===4,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank}));var p=o==="NHWC"?l[3]:l[1],v=o==="NHWC"?f.shape[3]:f.shape[1];B(p===e.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+p+") must match input depth for filter "+e.shape[2]+"."})),B(v===e.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+v+") must match output depth for filter "+e.shape[3]+"."})),s!=null&&B(At(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var m=Jp(o),y=Li(l,e.shape,n,1,a,s,!1,m),x=j.runKernelFunc((function(E,w){var C=E.conv2dDerInput(f,e,y);return w([e,f]),C}),{dy4D:f,filter:e},(function(E,w){var C=w[0],_=w[1];return{dy4D:function(){return lr(E,C,n,a,o,1,s)},filter:function(){return sv(E,_,C.shape,n,a,o,s)}}}));return h?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}function Kd(r){var t=(function(o){return typeof o=="number"?[o,o,o]:o.length===2?[o[0],o[1],1]:o})(r),e=t[0],n=t[1],a=t[2];return e===1&&n===1&&a===1}function o2(r,t,e,n,a){B(r.length===t.rank,(function(){return"Length of inShape ("+r.length+") and rank of dy ("+t.rank+") must match"}));var o=r,s=t,l=!1;t.rank===4&&(l=!0,s=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),o=[1,r[0],r[1],r[2],r[3]]);var f=o[4],h=s.shape[4];B(o.length===5,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),B(s.rank===5,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+s.rank})),B(e.rank===5,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank})),B(f===e.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+f+") must match input depth for filter "+e.shape[3]+"."})),B(h===e.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+h+") must match output depth for filter "+e.shape[4]+"."}));var p=Ac(o,e.shape,n,1,a),v=j.runKernelFunc((function(m){return m.conv3dDerInput(s,e,p)}),{dy5D:s});return l?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}var V3=H({conv1d_:function(r,t,e,n,a,o,s){a===void 0&&(a="NWC"),o===void 0&&(o=1);var l=O(r,"x","conv1d"),f=O(t,"filter","conv1d"),h=l,p=!1;l.rank===2&&(p=!0,h=l.as3D(1,l.shape[0],l.shape[1])),B(h.rank===3,(function(){return"Error in conv1d: input must be rank 3, but got rank "+h.rank+"."})),B(f.rank===3,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+f.rank+"."})),s!=null&&B(At(n),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."})),B(h.shape[2]===f.shape[1],(function(){return"Error in conv1d: depth of input ("+h.shape[2]+") must match input depth for filter "+f.shape[1]+"."})),B(Nn(e,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+o+"'"})),B(a==="NWC",(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var v=f.as4D(1,f.shape[0],f.shape[1],f.shape[2]),m=h.as4D(h.shape[0],1,h.shape[1],h.shape[2]),y=lr(m,v,[1,e],n,"NHWC",[1,o],s);return p?y.as2D(y.shape[2],y.shape[3]):y.as3D(y.shape[0],y.shape[2],y.shape[3])}}),lr=H({conv2d_:function(r,t,e,n,a,o,s){a===void 0&&(a="NHWC"),o===void 0&&(o=[1,1]);var l=O(r,"x","conv2d"),f=O(t,"filter","conv2d"),h=l,p=!1;l.rank===3&&(p=!0,h=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),B(h.rank===4,(function(){return"Error in conv2d: input must be rank 4, but got rank "+h.rank+"."})),B(f.rank===4,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+f.rank+"."})),s!=null&&B(At(n),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."}));var v=a==="NHWC"?h.shape[3]:h.shape[1];B(v===f.shape[2],(function(){return"Error in conv2d: depth of input ("+v+") must match input depth for filter "+f.shape[2]+"."})),B(Nn(e,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"}));var m=Jp(a),y=Li(h.shape,f.shape,e,o,n,s,!1,m),x=[f,h],E=j.runKernelFunc((function(w,C){var _=w.conv2d(h,f,y);return C([f,h]),_}),{x:h,filter:f},(function(w,C){var _=C,R=_[0],A=_[1];return B(Go(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return u2(A.shape,w,R,e,n,a)},filter:function(){return sv(A,w,R.shape,e,n,a)}}}),"Conv2D",y,x);return p?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),W3=H({conv3d_:function(r,t,e,n,a,o){a===void 0&&(a="NDHWC"),o===void 0&&(o=[1,1,1]);var s=O(r,"x","conv3d"),l=O(t,"filter","conv3d"),f=s,h=!1;s.rank===4&&(h=!0,f=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),B(f.rank===5,(function(){return"Error in conv3d: input must be rank 5, but got rank "+f.rank+"."})),B(l.rank===5,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."})),B(f.shape[4]===l.shape[3],(function(){return"Error in conv3d: depth of input ("+f.shape[4]+") must match input depth for filter "+l.shape[3]+"."})),B((function(m,y){return Kd(m)||Kd(y)})(e,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"})),B(a==="NDHWC",(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var p=Ac(f.shape,l.shape,e,o,n),v=j.runKernelFunc((function(m,y){var x=m.conv3d(f,l,p);return y([f,l]),x}),{x:f,$filter:l},(function(m,y){B(Kd(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var x=y[0],E=y[1];return{x:function(){return o2(x.shape,m,E,e,n)},$filter:function(){return(function(w,C,_,R,A){var T=w;w.rank===4&&(T=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]));var N=C;N.rank===4&&(N=C.as5D(1,C.shape[0],C.shape[1],C.shape[2],C.shape[3])),B(T.rank===5,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+T.shape+"."})),B(N.rank===5,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+N.shape+"."})),B(_.length===5,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+_+"."})),B(T.shape[4]===_[3],(function(){return"Error in conv3dDerFilter: depth of input "+T.shape[4]+") must match input depth in filter ("+_[3]+"."})),B(N.shape[4]===_[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+N.shape[4]+") must match output depth for filter ("+_[4]+")."}));var M=Ac(T.shape,_,R,1,A);return j.runKernelFunc((function(I){return I.conv3dDerFilter(T,N,M)}),{x5D:T,dy5D:N})})(x,m,E.shape,e,n)}}}));return h?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),sv=H({conv2dDerFilter_:function(r,t,e,n,a,o,s){o===void 0&&(o="NHWC");var l=r;r.rank===3&&(l=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var f=t;f.rank===3&&(f=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),B(l.rank===4,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+l.shape+"."})),B(f.rank===4,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+f.shape+"."})),B(e.length===4,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."}));var h=o==="NHWC"?l.shape[3]:l.shape[1],p=o==="NHWC"?f.shape[3]:f.shape[1];B(h===e[2],(function(){return"Error in conv2dDerFilter: depth of input "+h+") must match input depth in filter ("+e[2]+"."})),B(p===e[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+p+") must match output depth for filter ("+e[3]+")."})),s!=null&&B(At(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var v=Jp(o),m=Li(l.shape,e,n,1,a,s,!1,v);return j.runKernelFunc((function(y){return y.conv2dDerFilter(l,f,m)}),{x4D:l,dy4D:f})}}),u2=H({conv2dDerInput_:i2}),Gc=H({depthwiseConv2d_:function(r,t,e,n,a,o,s){o===void 0&&(o=[1,1]);var l=O(r,"x","depthwiseConv2d"),f=O(t,"filter","depthwiseConv2d"),h=l,p=!1;l.rank===3&&(p=!0,h=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),B(h.rank===4,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+h.rank+"."})),B(f.rank===4,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+f.rank+"."})),B(h.shape[3]===f.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+h.shape[3]+") must match the inChannels dimension in filter "+f.shape[2]+"."})),o==null&&(o=[1,1]),B(Nn(e,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+o+"'"})),s!=null&&B(At(n),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+n+"."}));var v=Li(h.shape,f.shape,e,o,n,s,!0),m=[h,f],y=j.runKernelFunc((function(x,E){var w=x.depthwiseConv2D(h,f,v);return E([h,f]),w}),{x:h,filter:f},(function(x,E){B(Go(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var w=E[0],C=E[1];return{x:function(){return s2(w.shape,x,C,v)},filter:function(){return l2(w,x,C.shape,v)}}}),"DepthwiseConv2dNative",v,m);return p?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),s2=H({depthwiseConv2dDerInput_:function(r,t,e,n){var a=t,o=!1;t.rank===3&&(o=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var s=j.runKernelFunc((function(l){return l.depthwiseConv2DDerInput(a,e,n)}),{dy4D:a});return o?s.as3D(s.shape[1],s.shape[2],s.shape[3]):s}}),l2=H({depthwiseConv2dDerFilter_:function(r,t,e,n){var a=r;r.rank===3&&(a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t;return o.rank===3&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),j.runKernelFunc((function(s){return s.depthwiseConv2DDerFilter(a,o,n)}),{x4D:a,dy4D:o})}}),lv=H({separableConv2d_:function(r,t,e,n,a,o,s){o===void 0&&(o=[1,1]),s===void 0&&(s="NHWC");var l=O(r,"x","separableConv2d"),f=O(t,"depthwiseFilter","separableConv2d"),h=O(e,"pointwiseFilter","separableConv2d"),p=l,v=!1;if(l.rank===3&&(v=!0,p=l.as4D(1,l.shape[0],l.shape[1],l.shape[2])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(p.rank===4,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+p.rank+"."})),B(f.rank===4,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+f.rank+"."})),B(h.rank===4,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+f.rank+"."})),B(h.shape[0]===1,(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+h.shape[0]+"."})),B(h.shape[1]===1,(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+h.shape[1]+"."}));var m=f.shape[2],y=f.shape[3];B(h.shape[2]===m*y,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+m*y+", but got "+h.shape[2]+"."}));var x=Gc(p,f,n,a,s,o),E=lr(x,h,1,"valid",s);return v?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),j3=H({conv2dTranspose_:function(r,t,e,n,a,o){return i2(e,O(r,"x","conv2dTranspose"),O(t,"filter","conv2dTranspose"),n,a,"NHWC",o)}}),G3=H({conv3dTranspose_:function(r,t,e,n,a){return o2(e,O(r,"x","conv3dTranspose"),O(t,"filter","conv3dTranspose"),n,a)}}),qc=H({matMul_:function(r,t,e,n){var a;e===void 0&&(e=!1),n===void 0&&(n=!1);var o=O(r,"a","matMul"),s=O(t,"b","matMul");a=wt(o,s),o=a[0],s=a[1];var l=e?o.shape[o.rank-2]:o.shape[o.rank-1],f=n?s.shape[s.rank-1]:s.shape[s.rank-2],h=e?o.shape[o.rank-1]:o.shape[o.rank-2],p=n?s.shape[s.rank-2]:s.shape[s.rank-1],v=o.shape.slice(0,-2),m=s.shape.slice(0,-2),y=Se(v),x=Se(m);B(o.rank>=2&&s.rank>=2&&o.rank===s.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+s.rank+"."})),B(Gt(v,m),(function(){return"Error in matMul: outer dimensions ("+v+") and ("+m+") of Tensors with shapes "+o.shape+" and "+s.shape+" must match."})),B(l===f,(function(){return"Error in matMul: inner shapes ("+l+") and ("+f+") of Tensors with shapes "+o.shape+" and "+s.shape+" and transposeA="+e+" and transposeB="+n+" must match."}));var E=o.shape.slice(0,-2).concat([h,p]),w=e?o.as3D(y,l,h):o.as3D(y,h,l),C=n?s.as3D(x,p,f):s.as3D(x,f,p),_={transposeA:e,transposeB:n};return j.runKernelFunc((function(R,A){var T=R.batchMatMul(w,C,e,n);return A([w,C]),T}),{a:w,b:C},(function(R,A){var T=A,N=T[0],M=T[1];return e||n?!e&&n?{a:function(){return R.matMul(M,!1,!1)},b:function(){return R.matMul(N,!0,!1)}}:e&&!n?{a:function(){return M.matMul(R,!1,!0)},b:function(){return N.matMul(R,!1,!1)}}:{a:function(){return M.matMul(R,!0,!0)},b:function(){return R.matMul(N,!0,!0)}}:{a:function(){return R.matMul(M,!1,!0)},b:function(){return N.matMul(R,!0,!1)}}}),"BatchMatMul",_).reshape(E)}}),q3=H({dot_:function(r,t){var e=O(r,"t1","dot"),n=O(t,"t2","dot");B(!(e.rank!==1&&e.rank!==2||n.rank!==1&&n.rank!==2),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+n.rank+"."}));var a=e.rank===1?e.size:e.shape[1],o=n.rank===1?n.size:n.shape[0];return B(a===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+o+"."})),e.rank===1&&n.rank===1?e.as2D(1,-1).matMul(n.as2D(-1,1)).asScalar():e.rank===1&&n.rank===2?e.as2D(1,-1).matMul(n.as2D(n.shape[0],n.shape[1])).as1D():e.rank===2&&n.rank===1?e.matMul(n.as2D(-1,1)).as1D():e.matMul(n.as2D(n.shape[0],n.shape[1]))}}),X3=H({outerProduct_:function(r,t){var e=O(r,"v1","outerProduct"),n=O(t,"v2","outerProduct");return B(e.rank===1&&n.rank===1,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+n.rank+"."})),e.as2D(-1,1).matMul(n.as2D(1,-1))}}),gs=H({reverse_:function(r,t){var e=O(r,"x","reverse");if(e.rank===0)return e.clone();var n=Ht(t,e.shape);return j.runKernelFunc((function(a){return a.reverse(e,n)}),{$x:e},(function(a){return{$x:function(){return a.reverse(n)}}})).reshapeAs(e)}}),K3=H({reverse1d_:function(r){var t=O(r,"x","reverse");return B(t.rank===1,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),gs(t,0)}}),Y3=H({reverse2d_:function(r,t){var e=O(r,"x","reverse");return B(e.rank===2,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."})),gs(e,t)}}),Q3=H({reverse3d_:function(r,t){var e=O(r,"x","reverse");return B(e.rank===3,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."})),gs(e,t)}}),Z3=H({reverse4d_:function(r,t){var e=O(r,"x","reverse");return B(e.rank===4,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."})),gs(e,t)}});function c2(r,t,e,n,a,o){var s=O(r,"x","maxPool"),l=s,f=!1;s.rank===3&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),B(l.rank===4,(function(){return"Error in maxPool: input must be rank 4 but got rank "+l.rank+"."})),B(Nn(e,n),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"})),o!=null&&B(At(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var h=is(l.shape,t,e,n,a,o);if(h.filterWidth===1&&h.filterHeight===1&&Gt(h.inShape,h.outShape))return s.clone();var p=[l],v=j.runKernelFunc((function(m,y){var x=m.maxPool(l,h);return y([l,x]),x}),{x:l},(function(m,y){var x=y[0],E=y[1];return{x:function(){return(function(w,C,_,R,A,T,N,M){var I=O(w,"dy","maxPoolBackprop"),k=O(C,"input","maxPoolBackprop"),F=O(_,"output","maxPoolBackprop");B(k.rank===I.rank,(function(){return"Rank of input ("+k.rank+") does not match rank of dy ("+I.rank+")"})),B(Nn(A,T),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+A+" and dilations '"+T+"'"})),B(I.rank===4,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+I.rank+"."})),B(k.rank===4,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+k.rank+"."}));var W=is(k.shape,R,A,T,N,M);return j.runKernelFunc((function(P){return P.maxPoolBackprop(I,k,F,W)}),{$dy:I,$input:k})})(m,x,E,t,e,n,a)}}}),"MaxPool",h,p);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function f2(r,t,e,n,a,o){var s=O(r,"x","avgPool","float32");B(Nn(e,n),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+n+"'"}));var l=s,f=!1;s.rank===3&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),B(l.rank===4,(function(){return"Error in avgPool: x must be rank 4 but got rank "+l.rank+"."})),o!=null&&B(At(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var h=is(l.shape,t,e,n,a,o);if(h.filterWidth===1&&h.filterHeight===1&&Gt(h.inShape,h.outShape))return s.clone();var p=j.runKernelFunc((function(v){return v.avgPool(l,h)}),{x:l},(function(v){return{x:function(){return(function(m,y,x,E,w,C){var _=O(m,"dy","avgPoolBackprop"),R=O(y,"input","avgPoolBackprop");B(R.rank===_.rank,(function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+_.rank+")"})),B(Nn(E,w),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+E+" and dilations '"+w+"'"}));var A=R,T=_,N=!1;R.rank===3&&(N=!0,A=R.as4D(1,R.shape[0],R.shape[1],R.shape[2]),T=_.as4D(1,_.shape[0],_.shape[1],_.shape[2])),B(T.rank===4,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+T.rank+"."})),B(A.rank===4,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+A.rank+"."}));var M=is(A.shape,x,E,w,C),I=j.runKernelFunc((function(k){return k.avgPoolBackprop(T,A,M)}),{dy4D:T,input4D:A});return N?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I})(v,l,t,e,n,a)}}}),"AvgPool",h);return p=p.cast(s.dtype),f?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}var jt=H({maxPool_:function(r,t,e,n,a){return c2(r,t,e,1,n,a)}}),ys=H({avgPool_:function(r,t,e,n,a){return f2(r,t,e,1,n,a)}}),J3=H({pool_:function(r,t,e,n,a,o){a==null&&(a=[1,1]),o==null&&(o=1),n===0&&(n="valid");var s=O(r,"x","maxPool"),l=s,f=!1;s.rank===3&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),B(Nn(o,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+a+"'"}));var h,p=is(l.shape,t,o,a,n),v=[p.dilationHeight,p.dilationWidth];h=n==="same"?(function(A,T){var N=A.map((function(k,F){return k+(k-1)*(T[F]-1)})).map((function(k){return k-1})),M=N.map((function(k){return Math.floor(k/2)})),I=N.map((function(k,F){return k-M[F]}));return N.map((function(k,F){return[M[F],I[F]]}))})([p.filterHeight,p.filterWidth],v):[[0,0],[0,0]];var m=v[0]===1&&v[1]===1,y=(function(A,T,N){var M=N.map((function(ee){return ee[0]})),I=N.map((function(ee){return ee[1]})),k=A.concat(M,I),F=T.map((function(ee,ae){return(ee-k[ae]%ee)%ee})),W=I.map((function(ee,ae){return ee+F[ae]})),P=T.map((function(ee,ae){return[M[ae],W[ae]]})),oe=T.map((function(ee,ae){return[0,F[ae]]}));return[P,oe]})([p.inHeight,p.inWidth],v,h),x=y[0],E=y[1],w=m?n:"valid",C=m?l:gx(l,v,x),_=(e==="avg"?function(){return f2(C,t,o,1,w)}:function(){return c2(C,t,o,1,w)})(),R=m?_:px(_,v,E);return f?R.as3D(R.shape[1],R.shape[2],R.shape[3]):R}}),$3=H({maxPool3d_:function(r,t,e,n,a,o,s){o===void 0&&(o="NDHWC");var l=O(r,"x","maxPool3d"),f=l,h=!1;l.rank===4&&(h=!0,f=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),B(f.rank===5,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+f.rank+"."})),B(o==="NDHWC",(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),B(Nn(e,s),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"})),a!=null&&B(At(n),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."}));var p=Rc(f.shape,t,e,s,n,a,o),v=j.runKernelFunc((function(m,y){var x=m.maxPool3d(f,p);return y([f,x]),x}),{x:f},(function(m,y){var x=y[0],E=y[1];return{x:function(){return(function(w,C,_,R,A,T,N,M){var I=O(w,"dy","maxPool3dBackprop"),k=O(C,"input","maxPool3dBackprop"),F=O(_,"output","maxPool3dBackprop"),W=I,P=k,oe=F,ee=!1;k.rank===4&&(ee=!0,W=I.as5D(1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]),P=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),oe=F.as5D(1,F.shape[0],F.shape[1],F.shape[2],F.shape[3])),B(W.rank===5,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+W.rank+"."})),B(P.rank===5,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."})),B(oe.rank===5,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+oe.rank+"."})),T==null&&(T=[1,1,1]),B(Nn(A,T),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+A+" and dilations '"+T+"'"})),M!=null&&B(At(N),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+M+" but got pad "+N+"."}));var ae=Rc(P.shape,R,A,T,N,M),z=j.runKernelFunc((function(G){return G.maxPool3dBackprop(W,P,oe,ae)}),{dy5D:W,input5D:P});return ee?z.as4D(z.shape[1],z.shape[2],z.shape[3],z.shape[4]):z})(m,x,E,t,e,s,n,a)}}}));return h?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),eN=H({avgPool3d_:function(r,t,e,n,a,o,s){o===void 0&&(o="NDHWC");var l=O(r,"x","avgPool3d","float32"),f=l,h=!1;l.rank===4&&(h=!0,f=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),s==null&&(s=[1,1,1]),B(f.rank===5,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+f.rank+"."})),B(o==="NDHWC",(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),B(Nn(e,s),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+s+"'"})),a!=null&&B(At(n),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+n+"."}));var p=Rc(f.shape,t,e,s,n,a,o),v=j.runKernelFunc((function(m){return m.avgPool3d(f,p)}),{x:f},(function(m){return{x:function(){return(function(y,x,E,w,C,_,R){var A=O(y,"dy","avgPool3dBackprop"),T=O(x,"input","avgPool3dBackprop"),N=A,M=T,I=!1;T.rank===4&&(I=!0,N=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3]),M=T.as5D(1,T.shape[0],T.shape[1],T.shape[2],T.shape[3])),B(N.rank===5,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+N.rank+"."})),B(M.rank===5,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+M.rank+"."})),C==null&&(C=[1,1,1]),B(Nn(w,C),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+C+"'"})),R!=null&&B(At(_),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+R+" but got pad "+_+"."}));var k=Rc(M.shape,E,w,C,_,R),F=j.runKernelFunc((function(W){return W.avgPool3dBackprop(N,M,k)}),{dy5D:N,input5D:M});return I?F.as4D(F.shape[1],F.shape[2],F.shape[3],F.shape[4]):F})(m,f,t,e,s,n,a)}}}));return v=v.cast(f.dtype),h?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}}),zr=H({slice_:function(r,t,e){var n,a,o=O(r,"x","slice");if(o.rank===0)throw new Error("Slicing scalar is not possible");(n=typeof t=="number"?[t].concat(new Array(o.rank-1).fill(0)):t.length<o.rank?t.concat(new Array(o.rank-t.length).fill(0)):t.slice()).forEach((function(f){B(f!==-1,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=e==null?new Array(o.rank).fill(-1):typeof e=="number"?[e].concat(new Array(o.rank-1).fill(-1)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(-1)):e).map((function(f,h){return f>=0?f:(B(f===-1,(function(){return"Negative size values should be exactly -1 but got "+f+" for the slice() size at index "+h+"."})),o.shape[h]-n[h])})),TA(o,n,a);var s=o.shape,l={begin:n,size:a};return j.runKernelFunc((function(f){return f.slice(o,n,a)}),{x:o},(function(f){for(var h=[],p=0;p<f.rank;p++)h.push([n[p],s[p]-n[p]-a[p]]);return{x:function(){return f.pad(h)}}}),"Slice",l)}}),tN=H({slice1d_:function(r,t,e){var n=O(r,"x","slice1d");return B(n.rank===1,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+n.rank+" tensor"})),zr(n,[t],[e])}}),nN=H({slice2d_:function(r,t,e){var n=O(r,"x","slice2d");return B(n.rank===2,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+n.rank+" tensor"})),zr(n,t,e)}}),h2=H({slice3d_:function(r,t,e){var n=O(r,"x","slice3d");return B(n.rank===3,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+n.rank+" tensor"})),zr(n,t,e)}}),rN=H({slice4d_:function(r,t,e){var n=O(r,"x","slice4d");return B(n.rank===4,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+n.rank+" tensor"})),zr(n,t,e)}});function d2(r,t,e,n,a){return t.rank<e.rank&&(t=t.reshape(Dn(t.shape,n))),r.rank<e.rank&&(r=r.reshape(Dn(r.shape,n))),{x:function(){var o=r.mul(e.equal(t).cast(r.dtype));return a==null?o:o.transpose(a)}}}var aN=H({all_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","all","bool"),a=Ht(t,n.shape),o=a,s=Pr(o,n.rank);s!=null&&(n=n.transpose(s),o=Hr(o.length,n.rank));var l=j.runKernelFunc((function(h){return h.all(n,o)}),{$x:n});if(e){var f=Dn(l.shape,a);return l.reshape(f)}return l}}),iN=H({any_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","any","bool"),a=Ht(t,n.shape),o=a,s=Pr(o,n.rank);s!=null&&(n=n.transpose(s),o=Hr(o.length,n.rank));var l=j.runKernelFunc((function(h){return h.any(n,o)}),{$x:n});if(e){var f=Dn(l.shape,a);return l.reshape(f)}return l}}),oN=H({argMax_:function(r,t){t===void 0&&(t=0);var e=O(r,"x","argMax");t==null&&(t=0);var n=Ht(t,e.shape),a=Pr(n,e.rank);a!=null&&(e=e.transpose(a),n=Hr(n.length,e.rank));var o={axis:n[0]},s=[e];return j.runKernelFunc((function(l,f){var h=l.argMax(e,n[0]);return f([e]),h}),{x:e},(function(l,f){var h=f[0];return{x:function(){return Qe(h)}}}),"ArgMax",o,s)}}),uN=H({argMin_:function(r,t){t===void 0&&(t=0);var e=O(r,"x","argMin");t==null&&(t=0);var n=Ht(t,e.shape),a=Pr(n,e.rank);return a!=null&&(e=e.transpose(a),n=Hr(n.length,e.rank)),j.runKernelFunc((function(o,s){var l=o.argMin(e,n[0]);return s([e]),l}),{$x:e},(function(o,s){var l=s[0];return{$x:function(){return Qe(l)}}}))}}),sN=H({logSumExp_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","logSumExp"),a=Ht(t,n.shape),o=n.max(a,!0),s=n.sub(o).exp().sum(a).log(),l=o.reshape(s.shape).add(s);if(e){var f=Dn(l.shape,a);return l.reshape(f)}return l}}),Xc=H({max_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","max"),a=n,o=Ht(t,n.shape),s=o,l=Pr(s,n.rank);l!=null&&(n=n.transpose(l),s=Hr(s.length,n.rank));var f=[n],h=j.runKernelFunc((function(v,m){var y=v.max(n,s);return m([a,y]),y}),{x:n},(function(v,m){return d2(v,m[1],m[0],o,l)}),"Max",{axes:s},f,[!0]);if(e){var p=Dn(h.shape,o);h=h.reshape(p)}return h}}),lN=H({mean_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","mean"),a=Ht(t,n.shape),o=Se(an(n.shape,a)[1]);return Vc((function(s){var l=ge(o);return{value:(l.dtype===s.dtype?s:s.cast(l.dtype)).div(l).sum(t,e),gradFunc:function(f){var h=s.shape.slice();return a.forEach((function(p){h[p]=1})),f.reshape(h).mul(Qo(s.shape,"float32")).div(o)}}}))(n)}}),cN=H({min_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","min"),a=n,o=Ht(t,n.shape),s=o,l=Pr(s,n.rank);l!=null&&(n=n.transpose(l),s=Hr(s.length,n.rank));var f=[n],h=j.runKernelFunc((function(v,m){var y=v.min(n,s);return m([a,y]),y}),{x:n},(function(v,m){return d2(v,m[1],m[0],o,l)}),"Min",{axes:s},f,[!0]);if(e){var p=Dn(h.shape,o);h=h.reshape(p)}return h}}),fN=H({moments_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=Ht(t,(r=O(r,"x","moments")).shape),a=r.mean(n,e),o=a.shape;e||(o=Dn(a.shape,n));var s=r.toFloat().sub(a.reshape(o)).square();return{mean:a,variance:s.mean(n,e)}}}),p2=H({sum_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","sum");n.dtype==="bool"&&(n=n.toInt());var a=Ht(t,n.shape);return Vc((function(o){var s=Pr(a,o.rank),l=a,f=o;s!=null&&(f=o.transpose(s),l=Hr(l.length,o.rank));var h=function(y){var x=o.shape.slice();return a.forEach((function(E){x[E]=1})),y.reshape(x).mul(Qo(o.shape,"float32"))},p={axes:l},v=j.runKernelFunc((function(y){return y.sum(f,l)}),{x:f},(function(y){return{x:function(){return h(y)}}}),"Sum",p);if(e){var m=Dn(v.shape,a);v=v.reshape(m)}return{value:v,gradFunc:h}}))(n)}}),hN=H({prod_:function(r,t,e){t===void 0&&(t=null),e===void 0&&(e=!1);var n=O(r,"x","prod");n.dtype==="bool"&&(n=n.toInt());var a=Ht(t,n.shape),o=Pr(a,n.rank),s=a,l=n;o!=null&&(l=n.transpose(o),s=Hr(s.length,n.rank));var f=j.runKernelFunc((function(p){return p.prod(l,s)}),{permutedX:l});if(e){var h=Dn(f.shape,a);f=f.reshape(h)}return f}}),v2=H({elu_:function(r){var t=O(r,"x","elu");return j.runKernelFunc((function(e,n){var a=e.elu(t);return n([a]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){return j.runKernelFunc((function(o){return o.eluDer(e,a)}),{dy:e,y:a})}}}))}}),dN=H({leakyRelu_:function(r,t){t===void 0&&(t=.2);var e=O(r,"x","leakyRelu");return ov(ge(t).mul(e),e)}}),m2=H({prelu_:function(r,t){var e=O(r,"x","prelu"),n=O(t,"alpha","prelu");return j.runKernelFunc((function(a,o){var s=a.prelu(e,n);return o([e,n]),s}),{x:e,alpha:n},(function(a,o){var s=o[0],l=o[1],f=s.greater(0);return{x:function(){return Oi(f,a,a.mul(l))},alpha:function(){var h=Oi(f,Qe(a),a.mul(s)),p=Ut(l.shape,a.shape);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)}}}),"Prelu")}}),bt=H({relu_:function(r){var t=O(r,"x","relu");return t.dtype==="bool"?t.toInt():j.runKernelFunc((function(e,n){var a=e.relu(t);return n([t]),a}),{x:t},(function(e,n){var a=n[0];return{x:function(){return e.mulStrict(a.step().toFloat())}}}),"Relu")}}),g2=H({relu6_:function(r){var t=O(r,"x","relu6");return t.dtype==="bool"?t.toInt():j.runKernelFunc((function(e,n){var a=e.relu6(t);return n([t]),a}),{x:t},(function(e,n){var a=n[0],o=a.lessEqual(6).mul(a.step());return{x:function(){return e.mulStrict(o.toFloat())}}}),"Relu6")}}),pN=H({selu_:function(r){var t=O(r,"x","selu");return j.runKernelFunc((function(e,n){var a=e.selu(t);return n([t]),a}),{$x:t},(function(e,n){var a=n[0];return{$x:function(){var o=a.greater(ge(0)),s=ge(rv),l=ge(av),f=e.mul(l),h=e.mul(s).mul(a.toFloat().exp());return Oi(o,f,h)}}}))}}),$a=H({transpose_:function(r,t){var e=O(r,"x","transpose");if(t==null&&(t=e.shape.map((function(a,o){return o})).reverse()),B(e.rank===t.length,(function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+t+"."})),t.forEach((function(a){B(a>=0&&a<e.rank,(function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+t}))})),e.rank<=1)return e.clone();var n={perm:t};return j.runKernelFunc((function(a){return a.transpose(e,t)}),{x:e},(function(a){var o=Xp(t);return{x:function(){return a.transpose(o)}}}),"Transpose",n)}}),vN=H({localResponseNormalization_:function(r,t,e,n,a){t===void 0&&(t=5),e===void 0&&(e=1),n===void 0&&(n=1),a===void 0&&(a=.5);var o=O(r,"x","localResponseNormalization");B(o.rank===4||o.rank===3,(function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+o.rank+"."})),B(At(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var s=o,l=!1;o.rank===3&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var f=j.runKernelFunc((function(h,p){var v=h.localResponseNormalization4D(s,t,e,n,a);return p([s,v]),v}),{x4D:s},(function(h,p){var v=p[0],m=p[1];return{x4D:function(){return j.runKernelFunc((function(y){return y.LRNGrad(h,v,m,t,e,n,a)}),{})}}}));return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),y2=H({norm_:function(r,t,e,n){t===void 0&&(t="euclidean"),e===void 0&&(e=null),n===void 0&&(n=!1);var a=(function l(f,h,p){if(p===void 0&&(p=null),f.rank===0)return f.abs();if(f.rank!==1&&p===null)return l(f.reshape([-1]),h,p);if(f.rank===1||typeof p=="number"||Array.isArray(p)&&p.length===1){if(h===1)return f.abs().sum(p);if(h===1/0)return f.abs().max(p);if(h===-1/0)return f.abs().min(p);if(h==="euclidean"||h===2)return f.abs().pow(ge(2,"int32")).sum(p).sqrt();throw new Error("Error in norm: invalid ord value: "+h)}if(Array.isArray(p)&&p.length===2){if(h===1)return f.abs().sum(p[0]).max(p[1]-1);if(h===1/0)return f.abs().sum(p[1]).max(p[0]);if(h===-1/0)return f.abs().sum(p[1]).min(p[0]);if(h==="fro"||h==="euclidean")return f.square().sum(p).sqrt();throw new Error("Error in norm: invalid ord value: "+h)}throw new Error("Error in norm: invalid axis: "+p)})(r=O(r,"x","norm"),t,e),o=a.shape;if(n){var s=Ht(e,r.shape);o=Dn(a.shape,s)}return a.reshape(o)}}),mN=H({basicLSTMCell_:function(r,t,e,n,a,o){var s=O(r,"forgetBias","basicLSTMCell"),l=O(t,"lstmKernel","basicLSTMCell"),f=O(e,"lstmBias","basicLSTMCell"),h=O(n,"data","basicLSTMCell"),p=O(a,"c","basicLSTMCell"),v=O(o,"h","basicLSTMCell"),m=h.concat(v,1).matMul(l).add(f),y=m.shape[0],x=m.shape[1]/4,E=[y,x],w=m.slice([0,0],E),C=m.slice([0,x],E),_=m.slice([0,2*x],E),R=m.slice([0,3*x],E),A=w.sigmoid().mulStrict(C.tanh()).addStrict(p.mulStrict(s.add(_).sigmoid())),T=A.tanh().mulStrict(R.sigmoid());return[A,T]}}),gN=H({multiRNNCell_:function(r,t,e,n){for(var a=O(t,"data","multiRNNCell"),o=xc(e,"c","multiRNNCell"),s=xc(n,"h","multiRNNCell"),l=a,f=[],h=0;h<r.length;h++){var p=r[h](l,o[h],s[h]);f.push(p[0]),f.push(p[1]),l=p[1]}var v=[],m=[];for(h=0;h<f.length;h+=2)v.push(f[h]),m.push(f[h+1]);return[v,m]}}),yN=H({movingAverage_:function(r,t,e,n,a){a===void 0&&(a=!0);var o=O(r,"v","movingAverage"),s=O(t,"x","movingAverage"),l=O(e,"decay","movingAverage");vR(o,s),B(Gt(o.shape,s.shape),(function(){return"Shape mismatch in v and x"}));var f=ge(1),h=f.sub(l),p=s.sub(o).mul(h);if(a){B(n!=null,(function(){return"When using zeroDebias: true, step is required."}));var v=O(n,"step","movingAverage");p=p.div(f.sub(Nc(l,v)))}return o.add(p)}}),bN=H({stridedSlice_:function(r,t,e,n,a,o,s,l,f){if(a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=0),f===void 0&&(f=0),n==null&&(n=new Array(t.length)),s!==0)throw new Error("ellipsis mask is not yet supported");var h=O(r,"x","stridedSlice"),p=Eb(l),v=h.shape.slice();p.forEach((function(w){t[w]=0,e[w]=1,v.splice(w,0,1)})),h=h.reshape(v);for(var m=0;m<h.rank;m++)t[m]=DA(a,t,n,h.shape,m),e[m]=NA(o,e,n,h.shape,m),n[m]=n[m]||1;var y=Eb(f);y.forEach((function(w){e[w]=t[w]+1,n[w]=1}));var x=Zp(t,e,n),E=x.filter((function(w,C){return y.indexOf(C)===-1}));return n.every((function(w){return w===1}))?zr(h,t,x).reshape(E):j.runKernelFunc((function(w){return w.stridedSlice(h,t,e,n)}),{$x:h}).reshape(E)}}),xN=H({topk_:function(r,t,e){t===void 0&&(t=1),e===void 0&&(e=!0);var n=O(r,"x","topk");if(n.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var a=n.shape[n.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var o=j.runKernelFunc((function(s){return s.topk(n,t,e)}),{$x:n});return{values:o[0],indices:o[1]}}}),wN=H({scatterND_:function(r,t,e){var n=O(r,"indices","scatterND","int32"),a=O(t,"updates","scatterND");return AA(a,n,e),j.runKernelFunc((function(o){return o.scatterND(n,a,e)}),{indices:n,updates:a},null,"ScatterNd",{shape:e})}}),cv=H({fft_:function(r){B(r.dtype==="complex64",(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+r.dtype+"."}));var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return j.runKernelFunc((function(a){return a.fft(n)}),{input:r}).reshape(r.shape)}}),Oc=H({ifft_:function(r){B(r.dtype==="complex64",(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+r.dtype+"."}));var t=r.shape[r.shape.length-1],e=r.size/t,n=r.as2D(e,t);return j.runKernelFunc((function(a){return a.ifft(n)}),{input:r}).reshape(r.shape)}}),fv=H({rfft_:function(r,t){B(r.dtype==="float32",(function(){return"The dtype for rfft() must be real value but got "+r.dtype}));var e,n=r.shape[r.shape.length-1],a=r.size/n;if(t!=null&&t<n){var o=r.shape.map((function(C){return 0})),s=r.shape.map((function(C){return C}));s[r.shape.length-1]=t,e=r.slice(o,s),n=t}else if(t!=null&&t>n){var l=r.shape.map((function(C){return C}));l[r.shape.length-1]=t-n,e=r.concat(mt(l),r.shape.length-1),n=t}else e=r;var f=e.zerosLike(),h=en(e,f).as2D(a,n),p=cv(h),v=Math.floor(n/2)+1,m=or(p),y=Mr(p),x=m.split([v,n-v],m.shape.length-1),E=y.split([v,n-v],y.shape.length-1),w=e.shape.slice();return w[e.shape.length-1]=v,en(x[0],E[0]).reshape(w)}}),b2=H({irfft_:function(r){var t=r.shape[r.shape.length-1],e=r.size/t;if(t<=2){var n=r.as2D(e,t),a=Oc(n);return or(a)}var o=[e,2*(t-1)],s=or(r).as2D(e,t),l=Mr(r).as2D(e,t),f=s.slice([0,1],[e,t-2]).reverse(1),h=l.slice([0,1],[e,t-2]).reverse(1).mul(ge(-1)),p=s.concat(f,1),v=l.concat(h,1);return n=en(p,v).as2D(o[0],o[1]),a=Oc(n),or(a)}}),EN=Object.freeze({fft:cv,ifft:Oc,rfft:fv,irfft:b2}),CN=H({sparseToDense_:function(r,t,e,n){n===void 0&&(n=0);var a=O(r,"sparseIndices","sparseToDense","int32"),o=O(t,"sparseValues","sparseToDense"),s=O(n,"defaultValue","sparseToDense",o.dtype);return(function(l,f,h,p){if(l.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+l.dtype+".");if(l.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+l.shape+".");var v=l.rank>0?l.shape[0]:1,m=l.rank>1?l.shape[1]:1;if(h.length!==m)throw new Error("outputShape has incorrect number of elements:, "+h.length+", should be: "+m+".");var y=f.size;if(f.rank!==0&&(f.rank!==1||y!==v))throw new Error("sparseValues has incorrect shape "+f.shape+", should be [] or ["+v+"]");if(f.dtype!==p.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")})(a,o,e,s),j.runKernelFunc((function(l){return l.sparseToDense(a,o,e,s)}),{$sparseIndices:a,$sparseValues:o,$defaultValue:s})}}),_N=H({gatherND_:function(r,t){var e=O(t,"indices","gatherND","int32"),n=O(r,"x","gatherND");return j.runKernelFunc((function(a){return a.gatherND(n,e)}),{x:n,indices:e},null,"GatherNd")}}),SN=H({diag_:function(r){var t=O(r,"x","diag").flatten(),e=r.shape.concat(r.shape);return j.runKernelFunc((function(n){return n.diag(t)}),{$x:t}).reshape(e)}}),RN=H({dropout_:function(r,t,e,n){var a=O(r,"x","dropout");if(B(a.dtype==="float32",(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),B(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),t===0)return r instanceof yt?a.clone():a;var o=(function(f,h){if(h==null)return f.shape.slice();if(Gt(f.shape,h))return h;if(f.shape.length===h.length){for(var p=[],v=0;v<f.shape.length;v++)h[v]==null&&f.shape[v]!=null?p.push(f.shape[v]):p.push(h[v]);return p}return h})(a,e),s=1-t,l=mx(o,0,1,"float32",n).add(s).floor().div(s);return a.mul(l)}});function x2(r,t,e){for(var n=1-r%2,a=new Float32Array(r),o=0;o<r;++o){var s=2*Math.PI*o/(r+n-1);a[o]=t-e*Math.cos(s)}return It(a,"float32")}var hv=H({hannWindow_:function(r){return x2(r,.5,.5)}}),w2=H({hammingWindow_:function(r){return x2(r,.54,.46)}}),dv=H({frame_:function(r,t,e,n,a){n===void 0&&(n=!1),a===void 0&&(a=0);for(var o=0,s=[];o+t<=r.size;)s.push(zr(r,o,t)),o+=e;if(n)for(;o<r.size;){var l=o+t-r.size,f=Lt([zr(r,o,t-l),Fr([l],a)]);s.push(f),o+=e}return s.length===0?Qa([],[0,t]):Lt(s).as2D(s.length,t)}}),E2=H({stft_:function(r,t,e,n,a){var o;a===void 0&&(a=hv),n==null&&(o=t,n=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var s=dv(r,t,e),l=cn(s,a(t)),f=[],h=0;h<s.shape[0];h++)f.push(fv(l.slice([h,0],[1,t]),n));return Lt(f)}}),AN=Object.freeze({hannWindow:hv,hammingWindow:w2,frame:dv,stft:E2}),sn,TN=function(r,t,e){return e===void 0&&(e=1),Ee(this,void 0,void 0,(function(){var n,a,o,s,l,f,h,p,v,m,y,x,E,w;return Ce(this,(function(C){switch(C.label){case 0:return n=O(r,"predictions","inTopK"),a=O(t,"targets","inTopK"),B(n.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+n.rank})),B(n.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+n.rank+" and targets rank "+a.rank})),rt(n.shape.slice(0,n.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=n.shape[n.shape.length-1],B(e>0&&e<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+e})),[4,n.data()];case 1:return s=C.sent(),[4,a.data()];case 2:for(l=C.sent(),f=[s.length/o,o],p=f[1],v=ns("bool",h=f[0]),m=0;m<h;m++){for(y=m*p,x=s.subarray(y,y+p),E=[],w=0;w<x.length;w++)E.push({value:x[w],index:w});for(E.sort((function(_,R){return R.value-_.value})),v[m]=0,w=0;w<e;w++)if(E[w].index===l[m]){v[m]=1;break}}return r!==n&&n.dispose(),t!==a&&a.dispose(),[2,nn(v,a.shape,"bool")]}}))}))};(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(sn||(sn={}));var DN=H({absoluteDifference_:function(r,t,e,n){n===void 0&&(n=sn.SUM_BY_NONZERO_WEIGHTS);var a=O(r,"labels","absoluteDifference"),o=O(t,"predictions","absoluteDifference"),s=null;e!=null&&(s=O(e,"weights","absoluteDifference")),rt(a.shape,o.shape,"Error in absoluteDifference: ");var l=a.sub(o).abs();return ya(l,s,n)}}),ya=H({computeWeightedLoss_:function(r,t,e){e===void 0&&(e=sn.SUM_BY_NONZERO_WEIGHTS);var n=O(r,"losses","computeWeightedLoss"),a=null;t!=null&&(a=O(t,"weights","computeWeightedLoss"));var o=a==null?n:n.mul(a);if(e===sn.NONE)return o;if(e===sn.SUM)return o.sum();if(e===sn.MEAN){if(a==null)return o.mean();var s=n.size/a.size,l=o.sum().div(a.sum());return s>1?l.div(ge(s)):l}if(e===sn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return o.sum().div(ge(n.size));var f=a.mul(Qo(n.shape)).notEqual(ge(0)).sum().toFloat();return o.sum().div(f)}throw Error("Unknown reduction: "+e)}}),NN=H({cosineDistance_:function(r,t,e,n,a){a===void 0&&(a=sn.SUM_BY_NONZERO_WEIGHTS);var o=O(r,"labels","cosineDistance"),s=O(t,"predictions","cosineDistance"),l=null;n!=null&&(l=O(n,"weights","cosineDistance")),rt(o.shape,s.shape,"Error in cosineDistance: ");var f=ge(1).sub(o.mul(s).sum(e,!0));return ya(f,l,a)}}),ON=H({hingeLoss_:function(r,t,e,n){n===void 0&&(n=sn.SUM_BY_NONZERO_WEIGHTS);var a=O(r,"labels","hingeLoss"),o=O(t,"predictions","hingeLoss"),s=null;e!=null&&(s=O(e,"weights","hingeLoss")),rt(a.shape,o.shape,"Error in hingeLoss: ");var l=ge(1);a=ge(2).mul(a).sub(l);var f=l.sub(a.mul(o)).relu();return ya(f,s,n)}}),MN=H({huberLoss_:function(r,t,e,n,a){n===void 0&&(n=1),a===void 0&&(a=sn.SUM_BY_NONZERO_WEIGHTS);var o=O(r,"labels","huberLoss"),s=O(t,"predictions","huberLoss"),l=null;e!=null&&(l=O(e,"weights","huberLoss")),rt(o.shape,s.shape,"Error in huberLoss: ");var f=ge(n),h=s.sub(o).abs(),p=t2(h,f),v=h.sub(p),m=ge(.5).mul(p.square()).add(f.mul(v));return ya(m,l,a)}}),kN=H({logLoss_:function(r,t,e,n,a){n===void 0&&(n=1e-7),a===void 0&&(a=sn.SUM_BY_NONZERO_WEIGHTS);var o=O(r,"labels","logLoss"),s=O(t,"predictions","logLoss"),l=null;e!=null&&(l=O(e,"weights","logLoss")),rt(o.shape,s.shape,"Error in logLoss: ");var f=ge(1),h=ge(n),p=o.mul(s.add(h).log()).neg().sub(f.sub(o).mul(f.sub(s).add(h).log()));return ya(p,l,a)}}),IN=H({meanSquaredError_:function(r,t,e,n){n===void 0&&(n=sn.SUM_BY_NONZERO_WEIGHTS);var a=O(r,"labels","meanSquaredError"),o=O(t,"predictions","meanSquaredError"),s=null;e!=null&&(s=O(e,"weights","meanSquaredError")),rt(a.shape,o.shape,"Error in meanSquaredError: ");var l=a.squaredDifference(o);return ya(l,s,n)}}),BN=H({sigmoidCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=sn.SUM_BY_NONZERO_WEIGHTS);var o=O(r,"multiClassLabels","sigmoidCrossEntropy"),s=O(t,"logits","sigmoidCrossEntropy"),l=null;if(e!=null&&(l=O(e,"weights","sigmoidCrossEntropy")),rt(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),n>0){var f=ge(n),h=ge(1),p=ge(.5);o=o.mul(h.sub(f)).add(p.mul(f))}var v=(function(m,y){var x=O(m,"labels","sigmoidCrossEntropyWithLogits"),E=O(y,"logits","sigmoidCrossEntropyWithLogits");rt(x.shape,E.shape,"Error in sigmoidCrossEntropyWithLogits: ");var w=E.relu(),C=E.mul(x),_=E.abs().neg().exp().log1p();return w.sub(C).add(_)})(o,s);return ya(v,l,a)}}),FN=H({softmaxCrossEntropy_:function(r,t,e,n,a){n===void 0&&(n=0),a===void 0&&(a=sn.SUM_BY_NONZERO_WEIGHTS);var o=O(r,"onehotLabels","softmaxCrossEntropy"),s=O(t,"logits","softmaxCrossEntropy"),l=null;if(e!=null&&(l=O(e,"weights","softmaxCrossEntropy")),rt(o.shape,s.shape,"Error in softmaxCrossEntropy: "),n>0){var f=ge(n),h=ge(1),p=ge(o.shape[1]);o=o.mul(h.sub(f)).add(f.div(p))}var v=(function(m,y,x){if(x===void 0&&(x=-1),x===-1&&(x=y.rank-1),x!==y.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+y.rank+" and dim was "+x);return Vc((function(E,w,C){var _=w.logSumExp([x],!0),R=w.toFloat().sub(_);return C([E,R]),{value:R.mul(E).neg().sum([x]),gradFunc:function(A,T){var N=T[0],M=T[1],I=Dn(A.shape,[x]);return[A.reshape(I).mul(N.toFloat().sub(M.exp())),A.reshape(I).mul(M.exp().sub(N.toFloat()))]}}}))(m,y)})(o,s);return ya(v,l,a)}}),LN=Object.freeze({get Reduction(){return sn},absoluteDifference:DN,computeWeightedLoss:ya,cosineDistance:NN,hingeLoss:ON,huberLoss:MN,logLoss:kN,meanSquaredError:IN,sigmoidCrossEntropy:BN,softmaxCrossEntropy:FN});function jb(r,t){return t===void 0&&(t=!1),j.tidy((function(){if(r.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+r.shape.length+"D Tensor.");for(var e=r.shape[0],n=r.shape[1],a=vx(e),o=r.clone(),s=Qa([[1]],[1,1]),l=s.clone(),f=e>=n?n:e,h=function(v){var m,y=o,x=l,E=a;m=j.tidy((function(){var w=o.slice([v,v],[e-v,1]),C=w.norm(),_=o.slice([v,v],[1,1]),R=Qa([[-1]]).where(_.greater(0),Qa([[1]])),A=_.sub(R.mul(C)),T=w.div(A);l=T.shape[0]===1?s.clone():s.concat(T.slice([1,0],[T.shape[0]-1,T.shape[1]]),0);var N=R.matMul(A).div(C).neg(),M=o.slice([v,0],[e-v,n]),I=N.mul(l);if(v===0)o=M.sub(I.matMul(l.transpose().matMul(M)));else{var k=M.sub(I.matMul(l.transpose().matMul(M)));o=o.slice([0,0],[v,n]).concat(k,0)}var F=a.slice([0,v],[e,a.shape[1]-v]);if(v===0)a=F.sub(F.matMul(l).matMul(I.transpose()));else{var W=F.sub(F.matMul(l).matMul(I.transpose()));a=a.slice([0,0],[e,v]).concat(W,1)}return[l,o,a]})),l=m[0],o=m[1],a=m[2],Rn([y,x,E])},p=0;p<f;++p)h(p);return!t&&e>n&&(a=a.slice([0,0],[e,n]),o=o.slice([0,0],[n,n])),[a,o]}))}var zN=H({bandPart_:function(r,t,e){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var n=O(r,"a","bandPart");if(n.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+n.rank+".");var a=n.shape,o=n.shape.slice(-2),s=o[0],l=o[1];if(!(t<=s))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+s+").");if(!(e<=l))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+l+").");t<0&&(t=s),e<0&&(e=l);var f=wc(0,s,1,"int32").reshape([-1,1]),h=wc(0,l,1,"int32"),p=Pt(f,h),v=jc(p.lessEqual(ge(+t,"int32")),p.greaterEqual(ge(-e,"int32"))),m=mt([s,l],n.dtype);return qn(zt(n.reshape([-1,s,l])).map((function(y){return Oi(v,y,m)}))).reshape(a)}}),UN=H({gramSchmidt_:function(r){var t;if(Array.isArray(r)){t=!1,B(r!=null&&r.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var e=r[0].shape[0],n=function(f){B(r[f].shape[0]===e,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+r[f].shape[0]+" vs. "+e+")"}))},a=1;a<r.length;++a)n(a)}else t=!0,r=Yp(r,r.shape[0],0).map((function(f){return yx(f,[0])}));B(r.length<=r[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+r.length+") exceeds number of dimensions ("+r[0].shape[0]+")."}));var o=[],s=r,l=function(f){o.push(j.tidy((function(){var h=s[f];if(f>0)for(var p=0;p<f;++p){var v=p2(o[p].mulStrict(h)).mul(o[p]);h=h.sub(v)}return h.div(y2(h,"euclidean"))})))};for(a=0;a<r.length;++a)l(a);return t?qn(o,0):o}}),PN=H({qr_:function(r,t){if(t===void 0&&(t=!1),r.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+r.rank);if(r.rank===2)return jb(r,t);var e=r.shape.slice(0,r.shape.length-2).reduce((function(s,l){return s*l})),n=zt(r.reshape([e,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),a=[],o=[];return n.forEach((function(s){var l=jb(s,t),f=l[0],h=l[1];a.push(f),o.push(h)})),[qn(a,0).reshape(r.shape),qn(o,0).reshape(r.shape)]}}),HN=Object.freeze({bandPart:zN,gramSchmidt:UN,qr:PN});function Kc(r,t,e,n,a,o){n==null&&(n=.5),a==null&&(a=Number.NEGATIVE_INFINITY),o==null&&(o=0);var s=r.shape[0];return e=Math.min(e,s),B(0<=n&&n<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+n+"'"})),B(r.rank===2,(function(){return"boxes must be a 2D tensor, but was of rank '"+r.rank+"'"})),B(r.shape[1]===4,(function(){return"boxes must have 4 columns, but 2nd dimension was "+r.shape[1]})),B(t.rank===1,(function(){return"scores must be a 1D tensor"})),B(t.shape[0]===s,(function(){return"scores has incompatible shape with boxes. Expected "+s+", but was "+t.shape[0]})),B(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"})),{maxOutputSize:e,iouThreshold:n,scoreThreshold:a,softNmsSigma:o}}var VN=H({resizeBilinear_:function(r,t,e){e===void 0&&(e=!1);var n=O(r,"images","resizeBilinear");B(n.rank===3||n.rank===4,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+n.rank+"."})),B(t.length===2,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var a=n,o=!1;n.rank===3&&(o=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],f=j.runKernelFunc((function(h,p){return p([a]),h.resizeBilinear(a,s,l,e)}),{x:a},(function(h,p){return{x:function(){return j.runKernelFunc((function(v){return v.resizeBilinearBackprop(h,p[0],e)}),{})}}}),"ResizeBilinear",{alignCorners:e,newHeight:s,newWidth:l});return o?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),WN=H({resizeNearestNeighbor_:function(r,t,e){e===void 0&&(e=!1);var n=O(r,"images","resizeNearestNeighbor");B(n.rank===3||n.rank===4,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+n.rank+"."})),B(t.length===2,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),B(n.dtype==="float32"||n.dtype==="int32",(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=n,o=!1;n.rank===3&&(o=!0,a=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var s=t[0],l=t[1],f=j.runKernelFunc((function(h,p){return p([a]),h.resizeNearestNeighbor(a,s,l,e)}),{batchImages:a},(function(h,p){return{batchImages:function(){return j.runKernelFunc((function(v){return v.resizeNearestNeighborBackprop(h,p[0],e)}),{})}}}));return o?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),jN=H({nonMaxSuppression_:function(r,t,e,n,a){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY);var o=O(r,"boxes","nonMaxSuppression"),s=O(t,"scores","nonMaxSuppression"),l=Kc(o,s,e,n,a);e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold;var f={maxOutputSize:e,iouThreshold:n,scoreThreshold:a};return j.runKernelFunc((function(h){return h.nonMaxSuppression(o,s,e,n,a)}),{boxes:o,scores:s},null,"NonMaxSuppressionV3",f)}}),GN=function(r,t,e,n,a){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),Ee(this,void 0,void 0,(function(){var o,s,l,f,h,p,v;return Ce(this,(function(m){switch(m.label){case 0:return o=O(r,"boxes","nonMaxSuppressionAsync"),s=O(t,"scores","nonMaxSuppressionAsync"),l=Kc(o,s,e,n,a),e=l.maxOutputSize,n=l.iouThreshold,a=l.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return f=m.sent(),h=f[0],p=f[1],v=$p(h,p,e,n,a),o!==r&&o.dispose(),s!==t&&s.dispose(),[2,v]}}))}))},qN=H({nonMaxSuppressionWithScore_:function(r,t,e,n,a,o){n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),o===void 0&&(o=0);var s=O(r,"boxes","nonMaxSuppression"),l=O(t,"scores","nonMaxSuppression"),f=Kc(s,l,e,n,a,o),h={maxOutputSize:e=f.maxOutputSize,iouThreshold:n=f.iouThreshold,scoreThreshold:a=f.scoreThreshold,softNmsSigma:o=f.softNmsSigma},p=j.runKernel("NonMaxSuppressionV5",{boxes:s,scores:l},h);return{selectedIndices:p[0],selectedScores:p[1]}}}),XN=function(r,t,e,n,a,o){return n===void 0&&(n=.5),a===void 0&&(a=Number.NEGATIVE_INFINITY),o===void 0&&(o=0),Ee(this,void 0,void 0,(function(){var s,l,f,h,p,v,m;return Ce(this,(function(y){switch(y.label){case 0:return s=O(r,"boxes","nonMaxSuppressionAsync"),l=O(t,"scores","nonMaxSuppressionAsync"),f=Kc(s,l,e,n,a,o),e=f.maxOutputSize,n=f.iouThreshold,a=f.scoreThreshold,o=f.softNmsSigma,[4,Promise.all([s.data(),l.data()])];case 1:return h=y.sent(),p=h[0],v=h[1],m=ev(p,v,e,n,a,o),s!==r&&s.dispose(),l!==t&&l.dispose(),[2,m]}}))}))},KN=H({cropAndResize_:function(r,t,e,n,a,o){var s=O(r,"image","cropAndResize"),l=O(t,"boxes","cropAndResize","float32"),f=O(e,"boxInd","cropAndResize","int32");a=a||"bilinear",o=o||0;var h=l.shape[0];return B(s.rank===4,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+s.rank+"."})),B(l.rank===2&&l.shape[1]===4,(function(){return"Error in cropAndResize: boxes must be have size ["+h+",4] but had shape "+l.shape+"."})),B(f.rank===1&&f.shape[0]===h,(function(){return"Error in cropAndResize: boxInd must be have size ["+h+"] but had shape "+l.shape+"."})),B(n.length===2,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+n.length+"."})),B(n[0]>=1&&n[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+n})),B(a==="bilinear"||a==="nearest",(function(){return"method must be bilinear or nearest, but was "+a})),j.runKernelFunc((function(p,v){return p.cropAndResize(s,l,f,n,a,o)}),{images:s,boxes:l,boxInd:f},null,"CropAndResize",{method:a,extrapolationValue:o,cropSize:n})}}),pv=Object.freeze({resizeBilinear:VN,resizeNearestNeighbor:WN,nonMaxSuppression:jN,nonMaxSuppressionAsync:GN,nonMaxSuppressionWithScore:qN,nonMaxSuppressionWithScoreAsync:XN,cropAndResize:KN}),vv=function(r,t){return!(r>0)||t==="linear"},mv=function(r,t,e){if(e==null||e==="linear")return r;if(e==="relu")return r.mul(t.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},gv=function(r,t){var e=t,n=Ut(r.shape,t.shape);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},yv=function(r,t,e){if(t==="linear")return r;if(t==="relu")return bt(r);if(t==="elu")return v2(r);if(t==="relu6")return g2(r);if(t==="prelu")return m2(r,e);throw new Error("Unknown fused activation "+t+".")},YN=H({fusedMatMul_:function(r){var t,e=r.a,n=r.b,a=r.transposeA,o=a!==void 0&&a,s=r.transposeB,l=s!==void 0&&s,f=r.bias,h=r.activation,p=h===void 0?"linear":h,v=r.preluActivationWeights;if(vv(j.state.gradientDepth,p)===!1){var m=qc(e,n,o,l);return f!=null&&(m=Ve(m,f)),yv(m,p,v)}var y=O(e,"a","fused matMul"),x=O(n,"b","fused matMul");t=wt(y,x),y=t[0],x=t[1];var E=o?y.shape[y.rank-2]:y.shape[y.rank-1],w=l?x.shape[x.rank-1]:x.shape[x.rank-2],C=o?y.shape[y.rank-1]:y.shape[y.rank-2],_=l?x.shape[x.rank-2]:x.shape[x.rank-1],R=y.shape.slice(0,-2),A=x.shape.slice(0,-2),T=Se(R),N=Se(A);B(y.rank>=2&&x.rank>=2&&y.rank===x.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+y.rank+" and "+x.rank+"."})),B(Gt(R,A),(function(){return"Error in fused matMul: outer dimensions ("+R+") and ("+A+") of Tensors with shapes "+y.shape+" and "+x.shape+" must match."})),B(E===w,(function(){return"Error in fused matMul: inner shapes ("+E+") and ("+w+") of Tensors with shapes "+y.shape+" and "+x.shape+" and transposeA="+o+" and transposeB="+l+" must match."}));var M,I,k=y.shape.slice(0,-2).concat([C,_]),F=o?y.as3D(T,E,C):y.as3D(T,C,E),W=l?x.as3D(N,_,w):x.as3D(N,w,_);f!=null&&Ge(k,(M=wt(M=O(f,"bias","fused matMul"),y)[0]).shape),v!=null&&(I=O(v,"prelu weights","fused matMul"));var P={a:F,b:W};f!=null&&(P.bias=M),v!=null&&(P.preluActivationWeights=I);var oe=[F,W];return j.runKernelFunc((function(ee,ae){var z=ee.fusedBatchMatMul({a:F,b:W,transposeA:o,transposeB:l,bias:M,activation:p,preluActivationWeights:I});return ae([F,W,z]),z}),P,(function(ee,ae){var z=ae[0],G=ae[1],K=ae[2],ie=mv(ee,K,p),se={};return f!=null&&(se={bias:function(){return gv(M,ie)}}),Object.assign(o||l?!o&&l?{a:function(){return ie.matMul(G,!1,!1)},b:function(){return ie.matMul(z,!0,!1)}}:o&&!l?{a:function(){return G.matMul(ie,!1,!0)},b:function(){return z.matMul(ie,!1,!1)}}:{a:function(){return G.matMul(ie,!0,!0)},b:function(){return ie.matMul(z,!0,!0)}}:{a:function(){return ie.matMul(G,!1,!0)},b:function(){return z.matMul(ie,!0,!1)}},se)}),"_FusedMatMul",{transposeA:o,transposeB:l,activation:p},oe,[!0]).reshape(k)}}),QN=H({fusedConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,o=r.dataFormat,s=o===void 0?"NHWC":o,l=r.dilations,f=l===void 0?[1,1]:l,h=r.dimRoundingMode,p=r.bias,v=r.activation,m=v===void 0?"linear":v,y=r.preluActivationWeights;if(m=m||"linear",vv(j.state.gradientDepth,m)===!1){var x=lr(t,e,n,a,s,f,h);return p!=null&&(x=Ve(x,p)),yv(x,m,y)}var E=O(t,"x","conv2d"),w=O(e,"filter","conv2d"),C=E,_=!1;E.rank===3&&(_=!0,C=E.as4D(1,E.shape[0],E.shape[1],E.shape[2])),B(C.rank===4,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+C.rank+"."})),B(w.rank===4,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+w.rank+"."})),h!=null&&B(At(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+h+" but got pad "+a+"."})),B(C.shape[3]===w.shape[2],(function(){return"Error in conv2d: depth of input ("+C.shape[3]+") must match input depth for filter "+w.shape[2]+"."})),B(Nn(n,f),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+f+"'"})),B(s==="NHWC",(function(){return"Error in conv2d: got dataFormat of "+s+" but only NHWC is currently supported."}));var R,A,T=Li(C.shape,w.shape,n,f,a,h);p!=null&&(R=wt(R=O(p,"bias","fused conv2d"),E)[0],Ge(T.outShape,R.shape)),y!=null&&(A=O(y,"prelu weights","fused conv2d"));var N={x:C,filter:w};p!=null&&(N.bias=R),y!=null&&(N.preluActivationWeights=A);var M=[w,C],I=j.runKernelFunc((function(k,F){var W=k.fusedConv2d({input:C,filter:w,convInfo:T,bias:R,activation:m,preluActivationWeights:A});return F([w,C,W]),W}),N,(function(k,F){var W=F,P=W[0],oe=W[1],ee=W[2],ae=mv(k,ee,m);B(Go(f),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+f+"'"}));var z={};return p!=null&&(z={bias:function(){return gv(R,ae)}}),Object.assign({x:function(){return u2(oe.shape,ae,P,n,a)},filter:function(){return sv(oe,ae,P.shape,n,a)}},z)}),"FusedConv2D",{convInfo:T,activation:m},M,[!0]);return _?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),ZN=H({fusedDepthwiseConv2d_:function(r){var t=r.x,e=r.filter,n=r.strides,a=r.pad,o=r.dataFormat,s=o===void 0?"NHWC":o,l=r.dilations,f=l===void 0?[1,1]:l,h=r.dimRoundingMode,p=r.bias,v=r.activation,m=v===void 0?"linear":v,y=r.preluActivationWeights;if(vv(j.state.gradientDepth,m)===!1){var x=Gc(t,e,n,a,s,f,h);return p!=null&&(x=Ve(x,p)),yv(x,m,y)}var E=O(t,"x","depthwiseConv2d"),w=O(e,"filter","depthwiseConv2d"),C=E,_=!1;E.rank===3&&(_=!0,C=E.as4D(1,E.shape[0],E.shape[1],E.shape[2])),B(C.rank===4,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+C.rank+"."})),B(w.rank===4,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+w.rank+"."})),B(C.shape[3]===w.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+C.shape[3]+") must match the inChannels dimension in filter "+w.shape[2]+"."})),f==null&&(f=[1,1]),B(Nn(n,f),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+f+"'"})),h!=null&&B(At(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+h+" but got pad "+a+"."}));var R,A,T=Li(C.shape,w.shape,n,f,a,h,!0);p!=null&&(R=wt(R=O(p,"bias","fused conv2d"),E)[0],Ge(T.outShape,R.shape)),y!=null&&(A=O(y,"prelu weights","fused depthwiseConv2d"));var N={x:C,filter:w};p!=null&&(N.bias=R),y!=null&&(N.preluActivationWeights=A);var M=[w,C],I=j.runKernelFunc((function(k,F){var W=k.fusedDepthwiseConv2D({input:C,filter:w,convInfo:T,bias:R,activation:m,preluActivationWeights:A});return F([w,C,W]),W}),N,(function(k,F){B(Go(f),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+f+"'"}));var W=F[0],P=F[1],oe=F[2],ee=mv(k,oe,m),ae={};return p!=null&&(ae={bias:function(){return gv(R,ee)}}),Object.assign({x:function(){return s2(P.shape,ee,W,T)},filter:function(){return l2(P,ee,W.shape,T)}},ae)}),"FusedDepthwiseConv2D",{convInfo:T,activation:m},M,[!0]);return _?I.as3D(I.shape[1],I.shape[2],I.shape[3]):I}}),JN=Object.freeze({matMul:YN,conv2d:QN,depthwiseConv2d:ZN}),$N=Object.freeze({image:pv,linalg:HN,losses:LN,spectral:EN,fused:JN,signal:AN,square:kD,squaredDifference:Gx,conv1d:V3,conv2d:lr,conv3d:W3,depthwiseConv2d:Gc,separableConv2d:lv,conv2dTranspose:j3,conv3dTranspose:G3,op:H,batchNormalization2d:l3,batchNormalization3d:c3,batchNormalization4d:f3,batchNormalization:h3,batchNorm:Zx,batchNorm2d:d3,batchNorm3d:p3,batchNorm4d:v3,booleanMaskAsync:H3,complex:en,real:or,imag:Mr,concat:Lt,concat1d:JR,concat2d:$R,concat3d:eA,concat4d:tA,split:Yp,matMul:qc,dot:q3,outerProduct:X3,reverse:gs,reverse1d:K3,reverse2d:Y3,reverse3d:Q3,reverse4d:Z3,maxPool:jt,avgPool:ys,pool:J3,maxPool3d:$3,avgPool3d:eN,slice:zr,slice1d:tN,slice2d:nN,slice3d:h2,slice4d:rN,abs:ID,acos:BD,acosh:FD,asin:LD,asinh:zD,atan:UD,atanh:PD,ceil:HD,clipByValue:iv,cos:VD,cosh:WD,erf:jD,exp:Sp,expm1:GD,floor:qD,log:XD,log1p:KD,logSigmoid:YD,neg:Dc,reciprocal:QD,round:ZD,rsqrt:qx,sigmoid:Xx,sign:JD,isNaN:$D,isInf:e3,isFinite:t3,sin:n3,sinh:r3,softplus:a3,sqrt:i3,step:o3,tan:u3,tanh:s3,all:aN,any:iN,argMax:oN,argMin:uN,logSumExp:sN,max:Xc,mean:lN,min:cN,moments:fN,sum:p2,prod:hN,equal:n2,equalStrict:O3,greater:M3,greaterEqual:r2,greaterEqualStrict:k3,greaterStrict:I3,less:B3,lessEqual:F3,lessEqualStrict:L3,lessStrict:z3,notEqual:U3,notEqualStrict:P3,add:Ve,addN:y3,addStrict:b3,atan2:x3,div:vr,divNoNan:w3,divStrict:E3,floorDiv:e2,maximum:ov,maximumStrict:C3,minimum:t2,minimumStrict:_3,mod:S3,modStrict:R3,mul:cn,mulStrict:A3,pow:Nc,powStrict:T3,squaredDifferenceStrict:D3,sub:Pt,subStrict:N3,elu:v2,leakyRelu:dN,prelu:m2,relu:bt,relu6:g2,selu:pN,logicalAnd:jc,logicalNot:m3,logicalOr:Jx,logicalXor:g3,where:Oi,whereAsync:$x,buffer:Le,print:cA,batchToSpaceND:px,broadcastTo:fA,cast:hA,clone:dA,cumsum:pA,depthToSpace:vA,expandDims:ir,eye:vx,multinomial:mA,oneHot:wp,pad:Fi,pad1d:gA,pad2d:yA,pad3d:bA,pad4d:xA,rand:wA,randomNormal:EA,randomGamma:CA,randomUniform:mx,reshape:mr,spaceToBatchND:gx,squeeze:yx,stack:qn,tile:Bo,truncatedNormal:_A,unstack:zt,setdiff1dAsync:SA,fill:Fr,linspace:ZR,ones:Qo,range:wc,scalar:ge,tensor:nn,tensor1d:It,tensor2d:Qa,tensor3d:Kp,tensor4d:_n,tensor5d:KR,tensor6d:YR,variable:QR,zeros:mt,onesLike:dx,zerosLike:Qe,transpose:$a,softmax:ga,logSoftmax:MA,localResponseNormalization:vN,norm:y2,gather:uv,unsortedSegmentSum:a2,basicLSTMCell:mN,multiRNNCell:gN,movingAverage:yN,stridedSlice:bN,topk:xN,scatterND:wN,fft:cv,ifft:Oc,rfft:fv,irfft:b2,sparseToDense:CN,gatherND:_N,diag:SN,dropout:RN,hannWindow:hv,hammingWindow:w2,frame:dv,stft:E2,inTopKAsync:TN});function de(r,t){Array.isArray(r)||(r=[r]),r.forEach((function(e){e!=null&&B(e.dtype!=="complex64",(function(){return t+" does not support complex64 tensors."}))}))}function Yd(r,t,e,n){if(e==="linear")return r.linear(t);if(e==="relu")return r.relu(t);if(e==="elu")return r.elu(t);if(e==="relu6")return r.relu6(t);if(e==="prelu")return r.prelu(t,n);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var e4=(function(r){function t(){var e=r.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new Sx(e,j),e}return yr(t,r),t.prototype.write=function(e,n,a){this.firstUse&&(this.firstUse=!1,ce().get("IS_NODE")&&bc(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var o={};return this.data.set(o,{values:e,dtype:a}),o},t.prototype.move=function(e,n,a,o){this.data.set(e,{values:n,dtype:o})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(n){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var n=this.data.get(e),a=n.dtype,o=n.complexTensors;return a==="complex64"?_p(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var n=this.readSync(e.dataId),a=n;if(e.dtype==="string")try{a=n.map((function(o){return mc(o)}))}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Le(e.shape,e.dtype,a)},t.prototype.makeOutput=function(e,n,a){var o=this.write(e,n,a);return j.makeTensorFromDataId(o,n,a,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var n=this.data.get(e).complexTensors;n!=null&&(n.real.dispose(),n.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Ee(this,void 0,void 0,(function(){var n;return Ce(this,(function(a){return n=Nr(),e(),[2,{kernelMs:Nr()-n}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,n){var a=this.makeOutput(null,e.shape,"complex64");return this.data.get(a.dataId).complexTensors={real:j.keep(e.clone()),imag:j.keep(n.clone())},a},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,n,a){if(de(e,"slice"),Cx(e.shape,n,a)){var o=_x(n,e.strides),s=Se(a);return nn(this.readSync(e.dataId).subarray(o,o+s),a,e.dtype)}for(var l=Le(a,e.dtype),f=this.bufferSync(e),h=0;h<l.size;++h){var p=l.indexToLoc(h).map((function(v,m){return v+n[m]}));l.values[h]=f.get.apply(f,p)}return l.toTensor()},t.prototype.stridedSlice=function(e,n,a,o){de(e,"stridedSlice");var s=Zp(n,a,o);if(s.some((function(y){return y===0})))return nn([],s);for(var l=Le(s,e.dtype),f=this.bufferSync(e),h=0;h<l.size;h++){for(var p=l.indexToLoc(h),v=new Array(p.length),m=0;m<v.length;m++)v[m]=p[m]*o[m]+n[m];l.set.apply(l,[f.get.apply(f,v)].concat(p))}return l.toTensor()},t.prototype.diag=function(e){for(var n=this.readSync(e.dataId),a=Le([e.size,e.size],e.dtype),o=a.values,s=0;s<n.length;s++)o[s*e.size+s]=n[s];return a.toTensor()},t.prototype.unstack=function(e,n){for(var a=e.shape[n],o=new Array(e.rank-1),s=0,l=0;l<e.rank;l++)l!==n&&(o[s++]=e.shape[l]);var f=new Array(e.rank).fill(0),h=e.shape.slice();h[n]=1;var p=new Array(a);for(l=0;l<p.length;l++)f[n]=l,p[l]=this.slice(e,f,h).reshape(o);return p},t.prototype.reverse=function(e,n){de(e,"reverse");for(var a=Le(e.shape,e.dtype),o=this.bufferSync(e),s=function(f){var h=a.indexToLoc(f),p=h.slice();n.forEach((function(v){return p[v]=e.shape[v]-1-p[v]})),a.set.apply(a,[o.get.apply(o,p)].concat(h))},l=0;l<a.size;l++)s(l);return a.toTensor()},t.prototype.concat=function(e,n){var a=this;if(e[0].dtype==="complex64"){var o=e.map((function(y){return or(y)})),s=e.map((function(y){return Mr(y)}));return en(this.concat(o,n),this.concat(s,n))}var l=e.map((function(y){var x=Se(y.shape.slice(n));return y.as2D(-1,x)})),f=jo(l.map((function(y){return y.shape})),1),h=Le(f,e[0].dtype).values;if(l[0].shape[0]===1){var p=0;l.forEach((function(y){h.set(a.readSync(y.dataId),p),p+=y.size}))}else{var v=0;l.forEach((function(y){for(var x=a.readSync(y.dataId),E=0,w=0;w<y.shape[0];++w)for(var C=w*f[1]+v,_=0;_<y.shape[1];++_)h[C+_]=x[E++];v+=y.shape[1]}))}var m=jo(e.map((function(y){return y.shape})),n);return nn(h,m,e[0].dtype)},t.prototype.neg=function(e){return de(e,"neg"),this.multiply(ge(-1),e)},t.prototype.add=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),(function(a,o,s,l){return{real:a+s,imag:o+l}})):this.broadcastedBinaryOp(e,n,tn(e.dtype,n.dtype),(function(a,o){return a+o}))},t.prototype.addN=function(e){var n=this;de(e,"addN");for(var a=e.map((function(p){return n.readSync(p.dataId)})),o=Le(e[0].shape,e[0].dtype),s=o.values,l=0;l<e.length;l++)for(var f=a[l],h=0;h<s.length;h++)s[h]+=f[h];return o.toTensor()},t.prototype.softmax=function(e,n){var a=Ht([n],e.shape),o=this.max(e,a),s=Dn(o.shape,a),l=this.subtract(e,o.reshape(s)),f=this.exp(l),h=this.sum(f,a).reshape(s);return this.realDivide(f,h)},t.prototype.subtract=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),(function(a,o,s,l){return{real:a-s,imag:o-l}})):this.broadcastedBinaryOp(e,n,tn(e.dtype,n.dtype),(function(a,o){return a-o}))},t.prototype.pow=function(e,n){return de([e,n],"pow"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){return Math.pow(a,o)}))},t.prototype.batchMatMul=function(e,n,a,o){de([e,n],"matMul");for(var s=a?e.shape[1]:e.shape[2],l=a?e.shape[2]:e.shape[1],f=o?n.shape[1]:n.shape[2],h=e.shape[0],p=this.readSync(e.dataId),v=this.readSync(n.dataId),m=a?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],y=m[0],x=m[1],E=m[2],w=o?[1,n.strides[1],n.strides[0]]:[n.strides[1],1,n.strides[0]],C=w[0],_=w[1],R=w[2],A=l*f,T=Le([h,l,f],e.dtype),N=T.values,M=this.blockSize,I=0;I<h;I++)for(var k=0;k<l;k+=M)for(var F=0;F<f;F+=M)for(var W=0;W<s;W+=M)for(var P=Math.min(k+M,l),oe=Math.min(F+M,f),ee=Math.min(W+M,s),ae=k;ae<P;ae++)for(var z=F;z<oe;z++){for(var G=0,K=W;K<ee;K++)G+=p[I*y+ae*x+K*E]*v[K*C+z*_+I*R];N[I*A+(ae*f+z)]+=G}return T.toTensor()},t.prototype.fusedBatchMatMul=function(e){var n=e.a,a=e.b,o=e.transposeA,s=e.transposeB,l=e.bias,f=e.activation,h=e.preluActivationWeights,p=this.batchMatMul(n,a,o,s);return l&&(p=this.add(p,l)),f&&(p=Yd(this,p,f,h)),p},t.prototype.multiply=function(e,n){return e.dtype==="complex64"||n.dtype==="complex64"?this.broadcastedBinaryComplexOp(e.cast("complex64"),n.cast("complex64"),(function(a,o,s,l){return{real:a*s-o*l,imag:a*l+o*s}})):this.broadcastedBinaryOp(e,n,tn(e.dtype,n.dtype),(function(a,o){return a*o}))},t.prototype.realDivide=function(e,n){return de([e,n],"realDivide"),this.broadcastedBinaryOp(e,n,"float32",(function(a,o){return a/o}))},t.prototype.floorDiv=function(e,n){return de([e,n],"floorDiv"),this.broadcastedBinaryOp(e,n,"int32",(function(a,o){return Math.floor(a/o)}))},t.prototype.sum=function(e,n){de(e,"sum"),Hn("sum",n,e.rank);for(var a=an(e.shape,n),o=a[0],s=a[1],l=mt(o,tn(e.dtype,"int32")),f=Se(s),h=this.readSync(l.dataId),p=this.readSync(e.dataId),v=0;v<h.length;++v){for(var m=v*f,y=0,x=0;x<f;++x)y+=p[m+x];h[v]=y}return l},t.prototype.prod=function(e,n){de(e,"sum");for(var a=an(e.shape,n),o=a[0],s=a[1],l=mt(o,tn(e.dtype,"int32")),f=Se(s),h=this.readSync(l.dataId),p=this.readSync(e.dataId),v=0;v<h.length;++v){for(var m=v*f,y=1,x=0;x<f;++x)y*=p[m+x];h[v]=y}return l},t.prototype.unsortedSegmentSum=function(e,n,a){de(e,"unsortedSegmentSum");for(var o=[],s=e.rank-n.rank,l=0;l<s;++l)n=n.expandDims(l+1);for(l=0;l<a;++l){var f=ge(l,"int32"),h=n2(f,n).asType("float32").mul(e).sum(0);o.push(h)}return qn(o)},t.prototype.argMin=function(e,n){de(e,"argMin");var a=[n];Hn("argMin",a,e.rank);for(var o=an(e.shape,a),s=o[0],l=o[1],f=mt(s,"int32"),h=Se(l),p=this.readSync(f.dataId),v=this.readSync(e.dataId),m=0;m<p.length;++m){for(var y=m*h,x=v[y],E=0,w=0;w<h;++w){var C=v[y+w];C<x&&(x=C,E=w)}p[m]=E}return f},t.prototype.argMax=function(e,n){de(e,"argMax");var a=[n];Hn("argMax",a,e.rank);for(var o=an(e.shape,a),s=o[0],l=o[1],f=mt(s,"int32"),h=Se(l),p=this.readSync(f.dataId),v=this.readSync(e.dataId),m=0;m<p.length;++m){for(var y=m*h,x=v[y],E=0,w=0;w<h;++w){var C=v[y+w];C>x&&(x=C,E=w)}p[m]=E}return f},t.prototype.cumsum=function(e,n,a,o){if(de(e,"cumsum"),n!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+n);for(var s=tn(e.dtype,"int32"),l=mt(e.shape,s),f=this.readSync(l.dataId),h=this.readSync(e.dataId),p=e.shape[e.rank-1],v=o?function(w,C){return w+p-C-1}:function(w,C){return w+C},m=0;m<h.length;m+=p)for(var y=0;y<p;y++){var x=v(m,y);if(y===0)f[x]=a?0:h[x];else{var E=v(m,y-1);f[x]=a?h[E]+f[E]:h[x]+f[E]}}return l},t.prototype.equal=function(e,n){return de([e,n],"equal"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a===o?1:0}))},t.prototype.notEqual=function(e,n){return de([e,n],"notEqual"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a!==o?1:0}))},t.prototype.less=function(e,n){return de([e,n],"less"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a<o?1:0}))},t.prototype.lessEqual=function(e,n){return de([e,n],"lessEqual"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a<=o?1:0}))},t.prototype.greater=function(e,n){return de([e,n],"greater"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a>o?1:0}))},t.prototype.greaterEqual=function(e,n){return de([e,n],"greaterEqual"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a>=o?1:0}))},t.prototype.logicalNot=function(e){de(e,"logicalNot");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),o=0;o<n.length;++o)a[o]=n[o]?0:1;return this.makeOutput(a,e.shape,"bool")},t.prototype.logicalAnd=function(e,n){return de([e,n],"logicalAnd"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a&&o}))},t.prototype.logicalOr=function(e,n){return de([e,n],"logicalOr"),this.broadcastedBinaryOp(e,n,"bool",(function(a,o){return a||o}))},t.prototype.select=function(e,n,a){de([e,n,a],"select");for(var o=this.readSync(e.dataId),s=this.readSync(n.dataId),l=this.readSync(a.dataId),f=mt(n.shape,tn(n.dtype,a.dtype)),h=this.readSync(f.dataId),p=0,v=e.rank===0||e.rank>1||n.rank===1?1:Se(n.shape.slice(1)),m=0;m<o.length;m++)for(var y=0;y<v;y++)o[m]===1?h[p++]=s[m]:h[p++]=l[m];return f},t.prototype.where=function(e){de([e],"where");var n=this.readSync(e.dataId);return tv(e.shape,n)},t.prototype.topk=function(e,n,a){return de(e,"topk"),kx(this.readSync(e.dataId),e.shape,e.dtype,n)},t.prototype.min=function(e,n){de(e,"min"),Hn("min",n,e.rank);for(var a=an(e.shape,n),o=a[0],s=a[1],l=mt(o,e.dtype),f=Se(s),h=this.readSync(l.dataId),p=this.readSync(e.dataId),v=0;v<h.length;++v){for(var m=v*f,y=p[m],x=0;x<f;++x){var E=p[m+x];E<y&&(y=E)}h[v]=y}return l},t.prototype.minimum=function(e,n){return de([e,n],"minimum"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){return Math.min(a,o)}))},t.prototype.mod=function(e,n){return de([e,n],"mod"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){var s=a%o;return a<0&&o<0||a>=0&&o>=0?s:(s+o)%o}))},t.prototype.max=function(e,n){de(e,"max"),Hn("max",n,e.rank);for(var a=an(e.shape,n),o=a[0],s=a[1],l=mt(o,e.dtype),f=Se(s),h=this.readSync(l.dataId),p=this.readSync(e.dataId),v=0;v<h.length;++v){for(var m=v*f,y=p[m],x=0;x<f;++x){var E=p[m+x];E>y&&(y=E)}h[v]=y}return l},t.prototype.maximum=function(e,n){return de([e,n],"maximum"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){return Math.max(a,o)}))},t.prototype.all=function(e,n){de(e,"all"),Hn("all",n,e.rank);for(var a=an(e.shape,n),o=a[0],s=a[1],l=mt(o,e.dtype),f=Se(s),h=this.readSync(l.dataId),p=this.readSync(e.dataId),v=0;v<h.length;++v){for(var m=v*f,y=p[m],x=0;x<f;++x){var E=p[m+x];y=y&&E}h[v]=y}return l},t.prototype.any=function(e,n){de(e,"any"),Hn("any",n,e.rank);for(var a=an(e.shape,n),o=a[0],s=a[1],l=mt(o,e.dtype),f=Se(s),h=this.readSync(l.dataId),p=this.readSync(e.dataId),v=0;v<h.length;++v){for(var m=v*f,y=p[m],x=0;x<f;++x){var E=p[m+x];y=y||E}h[v]=y}return l},t.prototype.squaredDifference=function(e,n){return de([e,n],"squaredDifference"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){var s=a-o;return s*s}))},t.prototype.ceil=function(e){de(e,"ceil");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=Math.ceil(n[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.floor=function(e){de(e,"floor");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=Math.floor(n[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.sign=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o)n[o]<0?a[o]=-1:n[o]>0?a[o]=1:a[o]=0;return this.makeOutput(a,e.shape,"float32")},t.prototype.isNaN=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),o=0;o<n.length;++o)Number.isNaN(n[o])&&(a[o]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isInf=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),o=0;o<n.length;++o)Math.abs(n[o])===1/0&&(a[o]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.isFinite=function(e){de(e,"x");for(var n=this.readSync(e.dataId),a=new Uint8Array(n.length),o=0;o<n.length;++o)Number.isFinite(n[o])&&(a[o]=1);return this.makeOutput(a,e.shape,"bool")},t.prototype.round=function(e){de(e,"round");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o){var s=Math.floor(n[o]);n[o]-s<.5?a[o]=Math.floor(n[o]):n[o]-s>.5?a[o]=Math.ceil(n[o]):a[o]=s%2==0?s:s+1}return this.makeOutput(a,e.shape,"float32")},t.prototype.exp=function(e){de(e,"exp");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=Math.exp(n[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.expm1=function(e){de(e,"expm1");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=Math.expm1(n[o]);return this.makeOutput(a,e.shape,"float32")},t.prototype.log=function(e){de(e,"log");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o){var s=n[o];a[o]=Math.log(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.log1p=function(e){de(e,"log1p");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o){var s=n[o];a[o]=Math.log1p(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.sqrt=function(e){de(e,"sqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o){var s=n[o];a[o]=Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.rsqrt=function(e){de(e,"rsqrt");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o){var s=n[o];a[o]=1/Math.sqrt(s)}return this.makeOutput(a,e.shape,"float32")},t.prototype.reciprocal=function(e){de(e,"reciprocal");for(var n=this.readSync(e.dataId),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=1/n[o];return this.makeOutput(a,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){de(e,"relu");for(var n=mt(e.shape,e.dtype),a=this.readSync(n.dataId),o=this.readSync(e.dataId),s=0;s<o.length;++s)a[s]=Math.max(0,o[s]);return n},t.prototype.relu6=function(e){de(e,"relu");for(var n=mt(e.shape,e.dtype),a=this.readSync(n.dataId),o=this.readSync(e.dataId),s=0;s<o.length;++s)a[s]=Math.min(Math.max(0,o[s]),6);return n},t.prototype.prelu=function(e,n){return de([e,n],"prelu"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){return a<0?o*a:a}))},t.prototype.elu=function(e){de(e,"elu");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o){var s=a[o];n[o]=s>=0?s:Math.exp(s)-1}return this.makeOutput(n,e.shape,"float32")},t.prototype.eluDer=function(e,n){de([e,n],"eluDer");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),s=this.readSync(e.dataId),l=0;l<o.length;++l){var f=o[l];a[l]=f>=1?s[l]:s[l]*(f+1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.selu=function(e){de(e,"selu");for(var n=rv,a=av,o=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var f=s[l];o[l]=f>=0?a*f:n*(Math.exp(f)-1)}return this.makeOutput(o,e.shape,"float32")},t.prototype.clip=function(e,n,a){de(e,"clip");for(var o=new Float32Array(e.size),s=this.readSync(e.dataId),l=0;l<s.length;++l){var f=s[l];o[l]=f>a?a:f<n?n:f}return this.makeOutput(o,e.shape,"float32")},t.prototype.abs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.abs(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<e.size;++o){var s=a[2*o],l=a[2*o+1];n[o]=Math.hypot(s,l)}return this.makeOutput(n,e.shape,"float32")},t.prototype.int=function(e){de(e,"int");for(var n=new Int32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=a[o];return this.makeOutput(n,e.shape,"int32")},t.prototype.sigmoid=function(e){de(e,"sigmoid");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=1/(1+Math.exp(-a[o]));return this.makeOutput(n,e.shape,"float32")},t.prototype.softplus=function(e){de(e,"softplus");for(var n=Math.log(11920928955078125e-23)+2,a=new Float32Array(e.size),o=this.readSync(e.dataId),s=0;s<o.length;++s){var l=o[s]>-n,f=o[s]<n,h=Math.exp(o[s]),p=void 0;p=f?h:l?o[s]:Math.log(1+h),a[s]=p}return this.makeOutput(a,e.shape,"float32")},t.prototype.sin=function(e){de(e,"sin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.sin(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cos=function(e){de(e,"cos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.cos(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tan=function(e){de(e,"tan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.tan(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asin=function(e){de(e,"asin");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.asin(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acos=function(e){de(e,"acos");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.acos(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan=function(e){de(e,"atan");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.atan(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atan2=function(e,n){return de([e,n],"atan2"),this.broadcastedBinaryOp(e,n,e.dtype,(function(a,o){return Math.atan2(a,o)}))},t.prototype.sinh=function(e){de(e,"sinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.sinh(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.cosh=function(e){de(e,"cosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.cosh(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.tanh=function(e){de(e,"tanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=tR(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.asinh=function(e){de(e,"asinh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.asinh(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.acosh=function(e){de(e,"acosh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.acosh(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.atanh=function(e){de(e,"atanh");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o)n[o]=Math.atanh(a[o]);return this.makeOutput(n,e.shape,"float32")},t.prototype.erf=function(e){de(e,"erf");for(var n=new Float32Array(e.size),a=this.readSync(e.dataId),o=0;o<a.length;++o){var s=Math.sign(a[o]),l=Math.abs(a[o]),f=1/(1+.3275911*l);n[o]=s*(1-((((1.061405429*f-1.453152027)*f+1.421413741)*f-.284496736)*f+.254829592)*f*Math.exp(-l*l))}return this.makeOutput(n,e.shape,"float32")},t.prototype.step=function(e,n){n===void 0&&(n=0),de(e,"step");for(var a=new Float32Array(e.size),o=this.readSync(e.dataId),s=0;s<o.length;++s){var l=o[s];isNaN(l)?a[s]=NaN:a[s]=l>0?1:n}return this.makeOutput(a,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var n=e.input,a=e.filter,o=e.convInfo,s=e.bias,l=e.activation,f=e.preluActivationWeights,h=this.conv2d(n,a,o);return s&&(h=this.add(h,s)),l&&(h=Yd(this,h,l,f)),h},t.prototype.conv2d=function(e,n,a){de([e,n],"conv2d");for(var o=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,f=a.dilationWidth,h=a.padInfo.left,p=a.padInfo.top,v=a.dataFormat==="channelsLast",m=Le(a.outShape,e.dtype),y=e.strides[0],x=v?e.strides[1]:e.strides[2],E=v?e.strides[2]:1,w=v?1:e.strides[1],C=m.strides[0],_=v?m.strides[1]:m.strides[2],R=v?m.strides[2]:1,A=v?1:m.strides[1],T=this.readSync(e.dataId),N=this.readSync(n.dataId),M=m.values,I=0;I<a.batchSize;++I)for(var k=I*y,F=I*C,W=0;W<a.outHeight;++W)for(var P=F+W*_,oe=W*a.strideHeight-p,ee=0;ee<o;ee++){var ae=oe+ee*l;if(!(ae<0||ae>=a.inHeight))for(var z=ee*n.strides[0],G=k+ae*x,K=0;K<a.outWidth;++K)for(var ie=P+K*R,se=K*a.strideWidth-h,L=0;L<s;L++){var q=se+L*f;if(!(q<0||q>=a.inWidth))for(var ue=G+q*E,pe=z+L*n.strides[1],me=0;me<a.inChannels;++me){for(var ye=T[ue+me*w],xe=0;xe<a.outChannels;++xe)M[ie+xe*A]+=ye*N[pe+xe];pe+=a.outChannels}}}return m.toTensor()},t.prototype.conv3d=function(e,n,a){for(var o=a.filterDepth,s=a.filterHeight,l=a.filterWidth,f=a.dilationDepth,h=a.dilationHeight,p=a.dilationWidth,v=a.padInfo.front,m=a.padInfo.left,y=a.padInfo.top,x=Le(a.outShape,e.dtype),E=this.readSync(e.dataId),w=this.readSync(n.dataId),C=x.values,_=0;_<a.batchSize;++_)for(var R=_*e.strides[0],A=_*x.strides[0],T=0;T<a.outDepth;++T)for(var N=A+T*x.strides[1],M=T*a.strideDepth-v,I=0;I<o;I++){var k=M+I*f;if(!(k<0||k>=a.inDepth))for(var F=I*n.strides[0],W=R+k*e.strides[1],P=0;P<a.outHeight;++P)for(var oe=N+P*x.strides[2],ee=P*a.strideHeight-y,ae=0;ae<s;ae++){var z=ee+ae*h;if(!(z<0||z>=a.inHeight))for(var G=F+ae*n.strides[1],K=W+z*e.strides[2],ie=0;ie<a.outWidth;++ie)for(var se=oe+ie*a.outChannels,L=ie*a.strideWidth-m,q=0;q<l;q++){var ue=L+q*p;if(!(ue<0||ue>=a.inWidth))for(var pe=G+q*n.strides[2],me=K+ue*a.inChannels,ye=pe,xe=0;xe<a.inChannels;++xe){for(var Oe=E[me+xe],De=0;De<a.outChannels;++De)C[se+De]+=Oe*w[ye+De];ye+=a.outChannels}}}}return x.toTensor()},t.prototype.conv2dDerInput=function(e,n,a){de([e,n],"conv2dDerInput");for(var o=Le(a.inShape,"float32"),s=o.values,l=this.readSync(e.dataId),f=this.readSync(n.dataId),h=n.strides,p=h[0],v=h[1],m=h[2],y=a.batchSize,x=a.filterHeight,E=a.filterWidth,w=a.inChannels,C=a.inHeight,_=a.inWidth,R=a.outChannels,A=a.outHeight,T=a.outWidth,N=a.strideHeight,M=a.strideWidth,I=a.dataFormat,k=x-1-a.padInfo.top,F=E-1-a.padInfo.left,W=I==="channelsLast",P=o.strides[0],oe=W?o.strides[1]:o.strides[2],ee=W?o.strides[2]:1,ae=W?1:o.strides[1],z=e.strides[0],G=W?e.strides[1]:e.strides[2],K=W?e.strides[2]:1,ie=W?1:e.strides[1],se=0;se<y;++se)for(var L=0;L<w;++L)for(var q=0;q<C;++q)for(var ue=q-k,pe=Math.max(0,Math.ceil(ue/N)),me=Math.min(A,(x+ue)/N),ye=0;ye<_;++ye){for(var xe=ye-F,Oe=Math.max(0,Math.ceil(xe/M)),De=Math.min(T,(E+xe)/M),lt=0,He=pe;He<me;++He)for(var Ze=He*N-ue,Ye=Oe;Ye<De;++Ye)for(var nt=z*se+G*He+K*Ye,ct=p*(x-1-Ze)+v*(E-1-(Ye*M-xe))+m*L,ft=0;ft<R;++ft)lt+=l[nt+ie*ft]*f[ct+ft];s[P*se+oe*q+ee*ye+ae*L]=lt}return o.toTensor()},t.prototype.conv3dDerInput=function(e,n,a){for(var o=Le(a.inShape,"float32"),s=o.values,l=o.strides,f=l[0],h=l[1],p=l[2],v=l[3],m=this.readSync(e.dataId),y=e.strides,x=y[0],E=y[1],w=y[2],C=y[3],_=this.readSync(n.dataId),R=n.strides,A=R[0],T=R[1],N=R[2],M=R[3],I=a.batchSize,k=a.filterDepth,F=a.filterHeight,W=a.filterWidth,P=a.inChannels,oe=a.inDepth,ee=a.inHeight,ae=a.inWidth,z=a.outChannels,G=a.outDepth,K=a.outHeight,ie=a.outWidth,se=a.strideDepth,L=a.strideHeight,q=a.strideWidth,ue=k-1-a.padInfo.front,pe=F-1-a.padInfo.top,me=W-1-a.padInfo.left,ye=0;ye<I;++ye)for(var xe=0;xe<P;++xe)for(var Oe=0;Oe<oe;++Oe)for(var De=Oe-ue,lt=Math.max(0,Math.ceil(De/se)),He=Math.min(G,(k+De)/se),Ze=0;Ze<ee;++Ze)for(var Ye=Ze-pe,nt=Math.max(0,Math.ceil(Ye/L)),ct=Math.min(K,(F+Ye)/L),ft=0;ft<ae;++ft){for(var Xn=ft-me,On=Math.max(0,Math.ceil(Xn/q)),Xt=Math.min(ie,(W+Xn)/q),wr=0,Mn=lt;Mn<He;++Mn)for(var Er=Mn*se-De,cr=nt;cr<ct;++cr)for(var Dt=cr*L-Ye,fr=On;fr<Xt;++fr)for(var Pi=x*ye+E*Mn+w*cr+C*fr,jr=A*(k-1-Er)+T*(F-1-Dt)+N*(W-1-(fr*q-Xn))+M*xe,hn=0;hn<z;++hn)wr+=m[Pi+hn]*_[jr+hn];s[f*ye+h*Oe+p*Ze+v*ft+xe]=wr}return o.toTensor()},t.prototype.conv2dDerFilter=function(e,n,a){de([e,n],"conv2dDerFilter");for(var o=a.strideHeight,s=a.strideWidth,l=a.filterHeight,f=a.filterWidth,h=a.dataFormat==="channelsLast",p=Le(a.filterShape,"float32"),v=a.padInfo.left,m=a.padInfo.top,y=this.bufferSync(e),x=this.bufferSync(n),E=0;E<l;++E)for(var w=Math.max(0,Math.ceil((m-E)/o)),C=Math.min(a.outHeight,(a.inHeight+m-E)/o),_=0;_<f;++_)for(var R=Math.max(0,Math.ceil((v-_)/s)),A=Math.min(a.outWidth,(a.inWidth+v-_)/s),T=0;T<a.inChannels;++T)for(var N=0;N<a.outChannels;++N){for(var M=0,I=0;I<a.batchSize;++I)for(var k=w;k<C;++k)for(var F=E+k*o-m,W=R;W<A;++W){var P=_+W*s-v;M+=h?y.get(I,F,P,T)*x.get(I,k,W,N):y.get(I,T,F,P)*x.get(I,N,k,W)}p.set(M,E,_,T,N)}return p.toTensor()},t.prototype.conv3dDerFilter=function(e,n,a){for(var o=a.strideDepth,s=a.strideHeight,l=a.strideWidth,f=a.filterDepth,h=a.filterHeight,p=a.filterWidth,v=Le(a.filterShape,"float32"),m=v.values,y=v.strides,x=y[0],E=y[1],w=y[2],C=y[3],_=this.readSync(n.dataId),R=n.strides,A=R[0],T=R[1],N=R[2],M=R[3],I=this.readSync(e.dataId),k=e.strides,F=k[0],W=k[1],P=k[2],oe=k[3],ee=a.padInfo.front,ae=a.padInfo.left,z=a.padInfo.top,G=0;G<f;++G)for(var K=Math.max(0,Math.ceil((ee-G)/o)),ie=Math.min(a.outDepth,(a.inDepth+ee-G)/o),se=G*x,L=0;L<h;++L)for(var q=Math.max(0,Math.ceil((z-L)/s)),ue=Math.min(a.outHeight,(a.inHeight+z-L)/s),pe=L*E+se,me=0;me<p;++me)for(var ye=Math.max(0,Math.ceil((ae-me)/l)),xe=Math.min(a.outWidth,(a.inWidth+ae-me)/l),Oe=me*w+pe,De=0;De<a.inChannels;++De)for(var lt=De*C+Oe,He=0;He<a.outChannels;++He){for(var Ze=0,Ye=0;Ye<a.batchSize;++Ye)for(var nt=Ye*F,ct=Ye*A,ft=K;ft<ie;++ft)for(var Xn=(G+ft*o-ee)*W+nt,On=ft*T+ct,Xt=q;Xt<ue;++Xt)for(var wr=(L+Xt*s-z)*P+Xn,Mn=Xt*N+On,Er=ye;Er<xe;++Er){var cr=Er*M+Mn;Ze+=I[(me+Er*l-ae)*oe+wr+De]*_[cr+He]}m[lt+He]=Ze}return v.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var n=e.input,a=e.filter,o=e.convInfo,s=e.bias,l=e.activation,f=e.preluActivationWeights,h=this.depthwiseConv2D(n,a,o);return s&&(h=this.add(h,s)),l&&(h=Yd(this,h,l,f)),h},t.prototype.depthwiseConv2D=function(e,n,a){de([e,n],"depthwiseConv2D");for(var o=a.filterHeight,s=a.filterWidth,l=a.dilationHeight,f=a.dilationWidth,h=a.padInfo.left,p=a.padInfo.top,v=a.outChannels/a.inChannels,m=Le(a.outShape,e.dtype),y=this.readSync(e.dataId),x=this.readSync(n.dataId),E=m.values,w=0;w<a.batchSize;++w)for(var C=w*e.strides[0],_=w*m.strides[0],R=0;R<a.outHeight;++R)for(var A=_+R*m.strides[1],T=R*a.strideHeight-h,N=0;N<o;++N){var M=T+N*l;if(!(M<0||M>=a.inHeight))for(var I=N*n.strides[0],k=C+M*e.strides[1],F=0;F<a.outWidth;++F)for(var W=A+F*m.strides[2],P=F*a.strideWidth-p,oe=0;oe<s;++oe){var ee=P+oe*f;if(!(ee<0||ee>=a.inWidth))for(var ae=I+oe*n.strides[1],z=k+ee*a.inChannels,G=W,K=ae,ie=0;ie<a.inChannels;++ie){for(var se=y[z+ie],L=0;L<v;++L)E[G+L]+=se*x[K+L];G+=v,K+=v}}}return m.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,n,a){de([e,n],"depthwiseConv2DDerInput");for(var o=Le(a.inShape,"float32"),s=o.values,l=o.strides,f=l[0],h=l[1],p=l[2],v=this.readSync(e.dataId),m=e.strides,y=m[0],x=m[1],E=m[2],w=this.readSync(n.dataId),C=n.strides,_=C[0],R=C[1],A=C[2],T=a.batchSize,N=a.filterHeight,M=a.filterWidth,I=a.inChannels,k=a.inHeight,F=a.inWidth,W=a.outChannels,P=a.outHeight,oe=a.outWidth,ee=a.strideHeight,ae=a.strideWidth,z=N-1-a.padInfo.top,G=M-1-a.padInfo.left,K=W/I,ie=0;ie<T;++ie)for(var se=0;se<I;++se)for(var L=0;L<k;++L)for(var q=L-z,ue=Math.max(0,Math.ceil(q/ee)),pe=Math.min(P,(N+q)/ee),me=0;me<F;++me){for(var ye=me-G,xe=Math.max(0,Math.ceil(ye/ae)),Oe=Math.min(oe,(M+ye)/ae),De=0,lt=ue;lt<pe;++lt)for(var He=lt*ee-q,Ze=xe;Ze<Oe;++Ze)for(var Ye=y*ie+x*lt+E*Ze,nt=_*(N-1-He)+R*(M-1-(Ze*ae-ye))+A*se,ct=0;ct<K;++ct)De+=v[Ye+(se*K+ct)]*w[nt+ct];s[f*ie+h*L+p*me+se]=De}return o.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,n,a){de([e,n],"depthwiseConv2DDerFilter");for(var o=a.strideHeight,s=a.strideWidth,l=a.filterHeight,f=a.filterWidth,h=Le(a.filterShape,"float32"),p=a.padInfo.left,v=a.padInfo.top,m=a.outChannels/a.inChannels,y=this.bufferSync(e),x=this.bufferSync(n),E=0;E<l;++E)for(var w=Math.max(0,Math.ceil((v-E)/o)),C=Math.min(a.outHeight,(a.inHeight+v-E)/o),_=0;_<f;++_)for(var R=Math.max(0,Math.ceil((p-_)/s)),A=Math.min(a.outWidth,(a.inWidth+p-_)/s),T=0;T<a.outChannels;++T){for(var N=Math.trunc(T/m),M=T%m,I=0,k=0;k<a.batchSize;++k)for(var F=w;F<C;++F)for(var W=E+F*o-v,P=R;P<A;++P){var oe=_+P*s-p;I+=y.get(k,W,oe,N)*x.get(k,F,P,T)}h.set(I,E,_,N,M)}return h.toTensor()},t.prototype.tile=function(e,n){return de(e,"tile"),Mx(this.bufferSync(e),n)},t.prototype.pad=function(e,n,a){de(e,"pad");var o=n.map((function(m,y){return m[0]+e.shape[y]+m[1]})),s=n.map((function(m){return m[0]})),l=this.bufferSync(e),f=Le(o,e.dtype);a!==0&&f.values.fill(a);for(var h=0;h<e.size;h++){var p=l.indexToLoc(h),v=p.map((function(m,y){return m+s[y]}));f.set.apply(f,[l.get.apply(l,p)].concat(v))}return f.toTensor()},t.prototype.transpose=function(e,n){de(e,"transpose");for(var a=new Array(e.rank),o=0;o<a.length;o++)a[o]=e.shape[n[o]];var s=this.readSync(e.dataId),l=Le(a,e.dtype),f=this.bufferSync(e);for(o=0;o<e.size;++o){for(var h=f.indexToLoc(o),p=new Array(h.length),v=0;v<p.length;v++)p[v]=h[n[v]];var m=l.locToIndex(p);l.values[m]=s[o]}return l.toTensor()},t.prototype.gather=function(e,n,a){de([e,n],"gather");var o=e.shape.slice(),s=this.readSync(n.dataId);o[a]=s.length;for(var l=Le(o,e.dtype),f=this.bufferSync(e),h=0;h<l.size;++h){var p=l.indexToLoc(h),v=p.slice();v[a]=s[p[a]];var m=f.locToIndex(v);l.values[h]=f.values[m]}return l.toTensor()},t.prototype.batchToSpaceND=function(e,n,a){de([e],"batchToSpaceND");var o=n.reduce((function(v,m){return v*m})),s=Ec(e.shape,n,o),l=Cc(s.length,n.length),f=_c(e.shape,n,o),h=bx(a,n.length),p=xx(f,a,n.length);return e.reshape(s).transpose(l).reshape(f).slice(h,p)},t.prototype.spaceToBatchND=function(e,n,a){de([e],"spaceToBatchND");var o=n.reduce((function(m,y){return m*y})),s=[[0,0]];s.push.apply(s,a);for(var l=1+n.length;l<e.shape.length;++l)s.push([0,0]);var f=e.pad(s),h=Ec(f.shape,n,o,!1),p=Cc(h.length,n.length,!1),v=_c(f.shape,n,o,!1);return f.reshape(h).transpose(p).reshape(v)},t.prototype.pool=function(e,n,a){de(e,"pool");for(var o=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=n.padInfo.top,m=n.padInfo.left,y=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=this.readSync(e.dataId),E=Le(n.outShape,e.dtype),w=E.values,C=n.outShape[1]*n.outShape[2]*n.outShape[3],_=n.outShape[2]*n.outShape[3],R=n.outShape[3],A=0;A<n.batchSize;++A)for(var T=A*C,N=A*e.strides[0],M=0;M<n.inChannels;++M)for(var I=0;I<n.outHeight;++I)for(var k=I*o-v,F=Math.max(0,k),W=Math.min(n.inHeight,h+k),P=T+I*_,oe=0;oe<n.outWidth;++oe){for(var ee=oe*s-m,ae=Math.max(0,ee),z=Math.min(n.inWidth,p+ee),G=y,K=0,ie=0,se=F;se<W;se+=l){for(var L=N+se*e.strides[1],q=ae;q<z;q+=f){var ue=x[L+q*e.strides[2]+M];a==="max"&&ue>G?G=ue:a==="avg"&&(K+=ue,ie++)}if(isNaN(G))break}w[P+oe*R+M]=a==="avg"?K/ie:G}return E.toTensor()},t.prototype.maxPool=function(e,n){return this.pool(e,n,"max")},t.prototype.maxPoolPositions=function(e,n){for(var a=Le(n.outShape,"int32"),o=n.strideHeight,s=n.strideWidth,l=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=n.padInfo.top,m=n.padInfo.left,y=this.bufferSync(e),x=0;x<n.batchSize;++x)for(var E=0;E<n.inChannels;++E)for(var w=0;w<n.outHeight;++w){for(var C=w*o-v,_=C;_<0;)_+=l;for(var R=Math.min(n.inHeight,h+C),A=0;A<n.outWidth;++A){for(var T=A*s-m,N=T;N<0;)N+=f;for(var M=Math.min(n.inWidth,p+T),I=Number.NEGATIVE_INFINITY,k=-1,F=_;F<R;F+=l)for(var W=F-C,P=N;P<M;P+=f){var oe=P-T,ee=y.get(x,F,P,E);ee>I&&(I=ee,k=W*p+oe)}a.set(k,x,w,A,E)}}return a.toTensor()},t.prototype.maxPoolBackprop=function(e,n,a,o){de([n,a],"maxPoolBackprop");for(var s=this.maxPoolPositions(n,o),l=o.strideHeight,f=o.strideWidth,h=o.dilationHeight,p=o.dilationWidth,v=o.effectiveFilterHeight,m=o.effectiveFilterWidth,y=m-1-o.padInfo.left,x=v-1-o.padInfo.top,E=Le(n.shape,"float32"),w=this.bufferSync(s),C=this.bufferSync(e),_=0;_<o.batchSize;++_)for(var R=0;R<o.inChannels;++R)for(var A=0;A<o.inHeight;++A)for(var T=0;T<o.inWidth;++T){for(var N=A-x,M=T-y,I=0,k=0;k<v;k+=h){var F=(N+k)/l;if(!(F<0||F>=o.outHeight||Math.floor(F)!==F))for(var W=0;W<m;W+=p){var P=(M+W)/f;if(!(P<0||P>=o.outWidth||Math.floor(P)!==P)){var oe=v*m-1-w.get(_,F,P,R)===k*m+W?1:0;oe!==0&&(I+=C.get(_,F,P,R)*oe)}}}E.set(I,_,A,T,R)}return E.toTensor()},t.prototype.avgPoolBackprop=function(e,n,a){de([e,n],"avgPoolBackprop");for(var o=a.strideHeight,s=a.strideWidth,l=a.filterHeight,f=a.filterWidth,h=a.dilationHeight,p=a.dilationWidth,v=a.effectiveFilterHeight,m=a.effectiveFilterWidth,y=m-1-a.padInfo.left,x=v-1-a.padInfo.top,E=Le(n.shape,"float32"),w=1/(l*f),C=this.bufferSync(e),_=0;_<a.batchSize;++_)for(var R=0;R<a.inChannels;++R)for(var A=0;A<a.inHeight;++A)for(var T=0;T<a.inWidth;++T){for(var N=A-x,M=T-y,I=0,k=0;k<v;k+=h){var F=(N+k)/o;if(!(F<0||F>=a.outHeight||Math.floor(F)!==F))for(var W=0;W<m;W+=p){var P=(M+W)/s;P<0||P>=a.outWidth||Math.floor(P)!==P||(I+=C.get(_,F,P,R))}}E.set(I*w,_,A,T,R)}return E.toTensor()},t.prototype.pool3d=function(e,n,a){de(e,"pool3d");for(var o=n.strideDepth,s=n.strideHeight,l=n.strideWidth,f=n.dilationDepth,h=n.dilationHeight,p=n.dilationWidth,v=n.effectiveFilterDepth,m=n.effectiveFilterHeight,y=n.effectiveFilterWidth,x=n.padInfo.front,E=n.padInfo.top,w=n.padInfo.left,C=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=this.readSync(e.dataId),R=Le(n.outShape,e.dtype),A=R.values,T=n.outShape[1]*n.outShape[2]*n.outShape[3]*n.outShape[4],N=n.outShape[2]*n.outShape[3]*n.outShape[4],M=n.outShape[3]*n.outShape[4],I=n.outShape[4],k=0;k<n.batchSize;++k)for(var F=k*T,W=k*e.strides[0],P=0;P<n.inChannels;++P)for(var oe=0;oe<n.outDepth;++oe){for(var ee=oe*o-x,ae=ee;ae<0;)ae+=f;for(var z=Math.min(n.inDepth,v+ee),G=F+oe*N,K=0;K<n.outHeight;++K){for(var ie=K*s-E,se=ie;se<0;)se+=h;for(var L=Math.min(n.inHeight,m+ie),q=G+K*M,ue=0;ue<n.outWidth;++ue){for(var pe=ue*l-w,me=pe;me<0;)me+=p;for(var ye=Math.min(n.inWidth,y+pe),xe=q+ue*I,Oe=C,De=0,lt=0,He=ae;He<z;He+=f){for(var Ze=W+He*e.strides[1],Ye=se;Ye<L;Ye+=h){for(var nt=Ze+Ye*e.strides[2],ct=me;ct<ye;ct+=p){var ft=_[nt+ct*e.strides[3]+P];if(a==="max"&&ft>Oe?Oe=ft:a==="avg"&&(De+=ft,lt++),isNaN(Oe))break}if(isNaN(Oe))break}if(isNaN(Oe))break}A[xe+P]=a==="avg"?De/lt:Oe}}}return R.toTensor()},t.prototype.avgPool3d=function(e,n){return de(e,"avgPool3d"),this.pool3d(e,n,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,n,a){de([e,n],"avgPool3dBackprop");for(var o=a.strideDepth,s=a.strideHeight,l=a.strideWidth,f=a.filterDepth,h=a.filterHeight,p=a.filterWidth,v=a.dilationDepth,m=a.dilationHeight,y=a.dilationWidth,x=a.effectiveFilterDepth,E=a.effectiveFilterHeight,w=a.effectiveFilterWidth,C=x-1-a.padInfo.front,_=w-1-a.padInfo.left,R=E-1-a.padInfo.top,A=Le(n.shape,"float32"),T=1/(f*h*p),N=this.bufferSync(e),M=0;M<a.batchSize;++M)for(var I=0;I<a.inChannels;++I)for(var k=0;k<a.inDepth;++k)for(var F=0;F<a.inHeight;++F)for(var W=0;W<a.inWidth;++W){for(var P=k-C,oe=F-R,ee=W-_,ae=0,z=0;z<x;z+=v){var G=(P+z)/o;if(!(G<0||G>=a.outDepth||Math.floor(G)!==G))for(var K=0;K<E;K+=m){var ie=(oe+K)/s;if(!(ie<0||ie>=a.outHeight||Math.floor(ie)!==ie))for(var se=0;se<w;se+=y){var L=(ee+se)/l;L<0||L>=a.outWidth||Math.floor(L)!==L||(ae+=N.get(M,G,ie,L,I))}}}A.set(ae*T,M,k,F,W,I)}return A.toTensor()},t.prototype.maxPool3d=function(e,n){return de(e,"maxPool3d"),this.pool3d(e,n,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,n){for(var a=Le(n.outShape,"int32"),o=n.strideDepth,s=n.strideHeight,l=n.strideWidth,f=n.dilationDepth,h=n.dilationHeight,p=n.dilationWidth,v=n.effectiveFilterDepth,m=n.effectiveFilterHeight,y=n.effectiveFilterWidth,x=n.padInfo.front,E=n.padInfo.top,w=n.padInfo.left,C=this.bufferSync(e),_=0;_<n.batchSize;++_)for(var R=0;R<n.inChannels;++R)for(var A=0;A<n.outDepth;++A){for(var T=A*o-x,N=T;N<0;)N+=f;for(var M=Math.min(n.inDepth,v+T),I=0;I<n.outHeight;++I){for(var k=I*s-E,F=k;F<0;)F+=h;for(var W=Math.min(n.inHeight,m+k),P=0;P<n.outWidth;++P){for(var oe=P*l-w,ee=oe;ee<0;)ee+=p;for(var ae=Math.min(n.inWidth,y+oe),z=Number.NEGATIVE_INFINITY,G=-1,K=N;K<M;K+=f)for(var ie=K-T,se=F;se<W;se+=h)for(var L=se-k,q=ee;q<ae;q+=p){var ue=q-oe,pe=C.get(_,K,se,q,R);pe>=z&&(z=pe,G=ie*m*y+L*m+ue)}a.set(G,_,A,I,P,R)}}}return a.toTensor()},t.prototype.maxPool3dBackprop=function(e,n,a,o){de([n,a],"maxPool3dBackprop");for(var s=this.maxPool3dPositions(n,o),l=o.strideDepth,f=o.strideHeight,h=o.strideWidth,p=o.dilationDepth,v=o.dilationHeight,m=o.dilationWidth,y=o.effectiveFilterDepth,x=o.effectiveFilterHeight,E=o.effectiveFilterWidth,w=y-1-o.padInfo.front,C=E-1-o.padInfo.left,_=x-1-o.padInfo.top,R=Le(n.shape,"float32"),A=this.bufferSync(s),T=this.bufferSync(e),N=0;N<o.batchSize;++N)for(var M=0;M<o.inChannels;++M)for(var I=0;I<o.inDepth;++I)for(var k=0;k<o.inHeight;++k)for(var F=0;F<o.inWidth;++F){for(var W=I-w,P=k-_,oe=F-C,ee=0,ae=0;ae<y;ae+=p){var z=(W+ae)/l;if(!(z<0||z>=o.outDepth||Math.floor(z)!==z))for(var G=0;G<x;G+=v){var K=(P+G)/f;if(!(K<0||K>=o.outHeight||Math.floor(K)!==K))for(var ie=0;ie<E;ie+=m){var se=(oe+ie)/h;if(!(se<0||se>=o.outWidth||Math.floor(se)!==se)){var L=y*x*E-1-A.get(N,z,K,se,M)===ae*x*E+G*E+ie?1:0;L!==0&&(ee+=T.get(N,z,K,se,M)*L)}}}}R.set(ee,N,I,k,F,M)}return R.toTensor()},t.prototype.cast=function(e,n){return Tx(e,n,this)},t.prototype.reshape=function(e,n){return Cp(e,n)},t.prototype.avgPool=function(e,n){return de(e,"avgPool"),this.pool(e,n,"avg").toFloat()},t.prototype.resizeBilinear=function(e,n,a,o){de(e,"resizeBilinear");for(var s=e.shape,l=s[0],f=s[1],h=s[2],p=s[3],v=this.readSync(e.dataId),m=new Float32Array(Se([l,n,a,p])),y=[o&&n>1?f-1:f,o&&a>1?h-1:h],x=[o&&n>1?n-1:n,o&&a>1?a-1:a],E=0,w=y[0]/x[0],C=y[1]/x[1],_=0;_<l;_++)for(var R=0;R<n;R++)for(var A=w*R,T=Math.floor(A),N=A-T,M=Math.min(f-1,Math.ceil(A)),I=_*e.strides[0]+T*e.strides[1],k=_*e.strides[0]+M*e.strides[1],F=0;F<a;F++)for(var W=C*F,P=Math.floor(W),oe=W-P,ee=Math.min(h-1,Math.ceil(W)),ae=I+P*e.strides[2],z=k+P*e.strides[2],G=I+ee*e.strides[2],K=k+ee*e.strides[2],ie=0;ie<p;ie++){var se=v[ae+ie],L=v[z+ie],q=se+(v[G+ie]-se)*oe,ue=q+(L+(v[K+ie]-L)*oe-q)*N;m[E++]=ue}return nn(m,[l,n,a,p])},t.prototype.resizeBilinearBackprop=function(e,n,a){de([e,n],"resizeBilinearBackprop");for(var o=n.shape,s=o[0],l=o[1],f=o[2],h=o[3],p=e.shape,v=p[1],m=p[2],y=new Float32Array(s*l*f*h),x=[a&&v>1?l-1:l,a&&m>1?f-1:f],E=[a&&v>1?v-1:v,a&&m>1?m-1:m],w=x[0]/E[0],C=x[1]/E[1],_=this.readSync(e.dataId),R=0,A=0;A<s;A++)for(var T=A*n.strides[0],N=0;N<v;N++)for(var M=N*w,I=Math.floor(M),k=Math.min(Math.ceil(M),l-1),F=T+I*n.strides[1],W=T+k*n.strides[1],P=M-I,oe=1-P,ee=0;ee<m;ee++)for(var ae=ee*C,z=Math.floor(ae),G=Math.min(Math.ceil(ae),f-1),K=ae-z,ie=1-K,se=F+z*n.strides[2],L=F+G*n.strides[2],q=W+z*n.strides[2],ue=W+G*n.strides[2],pe=oe*ie,me=oe*K,ye=P*ie,xe=P*K,Oe=0;Oe<h;Oe++){var De=_[R++];y[se+Oe]+=De*pe,y[L+Oe]+=De*me,y[q+Oe]+=De*ye,y[ue+Oe]+=De*xe}return _n(y,[s,f,l,h],n.dtype)},t.prototype.resizeNearestNeighbor=function(e,n,a,o){de(e,"resizeNearestNeighbor");for(var s=e.shape,l=s[0],f=s[1],h=s[2],p=s[3],v=this.readSync(e.dataId),m=new Float32Array(l*n*a*p),y=[o&&n>1?f-1:f,o&&a>1?h-1:h],x=[o&&n>1?n-1:n,o&&a>1?a-1:a],E=y[0]/x[0],w=y[1]/x[1],C=0,_=0;_<l;_++)for(var R=_*e.strides[0],A=0;A<n;A++)for(var T=E*A,N=R+Math.min(f-1,o?Math.round(T):Math.floor(T))*e.strides[1],M=0;M<a;M++)for(var I=w*M,k=N+Math.min(h-1,o?Math.round(I):Math.floor(I))*e.strides[2],F=0;F<p;F++){var W=v[k+F];m[C++]=W}return nn(m,[l,n,a,p],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,n,a){de([e,n],"resizeNearestNeighborBackprop");for(var o=n.shape,s=o[0],l=o[1],f=o[2],h=o[3],p=e.shape,v=p[1],m=p[2],y=new Float32Array(s*l*f*h),x=this.readSync(e.dataId),E=[a&&v>1?l-1:l,a&&m>1?f-1:f],w=[a&&v>1?v-1:v,a&&m>1?m-1:m],C=E[0]/w[0],_=E[1]/w[1],R=1/C,A=1/_,T=2*Math.ceil(R)+2,N=2*Math.ceil(A)+2,M=0;M<s;M++)for(var I=M*n.strides[0],k=0;k<l;k++)for(var F=I+k*n.strides[1],W=Math.floor(k*R),P=Math.floor(W-T/2),oe=0;oe<f;oe++)for(var ee=F+oe*n.strides[2],ae=Math.floor(oe*A),z=Math.floor(ae-N/2),G=0;G<h;G++){for(var K=0,ie=0;ie<T;ie++){var se=ie+P;if(!(se<0||se>=v)){var L=I+se*e.strides[1],q=se*C;if(k===Math.min(l-1,a?Math.round(q):Math.floor(q)))for(var ue=0;ue<N;ue++){var pe=ue+z;if(!(pe<0||pe>=m)){var me=L+pe*e.strides[2],ye=pe*_;oe===Math.min(f-1,a?Math.round(ye):Math.floor(ye))&&(K+=x[me+G])}}}}y[ee+G]=K}return _n(y,n.shape,n.dtype)},t.prototype.batchNormalization=function(e,n,a,o,s,l){de([e,n,a,s,l],"batchNorm");for(var f=this.readSync(e.dataId),h=this.readSync(n.dataId),p=this.readSync(a.dataId),v=s?this.readSync(s.dataId):new Float32Array([1]),m=l?this.readSync(l.dataId):new Float32Array([0]),y=new Float32Array(f.length),x=m.length,E=v.length,w=p.length,C=h.length,_=0,R=0,A=0,T=0,N=0;N<f.length;++N)y[N]=m[_++]+(f[N]-h[R++])*v[A++]/Math.sqrt(p[T++]+o),_>=x&&(_=0),R>=C&&(R=0),A>=E&&(A=0),T>=w&&(T=0);return _n(y,e.shape)},t.prototype.localResponseNormalization4D=function(e,n,a,o,s){de(e,"localResponseNormalization4D");var l=e.shape[3],f=l-1,h=this.readSync(e.dataId),p=e.size,v=new Float32Array(p);function m(w){for(var C=w%l,_=w-C+Math.max(0,C-n),R=w-C+Math.min(C+n,f),A=0;_<=R;_++){var T=h[_];A+=T*T}return A}for(var y=0;y<p;y++){var x=m(y),E=h[y]*Math.pow(a+o*x,-s);v[y]=E}return _n(v,e.shape)},t.prototype.LRNGrad=function(e,n,a,o,s,l,f){de(e,"LRNGrad");for(var h=e.shape[3],p=this.readSync(e.dataId),v=this.readSync(n.dataId),m=this.readSync(a.dataId),y=new Float32Array(e.size),x=e.size,E=0;E<x;E++){for(var w=E%h,C=E-w+Math.max(0,w-o),_=E-w+Math.min(h,w+o+1),R=0,A=C;A<_;A++)R+=Math.pow(v[A],2);for(R=l*R+s,A=C;A<_;A++){var T=-2*l*f*v[A]*m[E]/R;E===A&&(T+=Math.pow(R,-f)),T*=p[E],y[A]+=T}}return _n(y,e.shape)},t.prototype.multinomial=function(e,n,a,o){de(e,"multinomial");for(var s=n?e:ga(e),l=s.shape[0],f=s.shape[1],h=mt([l,a],"int32"),p=this.readSync(h.dataId),v=this.readSync(s.dataId),m=0;m<l;++m){var y=m*f,x=new Float32Array(f-1);x[0]=v[y];for(var E=1;E<x.length;++E)x[E]=x[E-1]+v[y+E];for(var w=Hc(o.toString()),C=m*a,_=0;_<a;++_){var R=w();p[C+_]=x.length;for(var A=0;A<x.length;A++)if(R<x[A]){p[C+_]=A;break}}}return h},t.prototype.oneHot=function(e,n,a,o){de(e,"oneHot");var s=new Float32Array(e.size*n);s.fill(o);for(var l=this.readSync(e.dataId),f=0;f<e.size;++f)l[f]>=0&&l[f]<n&&(s[f*n+l[f]]=a);return Qa(s,[e.size,n],"int32")},t.prototype.nonMaxSuppression=function(e,n,a,o,s){return de(e,"nonMaxSuppression"),$p(this.readSync(e.dataId),this.readSync(n.dataId),a,o,s)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,n){for(var a=e.shape[0],o=e.shape[1],s=Le(e.shape,"float32"),l=Le(e.shape,"float32"),f=or(e).as2D(a,o),h=Mr(e).as2D(a,o),p=0;p<a;p++)for(var v=f.slice([p,0],[1,o]),m=h.slice([p,0],[1,o]),y=en(v,m),x=this.readSync(this.fftImpl(y,n).dataId),E=0;E<o;E++){var w=Cb(x,E);s.values[p*o+E]=w.real,l.values[p*o+E]=w.imag}return en(s.toTensor(),l.toTensor()).as2D(a,o)},t.prototype.fftImpl=function(e,n){var a=e.as1D(),o=a.size;if(this.isExponentOf2(o)){var s=this.fftRadix2(a,o,n).as2D(e.shape[0],e.shape[1]);return n&&(s=en(or(s).div(ge(o)),Mr(s).div(ge(o)))),s}var l=this.readSync(e.dataId),f=(function(h){for(var p=new Float32Array(h.length/2),v=new Float32Array(h.length/2),m=0;m<h.length;m+=2)p[m/2]=h[m],v[m/2]=h[m+1];return{real:p,imag:v}})(this.fourierTransformByMatmul(l,o,n));return en(f.real,f.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return(e&e-1)==0},t.prototype.fftRadix2=function(e,n,a){if(n===1)return e;var o=this.readSync(e.dataId),s=n/2,l=(function(C){for(var _=Math.ceil(C.length/4),R=new Float32Array(_),A=new Float32Array(_),T=0;T<C.length;T+=4)R[Math.floor(T/4)]=C[T],A[Math.floor(T/4)]=C[T+1];return{real:R,imag:A}})(o),f=en(l.real,l.imag).as1D(),h=(function(C){for(var _=Math.floor(C.length/4),R=new Float32Array(_),A=new Float32Array(_),T=2;T<C.length;T+=4)R[Math.floor(T/4)]=C[T],A[Math.floor(T/4)]=C[T+1];return{real:R,imag:A}})(o),p=en(h.real,h.imag).as1D();f=this.fftRadix2(f,s,a),p=this.fftRadix2(p,s,a);var v=(function(C,_){for(var R=new Float32Array(C/2),A=new Float32Array(C/2),T=0;T<Math.ceil(C/2);T++){var N=(_?2:-2)*Math.PI*(T/C);R[T]=Math.cos(N),A[T]=Math.sin(N)}return{real:R,imag:A}})(n,a),m=en(v.real,v.imag).mul(p),y=f.add(m),x=f.sub(m),E=or(y).concat(or(x)),w=Mr(y).concat(Mr(x));return en(E,w).as1D()},t.prototype.fourierTransformByMatmul=function(e,n,a){for(var o=new Float32Array(2*n),s=0;s<n;s++){for(var l=0,f=0,h=0;h<n;h++){var p=IA(s*h,n,a),v=Cb(e,h);l+=v.real*p.real-v.imag*p.imag,f+=v.real*p.imag+v.imag*p.real}a&&(l/=n,f/=n),kA(o,l,f,s)}return o},t.prototype.depthToSpace=function(e,n,a){B(a==="NHWC",(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+a})),B(n>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+n}));for(var o=e.shape[0],s=e.shape[1],l=e.shape[2],f=e.shape[3],h=s*n,p=l*n,v=f/(n*n),m=this.readSync(e.dataId),y=new Float32Array(o*h*p*v),x=0,E=0;E<o;++E)for(var w=0;w<h;++w)for(var C=Math.floor(w/n),_=w%n,R=0;R<p;++R)for(var A=Math.floor(R/n),T=(_*n+R%n)*v,N=0;N<v;++N){var M=N+T+f*(A+l*(C+s*E));y[x++]=m[M]}return _n(y,[o,h,p,v])},t.prototype.broadcastedBinaryOp=function(e,n,a,o){var s=Ge(e.shape,n.shape),l=Le(s,a),f=this.readSync(e.dataId),h=this.readSync(n.dataId),p=Ka(e.shape,s),v=Ka(n.shape,s),m=l.values;if(p.length+v.length===0)for(var y=0;y<m.length;++y)m[y]=o(f[y%f.length],h[y%h.length]);else{var x=this.bufferSync(e),E=this.bufferSync(n),w=function(C){var _=l.indexToLoc(C),R=_.slice(-e.rank);p.forEach((function(M){return R[M]=0}));var A=x.locToIndex(R),T=_.slice(-n.rank);v.forEach((function(M){return T[M]=0}));var N=E.locToIndex(T);m[C]=o(f[A],h[N])};for(y=0;y<m.length;++y)w(y)}return l.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,n,a){var o=Ge(e.shape,n.shape),s=Le(o,"float32"),l=Le(o,"float32"),f=this.readSync(e.dataId),h=this.readSync(n.dataId),p=Ka(e.shape,o),v=Ka(n.shape,o),m=s.values,y=l.values;if(p.length+v.length===0)for(var x=0;x<m.length;x++){var E=x%f.length,w=x%h.length,C=a(f[2*E],f[2*E+1],h[2*w],h[2*w+1]);m[x]=C.real,y[x]=C.imag}else{var _=this.bufferSync(this.data.get(e.dataId).complexTensors.real),R=this.bufferSync(this.data.get(n.dataId).complexTensors.real),A=function(T){var N=s.indexToLoc(T),M=N.slice(-e.rank);p.forEach((function(P){return M[P]=0}));var I=_.locToIndex(M),k=N.slice(-n.rank);v.forEach((function(P){return k[P]=0}));var F=R.locToIndex(k),W=a(f[2*I],f[2*I+1],h[2*F],h[2*F+1]);m[T]=W.real,y[T]=W.imag};for(x=0;x<m.length;x++)A(x)}return this.complex(s.toTensor(),l.toTensor())},t.prototype.split=function(e,n,a){return Ox(e,n,a)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,n,a,o,s,l){for(var f=e.shape,h=f[0],p=f[1],v=f[2],m=f[3],y=n.shape[0],x=o[0],E=o[1],w=Le([y,x,E,m],"float32"),C=this.readSync(n.dataId),_=this.readSync(a.dataId),R=this.readSync(e.dataId),A=e.strides,T=w.strides,N=0;N<y;N++){var M=4*N,I=C[M],k=C[M+1],F=C[M+2],W=C[M+3],P=_[N];if(!(P>=h))for(var oe=x>1?(F-I)*(p-1)/(x-1):0,ee=E>1?(W-k)*(v-1)/(E-1):0,ae=0;ae<x;ae++){var z=x>1?I*(p-1)+ae*oe:.5*(I+F)*(p-1);if(z<0||z>p-1)for(var G=0;G<E;G++)for(var K=0;K<m;K++){var ie=K+G*T[2]+ae*T[1]+N*T[0];w.values[ie]=l}else if(s==="bilinear"){var se=Math.floor(z),L=Math.ceil(z),q=z-se;for(G=0;G<E;G++)if((He=E>1?k*(v-1)+G*ee:.5*(k+W)*(v-1))<0||He>v-1)for(K=0;K<m;K++)ie=K+G*T[2]+ae*T[1]+N*T[0],w.values[ie]=l;else{var ue=Math.floor(He),pe=Math.ceil(He),me=He-ue;for(K=0;K<m;K++){var ye=R[ie=K+ue*A[2]+se*A[1]+P*A[0]],xe=R[ie=K+pe*A[2]+se*A[1]+P*A[0]],Oe=R[ie=K+ue*A[2]+L*A[1]+P*A[0]],De=ye+(xe-ye)*me,lt=Oe+(R[ie=K+pe*A[2]+L*A[1]+P*A[0]]-Oe)*me;ie=K+G*T[2]+ae*T[1]+N*T[0],w.values[ie]=De+(lt-De)*q}}}else for(G=0;G<E;++G){var He;if((He=E>1?k*(v-1)+G*ee:.5*(k+W)*(v-1))<0||He>v-1)for(K=0;K<m;K++)ie=K+G*T[2]+ae*T[1]+N*T[0],w.values[ie]=l;else{var Ze=Math.round(He),Ye=Math.round(z);for(K=0;K<m;K++){var nt=K+Ze*A[2]+Ye*A[1]+P*A[0],ct=K+G*T[2]+ae*T[1]+N*T[0];w.values[ct]=R[nt]}}}}}return w.toTensor()},t.prototype.sparseToDense=function(e,n,a,o){var s=Sc(0,e,a),l=s.sliceRank,f=s.numUpdates,h=s.sliceSize,p=s.strides,v=s.outputSize;return this.scatter(e,n,a,v,h,f,l,p,o,!1)},t.prototype.gatherND=function(e,n){var a=n.shape,o=a[a.length-1],s=wx(e,n),l=s[0],f=s[1],h=s[2],p=s[3];if(f===0)return nn([],l,e.dtype);for(var v=new rs([f,h],e.dtype),m=this.readSync(n.dataId),y=this.readSync(e.dataId),x=0;x<f;x++){for(var E=[],w=0,C=0;C<o;C++){var _=m[x*o+C];w+=_*p[C],E.push(_)}if(w<0||w>=e.size/h)throw new Error("Invalid indices: "+E+" does not index into "+e.shape);for(var R=0;R<h;R++)v.values[x*h+R]=y[w*h+R]}return v.toTensor().reshape(l)},t.prototype.scatterND=function(e,n,a){var o=Sc(0,e,a),s=o.sliceRank,l=o.numUpdates,f=o.sliceSize,h=o.strides,p=o.outputSize,v=ge(0);return this.scatter(e,n,a,p,f,l,s,h,v,!0)},t.prototype.fill=function(e,n,a){var o=vc(a=a||hs(n),Se(e));return o.fill(n),j.makeTensor(o,e,a,this)},t.prototype.onesLike=function(e){if(e.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var n=vc(e.dtype,Se(e.shape));return this.makeOutput(n,e.shape,e.dtype)},t.prototype.linspace=function(e,n,a){return Dx(e,n,a)},t.prototype.scatter=function(e,n,a,o,s,l,f,h,p,v){var m=[o/s,s],y=this.readSync(e.dataId),x=this.readSync(n.dataId);if(o===0)return nn([],a,n.dtype);var E=new rs(m,n.dtype);E.values.fill(this.readSync(p.dataId)[0]);for(var w=0;w<l;w++){for(var C=[],_=0,R=0;R<f;R++){var A=y[w*f+R];C.push(A),_+=A*h[R]}if(_<0||_>=o/s)throw new Error("Invalid indices: "+C+" does not index into "+a);for(var T=0;T<s;T++)v?E.values[_*s+T]+=x[w*s+T]:E.values[_*s+T]=n.rank===0?x[0]:x[w*s+T]}return E.toTensor().reshape(a)},t})(Rx);j.registerBackend("cpu",(function(){return new e4}),1);for(var Qd=0,Gb=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t,o=a.boxes,s=a.scores,l=n,f=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,v=l.softNmsSigma,m=e;de(o,"NonMaxSuppressionWithScore");var y=ev(m.data.get(o.dataId).values,m.data.get(s.dataId).values,f,h,p,v);return[y.selectedIndices,y.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e;de(n,"square");for(var o=a.data.get(n.dataId).values,s=new Float32Array(o.length),l=0;l<o.length;++l){var f=o[l];s[l]=f*f}return{dataId:a.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},{kernelName:os,backendName:"cpu",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,o=n.b,s=e;de([a,o],os);var l=s.data.get(a.dataId).values,f=s.data.get(o.dataId).values,h=(function(m,y,x,E,w,C){var _=Ge(m,y),R=_.length,A=Br(_),T=ns(w,Se(_)),N=m.length,M=y.length,I=Br(m),k=Br(y),F=Ka(m,_),W=Ka(y,_);if(F.length+W.length===0)for(var P=0;P<T.length;++P)T[P]=C(x[P%x.length],E[P%E.length]);else{var oe=function(ee){var ae=cR(ee,R,A),z=ae.slice(-N);F.forEach((function(se){return z[se]=0}));var G=pb(z,N,I),K=ae.slice(-M);W.forEach((function(se){return K[se]=0}));var ie=pb(K,M,k);T[ee]=C(x[G],E[ie])};for(P=0;P<T.length;++P)oe(P)}return[T,_]})(a.shape,o.shape,l,f,a.dtype,(function(m,y){var x=m-y;return x*x})),p=h[0],v=h[1];return{dataId:s.write(p,v,a.dtype),shape:v,dtype:a.dtype}}}];Qd<Gb.length;Qd++)ex(Gb[Qd]);var Ao,t4=function(r){this.variableNames=["A"];var t=un(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+n+".0, "+e+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},n4=function(r){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=un(),e=r[0],n=r[1];this.outputShape=r,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+n+".0, "+e+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Zd=0,qb=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs,a=t.pixels,o=n.numChannels,s=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,f=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],h=f[0],p=f[1],v=[p,h],m=[p,h,o];(l||s)&&(Ao==null&&(Ao=document.createElement("canvas").getContext("2d")),Ao.canvas.width=h,Ao.canvas.height=p,Ao.drawImage(a,0,0,h,p),a=Ao.canvas);var y=e.makeTensorInfo(v,"int32");e.texData.get(y.dataId).usage=Wn.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(y.dataId),a);var x=ce().getBool("WEBGL_PACK")?new n4(m):new t4(m),E=e.runWebGLProgram(x,[y],"int32");return e.disposeData(y.dataId),E}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=r.attrs;bc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,o=a.boxes,s=a.scores,l=n,f=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,v=l.softNmsSigma,m=e,y=ev(m.readSync(o.dataId),m.readSync(s.dataId),f,h,p,v);return[y.selectedIndices,y.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t.x,a=e,o=new Pe(n.shape,"return x * x;");return a.runWebGLProgram(o,[n],n.dtype)}},{kernelName:os,backendName:"webgl",kernelFunc:function(r){var t=r.inputs,e=r.backend,n=t,a=n.a,o=n.b,s=e,l=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fa("return (a - b) * (a - b);",a.shape,o.shape):new _t("return (a - b) * (a - b);",a.shape,o.shape);return s.compileAndRun(l,[a,o])}}];Zd<qb.length;Zd++)ex(qb[Zd]);for(var Jd=0,Xb=[{kernelName:"Square",gradFunc:function(r,t){var e=t[0];return{x:function(){return r.mul(e.toFloat().mul(2))}}}},{kernelName:os,gradFunc:function(r,t){var e=t[0],n=t[1],a=ge(2);return{a:function(){return cn(r,cn(a,Pt(e,n)))},b:function(){return cn(r,cn(a,Pt(n,e)))}}}}];Jd<Xb.length;Jd++)$S(Xb[Jd]);var r4=(function(){function r(){}return r.prototype.fetch=function(t,e){return fetch(t,e)},r.prototype.now=function(){return performance.now()},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+e);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},r})();ce().get("IS_BROWSER")&&ce().setPlatform("browser",new r4);var $d,a4=function(){return require("node-fetch")},i4=(function(){function r(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return r.prototype.fetch=function(t,e){return ce().global.fetch!=null?ce().global.fetch(t,e):($d==null&&($d=a4()),$d(t,e))},r.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},r.prototype.encode=function(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},r.prototype.decode=function(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)},r})();ce().get("IS_NODE")&&ce().setPlatform("node",new i4);var Rp={float32:4,int32:4,uint16:2,uint8:1,bool:1},Mc=4;function C2(r,t){for(var e={},n=0,a=function(l){var f=l.name,h=l.dtype,p=l.shape,v=Se(p),m=void 0;if("quantization"in l){var y=l.quantization;if(y.dtype!=="uint8"&&y.dtype!=="uint16")throw new Error("Weight "+l.name+" has unknown quantization dtype "+y.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var x=Rp[y.dtype],E=r.slice(n,n+v*x),w=y.dtype==="uint8"?new Uint8Array(E):new Uint16Array(E);if(h==="float32")m=Float32Array.from(w,(function(N){return N*y.scale+y.min}));else{if(h!=="int32")throw new Error("Unsupported dtype in weight '"+f+"': "+h);m=Int32Array.from(w,(function(N){return Math.round(N*y.scale+y.min)}))}n+=v*x}else if(h==="string"){var C=Se(l.shape);m=[];for(var _=0;_<C;_++){var R=new Uint32Array(r.slice(n,n+Mc))[0];n+=Mc;var A=new Uint8Array(r.slice(n,n+R));m.push(A),n+=R}}else{var T=Rp[h];if(E=r.slice(n,n+v*T),h==="float32")m=new Float32Array(E);else if(h==="int32")m=new Int32Array(E);else{if(h!=="bool")throw new Error("Unsupported dtype in weight '"+f+"': "+h);m=new Uint8Array(E)}n+=v*T}e[f]=nn(m,p,h)},o=0,s=t;o<s.length;o++)a(s[o]);return e}function o4(r){if(r===null)throw new Error("Invalid input value: "+JSON.stringify(r));var t=0,e=[];r.forEach((function(o){if(t+=o.byteLength,e.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+o.constructor.name)}));var n=new Uint8Array(t),a=0;return e.forEach((function(o){n.set(new Uint8Array(o.buffer),a),a+=o.byteLength})),n.buffer}var Ap=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Kb(r){return Ap?Buffer.byteLength(r):new Blob([r]).size}function bv(r){var t=0;r.forEach((function(a){t+=a.byteLength}));var e=new Uint8Array(t),n=0;return r.forEach((function(a){e.set(new Uint8Array(a),n),n+=a.byteLength})),e.buffer}function Yb(r){for(r=r.trim();r.endsWith("/");)r=r.slice(0,r.length-1);var t=r.split("/");return t[t.length-1]}function bs(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:Kb(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:Kb(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}var jn=(function(){function r(){this.saveRouters=[],this.loadRouters=[]}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerSaveRouter=function(t){r.getInstance().saveRouters.push(t)},r.registerLoadRouter=function(t){r.getInstance().loadRouters.push(t)},r.getSaveHandlers=function(t){return r.getHandlers(t,"save")},r.getLoadHandlers=function(t,e){return r.getHandlers(t,"load",e)},r.getHandlers=function(t,e,n){var a=[];return(e==="load"?r.getInstance().loadRouters:r.getInstance().saveRouters).forEach((function(o){var s=o(t,n);s!==null&&a.push(s)})),a},r})(),Lo="://",Za=(function(){function r(){this.managers={}}return r.getInstance=function(){return r.instance==null&&(r.instance=new r),r.instance},r.registerManager=function(t,e){B(t!=null,(function(){return"scheme must not be undefined or null."})),t.endsWith(Lo)&&(t=t.slice(0,t.indexOf(Lo))),B(t.length>0,(function(){return"scheme must not be an empty string."}));var n=r.getInstance();B(n.managers[t]==null,(function(){return"A model store manager is already registered for scheme '"+t+"'."})),n.managers[t]=e},r.getManager=function(t){var e=this.getInstance().managers[t];if(e==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},r.getSchemes=function(){return Object.keys(this.getInstance().managers)},r})();function sc(r){if(r.indexOf(Lo)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Za.getSchemes().join(","));return{scheme:r.split(Lo)[0],path:r.split(Lo)[1]}}function Qb(r,t,e){return e===void 0&&(e=!1),Ee(this,void 0,void 0,(function(){var n,a,o,s,l,f,h,p,v;return Ce(this,(function(m){switch(m.label){case 0:return B(r!==t,(function(){return"Old path and new path are the same: '"+r+"'"})),B((n=jn.getLoadHandlers(r)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+r+"."})),B(n.length<2,(function(){return"Copying failed because more than one ("+n.length+") load handlers for source URL "+r+"."})),a=n[0],B((o=jn.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),B(o.length<2,(function(){return"Copying failed because more than one ("+n.length+") save handlers for destination URL "+t+"."})),s=o[0],l=sc(r).scheme,f=sc(r).path,h=l===sc(r).scheme,[4,a.load()];case 1:return p=m.sent(),e&&h?[4,Za.getManager(l).removeModel(f)]:[3,3];case 2:m.sent(),m.label=3;case 3:return[4,s.save(p)];case 4:return v=m.sent(),!e||h?[3,6]:[4,Za.getManager(l).removeModel(f)];case 5:m.sent(),m.label=6;case 6:return[2,v.modelArtifactsInfo]}}))}))}var Ai="models_store",Ya="model_info_store";function _2(){if(!ce().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var r=window||self,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Tp(r){var t=r.result;t.createObjectStore(Ai,{keyPath:"modelPath"}),t.createObjectStore(Ya,{keyPath:"modelPath"})}var zo=(function(){function r(t){if(this.indexedDB=_2(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return r.prototype.save=function(t){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},r.prototype.load=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},r.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(a,o){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return Tp(s)},s.onsuccess=function(){var l=s.result;if(e==null){var f=l.transaction(Ai,"readonly"),h=f.objectStore(Ai).get(n.modelPath);h.onsuccess=function(){if(h.result==null)return l.close(),o(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));a(h.result.modelArtifacts)},h.onerror=function(E){return l.close(),o(h.error)},f.oncomplete=function(){return l.close()}}else{var p,v=bs(e),m=l.transaction(Ya,"readwrite"),y=m.objectStore(Ya),x=y.put({modelPath:n.modelPath,modelArtifactsInfo:v});x.onsuccess=function(){var E=(p=l.transaction(Ai,"readwrite")).objectStore(Ai).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:v});E.onsuccess=function(){return a({modelArtifactsInfo:v})},E.onerror=function(w){var C=(y=m.objectStore(Ya)).delete(n.modelPath);C.onsuccess=function(){return l.close(),o(E.error)},C.onerror=function(_){return l.close(),o(E.error)}}},x.onerror=function(E){return l.close(),o(x.error)},m.oncomplete=function(){p==null?l.close():p.oncomplete=function(){return l.close()}}}},s.onerror=function(l){return o(s.error)}}))},r.URL_SCHEME="indexeddb://",r})(),Zb=function(r){return ce().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(zo.URL_SCHEME)?(t=r.slice(zo.URL_SCHEME.length),new zo(t)):null;var t};jn.registerSaveRouter(Zb),jn.registerLoadRouter(Zb);var u4=(function(){function r(){this.indexedDB=_2()}return r.prototype.listModels=function(){return Ee(this,void 0,void 0,(function(){var t=this;return Ce(this,(function(e){return[2,new Promise((function(n,a){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return Tp(o)},o.onsuccess=function(){var s=o.result,l=s.transaction(Ya,"readonly"),f=l.objectStore(Ya).getAll();f.onsuccess=function(){for(var h={},p=0,v=f.result;p<v.length;p++){var m=v[p];h[m.modelPath]=m.modelArtifactsInfo}n(h)},f.onerror=function(h){return s.close(),a(f.error)},l.oncomplete=function(){return s.close()}},o.onerror=function(s){return a(o.error)}}))]}))}))},r.prototype.removeModel=function(t){return Ee(this,void 0,void 0,(function(){var e=this;return Ce(this,(function(n){var a;return t=(a=t).startsWith(zo.URL_SCHEME)?a.slice(zo.URL_SCHEME.length):a,[2,new Promise((function(o,s){var l=e.indexedDB.open("tensorflowjs",1);l.onupgradeneeded=function(){return Tp(l)},l.onsuccess=function(){var f,h=l.result,p=h.transaction(Ya,"readwrite"),v=p.objectStore(Ya),m=v.get(t);m.onsuccess=function(){if(m.result==null)return h.close(),s(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var y=v.delete(t),x=function(){var E=(f=h.transaction(Ai,"readwrite")).objectStore(Ai).delete(t);E.onsuccess=function(){return o(m.result.modelArtifactsInfo)},E.onerror=function(w){return s(m.error)}};y.onsuccess=x,y.onerror=function(E){return x(),h.close(),s(m.error)}},m.onerror=function(y){return h.close(),s(m.error)},p.oncomplete=function(){f==null?h.close():f.oncomplete=function(){return h.close()}}},l.onerror=function(f){return s(l.error)}}))]}))}))},r})();if(ce().getBool("IS_BROWSER"))try{Za.registerManager(zo.URL_SCHEME,new u4)}catch{}var ha="/",ko="tensorflowjs_models",S2="info",s4="model_topology",l4="weight_specs",c4="weight_data",f4="model_metadata";function R2(r){return{info:[ko,r,S2].join(ha),topology:[ko,r,s4].join(ha),weightSpecs:[ko,r,l4].join(ha),weightData:[ko,r,c4].join(ha),modelMetadata:[ko,r,f4].join(ha)}}function h4(r){var t=r.split(ha);if(t.length<3)throw new Error("Invalid key format: "+r);return t.slice(1,t.length-1).join(ha)}var Uo=(function(){function r(t){if(!ce().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=R2(this.modelPath)}return r.prototype.save=function(t){return Ee(this,void 0,void 0,(function(){var e,n,a;return Ce(this,(function(o){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),a=bs(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(function(s){if(Ap)return Buffer.from(s).toString("base64");for(var l=new Uint8Array(s),f="",h=0,p=l.length;h<p;h++)f+=String.fromCharCode(l[h]);return btoa(f)})(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:a}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+a.modelTopologyBytes+", weightSpecsBytes="+a.weightSpecsBytes+", weightDataBytes="+a.weightDataBytes+".")}return[2]}))}))},r.prototype.load=function(){return Ee(this,void 0,void 0,(function(){var t,e,n,a,o,s,l;return Ce(this,(function(f){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},(n=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=a,(o=this.LS.getItem(this.keys.modelMetadata))!=null&&(s=JSON.parse(o),e.format=s.format,e.generatedBy=s.generatedBy,e.convertedBy=s.convertedBy,e.userDefinedMetadata=s.userDefinedMetadata),(l=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=(function(h){if(Ap){var p=Buffer.from(h,"base64");return p.buffer.slice(p.byteOffset,p.byteOffset+p.byteLength)}for(var v=atob(h),m=new Uint8Array(v.length),y=0;y<v.length;++y)m.set([v.charCodeAt(y)],y);return m.buffer})(l),[2,e]}))}))},r.URL_SCHEME="localstorage://",r})(),Jb=function(r){return ce().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Uo.URL_SCHEME)?(t=r.slice(Uo.URL_SCHEME.length),new Uo(t)):null;var t};jn.registerSaveRouter(Jb),jn.registerLoadRouter(Jb);var d4=(function(){function r(){B(ce().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),B(typeof window>"u"||window.localStorage!==void 0,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return r.prototype.listModels=function(){return Ee(this,void 0,void 0,(function(){var t,e,n,a,o,s;return Ce(this,(function(l){for(t={},e=ko+ha,n=ha+S2,a=0;a<this.LS.length;++a)(o=this.LS.key(a)).startsWith(e)&&o.endsWith(n)&&(s=h4(o),t[s]=JSON.parse(this.LS.getItem(o)));return[2,t]}))}))},r.prototype.removeModel=function(t){return Ee(this,void 0,void 0,(function(){var e,n;return Ce(this,(function(a){var o;if(t=(o=t).startsWith(Uo.URL_SCHEME)?o.slice(Uo.URL_SCHEME.length):o,e=R2(t),this.LS.getItem(e.info)==null)throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},r})();if(ce().getBool("IS_BROWSER"))try{Za.registerManager(Uo.URL_SCHEME,new d4)}catch{}var p4="model",v4=".json",m4=".weights.bin";function $b(r){return new Promise((function(t){return setTimeout(t)})).then(r)}var ep=(function(){function r(t){if(!ce().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(r.URL_SCHEME)&&(t=t.slice(r.URL_SCHEME.length)),t!=null&&t.length!==0||(t=p4),this.modelTopologyFileName=t+v4,this.weightDataFileName=t+m4}return r.prototype.save=function(t){return Ee(this,void 0,void 0,(function(){var e,n,a,o,s,l;return Ce(this,(function(f){switch(f.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(s=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,s.href=o,[4,$b((function(){return s.dispatchEvent(new MouseEvent("click"))}))];case 2:return f.sent(),t.weightData==null?[3,4]:((l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,l.href=e,[4,$b((function(){return l.dispatchEvent(new MouseEvent("click"))}))]);case 3:f.sent(),f.label=4;case 4:return[2,{modelArtifactsInfo:bs(t)}]}}))}))},r.URL_SCHEME="downloads://",r})(),g4=(function(){function r(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return r.prototype.load=function(){return Ee(this,void 0,void 0,(function(){var t,e,n=this;return Ce(this,(function(a){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(o,s){var l=new FileReader;l.onload=function(f){var h=JSON.parse(f.target.result),p=h.modelTopology;if(p!=null){e.length===0&&o({modelTopology:p});var v=h.weightsManifest;if(v!=null){var m;try{m=n.checkManifestAndWeightFiles(v,e)}catch(w){return void s(w)}var y=[],x=[],E=[];v.forEach((function(w){w.paths.forEach((function(C){x.push(C),E.push(null)})),y.push.apply(y,w.weights)})),v.forEach((function(w){w.paths.forEach((function(C){var _=new FileReader;_.onload=function(R){var A=R.target.result,T=x.indexOf(C);E[T]=A,E.indexOf(null)===-1&&o({modelTopology:p,weightSpecs:y,weightData:bv(E),format:h.format,generatedBy:h.generatedBy,convertedBy:h.convertedBy,userDefinedMetadata:h.userDefinedMetadata})},_.onerror=function(R){return s("Failed to weights data from file of path '"+C+"'.")},_.readAsArrayBuffer(m[C])}))}))}else s(new Error("weightManifest field is missing from file "+t.name))}else s(new Error("modelTopology field is missing from file "+t.name))},l.onerror=function(f){return s("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},l.readAsText(t)}))]}))}))},r.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],a=e.map((function(f){return Yb(f.name)})),o={},s=0,l=t;s<l.length;s++)l[s].paths.forEach((function(f){var h=Yb(f);if(n.indexOf(h)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+h+"'");if(n.push(h),a.indexOf(h)===-1)throw new Error("Weight file with basename '"+h+"' is not provided.");o[f]=e[a.indexOf(h)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return o},r})();function e1(r,t,e,n){(function(o){B(o!=null&&Array.isArray(o)&&o.length>0,(function(){return"promises must be a none empty array"}))})(r),(function(o,s){B(o>=0&&o<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+o})),B(s>=0&&s<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+s})),B(s>=o,(function(){return"startFraction must be no more than endFraction, but got startFraction "+o+" and endFraction "+s}))})(e=e??0,n=n??1);var a=0;return Promise.all(r.map((function(o){return o.then((function(s){var l=e+ ++a/r.length*(n-e);return t(l),s})),o})))}function A2(r,t){return Ee(this,void 0,void 0,(function(){var e,n,a,o,s,l,f,h,p;return Ce(this,(function(v){switch(v.label){case 0:return t==null&&(t={}),e=t.fetchFunc==null?ce().platform.fetch:t.fetchFunc,n=r.map((function(m){return e(m,t.requestInit,{isBinary:!0})})),a=0,o=.5,t.onProgress!=null?[3,2]:[4,Promise.all(n)];case 1:return s=v.sent(),[3,4];case 2:return[4,e1(n,t.onProgress,a,o)];case 3:s=v.sent(),v.label=4;case 4:return l=s.map((function(m){return m.arrayBuffer()})),f=.5,h=1,t.onProgress!=null?[3,6]:[4,Promise.all(l)];case 5:return p=v.sent(),[3,8];case 6:return[4,e1(l,t.onProgress,f,h)];case 7:p=v.sent(),v.label=8;case 8:return[2,p]}}))}))}function t1(r){var t=this;return function(e,n,a){return n===void 0&&(n=""),Ee(t,void 0,void 0,(function(){var o,s,l,f,h,p,v,m,y,x;return Ce(this,(function(E){switch(E.label){case 0:if(o=e.map((function(){return!1})),s={},l=a!=null?a.map((function(){return!1})):[],f=[],e.forEach((function(w,C){var _=0;w.weights.forEach((function(R){var A="quantization"in R?R.quantization.dtype:R.dtype,T=Rp[A]*Se(R.shape),N=function(){o[C]=!0,s[C]==null&&(s[C]=[]),s[C].push({manifestEntry:R,groupOffset:_,sizeBytes:T})};a!=null?a.forEach((function(M,I){M===R.name&&(N(),l[I]=!0)})):N(),f.push(R.name),_+=T}))})),!l.every((function(w){return w})))throw h=a.filter((function(w,C){return!l[C]})),new Error("Could not find weights in manifest with names: "+h.join(", ")+`. 
Manifest JSON has weights with names: `+f.join(", ")+".");return p=o.reduce((function(w,C,_){return C&&w.push(_),w}),[]),v=[],p.forEach((function(w){e[w].paths.forEach((function(C){var _=n+(n.endsWith("/")?"":"/")+C;v.push(_)}))})),[4,r(v)];case 1:return m=E.sent(),y={},x=0,p.forEach((function(w){for(var C=e[w].paths.length,_=0,R=0;R<C;R++)_+=m[x+R].byteLength;for(var A=new ArrayBuffer(_),T=new Uint8Array(A),N=0,M=0;M<C;M++){var I=new Uint8Array(m[x+M]);T.set(I,N),N+=I.byteLength}s[w].forEach((function(k){var F=C2(A.slice(k.groupOffset,k.groupOffset+k.sizeBytes),[k.manifestEntry]);for(var W in F)y[W]=F[W]})),x+=C})),[2,y]}}))}))}}jn.registerSaveRouter((function(r){return ce().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(ep.URL_SCHEME)?(function(t){return t===void 0&&(t="model"),new ep(t)})(r.slice(ep.URL_SCHEME.length)):null}));var T2=(function(){function r(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,e.fetchFunc!=null?(B(typeof e.fetchFunc=="function",(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=ce().platform.fetch,B(t!=null&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&B(t.length===2,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return r.prototype.save=function(t){return Ee(this,void 0,void 0,(function(){var e,n,a,o;return Ce(this,(function(s){switch(s.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),t.weightData!=null&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((o=s.sent()).ok)return[2,{modelArtifactsInfo:bs(t),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},r.prototype.load=function(){return Ee(this,void 0,void 0,(function(){var t,e,n,a,o,s,l,f,h,p,v,m;return Ce(this,(function(y){switch(y.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=y.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");y.label=2;case 2:return y.trys.push([2,4,,5]),[4,t.json()];case 3:return e=y.sent(),[3,5];case 4:throw y.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(a=e.modelTopology,o=e.weightsManifest,s=e.generatedBy,l=e.convertedBy,f=e.format,h=e.userDefinedMetadata,a==null&&o==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return o==null?[3,7]:[4,this.loadWeights(o)];case 6:m=y.sent(),p=m[0],v=m[1],y.label=7;case 7:return[2,{modelTopology:a,weightSpecs:p,weightData:v,userDefinedMetadata:h,generatedBy:s,convertedBy:l,format:f}]}}))}))},r.prototype.loadWeights=function(t){return Ee(this,void 0,void 0,(function(){var e,n,a,o,s,l,f,h,p,v,m;return Ce(this,(function(y){switch(y.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=(function(x){var E=x.lastIndexOf("/"),w=x.lastIndexOf("?"),C=x.substring(0,E),_=w>E?x.substring(w):"";return[C+"/",_]})(e),a=n[0],o=n[1],s=this.weightPathPrefix||a,l=[],f=0,h=t;f<h.length;f++)p=h[f],l.push.apply(l,p.weights);return v=[],t.forEach((function(x){x.paths.forEach((function(E){v.push(s+E+o)}))})),[4,A2(v,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return m=y.sent(),[2,[l,bv(m)]]}}))}))},r.URL_SCHEME_REGEX=/^https?:\/\//,r})();function Dp(r){return r.match(T2.URL_SCHEME_REGEX)!=null}var n1=function(r,t){return typeof fetch>"u"?null:(Array.isArray(r)?r.every((function(e){return Dp(e)})):Dp(r))?Np(r,{onProgress:t}):null};function Np(r,t){return new T2(r,t)}jn.registerSaveRouter(n1),jn.registerLoadRouter(n1);var tp=(function(){function r(t){this.modelArtifacts=t}return r.prototype.load=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(t){return[2,this.modelArtifacts]}))}))},r})(),y4=(function(){function r(t){this.saveHandler=t}return r.prototype.save=function(t){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){return[2,this.saveHandler(t)]}))}))},r})(),D2=Object.freeze({browserFiles:function(r){return new g4(r)},browserHTTPRequest:function(r,t){return Np(r,t)},concatenateArrayBuffers:bv,decodeWeights:C2,encodeWeights:function(r,t){return Ee(this,void 0,void 0,(function(){var e,n,a,o,s,l=this;return Ce(this,(function(f){switch(f.label){case 0:for(e=[],n=[],a=Array.isArray(r)?r.map((function(h){return h.name})):Object.keys(r),o=function(h){var p=a[h],v=Array.isArray(r)?r[h].tensor:r[p];if(v.dtype!=="float32"&&v.dtype!=="int32"&&v.dtype!=="bool"&&v.dtype!=="string")throw new Error("Unsupported dtype in weight '"+p+"': "+v.dtype);var m={name:p,shape:v.shape,dtype:v.dtype};if(v.dtype==="string"){var y=new Promise((function(x){return Ee(l,void 0,void 0,(function(){var E,w,C,_,R,A,T;return Ce(this,(function(N){switch(N.label){case 0:return[4,v.bytes()];case 1:for(E=N.sent(),w=E.reduce((function(M,I){return M+I.length}),0)+Mc*E.length,C=new Uint8Array(w),_=0,R=0;R<E.length;R++)A=E[R],T=new Uint8Array(new Uint32Array([A.length]).buffer),C.set(T,_),_+=Mc,C.set(A,_),_+=A.length;return x(C),[2]}}))}))}));n.push(y)}else n.push(v.data());t!=null&&(m.group=t),e.push(m)},s=0;s<a.length;++s)o(s);return[4,Promise.all(n)];case 1:return[2,{data:o4(f.sent()),specs:e}]}}))}))},fromMemory:function(r,t,e,n){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new tp(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tp({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tp({modelTopology:r,weightSpecs:t,weightData:e,trainingConfig:n}))},getLoadHandlers:function(r,t){return jn.getLoadHandlers(r,t)},getModelArtifactsInfoForJSON:bs,getSaveHandlers:function(r){return jn.getSaveHandlers(r)},http:Np,isHTTPScheme:Dp,loadWeights:function(r,t,e,n){return t===void 0&&(t=""),Ee(this,void 0,void 0,(function(){return Ce(this,(function(a){return[2,t1((function(o){return A2(o,{requestInit:n})}))(r,t,e)]}))}))},registerLoadRouter:function(r){return jn.registerLoadRouter(r)},registerSaveRouter:function(r){return jn.registerSaveRouter(r)},weightsLoaderFactory:t1,withSaveHandler:function(r){return new y4(r)},copyModel:function(r,t){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){return[2,Qb(r,t,!1)]}))}))},listModels:function(){return Ee(this,void 0,void 0,(function(){var r,t,e,n,a,o,s;return Ce(this,(function(l){switch(l.label){case 0:r=Za.getSchemes(),t={},e=0,n=r,l.label=1;case 1:return e<n.length?(a=n[e],[4,Za.getManager(a).listModels()]):[3,4];case 2:for(s in o=l.sent())t[a+Lo+s]=o[s];l.label=3;case 3:return e++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(r,t){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){return[2,Qb(r,t,!0)]}))}))},removeModel:function(r){return Ee(this,void 0,void 0,(function(){var t;return Ce(this,(function(e){return t=sc(r),[2,Za.getManager(t.scheme).removeModel(t.path)]}))}))}}),To;H({confusionMatrix_:function(r,t,e){var n=O(r,"labels","confusionMatrix"),a=O(t,"predictions","confusionMatrix");B(e==null||e>0&&Number.isInteger(e),(function(){return"If provided, numClasses must be a positive integer, but got "+e})),B(n.rank===1,(function(){return"Expected the rank of labels to be 1, but got "+n.rank})),B(a.rank===1,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),B(n.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+n.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),B(e>0&&Number.isInteger(e),(function(){return"numClasses is required to be a positive integer, but got "+e}));var o=wp(n.asType("int32"),e),s=wp(a.asType("int32"),e);return o.transpose().matMul(s).asType("int32")}});var b4=H({fromPixels_:function(r,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,n=!1,a=!1,o=!1,s=!1;if(r.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&r instanceof ImageData)n=!0;else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)o=!0;else{if(r.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+r.constructor.name);s=!0}if(a&&a&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if($1("FromPixels",j.backendName)!=null)return j.runKernel("FromPixels",{pixels:r},{numChannels:t});var l,f,h=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],p=h[0],v=h[1];if(s?l=r.getContext("2d").getImageData(0,0,p,v).data:n||e?l=r.data:(o||a)&&(To==null&&(To=document.createElement("canvas").getContext("2d")),To.canvas.width=p,To.canvas.height=v,To.drawImage(r,0,0,p,v),l=To.getImageData(0,0,p,v).data),t===4)f=new Int32Array(l);else{var m=p*v;f=new Int32Array(m*t);for(var y=0;y<m;y++)for(var x=0;x<t;++x)f[y*t+x]=l[4*y+x]}return Kp(f,[v,p,t],"int32")}}),xv=Object.freeze({toPixels:function(r,t){return Ee(this,void 0,void 0,(function(){var e,n,a,o,s,l,f,h,p,v,m,y,x,E,w,C,_,R,A,T,N,M,I;return Ce(this,(function(k){switch(k.label){case 0:if(e=O(r,"img","toPixels"),r instanceof yt||(e=e.toInt()),e.rank!==2&&e.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(n=e.shape.slice(0,2),a=n[0],o=n[1],(s=e.rank===2?1:e.shape[2])>4||s===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,e.data()];case 1:return l=k.sent(),f=e.min(),h=e.max(),[4,Promise.all([f.data(),h.data()])];case 2:if(p=k.sent(),v=p[0],m=p[1],y=v[0],x=m[0],f.dispose(),h.dispose(),e.dtype==="float32"){if(y<0||x>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+y+" - "+x+"].")}else{if(e.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(y<0||x>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+y+" - "+x+"].")}for(E=e.dtype==="float32"?255:1,w=new Uint8ClampedArray(o*a*4),C=0;C<a*o;++C)_=void 0,R=void 0,A=void 0,T=void 0,s===1?(_=l[C]*E,R=l[C]*E,A=l[C]*E,T=255):s===3?(_=l[3*C]*E,R=l[3*C+1]*E,A=l[3*C+2]*E,T=255):s===4&&(_=l[4*C]*E,R=l[4*C+1]*E,A=l[4*C+2]*E,T=l[4*C+3]*E),w[(N=4*C)+0]=Math.round(_),w[N+1]=Math.round(R),w[N+2]=Math.round(A),w[N+3]=Math.round(T);return t!=null&&(t.width=o,t.height=a,M=t.getContext("2d"),I=new ImageData(w,o,a),M.putImageData(I,0,0)),e!==r&&e.dispose(),[2,w]}}))}))},fromPixels:b4}),x4=(function(){function r(){}return r.prototype.getClassName=function(){return this.constructor.className},r.fromConfig=function(t,e){return new t(e)},r})(),w4=(function(){function r(){this.classNameMap={}}return r.getMap=function(){return r.instance==null&&(r.instance=new r),r.instance},r.register=function(t){r.getMap().classNameMap[t.className]=[t,t.fromConfig]},r})();function zi(r){B(r.className!=null,(function(){return"Class being registered does not have the static className property defined."})),B(typeof r.className=="string",(function(){return"className is required to be a string, but got type "+typeof r.className})),B(r.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),w4.register(r)}var Ui=(function(r){function t(){return r!==null&&r.apply(this,arguments)||this}return yr(t,r),t.prototype.minimize=function(e,n,a){n===void 0&&(n=!1);var o=this.computeGradients(e,a),s=o.value,l=o.grads;if(a!=null){var f=a.map((function(h){return{name:h.name,tensor:l[h.name]}}));this.applyGradients(f)}else this.applyGradients(l);return Rn(l),n?s:(s.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,n){return OA(e,n)},t.prototype.dispose=function(){this.iterations_!=null&&Rn(this.iterations_)},t.prototype.saveIterations=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ge(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(n){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return Ee(this,void 0,void 0,(function(){var n;return Ce(this,(function(a){switch(a.label){case 0:return n=this,[4,e[0].tensor.data()];case 1:return n.iterations_=a.sent()[0],[2,e.slice(1)]}}))}))},t})(x4);Object.defineProperty(Ui,Symbol.hasInstance,{value:function(r){return r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null}});var E4=(function(r){function t(e,n,a){a===void 0&&(a=null);var o=r.call(this)||this;return o.learningRate=e,o.rho=n,o.epsilon=a,o.accumulatedGrads=[],o.accumulatedUpdates=[],a==null&&(o.epsilon=j.backend.epsilon()),o}return yr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,o){var s=j.registeredVariables[a];n.accumulatedGrads[o]==null&&(n.accumulatedGrads[o]={originalName:a+"/accum_grad",variable:be((function(){return Qe(s).variable(!1)}))}),n.accumulatedUpdates[o]==null&&(n.accumulatedUpdates[o]={originalName:a+"/accum_var",variable:be((function(){return Qe(s).variable(!1)}))});var l=Array.isArray(e)?e[o].tensor:e[a];if(l!=null){var f=n.accumulatedGrads[o].variable,h=n.accumulatedUpdates[o].variable;be((function(){var p=f.mul(n.rho).add(l.square().mul(1-n.rho)),v=h.add(n.epsilon).sqrt().div(f.add(n.epsilon).sqrt()).mul(l),m=h.mul(n.rho).add(v.square().mul(1-n.rho));f.assign(p),h.assign(m);var y=v.mul(-n.learningRate).add(s);s.assign(y)}))}})),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Rn(this.accumulatedGrads.map((function(e){return e.variable}))),Rn(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){var e;return Ce(this,(function(n){switch(n.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){var n;return Ce(this,(function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=e.length/2,this.accumulatedGrads=e.slice(0,n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(n,2*n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.rho,n.epsilon)},t.className="Adadelta",t})(Ui);zi(E4);var C4=(function(r){function t(e,n){n===void 0&&(n=.1);var a=r.call(this)||this;return a.learningRate=e,a.initialAccumulatorValue=n,a.accumulatedGrads=[],a}return yr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,o){var s=j.registeredVariables[a];n.accumulatedGrads[o]==null&&(n.accumulatedGrads[o]={originalName:a+"/accumulator",variable:be((function(){return Fr(s.shape,n.initialAccumulatorValue).variable(!1)}))});var l=Array.isArray(e)?e[o].tensor:e[a];if(l!=null){var f=n.accumulatedGrads[o].variable;be((function(){var h=f.add(l.square());f.assign(h);var p=l.div(h.add(j.backend.epsilon()).sqrt()).mul(-n.learningRate).add(s);s.assign(p)}))}})),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Rn(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(n){return{name:n.originalName,tensor:n.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulatedGrads=e.map((function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,n){return new e(n.learningRate,n.initialAccumulatorValue)},t.className="Adagrad",t})(Ui);zi(C4);var _4=(function(r){function t(e,n,a,o){o===void 0&&(o=null);var s=r.call(this)||this;return s.learningRate=e,s.beta1=n,s.beta2=a,s.epsilon=o,s.accumulatedFirstMoment=[],s.accumulatedSecondMoment=[],be((function(){s.accBeta1=ge(n).variable(),s.accBeta2=ge(a).variable()})),o==null&&(s.epsilon=j.backend.epsilon()),s}return yr(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map((function(o){return o.name})):Object.keys(e);be((function(){var o=Pt(1,n.accBeta1),s=Pt(1,n.accBeta2);a.forEach((function(l,f){var h=j.registeredVariables[l];n.accumulatedFirstMoment[f]==null&&(n.accumulatedFirstMoment[f]={originalName:l+"/m",variable:be((function(){return Qe(h).variable(!1)}))}),n.accumulatedSecondMoment[f]==null&&(n.accumulatedSecondMoment[f]={originalName:l+"/v",variable:be((function(){return Qe(h).variable(!1)}))});var p=Array.isArray(e)?e[f].tensor:e[l];if(p!=null){var v=n.accumulatedFirstMoment[f].variable,m=n.accumulatedSecondMoment[f].variable,y=v.mul(n.beta1).add(p.mul(1-n.beta1)),x=m.mul(n.beta2).add(p.square().mul(1-n.beta2)),E=y.div(o),w=x.div(s);v.assign(y),m.assign(x);var C=E.div(w.sqrt().add(n.epsilon)).mul(-n.learningRate).add(h);h.assign(C)}})),n.accBeta1.assign(n.accBeta1.mul(n.beta1)),n.accBeta2.assign(n.accBeta2.mul(n.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Rn(this.accumulatedFirstMoment.map((function(e){return e.variable}))),this.accumulatedSecondMoment!=null&&Rn(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){var e;return Ce(this,(function(n){switch(n.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){var n,a=this;return Ce(this,(function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),be((function(){a.accBeta1.assign(Nc(a.beta1,a.iterations_+1)),a.accBeta2.assign(Nc(a.beta2,a.iterations_+1))})),n=e.length/2,this.accumulatedFirstMoment=e.slice(0,n).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(n,2*n).map((function(s){return{originalName:s.name,variable:s.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)},t.className="Adam",t})(Ui);zi(_4);var S4=(function(r){function t(e,n,a,o,s){o===void 0&&(o=null),s===void 0&&(s=0);var l=r.call(this)||this;return l.learningRate=e,l.beta1=n,l.beta2=a,l.epsilon=o,l.decay=s,l.accumulatedFirstMoment=[],l.accumulatedWeightedInfNorm=[],be((function(){l.iteration=ge(0).variable(),l.accBeta1=ge(n).variable()})),o==null&&(l.epsilon=j.backend.epsilon()),l}return yr(t,r),t.prototype.applyGradients=function(e){var n=this,a=Array.isArray(e)?e.map((function(o){return o.name})):Object.keys(e);be((function(){var o=Pt(1,n.accBeta1),s=vr(-n.learningRate,n.iteration.mul(n.decay).add(1));a.forEach((function(l,f){var h=j.registeredVariables[l];n.accumulatedFirstMoment[f]==null&&(n.accumulatedFirstMoment[f]={originalName:l+"/m",variable:Qe(h).variable(!1)}),n.accumulatedWeightedInfNorm[f]==null&&(n.accumulatedWeightedInfNorm[f]={originalName:l+"/v",variable:Qe(h).variable(!1)});var p=Array.isArray(e)?e[f].tensor:e[l];if(p!=null){var v=n.accumulatedFirstMoment[f].variable,m=n.accumulatedWeightedInfNorm[f].variable,y=v.mul(n.beta1).add(p.mul(1-n.beta1)),x=m.mul(n.beta2),E=p.abs(),w=x.maximum(E);v.assign(y),m.assign(w);var C=s.div(o).mul(y.div(w.add(n.epsilon))).add(h);h.assign(C)}})),n.iteration.assign(n.iteration.add(1)),n.accBeta1.assign(n.accBeta1.mul(n.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Rn(this.accumulatedFirstMoment.map((function(e){return e.variable}))),this.accumulatedWeightedInfNorm!=null&&Rn(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(n){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)},t.className="Adamax",t})(Ui);zi(S4);var N2=(function(r){function t(e){var n=r.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return yr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,o){var s=Array.isArray(e)?e[o].tensor:e[a];if(s!=null){var l=j.registeredVariables[a];be((function(){var f=n.c.mul(s).add(l);l.assign(f)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=GR(ge(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:if((e=n.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,n){return new e(n.learningRate)},t.className="SGD",t})(Ui);zi(N2);var R4=(function(r){function t(e,n,a){a===void 0&&(a=!1);var o=r.call(this,e)||this;return o.learningRate=e,o.momentum=n,o.useNesterov=a,o.accumulations=[],o.m=ge(o.momentum),o}return yr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,o){var s=j.registeredVariables[a];n.accumulations[o]==null&&(n.accumulations[o]={originalName:a+"/momentum",variable:be((function(){return Qe(s).variable(!1)}))});var l=n.accumulations[o].variable,f=Array.isArray(e)?e[o].tensor:e[a];f!=null&&be((function(){var h,p=n.m.mul(l).add(f);h=n.useNesterov?n.c.mul(f.add(p.mul(n.m))).add(s):n.c.mul(p).add(s),l.assign(p),s.assign(h)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Rn(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(n){return{name:n.originalName,tensor:n.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){return Ce(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),this.accumulations=e.map((function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)},t.className="Momentum",t})(N2);zi(R4);var A4=(function(r){function t(e,n,a,o,s){n===void 0&&(n=.9),a===void 0&&(a=0),o===void 0&&(o=null),s===void 0&&(s=!1);var l=r.call(this)||this;if(l.learningRate=e,l.decay=n,l.momentum=a,l.epsilon=o,l.accumulatedMeanSquares=[],l.accumulatedMoments=[],l.accumulatedMeanGrads=[],l.centered=s,o==null&&(l.epsilon=j.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return l}return yr(t,r),t.prototype.applyGradients=function(e){var n=this;(Array.isArray(e)?e.map((function(a){return a.name})):Object.keys(e)).forEach((function(a,o){var s=j.registeredVariables[a];n.accumulatedMeanSquares[o]==null&&(n.accumulatedMeanSquares[o]={originalName:a+"/rms",variable:be((function(){return Qe(s).variable(!1)}))}),n.accumulatedMoments[o]==null&&(n.accumulatedMoments[o]={originalName:a+"/momentum",variable:be((function(){return Qe(s).variable(!1)}))}),n.accumulatedMeanGrads[o]==null&&n.centered&&(n.accumulatedMeanGrads[o]={originalName:a+"/mg",variable:be((function(){return Qe(s).variable(!1)}))});var l=Array.isArray(e)?e[o].tensor:e[a];if(l!=null){var f=n.accumulatedMeanSquares[o].variable,h=n.accumulatedMoments[o].variable;be((function(){var p=f.mul(n.decay).add(l.square().mul(1-n.decay));if(n.centered){var v=n.accumulatedMeanGrads[o].variable,m=v.mul(n.decay).add(l.mul(1-n.decay)),y=h.mul(n.momentum).add(l.mul(n.learningRate).div(p.sub(m.square().add(n.epsilon)).sqrt()));f.assign(p),v.assign(m),h.assign(y);var x=s.sub(y);s.assign(x)}else{var E=f.mul(n.decay).add(l.square().mul(1-n.decay));y=h.mul(n.momentum).add(l.mul(n.learningRate).div(E.add(n.epsilon).sqrt())),f.assign(E),h.assign(y),x=s.sub(y),s.assign(x)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Rn(this.accumulatedMeanSquares.map((function(e){return e.variable}))),this.accumulatedMeanGrads!=null&&this.centered&&Rn(this.accumulatedMeanGrads.map((function(e){return e.variable}))),this.accumulatedMoments!=null&&Rn(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ee(this,void 0,void 0,(function(){var e;return Ce(this,(function(n){switch(n.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(e.map((function(a){return{name:a.originalName,tensor:a.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ee(this,void 0,void 0,(function(){var n;return Ce(this,(function(a){switch(a.label){case 0:return[4,this.extractIterations(e)];case 1:return e=a.sent(),n=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(n,2*n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*n,3*n).map((function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)},t.className="RMSProp",t})(Ui);zi(A4);yt.prototype.squaredDifference=function(r){return Gx(this,r)},re=$N;var Op=function(r,t){return Op=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])},Op(r,t)};function Be(r,t){Op(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var on=function(){return on=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},on.apply(this,arguments)};function Ae(r,t,e,n){function a(o){return o instanceof e?o:new e(function(s){s(o)})}return new(e||(e=Promise))(function(o,s){function l(p){try{h(n.next(p))}catch(v){s(v)}}function f(p){try{h(n.throw(p))}catch(v){s(v)}}function h(p){p.done?o(p.value):a(p.value).then(l,f)}h((n=n.apply(r,[])).next())})}function Te(r,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(h){return function(p){return f([h,p])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,a&&(o=h[0]&2?a.return:h[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,h[1])).done)return o;switch(a=0,o&&(h=[h[0]&2,o.value]),h[0]){case 0:case 1:o=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,a=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!o||h[1]>o[0]&&h[1]<o[3])){e.label=h[1];break}if(h[0]===6&&e.label<o[1]){e.label=o[1],o=h;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(h);break}o[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(r,e)}catch(p){h=[6,p],a=0}finally{n=o=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function es(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),a=0,t=0;t<e;t++)for(var o=arguments[t],s=0,l=o.length;s<l;s++,a++)n[a]=o[s];return n}var Po=(function(){function r(t,e){if(!Di(t)||!Di(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),r.prototype.reverse=function(){return new r(1/this.width,1/this.height)},r})();function Yc(r,t){return r instanceof yt&&r.shape.length===t}function T4(r){return Yc(r,2)}function Qc(r){return Yc(r,3)}function Ja(r){return Yc(r,4)}function D4(r){return r%1!==0}function r1(r){return r%2===0}function N4(r,t){t===void 0&&(t=2);var e=Math.pow(10,t);return Math.floor(r*e)/e}function a1(r){return r&&r.width&&r.height}function O4(r,t){var e=r.width,n=r.height,a=t/Math.max(n,e);return new Po(Math.round(e*a),Math.round(n*a))}function wv(r){return r.reduce(function(t,e){return t.add(e)},new tt(0,0)).div(new tt(r.length,r.length))}function us(r,t,e){return Array(r).fill(0).map(function(n,a){return t+a*e})}function Di(r){return!!r&&r!==1/0&&r!==-1/0&&!isNaN(r)||r===0}function i1(r){return Di(r)&&0<=r&&r<=1}var tt=(function(){function r(t,e){this._x=t,this._y=e}return Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),r.prototype.add=function(t){return new r(this.x+t.x,this.y+t.y)},r.prototype.sub=function(t){return new r(this.x-t.x,this.y-t.y)},r.prototype.mul=function(t){return new r(this.x*t.x,this.y*t.y)},r.prototype.div=function(t){return new r(this.x/t.x,this.y/t.y)},r.prototype.abs=function(){return new r(Math.abs(this.x),Math.abs(this.y))},r.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},r.prototype.floor=function(){return new r(Math.floor(this.x),Math.floor(this.y))},r})(),ei=(function(){function r(t,e){e===void 0&&(e=!0);var n=t||{},a=[n.left,n.top,n.right,n.bottom].every(Di),o=[n.x,n.y,n.width,n.height].every(Di);if(!o&&!a)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(n));var s=o?[n.x,n.y,n.width,n.height]:[n.left,n.top,n.right-n.left,n.bottom-n.top],l=s[0],f=s[1],h=s[2],p=s[3];r.assertIsValidBox({x:l,y:f,width:h,height:p},"Box.constructor",e),this._x=l,this._y=f,this._width=h,this._height=p}return r.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(Di)},r.assertIsValidBox=function(t,e,n){if(n===void 0&&(n=!1),!r.isRect(t))throw new Error(e+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!n&&(t.width<0||t.height<0))throw new Error(e+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new tt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topRight",{get:function(){return new tt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomLeft",{get:function(){return new tt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new tt(this.right,this.bottom)},enumerable:!0,configurable:!0}),r.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.round(s)}),e=t[0],n=t[1],a=t[2],o=t[3];return new r({x:e,y:n,width:a,height:o})},r.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(s){return Math.floor(s)}),e=t[0],n=t[1],a=t[2],o=t[3];return new r({x:e,y:n,width:a,height:o})},r.prototype.toSquare=function(){var t=this,e=t.x,n=t.y,a=t.width,o=t.height,s=Math.abs(a-o);return a<o&&(e-=s/2,a+=s),o<a&&(n-=s/2,o+=s),new r({x:e,y:n,width:a,height:o})},r.prototype.rescale=function(t){var e=a1(t)?t.width:t,n=a1(t)?t.height:t;return new r({x:this.x*e,y:this.y*n,width:this.width*e,height:this.height*n})},r.prototype.pad=function(t,e){var n=[this.x-t/2,this.y-e/2,this.width+t,this.height+e],a=n[0],o=n[1],s=n[2],l=n[3];return new r({x:a,y:o,width:s,height:l})},r.prototype.clipAtImageBorders=function(t,e){var n=this,a=n.x,o=n.y,s=n.right,l=n.bottom,f=Math.max(a,0),h=Math.max(o,0),p=s-f,v=l-h,m=Math.min(p,t-f),y=Math.min(v,e-h);return new r({x:f,y:h,width:m,height:y}).floor()},r.prototype.shift=function(t,e){var n=this,a=n.width,o=n.height,s=this.x+t,l=this.y+e;return new r({x:s,y:l,width:a,height:o})},r.prototype.padAtBorders=function(t,e){var n=this.width+1,a=this.height+1,o=1,s=1,l=n,f=a,h=this.left,p=this.top,v=this.right,m=this.bottom;return v>e&&(l=-v+e+n,v=e),m>t&&(f=-m+t+a,m=t),h<1&&(f=2-h,h=1),p<1&&(f=2-p,p=1),{dy:s,edy:f,dx:o,edx:l,y:p,ey:m,x:h,ex:v,w:n,h:a}},r.prototype.calibrate=function(t){return new r({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},r})(),Zc=(function(r){Be(t,r);function t(e,n,a,o,s){return s===void 0&&(s=!1),r.call(this,{left:e,top:n,right:a,bottom:o},s)||this}return t})(ei),O2=(function(){function r(t,e,n,a,o){this._imageDims=new Po(o.width,o.height),this._score=t,this._classScore=e,this._className=n,this._box=new ei(a).rescale(this._imageDims)}return Object.defineProperty(r.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativeBox",{get:function(){return new ei(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new r(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:e})},r})(),Vr=(function(r){Be(t,r);function t(e,n,a){return r.call(this,e,e,"",n,a)||this}return t.prototype.forSize=function(e,n){var a=r.prototype.forSize.call(this,e,n),o=a.score,s=a.relativeBox,l=a.imageDims;return new t(o,s,l)},t})(O2);function M4(r,t,e){e===void 0&&(e=!0);var n=Math.max(0,Math.min(r.right,t.right)-Math.max(r.left,t.left)),a=Math.max(0,Math.min(r.bottom,t.bottom)-Math.max(r.top,t.top)),o=n*a;return e?o/(r.area+t.area-o):o/Math.min(r.area,t.area)}function k4(r){var t=r.map(function(l){return l.x}),e=r.map(function(l){return l.y}),n=t.reduce(function(l,f){return f<l?f:l},1/0),a=e.reduce(function(l,f){return f<l?f:l},1/0),o=t.reduce(function(l,f){return l<f?f:l},0),s=e.reduce(function(l,f){return l<f?f:l},0);return new Zc(n,a,o,s)}function ss(r,t,e,n){n===void 0&&(n=!0);for(var a=t.map(function(l,f){return{score:l,boxIndex:f}}).sort(function(l,f){return l.score-f.score}).map(function(l){return l.boxIndex}),o=[],s=function(){var l=a.pop();o.push(l);for(var f=a,h=[],p=0;p<f.length;p++){var v=f[p],m=r[l],y=r[v];h.push(M4(m,y,n))}a=a.filter(function(x,E){return h[E]<=e})};a.length>0;)s();return o}function xs(r,t){return be(function(){var e=t[0],n=t[1],a=t[2],o=Fr(es(r.shape.slice(0,3),[1]),e),s=Fr(es(r.shape.slice(0,3),[1]),n),l=Fr(es(r.shape.slice(0,3),[1]),a),f=Lt([o,s,l],3);return Pt(r,f)})}function I4(r,t){return t===void 0&&(t=!1),be(function(){var e=r.shape.slice(1),n=e[0],a=e[1];if(n===a)return r;var o=Math.abs(n-a),s=Math.round(o*(t?.5:1)),l=n>a?2:1,f=function(y){var x=r.shape.slice();return x[l]=y,Fr(x,0)},h=f(s),p=o-h.shape[l],v=t&&p?f(p):null,m=[v,r,h].filter(function(y){return!!y}).map(function(y){return y.toFloat()});return Lt(m,l)})}function np(r){return 1/(1+Math.exp(-r))}var Ev=(function(r){Be(t,r);function t(e,n,a,o,s){return s===void 0&&(s=!1),r.call(this,{x:e,y:n,width:a,height:o},s)||this}return t})(ei),B4=.5,F4=.43,L4=.45,kc=(function(){function r(t,e,n){n===void 0&&(n=new tt(0,0));var a=e.width,o=e.height;this._imgDims=new Po(a,o),this._shift=n,this._positions=t.map(function(s){return s.mul(new tt(a,o)).add(n)})}return Object.defineProperty(r.prototype,"shift",{get:function(){return new tt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new tt(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),r.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},r.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new tt(t,e))},r.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},r.prototype.align=function(t,e){if(e===void 0&&(e={}),t){var n=t instanceof Vr?t.box.floor():new ei(t);return this.shiftBy(n.x,n.y).align(null,e)}var a=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),o=a.useDlibAlignment,s=a.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(s)},r.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],a=t[2],o=function(v){return a.sub(v).magnitude()},s=(o(e)+o(n))/2,l=Math.floor(s/L4),f=wv(t),h=Math.floor(Math.max(0,f.x-B4*l)),p=Math.floor(Math.max(0,f.y-F4*l));return new Ev(h,p,Math.min(l,this.imageWidth+h),Math.min(l,this.imageHeight+p))},r.prototype.alignMinBbox=function(t){var e=k4(this.positions);return e.pad(e.width*t,e.height*t)},r.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},r})(),z4=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],wv([e[3],e[4]])]},t})(kc),U4=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(wv)},t})(kc),o1=(function(){function r(t,e){this._label=t,this._distance=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),r.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+N4(this.distance)+")":"")},r})(),u1=(function(r){Be(t,r);function t(e,n){var a=r.call(this,e)||this;return a._label=n,a}return t.assertIsValidLabeledBox=function(e,n){if(ei.assertIsValidBox(e,n),!Di(e.label))throw new Error(n+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t})(ei),ec=(function(){function r(t,e){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(n){return!(n instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(r.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),r.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},r.fromJSON=function(t){var e=t.descriptors.map(function(n){return new Float32Array(n)});return new r(t.label,e)},r})();(function(r){Be(t,r);function t(e,n,a,o){var s=r.call(this,e,n)||this;return s._score=a,s._classScore=o,s}return t.assertIsValidPredictedBox=function(e,n){if(u1.assertIsValidLabeledBox(e,n),!i1(e.score)||!i1(e.classScore))throw new Error(n+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(u1);function P4(r){return r.detection instanceof Vr}function Cv(r,t){var e={detection:t};return Object.assign({},r,e)}function M2(){var r=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:r,readFile:t}}function k2(r){var t="";if(!r)try{r=require("fs")}catch(n){t=n.toString()}var e=r?function(n){return new Promise(function(a,o){r.readFile(n,function(s,l){return s?o(s):a(l)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:e}}function I2(){var r=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,e=function(){if(r)return new r;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},n=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},a=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=k2();return on({Canvas:r||(function(){function s(){}return s})(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||(function(){function s(){}return s})(),Image:t||(function(){function s(){}return s})(),ImageData:global.ImageData||(function(){function s(){}return s})(),Video:global.HTMLVideoElement||(function(){function s(){}return s})(),createCanvasElement:e,createImageElement:n,fetch:a},o)}function B2(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function F2(){return typeof global=="object"&&typeof require=="function"&&typeof Vw<"u"&&typeof process<"u"&&!!process.version}var Ft;function H4(){if(!Ft)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Ft}function Mp(r){Ft=r}function _v(){B2()&&Mp(M2()),F2()&&Mp(I2())}function V4(r){if(Ft||_v(),!Ft)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=r.Canvas,e=t===void 0?Ft.Canvas:t,n=r.Image,a=n===void 0?Ft.Image:n;Ft.Canvas=e,Ft.Image=a,Ft.createCanvasElement=r.createCanvasElement||(function(){return new e}),Ft.createImageElement=r.createImageElement||(function(){return new a}),Ft.ImageData=r.ImageData||Ft.ImageData,Ft.Video=r.Video||Ft.Video,Ft.fetch=r.fetch||Ft.fetch,Ft.readFile=r.readFile||Ft.readFile}var fn={getEnv:H4,setEnv:Mp,initialize:_v,createBrowserEnv:M2,createFileSystem:k2,createNodejsEnv:I2,monkeyPatch:V4,isBrowser:B2,isNodejs:F2};_v();function L2(r){return!fn.isNodejs()&&typeof r=="string"?document.getElementById(r):r}function Mi(r){var t=fn.getEnv(),e=t.Canvas,n=t.CanvasRenderingContext2D;if(r instanceof n)return r;var a=L2(r);if(!(a instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=a.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}var s1;(function(r){r.TOP_LEFT="TOP_LEFT",r.TOP_RIGHT="TOP_RIGHT",r.BOTTOM_LEFT="BOTTOM_LEFT",r.BOTTOM_RIGHT="BOTTOM_RIGHT"})(s1||(s1={}));function z2(r){var t=fn.getEnv(),e=t.Image,n=t.Video;return r instanceof e&&r.complete||r instanceof n&&r.readyState>=3}function W4(r){return new Promise(function(t,e){if(r instanceof fn.getEnv().Canvas||z2(r))return t();function n(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",n),o.currentTarget.removeEventListener("error",a),t(o))}function a(o){o.currentTarget&&(o.currentTarget.removeEventListener("load",n),o.currentTarget.removeEventListener("error",a),e(o))}r.addEventListener("load",n),r.addEventListener("error",a)})}function U2(r){var t=fn.getEnv(),e=t.Image,n=t.Video;return r instanceof e?new Po(r.naturalWidth,r.naturalHeight):r instanceof n?new Po(r.videoWidth,r.videoHeight):new Po(r.width,r.height)}function Jc(r){var t=r.width,e=r.height,n=fn.getEnv().createCanvasElement,a=n();return a.width=t,a.height=e,a}function Sv(r,t){var e=fn.getEnv().ImageData;if(!(r instanceof e)&&!z2(r))throw new Error("createCanvasFromMedia - media has not finished loading yet");var n=U2(r),a=n.width,o=n.height,s=Jc({width:a,height:o});return r instanceof e?Mi(s).putImageData(r,0,0):Mi(s).drawImage(r,0,0,a,o),s}function j4(r,t){return Ae(this,void 0,void 0,function(){var e,n,a,o,s,l;return Te(this,function(f){switch(f.label){case 0:return e=fn.getEnv().createCanvasElement(),n=r.shape.slice(Ja(r)?1:0),a=n[0],o=n[1],s=n[2],l=be(function(){return r.as3D(a,o,s).toInt()}),[4,xv.toPixels(l,e)];case 1:return f.sent(),l.dispose(),[2,e]}})})}function l1(r){var t=fn.getEnv(),e=t.Image,n=t.Canvas,a=t.Video;return r instanceof e||r instanceof n||r instanceof a}function G4(r,t,e){e===void 0&&(e=!1);var n=fn.getEnv(),a=n.Image,o=n.Canvas;if(!(r instanceof a||r instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var s=U2(r),l=t/Math.max(s.height,s.width),f=l*s.width,h=l*s.height,p=Jc({width:t,height:t}),v=r instanceof o?r:Sv(r),m=Math.abs(f-h)/2,y=e&&f<h?m:0,x=e&&h<f?m:0;return Mi(p).drawImage(v,y,x,f,h),p}var Ic=(function(){function r(t,e){var n=this;if(e===void 0&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(a,o){if(Qc(a)){n._imageTensors[o]=a,n._inputDimensions[o]=a.shape;return}if(Ja(a)){var s=a.shape[0];if(s!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+s+" passed, but not supported in input array");n._imageTensors[o]=a,n._inputDimensions[o]=a.shape.slice(1);return}var l=a instanceof fn.getEnv().Canvas?a:Sv(a);n._canvases[o]=l,n._inputDimensions[o]=[l.height,l.width,3]})}return Object.defineProperty(r.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"reshapedInputDimensions",{get:function(){var t=this;return us(this.batchSize,0,1).map(function(e,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),r.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},r.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},r.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},r.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},r.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),n=this.getInputHeight(t);return O4({width:e,height:n},this.inputSize)},r.prototype.toBatchTensor=function(t,e){var n=this;return e===void 0&&(e=!0),this._inputSize=t,be(function(){var a=us(n.batchSize,0,1).map(function(s){var l=n.getInput(s);if(l instanceof yt){var f=Ja(l)?l:l.expandDims();return f=I4(f,e),(f.shape[1]!==t||f.shape[2]!==t)&&(f=pv.resizeBilinear(f,[t,t])),f.as3D(t,t,3)}if(l instanceof fn.getEnv().Canvas)return xv.fromPixels(G4(l,t,e));throw new Error("toBatchTensor - at batchIdx "+s+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+l)}),o=qn(a.map(function(s){return s.toFloat()})).as4D(n.batchSize,t,t,3);return o})},r})();function qt(r){return Ae(this,void 0,void 0,function(){var t,e,n;return Te(this,function(a){switch(a.label){case 0:if(r instanceof Ic)return[2,r];if(t=Array.isArray(r)?r:[r],!t.length)throw new Error("toNetInput - empty array passed as input");return e=function(o){return Array.isArray(r)?" at input index "+o+":":""},n=t.map(L2),n.forEach(function(o,s){if(!l1(o)&&!Qc(o)&&!Ja(o))throw typeof t[s]=="string"?new Error("toNetInput -"+e(s)+" string passed, but could not resolve HTMLElement for element id "+t[s]):new Error("toNetInput -"+e(s)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ja(o)){var l=o.shape[0];if(l!==1)throw new Error("toNetInput -"+e(s)+" tf.Tensor4D with batchSize "+l+" passed, but not supported in input array")}}),[4,Promise.all(n.map(function(o){return l1(o)&&W4(o)}))];case 1:return a.sent(),[2,new Ic(n,Array.isArray(r))]}})})}function Rv(r,t){return Ae(this,void 0,void 0,function(){var e,n,a,o,s,l,f;return Te(this,function(h){switch(h.label){case 0:return e=fn.getEnv().Canvas,n=r,r instanceof e?[3,5]:[4,qt(r)];case 1:if(a=h.sent(),a.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=a.getInput(0),o instanceof e?(s=o,[3,4]):[3,2];case 2:return[4,j4(o)];case 3:s=h.sent(),h.label=4;case 4:n=s,h.label=5;case 5:return l=Mi(n),f=t.map(function(p){return p instanceof Vr?p.forSize(n.width,n.height).box.floor():p}).map(function(p){return p.clipAtImageBorders(n.width,n.height)}),[2,f.map(function(p){var v=p.x,m=p.y,y=p.width,x=p.height,E=Jc({width:y,height:x});return Mi(E).putImageData(l.getImageData(v,m,y,x),0,0),E})]}})})}function Av(r,t){return Ae(this,void 0,void 0,function(){return Te(this,function(e){if(!Qc(r)&&!Ja(r))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ja(r)&&r.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,be(function(){var n=r.shape.slice(Ja(r)?1:0),a=n[0],o=n[1],s=n[2],l=t.map(function(h){return h instanceof Vr?h.forSize(o,a).box:h}).map(function(h){return h.clipAtImageBorders(o,a)}),f=l.map(function(h){var p=h.x,v=h.y,m=h.width,y=h.height;return h2(r.as3D(a,o,s),[v,p,0],[y,m,s])});return f})]})})}function q4(r,t){return Ae(this,void 0,void 0,function(){var e,n;return Te(this,function(a){switch(a.label){case 0:return e=fn.getEnv().fetch,[4,e(r,t)];case 1:if(n=a.sent(),!(n.status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}})})}function X4(r){return Ae(this,void 0,void 0,function(){return Te(this,function(t){switch(t.label){case 0:return[4,q4(r)];case 1:return[2,t.sent().json()]}})})}function P2(r,t){var e=t+"-weights_manifest.json";if(!r)return{modelBaseUri:"",manifestUri:e};if(r==="/")return{modelBaseUri:"/",manifestUri:"/"+e};var n=r.startsWith("http://")?"http://":r.startsWith("https://")?"https://":"";r=r.replace(n,"");var a=r.split("/").filter(function(l){return l}),o=r.endsWith(".json")?a[a.length-1]:e,s=n+(r.endsWith(".json")?a.slice(0,a.length-1):a).join("/");return s=r.startsWith("/")?"/"+s:s,{modelBaseUri:s,manifestUri:s==="/"?"/"+o:s+"/"+o}}function K4(r,t){return Ae(this,void 0,void 0,function(){var e,n,a,o;return Te(this,function(s){switch(s.label){case 0:return e=P2(r,t),n=e.manifestUri,a=e.modelBaseUri,[4,X4(n)];case 1:return o=s.sent(),[2,D2.loadWeights(o,a)]}})})}var ba=(function(){function r(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(r.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),r.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),n=e.obj,a=e.objProp;return n[a]},r.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),a=n.obj,o=n.objProp;a[o].dispose(),a[o]=e},r.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},r.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Wo})},r.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Wo)})},r.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var n=e.path,a=e.tensor;t.reassignParamFromPath(n,a.variable())})},r.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var n=e.path,a=e.tensor,o=nn(a.dataSync());a.dispose(),t.reassignParamFromPath(n,o)})},r.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},r.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var e=t.tensor;return Array.from(e.dataSync())}).reduce(function(t,e){return t.concat(e)}))},r.prototype.load=function(t){return Ae(this,void 0,void 0,function(){return Te(this,function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},r.prototype.loadFromUri=function(t){return Ae(this,void 0,void 0,function(){var e;return Te(this,function(n){switch(n.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,K4(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}})})},r.prototype.loadFromDisk=function(t){return Ae(this,void 0,void 0,function(){var e,n,a,o,s,l,f,h,p,v;return Te(this,function(m){switch(m.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return e=fn.getEnv().readFile,n=P2(t,this.getDefaultModelName()),a=n.manifestUri,o=n.modelBaseUri,s=function(y){return Promise.all(y.map(function(x){return e(x).then(function(E){return E.buffer})}))},l=D2.weightsLoaderFactory(s),p=(h=JSON).parse,[4,e(a)];case 1:return f=p.apply(h,[m.sent().toString()]),[4,l(f,o)];case 2:return v=m.sent(),this.loadFromWeightMap(v),[2]}})})},r.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,a=e.params;this._paramMappings=n,this._params=a},r.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(o,s){if(!o.nextObj.hasOwnProperty(s))throw new Error("traversePropertyPath - object does not have property "+s+", for path "+t);return{obj:o.nextObj,objProp:s,nextObj:o.nextObj[s]}},{nextObj:this.params}),n=e.obj,a=e.objProp;if(!n||!a||!(n[a]instanceof yt))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:a}},r})();function Gn(r,t,e){return be(function(){var n=lv(r,t.depthwise_filter,t.pointwise_filter,e,"same");return n=Ve(n,t.bias),n})}function rp(r,t,e){return e===void 0&&(e=!1),be(function(){var n=bt(e?Ve(lr(r,t.conv0.filters,[2,2],"same"),t.conv0.bias):Gn(r,t.conv0,[2,2])),a=Gn(n,t.conv1,[1,1]),o=bt(Ve(n,a)),s=Gn(o,t.conv2,[1,1]);return bt(Ve(n,Ve(a,s)))})}function tc(r,t,e,n){return e===void 0&&(e=!1),n===void 0&&(n=!0),be(function(){var a=bt(e?Ve(lr(r,t.conv0.filters,n?[2,2]:[1,1],"same"),t.conv0.bias):Gn(r,t.conv0,n?[2,2]:[1,1])),o=Gn(a,t.conv1,[1,1]),s=bt(Ve(a,o)),l=Gn(s,t.conv2,[1,1]),f=bt(Ve(a,Ve(o,l))),h=Gn(f,t.conv3,[1,1]);return bt(Ve(a,Ve(o,Ve(l,h))))})}function gr(r,t,e,n){return e===void 0&&(e="same"),n===void 0&&(n=!1),be(function(){var a=Ve(lr(r,t.filters,[1,1],e),t.bias);return n?bt(a):a})}function xa(r,t){Object.keys(r).forEach(function(e){t.some(function(n){return n.originalPath===e})||r[e].dispose()})}function $c(r,t){return function(e,n,a,o){var s=_n(r(e*n*a*a),[a,a,e,n]),l=It(r(n));return t.push({paramPath:o+"/filters"},{paramPath:o+"/bias"}),{filters:s,bias:l}}}function Tv(r,t){return function(e,n,a){var o=Qa(r(e*n),[e,n]),s=It(r(n));return t.push({paramPath:a+"/weights"},{paramPath:a+"/bias"}),{weights:o,bias:s}}}var H2=(function(){function r(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n}return r})();function Dv(r,t){return function(e,n,a){var o=_n(r(9*e),[3,3,e,1]),s=_n(r(e*n),[1,1,e,n]),l=It(r(n));return t.push({paramPath:a+"/depthwise_filter"},{paramPath:a+"/pointwise_filter"},{paramPath:a+"/bias"}),new H2(o,s,l)}}function Nv(r){return function(t){var e=r(t+"/depthwise_filter",4),n=r(t+"/pointwise_filter",4),a=r(t+"/bias",1);return new H2(e,n,a)}}function ri(r,t){return function(e,n,a){var o=r[e];if(!Yc(o,n))throw new Error("expected weightMap["+e+"] to be a Tensor"+n+"D, instead have "+o);return t.push({originalPath:e,paramPath:a||e}),o}}function wa(r){var t=r;function e(a){var o=t.slice(0,a);return t=t.slice(a),o}function n(){return t}return{extractWeights:e,getRemainingWeights:n}}function V2(r,t){var e=$c(r,t),n=Dv(r,t);function a(s,l,f,h){h===void 0&&(h=!1);var p=h?e(s,l,3,f+"/conv0"):n(s,l,f+"/conv0"),v=n(l,l,f+"/conv1"),m=n(l,l,f+"/conv2");return{conv0:p,conv1:v,conv2:m}}function o(s,l,f,h){h===void 0&&(h=!1);var p=a(s,l,f,h),v=p.conv0,m=p.conv1,y=p.conv2,x=n(l,l,f+"/conv3");return{conv0:v,conv1:m,conv2:y,conv3:x}}return{extractDenseBlock3Params:a,extractDenseBlock4Params:o}}function Y4(r){var t=[],e=wa(r),n=e.extractWeights,a=e.getRemainingWeights,o=V2(n,t).extractDenseBlock4Params,s=o(3,32,"dense0",!0),l=o(32,64,"dense1"),f=o(64,128,"dense2"),h=o(128,256,"dense3");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:s,dense1:l,dense2:f,dense3:h}}}function W2(r){return function(t){var e=r(t+"/filters",4),n=r(t+"/bias",1);return{filters:e,bias:n}}}function j2(r,t){var e=ri(r,t),n=W2(e),a=Nv(e);function o(l,f){f===void 0&&(f=!1);var h=f?n(l+"/conv0"):a(l+"/conv0"),p=a(l+"/conv1"),v=a(l+"/conv2");return{conv0:h,conv1:p,conv2:v}}function s(l,f){f===void 0&&(f=!1);var h=f?n(l+"/conv0"):a(l+"/conv0"),p=a(l+"/conv1"),v=a(l+"/conv2"),m=a(l+"/conv3");return{conv0:h,conv1:p,conv2:v,conv3:m}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:s}}function Q4(r){var t=[],e=j2(r,t).extractDenseBlock4Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return xa(r,t),{params:n,paramMappings:t}}var G2=(function(r){Be(t,r);function t(){return r.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceFeatureExtractor - load model before inference");return be(function(){var a=e.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=xs(a,o).div(ge(255)),l=tc(s,n.dense0,!0);return l=tc(l,n.dense1),l=tc(l,n.dense2),l=tc(l,n.dense3),l=ys(l,[7,7],[2,2],"valid"),l})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Q4(e)},t.prototype.extractParams=function(e){return Y4(e)},t})(ba);function kr(r,t){return be(function(){return Ve(qc(r,t.weights),t.bias)})}function Z4(r,t,e){var n=[],a=wa(r),o=a.extractWeights,s=a.getRemainingWeights,l=Tv(o,n),f=l(t,e,"fc");if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{paramMappings:n,params:{fc:f}}}function J4(r){var t=[],e=ri(r,t);function n(o){var s=e(o+"/weights",2),l=e(o+"/bias",1);return{weights:s,bias:l}}var a={fc:n("fc")};return xa(r,t),{params:a,paramMappings:t}}function q2(r){var t={},e={};return Object.keys(r).forEach(function(n){var a=n.startsWith("fc")?e:t;a[n]=r[n]}),{featureExtractorMap:t,classifierMap:e}}var X2=(function(r){Be(t,r);function t(e,n){var a=r.call(this,e)||this;return a._faceFeatureExtractor=n,a}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return be(function(){var o=e instanceof Ic?n.faceFeatureExtractor.forwardInput(e):e;return kr(o.as2D(o.shape[0],-1),a.fc)})},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,o=n.paramMappings;this._params=a,this._paramMappings=o},t.prototype.extractClassifierParams=function(e){return Z4(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var n=q2(e),a=n.featureExtractorMap,o=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),J4(o)},t.prototype.extractParams=function(e){var n=this.getClassifierChannelsIn(),a=this.getClassifierChannelsOut(),o=a*n+a,s=e.slice(0,e.length-o),l=e.slice(e.length-o);return this.faceFeatureExtractor.extractWeights(s),this.extractClassifierParams(l)},t})(ba),c1=["neutral","happy","sad","angry","fearful","disgusted","surprised"],$4=(function(){function r(t){var e=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);c1.forEach(function(n,a){e[n]=t[a]})}return r.prototype.asSortedArray=function(){var t=this;return c1.map(function(e){return{expression:e,probability:t[e]}}).sort(function(e,n){return n.probability-e.probability})},r})(),eO=(function(r){Be(t,r);function t(e){return e===void 0&&(e=new G2),r.call(this,"FaceExpressionNet",e)||this}return t.prototype.forwardInput=function(e){var n=this;return be(function(){return ga(n.runNet(e))})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictExpressions=function(e){return Ae(this,void 0,void 0,function(){var n,a,o,s,l=this;return Te(this,function(f){switch(f.label){case 0:return[4,qt(e)];case 1:return n=f.sent(),[4,this.forwardInput(n)];case 2:return a=f.sent(),[4,Promise.all(zt(a).map(function(h){return Ae(l,void 0,void 0,function(){var p;return Te(this,function(v){switch(v.label){case 0:return[4,h.data()];case 1:return p=v.sent(),h.dispose(),[2,p]}})})}))];case 3:return o=f.sent(),a.dispose(),s=o.map(function(h){return new $4(h)}),[2,n.isBatchInput?s:s[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t})(X2);function K2(r,t){var e={expressions:t};return Object.assign({},r,e)}function tO(r){return P4(r)&&r.landmarks instanceof kc&&r.unshiftedLandmarks instanceof kc&&r.alignedRect instanceof Vr}function Ov(r,t){var e=r.detection.box,n=t.shiftBy(e.x,e.y),a=n.align(),o=r.detection.imageDims,s=new Vr(r.detection.score,a.rescale(o.reverse()),o),l={landmarks:n,unshiftedLandmarks:t,alignedRect:s};return Object.assign({},r,l)}function nO(r,t){var e=$c(r,t),n=Dv(r,t);function a(s,l,f){var h=n(s,l,f+"/separable_conv0"),p=n(l,l,f+"/separable_conv1"),v=e(s,l,1,f+"/expansion_conv");return{separable_conv0:h,separable_conv1:p,expansion_conv:v}}function o(s,l){var f=n(s,s,l+"/separable_conv0"),h=n(s,s,l+"/separable_conv1"),p=n(s,s,l+"/separable_conv2");return{separable_conv0:f,separable_conv1:h,separable_conv2:p}}return{extractConvParams:e,extractSeparableConvParams:n,extractReductionBlockParams:a,extractMainBlockParams:o}}function rO(r,t){var e=[],n=wa(r),a=n.extractWeights,o=n.getRemainingWeights,s=nO(a,e),l=s.extractConvParams,f=s.extractSeparableConvParams,h=s.extractReductionBlockParams,p=s.extractMainBlockParams,v=l(3,32,3,"entry_flow/conv_in"),m=h(32,64,"entry_flow/reduction_block_0"),y=h(64,128,"entry_flow/reduction_block_1"),x={conv_in:v,reduction_block_0:m,reduction_block_1:y},E={};us(t,0,1).forEach(function(R){E["main_block_"+R]=p(128,"middle_flow/main_block_"+R)});var w=h(128,256,"exit_flow/reduction_block"),C=f(256,512,"exit_flow/separable_conv"),_={reduction_block:w,separable_conv:C};if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{entry_flow:x,middle_flow:E,exit_flow:_}}}function aO(r,t){var e=ri(r,t),n=W2(e),a=Nv(e);function o(l){var f=a(l+"/separable_conv0"),h=a(l+"/separable_conv1"),p=n(l+"/expansion_conv");return{separable_conv0:f,separable_conv1:h,expansion_conv:p}}function s(l){var f=a(l+"/separable_conv0"),h=a(l+"/separable_conv1"),p=a(l+"/separable_conv2");return{separable_conv0:f,separable_conv1:h,separable_conv2:p}}return{extractConvParams:n,extractSeparableConvParams:a,extractReductionBlockParams:o,extractMainBlockParams:s}}function iO(r,t){var e=[],n=aO(r,e),a=n.extractConvParams,o=n.extractSeparableConvParams,s=n.extractReductionBlockParams,l=n.extractMainBlockParams,f=a("entry_flow/conv_in"),h=s("entry_flow/reduction_block_0"),p=s("entry_flow/reduction_block_1"),v={conv_in:f,reduction_block_0:h,reduction_block_1:p},m={};us(t,0,1).forEach(function(w){m["main_block_"+w]=l("middle_flow/main_block_"+w)});var y=s("exit_flow/reduction_block"),x=o("exit_flow/separable_conv"),E={reduction_block:y,separable_conv:x};return xa(r,e),{params:{entry_flow:v,middle_flow:m,exit_flow:E},paramMappings:e}}function Y2(r,t,e){return Ve(lr(r,t.filters,e,"same"),t.bias)}function ap(r,t,e){e===void 0&&(e=!0);var n=e?bt(r):r;return n=Gn(n,t.separable_conv0,[1,1]),n=Gn(bt(n),t.separable_conv1,[1,1]),n=jt(n,[3,3],[2,2],"same"),n=Ve(n,Y2(r,t.expansion_conv,[2,2])),n}function oO(r,t){var e=Gn(bt(r),t.separable_conv0,[1,1]);return e=Gn(bt(e),t.separable_conv1,[1,1]),e=Gn(bt(e),t.separable_conv2,[1,1]),e=Ve(e,r),e}var uO=(function(r){Be(t,r);function t(e){var n=r.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return t.prototype.forwardInput=function(e){var n=this,a=this.params;if(!a)throw new Error("TinyXception - load model before inference");return be(function(){var o=e.toBatchTensor(112,!0),s=[122.782,117.001,104.298],l=xs(o,s).div(ge(256)),f=bt(Y2(l,a.entry_flow.conv_in,[2,2]));return f=ap(f,a.entry_flow.reduction_block_0,!1),f=ap(f,a.entry_flow.reduction_block_1),us(n._numMainBlocks,0,1).forEach(function(h){f=oO(f,a.middle_flow["main_block_"+h])}),f=ap(f,a.exit_flow.reduction_block),f=bt(Gn(f,a.exit_flow.separable_conv,[1,1])),f})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return iO(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return rO(e,this._numMainBlocks)},t})(ba);function sO(r){var t=[],e=wa(r),n=e.extractWeights,a=e.getRemainingWeights,o=Tv(n,t),s=o(512,1,"fc/age"),l=o(512,2,"fc/gender");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{fc:{age:s,gender:l}}}}function lO(r){var t=[],e=ri(r,t);function n(o){var s=e(o+"/weights",2),l=e(o+"/bias",1);return{weights:s,bias:l}}var a={fc:{age:n("fc/age"),gender:n("fc/gender")}};return xa(r,t),{params:a,paramMappings:t}}var Bc;(function(r){r.FEMALE="female",r.MALE="male"})(Bc||(Bc={}));var cO=(function(r){Be(t,r);function t(e){e===void 0&&(e=new uO(2));var n=r.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var n=this,a=this.params;if(!a)throw new Error(this._name+" - load model before inference");return be(function(){var o=e instanceof Ic?n.faceFeatureExtractor.forwardInput(e):e,s=ys(o,[7,7],[2,2],"valid").as2D(o.shape[0],-1),l=kr(s,a.fc.age).as1D(),f=kr(s,a.fc.gender);return{age:l,gender:f}})},t.prototype.forwardInput=function(e){var n=this;return be(function(){var a=n.runNet(e),o=a.age,s=a.gender;return{age:o,gender:ga(s)}})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.predictAgeAndGender=function(e){return Ae(this,void 0,void 0,function(){var n,a,o,s,l,f,h=this;return Te(this,function(p){switch(p.label){case 0:return[4,qt(e)];case 1:return n=p.sent(),[4,this.forwardInput(n)];case 2:return a=p.sent(),o=zt(a.age),s=zt(a.gender),l=o.map(function(v,m){return{ageTensor:v,genderTensor:s[m]}}),[4,Promise.all(l.map(function(v){var m=v.ageTensor,y=v.genderTensor;return Ae(h,void 0,void 0,function(){var x,E,w,C,_;return Te(this,function(R){switch(R.label){case 0:return[4,m.data()];case 1:return x=R.sent()[0],[4,y.data()];case 2:return E=R.sent()[0],w=E>.5,C=w?Bc.MALE:Bc.FEMALE,_=w?E:1-E,m.dispose(),y.dispose(),[2,{age:x,gender:C,genderProbability:_}]}})})}))];case 3:return f=p.sent(),a.age.dispose(),a.gender.dispose(),[2,n.isBatchInput?f:f[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(e){e===void 0&&(e=!0),this.faceFeatureExtractor.dispose(e),r.prototype.dispose.call(this,e)},t.prototype.loadClassifierParams=function(e){var n=this.extractClassifierParams(e),a=n.params,o=n.paramMappings;this._params=a,this._paramMappings=o},t.prototype.extractClassifierParams=function(e){return sO(e)},t.prototype.extractParamsFromWeigthMap=function(e){var n=q2(e),a=n.featureExtractorMap,o=n.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(a),lO(o)},t.prototype.extractParams=function(e){var n=1539,a=e.slice(0,e.length-n),o=e.slice(e.length-n);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(o)},t})(ba),Q2=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.postProcess=function(e,n,a){var o=a.map(function(l){var f=l.width,h=l.height,p=n/Math.max(h,f);return{width:f*p,height:h*p}}),s=o.length;return be(function(){var l=function(m,y){return qn([Fr([68],m),Fr([68],y)],1).as2D(1,136).as1D()},f=function(m,y){var x=o[m],E=x.width,w=x.height;return y(E,w)?Math.abs(E-w)/2:0},h=function(m){return f(m,function(y,x){return y<x})},p=function(m){return f(m,function(y,x){return x<y})},v=e.mul(Fr([s,136],n)).sub(qn(Array.from(Array(s),function(m,y){return l(h(y),p(y))}))).div(qn(Array.from(Array(s),function(m,y){return l(o[y].width,o[y].height)})));return v})},t.prototype.forwardInput=function(e){var n=this;return be(function(){var a=n.runNet(e);return n.postProcess(a,e.inputSize,e.inputDimensions.map(function(o){var s=o[0],l=o[1];return{height:s,width:l}}))})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.detectLandmarks=function(e){return Ae(this,void 0,void 0,function(){var n,a,o,s=this;return Te(this,function(l){switch(l.label){case 0:return[4,qt(e)];case 1:return n=l.sent(),a=be(function(){return zt(s.forwardInput(n))}),[4,Promise.all(a.map(function(f,h){return Ae(s,void 0,void 0,function(){var p,v,m,y,x;return Te(this,function(E){switch(E.label){case 0:return m=(v=Array).from,[4,f.data()];case 1:return p=m.apply(v,[E.sent()]),y=p.filter(function(w,C){return r1(C)}),x=p.filter(function(w,C){return!r1(C)}),[2,new U4(Array(68).fill(0).map(function(w,C){return new tt(y[C],x[C])}),{height:n.getInputHeight(h),width:n.getInputWidth(h)})]}})})}))];case 2:return o=l.sent(),a.forEach(function(f){return f.dispose()}),[2,n.isBatchInput?o:o[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t})(X2),Z2=(function(r){Be(t,r);function t(e){return e===void 0&&(e=new G2),r.call(this,"FaceLandmark68Net",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t})(Q2);function fO(r){var t=[],e=j2(r,t).extractDenseBlock3Params,n={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return xa(r,t),{params:n,paramMappings:t}}function hO(r){var t=[],e=wa(r),n=e.extractWeights,a=e.getRemainingWeights,o=V2(n,t).extractDenseBlock3Params,s=o(3,32,"dense0",!0),l=o(32,64,"dense1"),f=o(64,128,"dense2");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:t,params:{dense0:s,dense1:l,dense2:f}}}var dO=(function(r){Be(t,r);function t(){return r.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("TinyFaceFeatureExtractor - load model before inference");return be(function(){var a=e.toBatchTensor(112,!0),o=[122.782,117.001,104.298],s=xs(a,o).div(ge(255)),l=rp(s,n.dense0,!0);return l=rp(l,n.dense1),l=rp(l,n.dense2),l=ys(l,[14,14],[2,2],"valid"),l})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return fO(e)},t.prototype.extractParams=function(e){return hO(e)},t})(ba),pO=(function(r){Be(t,r);function t(e){return e===void 0&&(e=new dO),r.call(this,"FaceLandmark68TinyNet",e)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t})(Q2);(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(Z2);function vO(r,t){return Ve(cn(r,t.weights),t.biases)}function Mv(r,t,e,n,a){a===void 0&&(a="same");var o=t.conv,s=o.filters,l=o.bias,f=lr(r,s,e,a);return f=Ve(f,l),f=vO(f,t.scale),n?bt(f):f}function mO(r,t){return Mv(r,t,[1,1],!0)}function J2(r,t){return Mv(r,t,[1,1],!1)}function $2(r,t){return Mv(r,t,[2,2],!0,"valid")}function gO(r,t){function e(l,f,h){var p=r(l),v=p.length/(f*h*h);if(D4(v))throw new Error("depth has to be an integer: "+v+", weights.length: "+p.length+", numFilters: "+f+", filterSize: "+h);return be(function(){return $a(_n(p,[f,v,h,h]),[2,3,1,0])})}function n(l,f,h,p){var v=e(l,f,h),m=It(r(f));return t.push({paramPath:p+"/filters"},{paramPath:p+"/bias"}),{filters:v,bias:m}}function a(l,f){var h=It(r(l)),p=It(r(l));return t.push({paramPath:f+"/weights"},{paramPath:f+"/biases"}),{weights:h,biases:p}}function o(l,f,h,p){var v=n(l,f,h,p+"/conv"),m=a(f,p+"/scale");return{conv:v,scale:m}}function s(l,f,h,p,v){v===void 0&&(v=!1);var m=o((v?.5:1)*l,f,h,p+"/conv1"),y=o(l,f,h,p+"/conv2");return{conv1:m,conv2:y}}return{extractConvLayerParams:o,extractResidualLayerParams:s}}function yO(r){var t=wa(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],o=gO(e,a),s=o.extractConvLayerParams,l=o.extractResidualLayerParams,f=s(4704,32,7,"conv32_down"),h=l(9216,32,3,"conv32_1"),p=l(9216,32,3,"conv32_2"),v=l(9216,32,3,"conv32_3"),m=l(36864,64,3,"conv64_down",!0),y=l(36864,64,3,"conv64_1"),x=l(36864,64,3,"conv64_2"),E=l(36864,64,3,"conv64_3"),w=l(147456,128,3,"conv128_down",!0),C=l(147456,128,3,"conv128_1"),_=l(147456,128,3,"conv128_2"),R=l(589824,256,3,"conv256_down",!0),A=l(589824,256,3,"conv256_1"),T=l(589824,256,3,"conv256_2"),N=l(589824,256,3,"conv256_down_out"),M=be(function(){return $a(Qa(e(256*128),[128,256]),[1,0])});if(a.push({paramPath:"fc"}),n().length!==0)throw new Error("weights remaing after extract: "+n().length);var I={conv32_down:f,conv32_1:h,conv32_2:p,conv32_3:v,conv64_down:m,conv64_1:y,conv64_2:x,conv64_3:E,conv128_down:w,conv128_1:C,conv128_2:_,conv256_down:R,conv256_1:A,conv256_2:T,conv256_down_out:N,fc:M};return{params:I,paramMappings:a}}function bO(r,t){var e=ri(r,t);function n(s){var l=e(s+"/scale/weights",1),f=e(s+"/scale/biases",1);return{weights:l,biases:f}}function a(s){var l=e(s+"/conv/filters",4),f=e(s+"/conv/bias",1),h=n(s);return{conv:{filters:l,bias:f},scale:h}}function o(s){return{conv1:a(s+"/conv1"),conv2:a(s+"/conv2")}}return{extractConvLayerParams:a,extractResidualLayerParams:o}}function xO(r){var t=[],e=bO(r,t),n=e.extractConvLayerParams,a=e.extractResidualLayerParams,o=n("conv32_down"),s=a("conv32_1"),l=a("conv32_2"),f=a("conv32_3"),h=a("conv64_down"),p=a("conv64_1"),v=a("conv64_2"),m=a("conv64_3"),y=a("conv128_down"),x=a("conv128_1"),E=a("conv128_2"),w=a("conv256_down"),C=a("conv256_1"),_=a("conv256_2"),R=a("conv256_down_out"),A=r.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!T4(A))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+A);var T={conv32_down:o,conv32_1:s,conv32_2:l,conv32_3:f,conv64_down:h,conv64_1:p,conv64_2:v,conv64_3:m,conv128_down:y,conv128_1:x,conv128_2:E,conv256_down:w,conv256_1:C,conv256_2:_,conv256_down_out:R,fc:A};return xa(r,t),{params:T,paramMappings:t}}function Ar(r,t){var e=mO(r,t.conv1);return e=J2(e,t.conv2),e=Ve(e,r),e=bt(e),e}function nc(r,t){var e=$2(r,t.conv1);e=J2(e,t.conv2);var n=ys(r,2,2,"valid"),a=mt(n.shape),o=n.shape[3]!==e.shape[3],s=n.shape[1]!==e.shape[1]||n.shape[2]!==e.shape[2];if(s){var l=es(e.shape);l[1]=1;var f=mt(l);e=Lt([e,f],1);var h=es(e.shape);h[2]=1;var p=mt(h);e=Lt([e,p],2)}return n=o?Lt([n,a],3):n,e=Ve(n,e),e=bt(e),e}var wO=(function(r){Be(t,r);function t(){return r.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("FaceRecognitionNet - load model before inference");return be(function(){var a=e.toBatchTensor(150,!0).toFloat(),o=[122.782,117.001,104.298],s=xs(a,o).div(ge(256)),l=$2(s,n.conv32_down);l=jt(l,3,2,"valid"),l=Ar(l,n.conv32_1),l=Ar(l,n.conv32_2),l=Ar(l,n.conv32_3),l=nc(l,n.conv64_down),l=Ar(l,n.conv64_1),l=Ar(l,n.conv64_2),l=Ar(l,n.conv64_3),l=nc(l,n.conv128_down),l=Ar(l,n.conv128_1),l=Ar(l,n.conv128_2),l=nc(l,n.conv256_down),l=Ar(l,n.conv256_1),l=Ar(l,n.conv256_2),l=nc(l,n.conv256_down_out);var f=l.mean([1,2]),h=qc(f,n.fc);return h})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.computeFaceDescriptor=function(e){return Ae(this,void 0,void 0,function(){var n,a,o,s=this;return Te(this,function(l){switch(l.label){case 0:return[4,qt(e)];case 1:return n=l.sent(),a=be(function(){return zt(s.forwardInput(n))}),[4,Promise.all(a.map(function(f){return f.data()}))];case 2:return o=l.sent(),a.forEach(function(f){return f.dispose()}),[2,n.isBatchInput?o:o[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return xO(e)},t.prototype.extractParams=function(e){return yO(e)},t})(ba);function ew(r,t){var e={descriptor:t};return Object.assign({},r,e)}function tw(r,t){var e={age:t};return Object.assign({},r,e)}function nw(r,t,e){var n={gender:t,genderProbability:e};return Object.assign({},r,n)}var rw=(function(){function r(t){var e=t===void 0?{}:t,n=e.minFaceSize,a=e.scaleFactor,o=e.maxNumScales,s=e.scoreThresholds,l=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=a||.709,this._maxNumScales=o||10,this._scoreThresholds=s||[.6,.7,.7],this._scaleSteps=l,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(f){return typeof f!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(f){return typeof f!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(r.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),r})();function EO(r,t){function e(f,h){var p=_n(r(9*f),[3,3,f,1]),v=It(r(f)),m=It(r(f)),y=It(r(f)),x=It(r(f));return t.push({paramPath:h+"/filters"},{paramPath:h+"/batch_norm_scale"},{paramPath:h+"/batch_norm_offset"},{paramPath:h+"/batch_norm_mean"},{paramPath:h+"/batch_norm_variance"}),{filters:p,batch_norm_scale:v,batch_norm_offset:m,batch_norm_mean:y,batch_norm_variance:x}}function n(f,h,p,v,m){var y=_n(r(f*h*p*p),[p,p,f,h]),x=It(r(h));return t.push({paramPath:v+"/filters"},{paramPath:v+"/"+(m?"batch_norm_offset":"bias")}),{filters:y,bias:x}}function a(f,h,p,v){var m=n(f,h,p,v,!0),y=m.filters,x=m.bias;return{filters:y,batch_norm_offset:x}}function o(f,h,p){var v=e(f,p+"/depthwise_conv"),m=a(f,h,1,p+"/pointwise_conv");return{depthwise_conv:v,pointwise_conv:m}}function s(){var f=a(3,32,3,"mobilenetv1/conv_0"),h=o(32,64,"mobilenetv1/conv_1"),p=o(64,128,"mobilenetv1/conv_2"),v=o(128,128,"mobilenetv1/conv_3"),m=o(128,256,"mobilenetv1/conv_4"),y=o(256,256,"mobilenetv1/conv_5"),x=o(256,512,"mobilenetv1/conv_6"),E=o(512,512,"mobilenetv1/conv_7"),w=o(512,512,"mobilenetv1/conv_8"),C=o(512,512,"mobilenetv1/conv_9"),_=o(512,512,"mobilenetv1/conv_10"),R=o(512,512,"mobilenetv1/conv_11"),A=o(512,1024,"mobilenetv1/conv_12"),T=o(1024,1024,"mobilenetv1/conv_13");return{conv_0:f,conv_1:h,conv_2:p,conv_3:v,conv_4:m,conv_5:y,conv_6:x,conv_7:E,conv_8:w,conv_9:C,conv_10:_,conv_11:R,conv_12:A,conv_13:T}}function l(){var f=a(1024,256,1,"prediction_layer/conv_0"),h=a(256,512,3,"prediction_layer/conv_1"),p=a(512,128,1,"prediction_layer/conv_2"),v=a(128,256,3,"prediction_layer/conv_3"),m=a(256,128,1,"prediction_layer/conv_4"),y=a(128,256,3,"prediction_layer/conv_5"),x=a(256,64,1,"prediction_layer/conv_6"),E=a(64,128,3,"prediction_layer/conv_7"),w=n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),C=n(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),_=n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),R=n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),A=n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),T=n(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),N=n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),M=n(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),I=n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),k=n(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),F=n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),W=n(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),P={box_encoding_predictor:w,class_predictor:C},oe={box_encoding_predictor:_,class_predictor:R},ee={box_encoding_predictor:A,class_predictor:T},ae={box_encoding_predictor:N,class_predictor:M},z={box_encoding_predictor:I,class_predictor:k},G={box_encoding_predictor:F,class_predictor:W};return{conv_0:f,conv_1:h,conv_2:p,conv_3:v,conv_4:m,conv_5:y,conv_6:x,conv_7:E,box_predictor_0:P,box_predictor_1:oe,box_predictor_2:ee,box_predictor_3:ae,box_predictor_4:z,box_predictor_5:G}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:l}}function CO(r){var t=[],e=wa(r),n=e.extractWeights,a=e.getRemainingWeights,o=EO(n,t),s=o.extractMobilenetV1Params,l=o.extractPredictionLayerParams,f=s(),h=l(),p=Kp(n(5118*4),[1,5118,4]),v={extra_dim:p};if(t.push({paramPath:"output_layer/extra_dim"}),a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:{mobilenetv1:f,prediction_layer:h,output_layer:v},paramMappings:t}}function _O(r,t){var e=ri(r,t);function n(h,p,v){var m=e(h+"/Conv2d_"+p+"_pointwise/weights",4,v+"/filters"),y=e(h+"/Conv2d_"+p+"_pointwise/convolution_bn_offset",1,v+"/batch_norm_offset");return{filters:m,batch_norm_offset:y}}function a(h){var p="mobilenetv1/conv_"+h,v="MobilenetV1/Conv2d_"+h+"_depthwise",m=p+"/depthwise_conv",y=p+"/pointwise_conv",x=e(v+"/depthwise_weights",4,m+"/filters"),E=e(v+"/BatchNorm/gamma",1,m+"/batch_norm_scale"),w=e(v+"/BatchNorm/beta",1,m+"/batch_norm_offset"),C=e(v+"/BatchNorm/moving_mean",1,m+"/batch_norm_mean"),_=e(v+"/BatchNorm/moving_variance",1,m+"/batch_norm_variance");return{depthwise_conv:{filters:x,batch_norm_scale:E,batch_norm_offset:w,batch_norm_mean:C,batch_norm_variance:_},pointwise_conv:n("MobilenetV1",h,y)}}function o(){return{conv_0:n("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:a(1),conv_2:a(2),conv_3:a(3),conv_4:a(4),conv_5:a(5),conv_6:a(6),conv_7:a(7),conv_8:a(8),conv_9:a(9),conv_10:a(10),conv_11:a(11),conv_12:a(12),conv_13:a(13)}}function s(h,p){var v=e(h+"/weights",4,p+"/filters"),m=e(h+"/biases",1,p+"/bias");return{filters:v,bias:m}}function l(h){var p=s("Prediction/BoxPredictor_"+h+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+h+"/box_encoding_predictor"),v=s("Prediction/BoxPredictor_"+h+"/ClassPredictor","prediction_layer/box_predictor_"+h+"/class_predictor");return{box_encoding_predictor:p,class_predictor:v}}function f(){return{conv_0:n("Prediction",0,"prediction_layer/conv_0"),conv_1:n("Prediction",1,"prediction_layer/conv_1"),conv_2:n("Prediction",2,"prediction_layer/conv_2"),conv_3:n("Prediction",3,"prediction_layer/conv_3"),conv_4:n("Prediction",4,"prediction_layer/conv_4"),conv_5:n("Prediction",5,"prediction_layer/conv_5"),conv_6:n("Prediction",6,"prediction_layer/conv_6"),conv_7:n("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:l(0),box_predictor_1:l(1),box_predictor_2:l(2),box_predictor_3:l(3),box_predictor_4:l(4),box_predictor_5:l(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:f}}function SO(r){var t=[],e=_O(r,t),n=e.extractMobilenetV1Params,a=e.extractPredictionLayerParams,o=r["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Qc(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var s={mobilenetv1:n(),prediction_layer:a(),output_layer:{extra_dim:o}};return xa(r,t),{params:s,paramMappings:t}}function Dr(r,t,e){return be(function(){var n=lr(r,t.filters,e,"same");return n=Ve(n,t.batch_norm_offset),iv(n,0,6)})}var RO=.0010000000474974513;function AO(r,t,e){return be(function(){var n=Gc(r,t.filters,e,"same");return n=Zx(n,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,RO),iv(n,0,6)})}function TO(r){return[2,4,6,12].some(function(t){return t===r})?[2,2]:[1,1]}function DO(r,t){return be(function(){var e=null,n=Dr(r,t.conv_0,[2,2]),a=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(a.forEach(function(o,s){var l=s+1,f=TO(l);n=AO(n,o.depthwise_conv,f),n=Dr(n,o.pointwise_conv,[1,1]),l===11&&(e=n)}),e===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:n,conv11:e}})}function NO(r,t,e,n,a){var o=r.shape[0],s=Math.min(e,o),l=t.map(function(p,v){return{score:p,boxIndex:v}}).filter(function(p){return p.score>a}).sort(function(p,v){return v.score-p.score}),f=function(p){return p<=n?1:0},h=[];return l.forEach(function(p){if(!(h.length>=s)){for(var v=p.score,m=h.length-1;m>=0;--m){var y=OO(r,p.boxIndex,h[m]);if(y!==0&&(p.score*=f(y),p.score<=a))break}v===p.score&&h.push(p.boxIndex)}}),h}function OO(r,t,e){var n=r.arraySync(),a=Math.min(n[t][0],n[t][2]),o=Math.min(n[t][1],n[t][3]),s=Math.max(n[t][0],n[t][2]),l=Math.max(n[t][1],n[t][3]),f=Math.min(n[e][0],n[e][2]),h=Math.min(n[e][1],n[e][3]),p=Math.max(n[e][0],n[e][2]),v=Math.max(n[e][1],n[e][3]),m=(s-a)*(l-o),y=(p-f)*(v-h);if(m<=0||y<=0)return 0;var x=Math.max(a,f),E=Math.max(o,h),w=Math.min(s,p),C=Math.min(l,v),_=Math.max(w-x,0)*Math.max(C-E,0);return _/(m+y-_)}function MO(r){var t=zt($a(r,[1,0])),e=[Pt(t[2],t[0]),Pt(t[3],t[1])],n=[Ve(t[0],vr(e[0],ge(2))),Ve(t[1],vr(e[1],ge(2)))];return{sizes:e,centers:n}}function kO(r,t){var e=MO(r),n=e.sizes,a=e.centers,o=zt($a(t,[1,0])),s=vr(cn(Sp(vr(o[2],ge(5))),n[0]),ge(2)),l=Ve(cn(vr(o[0],ge(10)),n[0]),a[0]),f=vr(cn(Sp(vr(o[3],ge(5))),n[1]),ge(2)),h=Ve(cn(vr(o[1],ge(10)),n[1]),a[1]);return $a(qn([Pt(l,s),Pt(h,f),Ve(l,s),Ve(h,f)]),[1,0])}function IO(r,t,e){return be(function(){var n=r.shape[0],a=kO(mr(Bo(e.extra_dim,[n,1,1]),[-1,4]),mr(r,[-1,4]));a=mr(a,[n,a.shape[0]/n,4]);var o=Xx(zr(t,[0,0,1],[-1,-1,-1])),s=zr(o,[0,0,0],[-1,-1,1]);s=mr(s,[n,s.shape[1]]);var l=zt(a),f=zt(s);return{boxes:l,scores:f}})}function Do(r,t){return be(function(){var e=r.shape[0],n=mr(gr(r,t.box_encoding_predictor),[e,-1,1,4]),a=mr(gr(r,t.class_predictor),[e,-1,3]);return{boxPredictionEncoding:n,classPrediction:a}})}function BO(r,t,e){return be(function(){var n=Dr(r,e.conv_0,[1,1]),a=Dr(n,e.conv_1,[2,2]),o=Dr(a,e.conv_2,[1,1]),s=Dr(o,e.conv_3,[2,2]),l=Dr(s,e.conv_4,[1,1]),f=Dr(l,e.conv_5,[2,2]),h=Dr(f,e.conv_6,[1,1]),p=Dr(h,e.conv_7,[2,2]),v=Do(t,e.box_predictor_0),m=Do(r,e.box_predictor_1),y=Do(a,e.box_predictor_2),x=Do(s,e.box_predictor_3),E=Do(f,e.box_predictor_4),w=Do(p,e.box_predictor_5),C=Lt([v.boxPredictionEncoding,m.boxPredictionEncoding,y.boxPredictionEncoding,x.boxPredictionEncoding,E.boxPredictionEncoding,w.boxPredictionEncoding],1),_=Lt([v.classPrediction,m.classPrediction,y.classPrediction,x.classPrediction,E.classPrediction,w.classPrediction],1);return{boxPredictions:C,classPredictions:_}})}var ef=(function(){function r(t){var e=t===void 0?{}:t,n=e.minConfidence,a=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=a||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(r.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),r})(),aw=(function(r){Be(t,r);function t(){return r.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(e){var n=this.params;if(!n)throw new Error("SsdMobilenetv1 - load model before inference");return be(function(){var a=e.toBatchTensor(512,!1).toFloat(),o=Pt(cn(a,ge(.007843137718737125)),ge(1)),s=DO(o,n.mobilenetv1),l=BO(s.out,s.conv11,n.prediction_layer),f=l.boxPredictions,h=l.classPredictions;return IO(f,h,n.output_layer)})},t.prototype.forward=function(e){return Ae(this,void 0,void 0,function(){var n;return Te(this,function(a){switch(a.label){case 0:return n=this.forwardInput,[4,qt(e)];case 1:return[2,n.apply(this,[a.sent()])]}})})},t.prototype.locateFaces=function(e,n){return n===void 0&&(n={}),Ae(this,void 0,void 0,function(){var a,o,s,l,f,h,p,v,m,y,x,E,w,C,_,R,A,T,N,M,I;return Te(this,function(k){switch(k.label){case 0:return a=new ef(n),o=a.maxResults,s=a.minConfidence,[4,qt(e)];case 1:for(l=k.sent(),f=this.forwardInput(l),h=f.boxes,p=f.scores,v=h[0],m=p[0],y=1;y<h.length;y++)h[y].dispose(),p[y].dispose();return w=(E=Array).from,[4,m.data()];case 2:return x=w.apply(E,[k.sent()]),C=.5,_=NO(v,x,o,C,s),R=l.getReshapedInputDimensions(0),A=l.inputSize,T=A/R.width,N=A/R.height,M=v.arraySync(),I=_.map(function(F){var W=[Math.max(0,M[F][0]),Math.min(1,M[F][2])].map(function(G){return G*N}),P=W[0],oe=W[1],ee=[Math.max(0,M[F][1]),Math.min(1,M[F][3])].map(function(G){return G*T}),ae=ee[0],z=ee[1];return new Vr(x[F],new Ev(ae,P,z-ae,oe-P),{height:l.getInputHeight(0),width:l.getInputWidth(0)})}),v.dispose(),m.dispose(),[2,I]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return SO(e)},t.prototype.extractParams=function(e){return CO(e)},t})(ba);(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t})(aw);var FO=.4,LO=[new tt(.738768,.874946),new tt(2.42204,2.65704),new tt(4.30971,7.04493),new tt(10.246,4.59428),new tt(12.6868,11.8741)],zO=[new tt(1.603231,2.094468),new tt(6.041143,7.080126),new tt(2.882459,3.518061),new tt(4.266906,5.178857),new tt(9.041765,10.66308)],UO=[117.001,114.697,97.404],PO="tiny_yolov2_model",HO="tiny_yolov2_separable_conv_model",rc=function(r){return typeof r=="number"};function VO(r){if(!r)throw new Error("invalid config: "+r);if(typeof r.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+r.withSeparableConvs);if(!rc(r.iouThreshold)||r.iouThreshold<0||r.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+r.iouThreshold);if(!Array.isArray(r.classes)||!r.classes.length||!r.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(r.classes));if(!Array.isArray(r.anchors)||!r.anchors.length||!r.anchors.map(function(t){return t||{}}).every(function(t){return rc(t.x)&&rc(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(r.anchors));if(r.meanRgb&&(!Array.isArray(r.meanRgb)||r.meanRgb.length!==3||!r.meanRgb.every(rc)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(r.meanRgb))}function kv(r){return be(function(){var t=cn(r,ge(.10000000149011612));return Ve(bt(Pt(r,t)),t)})}function qa(r,t){return be(function(){var e=Fi(r,[[0,0],[1,1],[1,1],[0,0]]);return e=lr(e,t.conv.filters,[1,1],"valid"),e=Pt(e,t.bn.sub),e=cn(e,t.bn.truediv),e=Ve(e,t.conv.bias),kv(e)})}function Xa(r,t){return be(function(){var e=Fi(r,[[0,0],[1,1],[1,1],[0,0]]);return e=lv(e,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),e=Ve(e,t.bias),kv(e)})}function WO(r,t){var e=$c(r,t);function n(s,l){var f=It(r(s)),h=It(r(s));return t.push({paramPath:l+"/sub"},{paramPath:l+"/truediv"}),{sub:f,truediv:h}}function a(s,l,f){var h=e(s,l,3,f+"/conv"),p=n(l,f+"/bn");return{conv:h,bn:p}}var o=Dv(r,t);return{extractConvParams:e,extractConvWithBatchNormParams:a,extractSeparableConvParams:o}}function jO(r,t,e,n){var a=wa(r),o=a.extractWeights,s=a.getRemainingWeights,l=[],f=WO(o,l),h=f.extractConvParams,p=f.extractConvWithBatchNormParams,v=f.extractSeparableConvParams,m;if(t.withSeparableConvs){var y=n[0],x=n[1],E=n[2],w=n[3],C=n[4],_=n[5],R=n[6],A=n[7],T=n[8],N=t.isFirstLayerConv2d?h(y,x,3,"conv0"):v(y,x,"conv0"),M=v(x,E,"conv1"),I=v(E,w,"conv2"),k=v(w,C,"conv3"),F=v(C,_,"conv4"),W=v(_,R,"conv5"),P=A?v(R,A,"conv6"):void 0,oe=T?v(A,T,"conv7"):void 0,ee=h(T||A||R,5*e,1,"conv8");m={conv0:N,conv1:M,conv2:I,conv3:k,conv4:F,conv5:W,conv6:P,conv7:oe,conv8:ee}}else{var y=n[0],x=n[1],E=n[2],w=n[3],C=n[4],_=n[5],R=n[6],A=n[7],T=n[8],N=p(y,x,"conv0"),M=p(x,E,"conv1"),I=p(E,w,"conv2"),k=p(w,C,"conv3"),F=p(C,_,"conv4"),W=p(_,R,"conv5"),P=p(R,A,"conv6"),oe=p(A,T,"conv7"),ee=h(T,5*e,1,"conv8");m={conv0:N,conv1:M,conv2:I,conv3:k,conv4:F,conv5:W,conv6:P,conv7:oe,conv8:ee}}if(s().length!==0)throw new Error("weights remaing after extract: "+s().length);return{params:m,paramMappings:l}}function GO(r,t){var e=ri(r,t);function n(l){var f=e(l+"/sub",1),h=e(l+"/truediv",1);return{sub:f,truediv:h}}function a(l){var f=e(l+"/filters",4),h=e(l+"/bias",1);return{filters:f,bias:h}}function o(l){var f=a(l+"/conv"),h=n(l+"/bn");return{conv:f,bn:h}}var s=Nv(e);return{extractConvParams:a,extractConvWithBatchNormParams:o,extractSeparableConvParams:s}}function qO(r,t){var e=[],n=GO(r,e),a=n.extractConvParams,o=n.extractConvWithBatchNormParams,s=n.extractSeparableConvParams,l;if(t.withSeparableConvs){var f=t.filterSizes&&t.filterSizes.length||9;l={conv0:t.isFirstLayerConv2d?a("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:f>7?s("conv6"):void 0,conv7:f>8?s("conv7"):void 0,conv8:a("conv8")}}else l={conv0:o("conv0"),conv1:o("conv1"),conv2:o("conv2"),conv3:o("conv3"),conv4:o("conv4"),conv5:o("conv5"),conv6:o("conv6"),conv7:o("conv7"),conv8:a("conv8")};return xa(r,e),{params:l,paramMappings:e}}var f1;(function(r){r[r.XS=224]="XS",r[r.SM=320]="SM",r[r.MD=416]="MD",r[r.LG=608]="LG"})(f1||(f1={}));var Iv=(function(){function r(t){var e=t===void 0?{}:t,n=e.inputSize,a=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=a||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(r.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),r})(),iw=(function(r){Be(t,r);function t(e){var n=r.call(this,"TinyYolov2")||this;return VO(e),n._config=e,n}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,n){var a=qa(e,n.conv0);return a=jt(a,[2,2],[2,2],"same"),a=qa(a,n.conv1),a=jt(a,[2,2],[2,2],"same"),a=qa(a,n.conv2),a=jt(a,[2,2],[2,2],"same"),a=qa(a,n.conv3),a=jt(a,[2,2],[2,2],"same"),a=qa(a,n.conv4),a=jt(a,[2,2],[2,2],"same"),a=qa(a,n.conv5),a=jt(a,[2,2],[1,1],"same"),a=qa(a,n.conv6),a=qa(a,n.conv7),gr(a,n.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,n){var a=this.config.isFirstLayerConv2d?kv(gr(e,n.conv0,"valid",!1)):Xa(e,n.conv0);return a=jt(a,[2,2],[2,2],"same"),a=Xa(a,n.conv1),a=jt(a,[2,2],[2,2],"same"),a=Xa(a,n.conv2),a=jt(a,[2,2],[2,2],"same"),a=Xa(a,n.conv3),a=jt(a,[2,2],[2,2],"same"),a=Xa(a,n.conv4),a=jt(a,[2,2],[2,2],"same"),a=Xa(a,n.conv5),a=jt(a,[2,2],[1,1],"same"),a=n.conv6?Xa(a,n.conv6):a,a=n.conv7?Xa(a,n.conv7):a,gr(a,n.conv8,"valid",!1)},t.prototype.forwardInput=function(e,n){var a=this,o=this.params;if(!o)throw new Error("TinyYolov2 - load model before inference");return be(function(){var s=e.toBatchTensor(n,!1).toFloat();return s=a.config.meanRgb?xs(s,a.config.meanRgb):s,s=s.div(ge(256)),a.config.withSeparableConvs?a.runMobilenet(s,o):a.runTinyYolov2(s,o)})},t.prototype.forward=function(e,n){return Ae(this,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,qt(e)];case 1:return[4,a.apply(this,[o.sent(),n])];case 2:return[2,o.sent()]}})})},t.prototype.detect=function(e,n){return n===void 0&&(n={}),Ae(this,void 0,void 0,function(){var a,o,s,l,f,h,p,v,m,y,x,E,w,C,_=this;return Te(this,function(R){switch(R.label){case 0:return a=new Iv(n),o=a.inputSize,s=a.scoreThreshold,[4,qt(e)];case 1:return l=R.sent(),[4,this.forwardInput(l,o)];case 2:return f=R.sent(),h=be(function(){return zt(f)[0].expandDims()}),p={width:l.getInputWidth(0),height:l.getInputHeight(0)},[4,this.extractBoxes(h,l.getReshapedInputDimensions(0),s)];case 3:return v=R.sent(),f.dispose(),h.dispose(),m=v.map(function(A){return A.box}),y=v.map(function(A){return A.score}),x=v.map(function(A){return A.classScore}),E=v.map(function(A){return _.config.classes[A.label]}),w=ss(m.map(function(A){return A.rescale(o)}),y,this.config.iouThreshold,!0),C=w.map(function(A){return new O2(y[A],x[A],E[A],m[A],p)}),[2,C]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return qO(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,a=n?n.length:void 0;if(a!==7&&a!==8&&a!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+a+" filterSizes in config");return jO(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,n,a){return Ae(this,void 0,void 0,function(){var o,s,l,f,h,p,v,m,y,x,E,w,C,_,R,A,T,N,M,I,k,F,W,P,oe,ee,ae,z,G,K=this;return Te(this,function(ie){switch(ie.label){case 0:return o=n.width,s=n.height,l=Math.max(o,s),f=l/o,h=l/s,p=e.shape[1],v=this.config.anchors.length,m=be(function(){var se=e.reshape([p,p,v,K.boxEncodingSize]),L=se.slice([0,0,0,0],[p,p,v,4]),q=se.slice([0,0,0,4],[p,p,v,1]),ue=K.withClassScores?ga(se.slice([0,0,0,5],[p,p,v,K.config.classes.length]),3):ge(0);return[L,q,ue]}),y=m[0],x=m[1],E=m[2],w=[],[4,x.array()];case 1:return C=ie.sent(),[4,y.array()];case 2:_=ie.sent(),R=0,ie.label=3;case 3:if(!(R<p))return[3,12];A=0,ie.label=4;case 4:if(!(A<p))return[3,11];T=0,ie.label=5;case 5:return T<v?(N=np(C[R][A][T][0]),!a||N>a?(M=(A+np(_[R][A][T][0]))/p*f,I=(R+np(_[R][A][T][1]))/p*h,k=Math.exp(_[R][A][T][2])*this.config.anchors[T].x/p*f,F=Math.exp(_[R][A][T][3])*this.config.anchors[T].y/p*h,W=M-k/2,P=I-F/2,oe={row:R,col:A,anchor:T},this.withClassScores?[4,this.extractPredictedClass(E,oe)]:[3,7]):[3,9]):[3,10];case 6:return G=ie.sent(),[3,8];case 7:G={classScore:1,label:0},ie.label=8;case 8:ee=G,ae=ee.classScore,z=ee.label,w.push(on({box:new Zc(W,P,W+k,P+F),score:N,classScore:N*ae,label:z},oe)),ie.label=9;case 9:return T++,[3,5];case 10:return A++,[3,4];case 11:return R++,[3,3];case 12:return y.dispose(),x.dispose(),E.dispose(),[2,w]}})})},t.prototype.extractPredictedClass=function(e,n){return Ae(this,void 0,void 0,function(){var a,o,s,l;return Te(this,function(f){switch(f.label){case 0:return a=n.row,o=n.col,s=n.anchor,[4,e.array()];case 1:return l=f.sent(),[2,Array(this.config.classes.length).fill(0).map(function(h,p){return l[a][o][s][p]}).map(function(h,p){return{classScore:h,label:p}}).reduce(function(h,p){return h.classScore>p.classScore?h:p})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t})(ba),XO=(function(r){Be(t,r);function t(e){e===void 0&&(e=!0);var n=this,a=Object.assign({},{withSeparableConvs:e,iouThreshold:FO,classes:["face"]},e?{anchors:zO,meanRgb:UO}:{anchors:LO,withClassScores:!0});return n=r.call(this,a)||this,n}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return Ae(this,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return[4,this.detect(e,n)];case 1:return a=o.sent(),[2,a.map(function(s){return new Vr(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?HO:PO},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t})(iw),ow=(function(r){Be(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return t})(Iv),ws=(function(){function r(){}return r.prototype.then=function(t){return Ae(this,void 0,void 0,function(){var e;return Te(this,function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}})})},r.prototype.run=function(){return Ae(this,void 0,void 0,function(){return Te(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},r})();function tf(r,t,e,n,a){return a===void 0&&(a=function(o){var s=o.alignedRect;return s}),Ae(this,void 0,void 0,function(){var o,s,l,f,h;return Te(this,function(p){switch(p.label){case 0:return o=r.map(function(v){return tO(v)?a(v):v.detection}),l=n,l?[3,5]:t instanceof yt?[4,Av(t,o)]:[3,2];case 1:return f=p.sent(),[3,4];case 2:return[4,Rv(t,o)];case 3:f=p.sent(),p.label=4;case 4:l=f,p.label=5;case 5:return s=l,[4,e(s)];case 6:return h=p.sent(),s.forEach(function(v){return v instanceof yt&&v.dispose()}),[2,h]}})})}function Bv(r,t,e,n,a){return Ae(this,void 0,void 0,function(){var o=this;return Te(this,function(s){return[2,tf([r],t,function(l){return Ae(o,void 0,void 0,function(){return Te(this,function(f){return[2,e(l[0])]})})},n,a)]})})}function KO(r){return be(function(){return qn(zt(r,3).reverse(),3)})}var ac=2,Fc=12;function YO(r,t){var e=$c(r,t),n=Tv(r,t);function a(h,p){var v=It(r(h));return t.push({paramPath:p}),v}function o(h,p,v){v===void 0&&(v=!1);var m=e(h[0],h[1],3,p+"/conv1"),y=a(h[1],p+"/prelu1_alpha"),x=e(h[1],h[2],3,p+"/conv2"),E=a(h[2],p+"/prelu2_alpha"),w=e(h[2],h[3],v?2:3,p+"/conv3"),C=a(h[3],p+"/prelu3_alpha");return{conv1:m,prelu1_alpha:y,conv2:x,prelu2_alpha:E,conv3:w,prelu3_alpha:C}}function s(){var h=o([3,10,16,32],"pnet"),p=e(32,2,1,"pnet/conv4_1"),v=e(32,4,1,"pnet/conv4_2");return on(on({},h),{conv4_1:p,conv4_2:v})}function l(){var h=o([3,28,48,64],"rnet",!0),p=n(576,128,"rnet/fc1"),v=a(128,"rnet/prelu4_alpha"),m=n(128,2,"rnet/fc2_1"),y=n(128,4,"rnet/fc2_2");return on(on({},h),{fc1:p,prelu4_alpha:v,fc2_1:m,fc2_2:y})}function f(){var h=o([3,32,64,64],"onet"),p=e(64,128,2,"onet/conv4"),v=a(128,"onet/prelu4_alpha"),m=n(1152,256,"onet/fc1"),y=a(256,"onet/prelu5_alpha"),x=n(256,2,"onet/fc2_1"),E=n(256,4,"onet/fc2_2"),w=n(256,10,"onet/fc2_3");return on(on({},h),{conv4:p,prelu4_alpha:v,fc1:m,prelu5_alpha:y,fc2_1:x,fc2_2:E,fc2_3:w})}return{extractPNetParams:s,extractRNetParams:l,extractONetParams:f}}function QO(r){var t=wa(r),e=t.extractWeights,n=t.getRemainingWeights,a=[],o=YO(e,a),s=o.extractPNetParams,l=o.extractRNetParams,f=o.extractONetParams,h=s(),p=l(),v=f();if(n().length!==0)throw new Error("weights remaing after extract: "+n().length);return{params:{pnet:h,rnet:p,onet:v},paramMappings:a}}function ZO(r,t){var e=ri(r,t);function n(p){var v=e(p+"/weights",4,p+"/filters"),m=e(p+"/bias",1);return{filters:v,bias:m}}function a(p){var v=e(p+"/weights",2),m=e(p+"/bias",1);return{weights:v,bias:m}}function o(p){return e(p,1)}function s(p){var v=n(p+"/conv1"),m=o(p+"/prelu1_alpha"),y=n(p+"/conv2"),x=o(p+"/prelu2_alpha"),E=n(p+"/conv3"),w=o(p+"/prelu3_alpha");return{conv1:v,prelu1_alpha:m,conv2:y,prelu2_alpha:x,conv3:E,prelu3_alpha:w}}function l(){var p=s("pnet"),v=n("pnet/conv4_1"),m=n("pnet/conv4_2");return on(on({},p),{conv4_1:v,conv4_2:m})}function f(){var p=s("rnet"),v=a("rnet/fc1"),m=o("rnet/prelu4_alpha"),y=a("rnet/fc2_1"),x=a("rnet/fc2_2");return on(on({},p),{fc1:v,prelu4_alpha:m,fc2_1:y,fc2_2:x})}function h(){var p=s("onet"),v=n("onet/conv4"),m=o("onet/prelu4_alpha"),y=a("onet/fc1"),x=o("onet/prelu5_alpha"),E=a("onet/fc2_1"),w=a("onet/fc2_2"),C=a("onet/fc2_3");return on(on({},p),{conv4:v,prelu4_alpha:m,fc1:y,prelu5_alpha:x,fc2_1:E,fc2_2:w,fc2_3:C})}return{extractPNetParams:l,extractRNetParams:f,extractONetParams:h}}function JO(r){var t=[],e=ZO(r,t),n=e.extractPNetParams,a=e.extractRNetParams,o=e.extractONetParams,s=n(),l=a(),f=o();return xa(r,t),{params:{pnet:s,rnet:l,onet:f},paramMappings:t}}function kp(r,t){var e=t[0],n=t[1];return{height:Math.floor(e*r),width:Math.floor(n*r)}}function $O(r,t,e){for(var n=e[0],a=e[1],o=Fc/r,s=[],l=Math.min(n,a)*o,f=0;l>=12;)s.push(o*Math.pow(t,f)),l=l*t,f+=1;return s}var Fv=(function(r){Be(t,r);function t(e,n,a,o){return r.call(this,{left:e,top:n,right:a,bottom:o},!0)||this}return t})(ei);function uw(r){return be(function(){return cn(Pt(r,ge(127.5)),ge(.0078125))})}function Ho(r,t){return be(function(){return Ve(bt(r),cn(t,Dc(bt(Dc(r)))))})}function Lv(r,t,e){return e===void 0&&(e=!1),be(function(){var n=gr(r,t.conv1,"valid");return n=Ho(n,t.prelu1_alpha),n=jt(n,e?[2,2]:[3,3],[2,2],"same"),n=gr(n,t.conv2,"valid"),n=Ho(n,t.prelu2_alpha),n=e?n:jt(n,[3,3],[2,2],"valid"),n=gr(n,t.conv3,"valid"),n=Ho(n,t.prelu3_alpha),n})}function eM(r,t){return be(function(){var e=Lv(r,t,!0),n=gr(e,t.conv4_1,"valid"),a=ir(Xc(n,3),3),o=ga(Pt(n,a),3),s=gr(e,t.conv4_2,"valid");return{prob:o,regions:s}})}function tM(r,t){return be(function(){var e=kp(t,r.shape.slice(1)),n=e.height,a=e.width,o=pv.resizeBilinear(r,[n,a]),s=uw(o);return $a(s,[0,2,1,3])})}function nM(r,t,e,n){for(var a=[],o=r.arraySync(),s=0;s<r.shape[0];s++)for(var l=0;l<r.shape[1];l++)o[s][l]>=n&&a.push(new tt(l,s));var f=a.map(function(h){var p=new Zc(Math.round((h.y*ac+1)/e),Math.round((h.x*ac+1)/e),Math.round((h.y*ac+Fc)/e),Math.round((h.x*ac+Fc)/e)),v=o[h.y][h.x],m=t.arraySync(),y=new Fv(m[h.y][h.x][0],m[h.y][h.x][1],m[h.y][h.x][2],m[h.y][h.x][3]);return{cell:p,score:v,region:y}});return f}function rM(r,t,e,n,a){a.stage1=[];var o=t.map(function(m){return be(function(){var y={scale:m},x=tM(r,m),E=Date.now(),w=eM(x,n),C=w.prob,_=w.regions;y.pnet=Date.now()-E;var R=zt(zt(C,3)[1])[0],A=zt(_)[0];return{scoresTensor:R,regionsTensor:A,scale:m,statsForScale:y}})}),s=o.map(function(m){var y=m.scoresTensor,x=m.regionsTensor,E=m.scale,w=m.statsForScale,C=nM(y,x,E,e);if(y.dispose(),x.dispose(),!C.length)return a.stage1.push(w),[];var _=Date.now(),R=ss(C.map(function(A){return A.cell}),C.map(function(A){return A.score}),.5);return w.nms=Date.now()-_,w.numBoxes=R.length,a.stage1.push(w),R.map(function(A){return C[A]})}),l=s.reduce(function(m,y){return m.concat(y)},[]),f=[],h=[];if(l.length>0){var p=Date.now(),v=ss(l.map(function(m){return m.cell}),l.map(function(m){return m.score}),.7);a.stage1_nms=Date.now()-p,h=v.map(function(m){return l[m].score}),f=v.map(function(m){return l[m]}).map(function(m){var y=m.cell,x=m.region;return new Zc(y.left+x.left*y.width,y.top+x.top*y.height,y.right+x.right*y.width,y.bottom+x.bottom*y.height).toSquare().round()})}return{boxes:f,scores:h}}function sw(r,t,e){var n=e.width,a=e.height;return Ae(this,void 0,void 0,function(){var o,s,l,f=this;return Te(this,function(h){switch(h.label){case 0:return o=Mi(r),[4,Promise.all(t.map(function(p){return Ae(f,void 0,void 0,function(){var v,m,y,x,E,w,C,_;return Te(this,function(R){return v=p.padAtBorders(r.height,r.width),m=v.y,y=v.ey,x=v.x,E=v.ex,w=x-1,C=m-1,_=o.getImageData(w,C,E-w,y-C),[2,fn.isNodejs()?Sv(_):createImageBitmap(_)]})})}))];case 1:return s=h.sent(),l=[],s.forEach(function(p){var v=Jc({width:n,height:a}),m=Mi(v);m.drawImage(p,0,0,n,a);for(var y=m.getImageData(0,0,n,a).data,x=[],E=0;E<y.length;E+=4)x.push(y[E+2]),x.push(y[E+1]),x.push(y[E]);l.push(x)}),[2,l.map(function(p){var v=be(function(){var m=$a(_n(p,[1,n,a,3]),[0,2,1,3]).toFloat();return uw(m)});return v})]}})})}function aM(r,t){return be(function(){var e=Lv(r,t),n=mr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=kr(n,t.fc1),o=Ho(a,t.prelu4_alpha),s=kr(o,t.fc2_1),l=ir(Xc(s,1),1),f=ga(Pt(s,l),1),h=kr(o,t.fc2_2),p=zt(f,1)[1];return{scores:p,regions:h}})}function iM(r,t,e,n,a){return Ae(this,void 0,void 0,function(){var o,s,l,f,h,p,v,m,y,x,E,w,C,_;return Te(this,function(R){switch(R.label){case 0:return o=Date.now(),[4,sw(r,t,{width:24,height:24})];case 1:return s=R.sent(),a.stage2_extractImagePatches=Date.now()-o,o=Date.now(),l=s.map(function(A){var T=aM(A,n);return A.dispose(),T}),a.stage2_rnet=Date.now()-o,f=l.length>1?Lt(l.map(function(A){return A.scores})):l[0].scores,v=(p=Array).from,[4,f.data()];case 2:return h=v.apply(p,[R.sent()]),f.dispose(),m=h.map(function(A,T){return{score:A,idx:T}}).filter(function(A){return A.score>e}).map(function(A){var T=A.idx;return T}),y=m.map(function(A){return t[A]}),x=m.map(function(A){return h[A]}),E=[],w=[],y.length>0&&(o=Date.now(),C=ss(y,x,.7),a.stage2_nms=Date.now()-o,_=C.map(function(A){var T=l[m[A]].regions.arraySync();return new Fv(T[0][0],T[0][1],T[0][2],T[0][3])}),w=C.map(function(A){return x[A]}),E=C.map(function(A,T){return y[A].calibrate(_[T])})),l.forEach(function(A){A.regions.dispose(),A.scores.dispose()}),[2,{boxes:E,scores:w}]}})})}function oM(r,t){return be(function(){var e=Lv(r,t);e=jt(e,[2,2],[2,2],"same"),e=gr(e,t.conv4,"valid"),e=Ho(e,t.prelu4_alpha);var n=mr(e,[e.shape[0],t.fc1.weights.shape[0]]),a=kr(n,t.fc1),o=Ho(a,t.prelu5_alpha),s=kr(o,t.fc2_1),l=ir(Xc(s,1),1),f=ga(Pt(s,l),1),h=kr(o,t.fc2_2),p=kr(o,t.fc2_3),v=zt(f,1)[1];return{scores:v,regions:h,points:p}})}function uM(r,t,e,n,a){return Ae(this,void 0,void 0,function(){var o,s,l,f,h,p,v,m,y,x,E,w,C,_,R;return Te(this,function(A){switch(A.label){case 0:return o=Date.now(),[4,sw(r,t,{width:48,height:48})];case 1:return s=A.sent(),a.stage3_extractImagePatches=Date.now()-o,o=Date.now(),l=s.map(function(T){var N=oM(T,n);return T.dispose(),N}),a.stage3_onet=Date.now()-o,f=l.length>1?Lt(l.map(function(T){return T.scores})):l[0].scores,v=(p=Array).from,[4,f.data()];case 2:return h=v.apply(p,[A.sent()]),f.dispose(),m=h.map(function(T,N){return{score:T,idx:N}}).filter(function(T){return T.score>e}).map(function(T){var N=T.idx;return N}),y=m.map(function(T){var N=l[T].regions.arraySync();return new Fv(N[0][0],N[0][1],N[0][2],N[0][3])}),x=m.map(function(T,N){return t[T].calibrate(y[N])}),E=m.map(function(T){return h[T]}),w=[],C=[],_=[],x.length>0&&(o=Date.now(),R=ss(x,E,.7,!1),a.stage3_nms=Date.now()-o,w=R.map(function(T){return x[T]}),C=R.map(function(T){return E[T]}),_=R.map(function(T,N){return Array(5).fill(0).map(function(M,I){var k=l[T].points.arraySync();return new tt(k[0][I]*(w[N].width+1)+w[N].left,k[0][I+5]*(w[N].height+1)+w[N].top)})})),l.forEach(function(T){T.regions.dispose(),T.scores.dispose(),T.points.dispose()}),[2,{boxes:w,scores:C,points:_}]}})})}var sM=(function(r){Be(t,r);function t(){return r.call(this,"Mtcnn")||this}return t.prototype.load=function(e){return Ae(this,void 0,void 0,function(){return Te(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.load.call(this,e)]})})},t.prototype.loadFromDisk=function(e){return Ae(this,void 0,void 0,function(){return Te(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,r.prototype.loadFromDisk.call(this,e)]})})},t.prototype.forwardInput=function(e,n){return n===void 0&&(n={}),Ae(this,void 0,void 0,function(){var a,o,s,l,f,h,p,v,m,y,x,E,w,C,_,R,A,T,N,M,I;return Te(this,function(k){switch(k.label){case 0:if(a=this.params,!a)throw new Error("Mtcnn - load model before inference");if(o=e.canvases[0],!o)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return s={},l=Date.now(),f=be(function(){return KO(ir(xv.fromPixels(o)).toFloat())}),h=function(F){return f.dispose(),s.total=Date.now()-l,F},p=f.shape.slice(1),v=p[0],m=p[1],y=new rw(n),x=y.minFaceSize,E=y.scaleFactor,w=y.maxNumScales,C=y.scoreThresholds,_=y.scaleSteps,R=(_||$O(x,E,[v,m])).filter(function(F){var W=kp(F,[v,m]);return Math.min(W.width,W.height)>Fc}).slice(0,w),s.scales=R,s.pyramid=R.map(function(F){return kp(F,[v,m])}),A=Date.now(),[4,rM(f,R,C[0],a.pnet,s)];case 1:return T=k.sent(),s.total_stage1=Date.now()-A,T.boxes.length?(s.stage2_numInputBoxes=T.boxes.length,A=Date.now(),[4,iM(o,T.boxes,C[1],a.rnet,s)]):[2,h({results:[],stats:s})];case 2:return N=k.sent(),s.total_stage2=Date.now()-A,N.boxes.length?(s.stage3_numInputBoxes=N.boxes.length,A=Date.now(),[4,uM(o,N.boxes,C[2],a.onet,s)]):[2,h({results:[],stats:s})];case 3:return M=k.sent(),s.total_stage3=Date.now()-A,I=M.boxes.map(function(F,W){return Ov(Cv({},new Vr(M.scores[W],new Ev(F.left/m,F.top/v,F.width/m,F.height/v),{height:v,width:m})),new z4(M.points[W].map(function(P){return P.sub(new tt(F.left,F.top)).div(new tt(F.width,F.height))}),{width:F.width,height:F.height}))}),[2,h({results:I,stats:s})]}})})},t.prototype.forward=function(e,n){return n===void 0&&(n={}),Ae(this,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,qt(e)];case 1:return[4,a.apply(this,[o.sent(),n])];case 2:return[2,o.sent().results]}})})},t.prototype.forwardWithStats=function(e,n){return n===void 0&&(n={}),Ae(this,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return a=this.forwardInput,[4,qt(e)];case 1:return[2,a.apply(this,[o.sent(),n])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return JO(e)},t.prototype.extractParams=function(e){return QO(e)},t})(ba),lM=.4,cM=[new tt(1.603231,2.094468),new tt(6.041143,7.080126),new tt(2.882459,3.518061),new tt(4.266906,5.178857),new tt(9.041765,10.66308)],fM=[117.001,114.697,97.404],hM=(function(r){Be(t,r);function t(){var e=this,n={withSeparableConvs:!0,iouThreshold:lM,classes:["face"],anchors:cM,meanRgb:fM,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=r.call(this,n)||this,e}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,n){return Ae(this,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return[4,this.detect(e,n)];case 1:return a=o.sent(),[2,a.map(function(s){return new Vr(s.score,s.relativeBox,{width:s.imageWidth,height:s.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(e){return r.prototype.extractParamsFromWeigthMap.call(this,e)},t})(iw),mn={ssdMobilenetv1:new aw,tinyFaceDetector:new hM,tinyYolov2:new XO,mtcnn:new sM,faceLandmark68Net:new Z2,faceLandmark68TinyNet:new pO,faceRecognitionNet:new wO,faceExpressionNet:new eO,ageGenderNet:new cO},lw=(function(r){Be(t,r);function t(e,n,a){var o=r.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=a,o}return t})(ws),zv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n,a=this;return Te(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return e=o.sent(),[4,tf(e,this.input,function(s){return Ae(a,void 0,void 0,function(){return Te(this,function(l){switch(l.label){case 0:return[4,Promise.all(s.map(function(f){return mn.faceExpressionNet.predictExpressions(f)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=o.sent(),[2,e.map(function(s,l){return K2(s,n[l])})]}})})},t.prototype.withAgeAndGender=function(){return new Vv(this,this.input)},t})(lw),Uv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n;return Te(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Bv(e,this.input,function(o){return mn.faceExpressionNet.predictExpressions(o)},this.extractedFaces)]:[2];case 2:return n=a.sent(),[2,K2(e,n)]}})})},t.prototype.withAgeAndGender=function(){return new Wv(this,this.input)},t})(lw),Pv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new jv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new qv(this,this.input)},t})(zv),Hv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Gv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Xv(this,this.input)},t})(Uv),cw=(function(r){Be(t,r);function t(e,n,a){var o=r.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=a,o}return t})(ws),Vv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n,a=this;return Te(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return e=o.sent(),[4,tf(e,this.input,function(s){return Ae(a,void 0,void 0,function(){return Te(this,function(l){switch(l.label){case 0:return[4,Promise.all(s.map(function(f){return mn.ageGenderNet.predictAgeAndGender(f)}))];case 1:return[2,l.sent()]}})})},this.extractedFaces)];case 2:return n=o.sent(),[2,e.map(function(s,l){var f=n[l],h=f.age,p=f.gender,v=f.genderProbability;return tw(nw(s,p,v),h)})]}})})},t.prototype.withFaceExpressions=function(){return new zv(this,this.input)},t})(cw),Wv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n,a,o,s;return Te(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?[4,Bv(e,this.input,function(f){return mn.ageGenderNet.predictAgeAndGender(f)},this.extractedFaces)]:[2];case 2:return n=l.sent(),a=n.age,o=n.gender,s=n.genderProbability,[2,tw(nw(e,o,s),a)]}})})},t.prototype.withFaceExpressions=function(){return new Uv(this,this.input)},t})(cw),jv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Pv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new qv(this,this.input)},t})(Vv),Gv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Hv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Xv(this,this.input)},t})(Wv),fw=(function(r){Be(t,r);function t(e,n){var a=r.call(this)||this;return a.parentTask=e,a.input=n,a}return t})(ws),qv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n;return Te(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),[4,tf(e,this.input,function(o){return Promise.all(o.map(function(s){return mn.faceRecognitionNet.computeFaceDescriptor(s)}))},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return n=a.sent(),[2,n.map(function(o,s){return ew(e[s],o)})]}})})},t.prototype.withFaceExpressions=function(){return new Pv(this,this.input)},t.prototype.withAgeAndGender=function(){return new jv(this,this.input)},t})(fw),Xv=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n;return Te(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),e?[4,Bv(e,this.input,function(o){return mn.faceRecognitionNet.computeFaceDescriptor(o)},null,function(o){return o.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return n=a.sent(),[2,ew(e,n)]}})})},t.prototype.withFaceExpressions=function(){return new Hv(this,this.input)},t.prototype.withAgeAndGender=function(){return new Gv(this,this.input)},t})(fw),hw=(function(r){Be(t,r);function t(e,n,a){var o=r.call(this)||this;return o.parentTask=e,o.input=n,o.useTinyLandmarkNet=a,o}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?mn.faceLandmark68TinyNet:mn.faceLandmark68Net},enumerable:!0,configurable:!0}),t})(ws),dM=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n,a,o,s,l=this;return Te(this,function(f){switch(f.label){case 0:return[4,this.parentTask];case 1:return e=f.sent(),n=e.map(function(h){return h.detection}),this.input instanceof yt?[4,Av(this.input,n)]:[3,3];case 2:return o=f.sent(),[3,5];case 3:return[4,Rv(this.input,n)];case 4:o=f.sent(),f.label=5;case 5:return a=o,[4,Promise.all(a.map(function(h){return l.landmarkNet.detectLandmarks(h)}))];case 6:return s=f.sent(),a.forEach(function(h){return h instanceof yt&&h.dispose()}),[2,e.map(function(h,p){return Ov(h,s[p])})]}})})},t.prototype.withFaceExpressions=function(){return new Pv(this,this.input)},t.prototype.withAgeAndGender=function(){return new jv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new qv(this,this.input)},t})(hw),pM=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n,a,o,s;return Te(this,function(l){switch(l.label){case 0:return[4,this.parentTask];case 1:return e=l.sent(),e?(n=e.detection,this.input instanceof yt?[4,Av(this.input,[n])]:[3,3]):[2];case 2:return o=l.sent(),[3,5];case 3:return[4,Rv(this.input,[n])];case 4:o=l.sent(),l.label=5;case 5:return a=o,[4,this.landmarkNet.detectLandmarks(a[0])];case 6:return s=l.sent(),a.forEach(function(f){return f instanceof yt&&f.dispose()}),[2,Ov(e,s)]}})})},t.prototype.withFaceExpressions=function(){return new Hv(this,this.input)},t.prototype.withAgeAndGender=function(){return new Gv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Xv(this,this.input)},t})(hw),dw=(function(r){Be(t,r);function t(e,n){n===void 0&&(n=new ef);var a=r.call(this)||this;return a.input=e,a.options=n,a}return t})(ws),pw=(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n,a,o;return Te(this,function(s){switch(s.label){case 0:return e=this,n=e.input,a=e.options,a instanceof rw?[4,mn.mtcnn.forward(n,a)]:[3,2];case 1:return[2,s.sent().map(function(l){return l.detection})];case 2:if(o=a instanceof ow?function(l){return mn.tinyFaceDetector.locateFaces(l,a)}:a instanceof ef?function(l){return mn.ssdMobilenetv1.locateFaces(l,a)}:a instanceof Iv?function(l){return mn.tinyYolov2.locateFaces(l,a)}:null,!o)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,o(n)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(n){return Ae(e,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return a=o.sent(),[2,n(a.map(function(s){return Cv({},s)}))]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new dM(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new zv(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Vv(this.runAndExtendWithFaceDetections(),this.input)},t})(dw);(function(r){Be(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Ae(this,void 0,void 0,function(){var e,n;return Te(this,function(a){switch(a.label){case 0:return[4,new pw(this.input,this.options)];case 1:return e=a.sent(),n=e[0],e.forEach(function(o){o.score>n.score&&(n=o)}),[2,n]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(n){return Ae(e,void 0,void 0,function(){var a;return Te(this,function(o){switch(o.label){case 0:return[4,this.run()];case 1:return a=o.sent(),[2,n(a?Cv({},a):void 0)]}})})})},t.prototype.withFaceLandmarks=function(e){return e===void 0&&(e=!1),new pM(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new Uv(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new Wv(this.runAndExtendWithFaceDetection(),this.input)},t})(dw);function vM(r,t){return t===void 0&&(t=new ef),new pw(r,t)}function mM(r,t){if(r.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(r),n=Array.from(t);return Math.sqrt(e.map(function(a,o){return a-n[o]}).reduce(function(a,o){return a+Math.pow(o,2)},0))}(function(){function r(t,e){e===void 0&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var a=1,o=function(){return"person "+a++};this._labeledDescriptors=n.map(function(s){if(s instanceof ec)return s;if(s instanceof Float32Array)return new ec(o(),[s]);if(s.descriptor&&s.descriptor instanceof Float32Array)return new ec(o(),[s.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(r.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),r.prototype.computeMeanDistance=function(t,e){return e.map(function(n){return mM(n,t)}).reduce(function(n,a){return n+a},0)/(e.length||1)},r.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(n){var a=n.descriptors,o=n.label;return new o1(o,e.computeMeanDistance(t,a))}).reduce(function(n,a){return n.distance<a.distance?n:a})},r.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new o1("unknown",e.distance)},r.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},r.fromJSON=function(t){var e=t.labeledDescriptors.map(function(n){return ec.fromJSON(n)});return new r(e,t.distanceThreshold)},r})();const lc={apiKey:"AIzaSyD2jtamDLHu6Qh_YBHCUjKZLb8dm8gbYeI",baseUrl:"https://www.googleapis.com/youtube/v3"},ip="/models";console.warn(" [DEBUG-CORE] 'emotionDetector.ts' file loaded and executing.");let Ip=!1;const gM=async()=>{if(Ip){console.log(" [DEBUG-CORE] Models already loaded. Skipping.");return}console.log(" [DEBUG-CORE] Starting Model Load...");try{const r=Date.now();await Promise.all([mn.tinyFaceDetector.loadFromUri(ip),mn.faceLandmark68Net.loadFromUri(ip),mn.faceExpressionNet.loadFromUri(ip)]),Ip=!0,console.log(` [DEBUG-CORE]  Models Loaded Successfully in ${Date.now()-r}ms`)}catch(r){throw console.error(" [DEBUG-CORE]  CRITICAL: Failed to load models",r),r}},yM=async r=>{if(!Ip)return console.warn(" [DEBUG-LOOP]  Skipped: Models not loaded"),null;if(!r)return console.warn(" [DEBUG-LOOP]  Skipped: Video element is null"),null;if(r.paused||r.ended||r.readyState<3)return console.warn(` [DEBUG-LOOP]  Skipped: Video not ready (Paused: ${r.paused}, State: ${r.readyState})`),null;try{const t=new ow({inputSize:224,scoreThreshold:.2}),e=await vM(r,t).withFaceLandmarks().withFaceExpressions();if(!e||e.length===0)return console.log(" [DEBUG-LOOP]  Loop running, but NO FACE DETECTED."),null;const a=e[0].expressions;let o="neutral",s=0;return Object.entries(a).forEach(([l,f])=>{f>s&&(s=f,o=l)}),console.log(` [DEBUG-LOOP]  FACE FOUND! Emotion: ${o} (${(s*100).toFixed(0)}%)`),{emotion:o,confidence:s,expressions:{...a},timestamp:Date.now()}}catch(t){return console.error(" [DEBUG-LOOP]  CRITICAL: Detection crashed",t),null}},pn="%c[EmotionContext]",vn="color: #00ffff; font-weight: bold",vw=$.createContext(void 0),bM=({children:r})=>{const[t,e]=$.useState(null),[n,a]=$.useState("idle"),[o,s]=$.useState(!1),[l,f]=$.useState(null),h=$.useRef(null),p=$.useRef(null),v=$.useRef(!1);$.useEffect(()=>(console.log(pn+" Mount: Initializing...",vn),a("initializing"),gM().then(()=>{console.log(pn+" Models Loaded.",vn),a("idle")}).catch(E=>{console.error(pn+" Model Load Failed",vn,E),f("Failed to load models")}),()=>{console.log(pn+" Unmount: Cleanup",vn),x()}),[]);const m=()=>{console.log(pn+" Starting Detection Loop...",vn),p.current&&clearInterval(p.current),a("scanning"),v.current=!0,p.current=window.setInterval(async()=>{if(!v.current){console.warn(pn+" Loop Tick Skipped: Loop Flag is FALSE",vn);return}const E=h.current;if(!E){console.warn(pn+" Loop Tick Skipped: Video Ref is NULL",vn);return}if(!(E.paused||E.ended||E.readyState<2))try{const w=await yM(E);w?(e(w),a("detected")):n!=="detected"&&a("scanning")}catch(w){console.error(pn+" Detection Error",vn,w)}},1e3)},y=async()=>{console.log(pn+" startCamera() called",vn);try{if(!h.current)throw new Error("Video element reference is missing");a("initializing"),console.log(pn+" Requesting Media Stream...",vn),await cb.startCamera(h.current),console.log(pn+" Stream Assigned to Video",vn);const E=h.current;if(E)try{await E.play(),console.log(pn+" Video.play() successful",vn)}catch(w){console.warn(pn+" Video.play() warning (might rely on autoplay)",vn,w)}s(!0),f(null),m()}catch(E){console.error(pn+" Camera Start Failed",vn,E),f(E.message||"Failed to start camera"),s(!1),v.current=!1}},x=()=>{console.log(pn+" stopCamera() called",vn),cb.stopCamera(),p.current&&(clearInterval(p.current),p.current=null),v.current=!1,s(!1),e(null),a("idle")};return ve.jsx(vw.Provider,{value:{currentEmotion:t,status:n,isCameraActive:o,startCamera:y,stopCamera:x,videoRef:h,error:l},children:r})},mw=()=>{const r=$.useContext(vw);if(r===void 0)throw new Error("useEmotion must be used within an EmotionProvider");return r};function gw(r,t){return function(){return r.apply(t,arguments)}}const{toString:xM}=Object.prototype,{getPrototypeOf:Kv}=Object,{iterator:nf,toStringTag:yw}=Symbol,rf=(r=>t=>{const e=xM.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),xr=r=>(r=r.toLowerCase(),t=>rf(t)===r),af=r=>t=>typeof t===r,{isArray:Zo}=Array,qo=af("undefined");function Es(r){return r!==null&&!qo(r)&&r.constructor!==null&&!qo(r.constructor)&&An(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const bw=xr("ArrayBuffer");function wM(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&bw(r.buffer),t}const EM=af("string"),An=af("function"),xw=af("number"),Cs=r=>r!==null&&typeof r=="object",CM=r=>r===!0||r===!1,cc=r=>{if(rf(r)!=="object")return!1;const t=Kv(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(yw in r)&&!(nf in r)},_M=r=>{if(!Cs(r)||Es(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},SM=xr("Date"),RM=xr("File"),AM=xr("Blob"),TM=xr("FileList"),DM=r=>Cs(r)&&An(r.pipe),NM=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||An(r.append)&&((t=rf(r))==="formdata"||t==="object"&&An(r.toString)&&r.toString()==="[object FormData]"))},OM=xr("URLSearchParams"),[MM,kM,IM,BM]=["ReadableStream","Request","Response","Headers"].map(xr),FM=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _s(r,t,{allOwnKeys:e=!1}={}){if(r===null||typeof r>"u")return;let n,a;if(typeof r!="object"&&(r=[r]),Zo(r))for(n=0,a=r.length;n<a;n++)t.call(null,r[n],n,r);else{if(Es(r))return;const o=e?Object.getOwnPropertyNames(r):Object.keys(r),s=o.length;let l;for(n=0;n<s;n++)l=o[n],t.call(null,r[l],l,r)}}function ww(r,t){if(Es(r))return null;t=t.toLowerCase();const e=Object.keys(r);let n=e.length,a;for(;n-- >0;)if(a=e[n],t===a.toLowerCase())return a;return null}const Ti=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ew=r=>!qo(r)&&r!==Ti;function Bp(){const{caseless:r,skipUndefined:t}=Ew(this)&&this||{},e={},n=(a,o)=>{const s=r&&ww(e,o)||o;cc(e[s])&&cc(a)?e[s]=Bp(e[s],a):cc(a)?e[s]=Bp({},a):Zo(a)?e[s]=a.slice():(!t||!qo(a))&&(e[s]=a)};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&_s(arguments[a],n);return e}const LM=(r,t,e,{allOwnKeys:n}={})=>(_s(t,(a,o)=>{e&&An(a)?Object.defineProperty(r,o,{value:gw(a,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(r,o,{value:a,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:n}),r),zM=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),UM=(r,t,e,n)=>{r.prototype=Object.create(t.prototype,n),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},PM=(r,t,e,n)=>{let a,o,s;const l={};if(t=t||{},r==null)return t;do{for(a=Object.getOwnPropertyNames(r),o=a.length;o-- >0;)s=a[o],(!n||n(s,r,t))&&!l[s]&&(t[s]=r[s],l[s]=!0);r=e!==!1&&Kv(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},HM=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const n=r.indexOf(t,e);return n!==-1&&n===e},VM=r=>{if(!r)return null;if(Zo(r))return r;let t=r.length;if(!xw(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},WM=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Kv(Uint8Array)),jM=(r,t)=>{const n=(r&&r[nf]).call(r);let a;for(;(a=n.next())&&!a.done;){const o=a.value;t.call(r,o[0],o[1])}},GM=(r,t)=>{let e;const n=[];for(;(e=r.exec(t))!==null;)n.push(e);return n},qM=xr("HTMLFormElement"),XM=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,a){return n.toUpperCase()+a}),h1=(({hasOwnProperty:r})=>(t,e)=>r.call(t,e))(Object.prototype),KM=xr("RegExp"),Cw=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),n={};_s(e,(a,o)=>{let s;(s=t(a,o,r))!==!1&&(n[o]=s||a)}),Object.defineProperties(r,n)},YM=r=>{Cw(r,(t,e)=>{if(An(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=r[e];if(An(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},QM=(r,t)=>{const e={},n=a=>{a.forEach(o=>{e[o]=!0})};return Zo(r)?n(r):n(String(r).split(t)),e},ZM=()=>{},JM=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function $M(r){return!!(r&&An(r.append)&&r[yw]==="FormData"&&r[nf])}const ek=r=>{const t=new Array(10),e=(n,a)=>{if(Cs(n)){if(t.indexOf(n)>=0)return;if(Es(n))return n;if(!("toJSON"in n)){t[a]=n;const o=Zo(n)?[]:{};return _s(n,(s,l)=>{const f=e(s,a+1);!qo(f)&&(o[l]=f)}),t[a]=void 0,o}}return n};return e(r,0)},tk=xr("AsyncFunction"),nk=r=>r&&(Cs(r)||An(r))&&An(r.then)&&An(r.catch),_w=((r,t)=>r?setImmediate:t?((e,n)=>(Ti.addEventListener("message",({source:a,data:o})=>{a===Ti&&o===e&&n.length&&n.shift()()},!1),a=>{n.push(a),Ti.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",An(Ti.postMessage)),rk=typeof queueMicrotask<"u"?queueMicrotask.bind(Ti):typeof process<"u"&&process.nextTick||_w,ak=r=>r!=null&&An(r[nf]),ne={isArray:Zo,isArrayBuffer:bw,isBuffer:Es,isFormData:NM,isArrayBufferView:wM,isString:EM,isNumber:xw,isBoolean:CM,isObject:Cs,isPlainObject:cc,isEmptyObject:_M,isReadableStream:MM,isRequest:kM,isResponse:IM,isHeaders:BM,isUndefined:qo,isDate:SM,isFile:RM,isBlob:AM,isRegExp:KM,isFunction:An,isStream:DM,isURLSearchParams:OM,isTypedArray:WM,isFileList:TM,forEach:_s,merge:Bp,extend:LM,trim:FM,stripBOM:zM,inherits:UM,toFlatObject:PM,kindOf:rf,kindOfTest:xr,endsWith:HM,toArray:VM,forEachEntry:jM,matchAll:GM,isHTMLForm:qM,hasOwnProperty:h1,hasOwnProp:h1,reduceDescriptors:Cw,freezeMethods:YM,toObjectSet:QM,toCamelCase:XM,noop:ZM,toFiniteNumber:JM,findKey:ww,global:Ti,isContextDefined:Ew,isSpecCompliantForm:$M,toJSONObject:ek,isAsyncFn:tk,isThenable:nk,setImmediate:_w,asap:rk,isIterable:ak};let ke=class Sw extends Error{static from(t,e,n,a,o,s){const l=new Sw(t.message,e||t.code,n,a,o);return l.cause=t,l.name=t.name,s&&Object.assign(l,s),l}constructor(t,e,n,a,o){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),n&&(this.config=n),a&&(this.request=a),o&&(this.response=o,this.status=o.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ne.toJSONObject(this.config),code:this.code,status:this.status}}};ke.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";ke.ERR_BAD_OPTION="ERR_BAD_OPTION";ke.ECONNABORTED="ECONNABORTED";ke.ETIMEDOUT="ETIMEDOUT";ke.ERR_NETWORK="ERR_NETWORK";ke.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";ke.ERR_DEPRECATED="ERR_DEPRECATED";ke.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";ke.ERR_BAD_REQUEST="ERR_BAD_REQUEST";ke.ERR_CANCELED="ERR_CANCELED";ke.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";ke.ERR_INVALID_URL="ERR_INVALID_URL";const ik=null;function Fp(r){return ne.isPlainObject(r)||ne.isArray(r)}function Rw(r){return ne.endsWith(r,"[]")?r.slice(0,-2):r}function d1(r,t,e){return r?r.concat(t).map(function(a,o){return a=Rw(a),!e&&o?"["+a+"]":a}).join(e?".":""):t}function ok(r){return ne.isArray(r)&&!r.some(Fp)}const uk=ne.toFlatObject(ne,{},null,function(t){return/^is[A-Z]/.test(t)});function of(r,t,e){if(!ne.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=ne.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,w){return!ne.isUndefined(w[E])});const n=e.metaTokens,a=e.visitor||p,o=e.dots,s=e.indexes,f=(e.Blob||typeof Blob<"u"&&Blob)&&ne.isSpecCompliantForm(t);if(!ne.isFunction(a))throw new TypeError("visitor must be a function");function h(x){if(x===null)return"";if(ne.isDate(x))return x.toISOString();if(ne.isBoolean(x))return x.toString();if(!f&&ne.isBlob(x))throw new ke("Blob is not supported. Use a Buffer instead.");return ne.isArrayBuffer(x)||ne.isTypedArray(x)?f&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function p(x,E,w){let C=x;if(x&&!w&&typeof x=="object"){if(ne.endsWith(E,"{}"))E=n?E:E.slice(0,-2),x=JSON.stringify(x);else if(ne.isArray(x)&&ok(x)||(ne.isFileList(x)||ne.endsWith(E,"[]"))&&(C=ne.toArray(x)))return E=Rw(E),C.forEach(function(R,A){!(ne.isUndefined(R)||R===null)&&t.append(s===!0?d1([E],A,o):s===null?E:E+"[]",h(R))}),!1}return Fp(x)?!0:(t.append(d1(w,E,o),h(x)),!1)}const v=[],m=Object.assign(uk,{defaultVisitor:p,convertValue:h,isVisitable:Fp});function y(x,E){if(!ne.isUndefined(x)){if(v.indexOf(x)!==-1)throw Error("Circular reference detected in "+E.join("."));v.push(x),ne.forEach(x,function(C,_){(!(ne.isUndefined(C)||C===null)&&a.call(t,C,ne.isString(_)?_.trim():_,E,m))===!0&&y(C,E?E.concat(_):[_])}),v.pop()}}if(!ne.isObject(r))throw new TypeError("data must be an object");return y(r),t}function p1(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Yv(r,t){this._pairs=[],r&&of(r,this,t)}const Aw=Yv.prototype;Aw.append=function(t,e){this._pairs.push([t,e])};Aw.toString=function(t){const e=t?function(n){return t.call(this,n,p1)}:p1;return this._pairs.map(function(a){return e(a[0])+"="+e(a[1])},"").join("&")};function sk(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Tw(r,t,e){if(!t)return r;const n=e&&e.encode||sk,a=ne.isFunction(e)?{serialize:e}:e,o=a&&a.serialize;let s;if(o?s=o(t,a):s=ne.isURLSearchParams(t)?t.toString():new Yv(t,a).toString(n),s){const l=r.indexOf("#");l!==-1&&(r=r.slice(0,l)),r+=(r.indexOf("?")===-1?"?":"&")+s}return r}class v1{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ne.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Dw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lk=typeof URLSearchParams<"u"?URLSearchParams:Yv,ck=typeof FormData<"u"?FormData:null,fk=typeof Blob<"u"?Blob:null,hk={isBrowser:!0,classes:{URLSearchParams:lk,FormData:ck,Blob:fk},protocols:["http","https","file","blob","url","data"]},Qv=typeof window<"u"&&typeof document<"u",Lp=typeof navigator=="object"&&navigator||void 0,dk=Qv&&(!Lp||["ReactNative","NativeScript","NS"].indexOf(Lp.product)<0),pk=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vk=Qv&&window.location.href||"http://localhost",mk=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Qv,hasStandardBrowserEnv:dk,hasStandardBrowserWebWorkerEnv:pk,navigator:Lp,origin:vk},Symbol.toStringTag,{value:"Module"})),ln={...mk,...hk};function gk(r,t){return of(r,new ln.classes.URLSearchParams,{visitor:function(e,n,a,o){return ln.isNode&&ne.isBuffer(e)?(this.append(n,e.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...t})}function yk(r){return ne.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function bk(r){const t={},e=Object.keys(r);let n;const a=e.length;let o;for(n=0;n<a;n++)o=e[n],t[o]=r[o];return t}function Nw(r){function t(e,n,a,o){let s=e[o++];if(s==="__proto__")return!0;const l=Number.isFinite(+s),f=o>=e.length;return s=!s&&ne.isArray(a)?a.length:s,f?(ne.hasOwnProp(a,s)?a[s]=[a[s],n]:a[s]=n,!l):((!a[s]||!ne.isObject(a[s]))&&(a[s]=[]),t(e,n,a[s],o)&&ne.isArray(a[s])&&(a[s]=bk(a[s])),!l)}if(ne.isFormData(r)&&ne.isFunction(r.entries)){const e={};return ne.forEachEntry(r,(n,a)=>{t(yk(n),a,e,0)}),e}return null}function xk(r,t,e){if(ne.isString(r))try{return(t||JSON.parse)(r),ne.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(r)}const Ss={transitional:Dw,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",a=n.indexOf("application/json")>-1,o=ne.isObject(t);if(o&&ne.isHTMLForm(t)&&(t=new FormData(t)),ne.isFormData(t))return a?JSON.stringify(Nw(t)):t;if(ne.isArrayBuffer(t)||ne.isBuffer(t)||ne.isStream(t)||ne.isFile(t)||ne.isBlob(t)||ne.isReadableStream(t))return t;if(ne.isArrayBufferView(t))return t.buffer;if(ne.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return gk(t,this.formSerializer).toString();if((l=ne.isFileList(t))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return of(l?{"files[]":t}:t,f&&new f,this.formSerializer)}}return o||a?(e.setContentType("application/json",!1),xk(t)):t}],transformResponse:[function(t){const e=this.transitional||Ss.transitional,n=e&&e.forcedJSONParsing,a=this.responseType==="json";if(ne.isResponse(t)||ne.isReadableStream(t))return t;if(t&&ne.isString(t)&&(n&&!this.responseType||a)){const s=!(e&&e.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(l){if(s)throw l.name==="SyntaxError"?ke.from(l,ke.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ln.classes.FormData,Blob:ln.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ne.forEach(["delete","get","head","post","put","patch"],r=>{Ss.headers[r]={}});const wk=ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ek=r=>{const t={};let e,n,a;return r&&r.split(`
`).forEach(function(s){a=s.indexOf(":"),e=s.substring(0,a).trim().toLowerCase(),n=s.substring(a+1).trim(),!(!e||t[e]&&wk[e])&&(e==="set-cookie"?t[e]?t[e].push(n):t[e]=[n]:t[e]=t[e]?t[e]+", "+n:n)}),t},m1=Symbol("internals");function Zu(r){return r&&String(r).trim().toLowerCase()}function fc(r){return r===!1||r==null?r:ne.isArray(r)?r.map(fc):String(r)}function Ck(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(r);)t[n[1]]=n[2];return t}const _k=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function op(r,t,e,n,a){if(ne.isFunction(n))return n.call(this,t,e);if(a&&(t=e),!!ne.isString(t)){if(ne.isString(n))return t.indexOf(n)!==-1;if(ne.isRegExp(n))return n.test(t)}}function Sk(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}function Rk(r,t){const e=ne.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+e,{value:function(a,o,s){return this[n].call(this,t,a,o,s)},configurable:!0})})}let Tn=class{constructor(t){t&&this.set(t)}set(t,e,n){const a=this;function o(l,f,h){const p=Zu(f);if(!p)throw new Error("header name must be a non-empty string");const v=ne.findKey(a,p);(!v||a[v]===void 0||h===!0||h===void 0&&a[v]!==!1)&&(a[v||f]=fc(l))}const s=(l,f)=>ne.forEach(l,(h,p)=>o(h,p,f));if(ne.isPlainObject(t)||t instanceof this.constructor)s(t,e);else if(ne.isString(t)&&(t=t.trim())&&!_k(t))s(Ek(t),e);else if(ne.isObject(t)&&ne.isIterable(t)){let l={},f,h;for(const p of t){if(!ne.isArray(p))throw TypeError("Object iterator must return a key-value pair");l[h=p[0]]=(f=l[h])?ne.isArray(f)?[...f,p[1]]:[f,p[1]]:p[1]}s(l,e)}else t!=null&&o(e,t,n);return this}get(t,e){if(t=Zu(t),t){const n=ne.findKey(this,t);if(n){const a=this[n];if(!e)return a;if(e===!0)return Ck(a);if(ne.isFunction(e))return e.call(this,a,n);if(ne.isRegExp(e))return e.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Zu(t),t){const n=ne.findKey(this,t);return!!(n&&this[n]!==void 0&&(!e||op(this,this[n],n,e)))}return!1}delete(t,e){const n=this;let a=!1;function o(s){if(s=Zu(s),s){const l=ne.findKey(n,s);l&&(!e||op(n,n[l],l,e))&&(delete n[l],a=!0)}}return ne.isArray(t)?t.forEach(o):o(t),a}clear(t){const e=Object.keys(this);let n=e.length,a=!1;for(;n--;){const o=e[n];(!t||op(this,this[o],o,t,!0))&&(delete this[o],a=!0)}return a}normalize(t){const e=this,n={};return ne.forEach(this,(a,o)=>{const s=ne.findKey(n,o);if(s){e[s]=fc(a),delete e[o];return}const l=t?Sk(o):String(o).trim();l!==o&&delete e[o],e[l]=fc(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return ne.forEach(this,(n,a)=>{n!=null&&n!==!1&&(e[a]=t&&ne.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[m1]=this[m1]={accessors:{}}).accessors,a=this.prototype;function o(s){const l=Zu(s);n[l]||(Rk(a,s),n[l]=!0)}return ne.isArray(t)?t.forEach(o):o(t),this}};Tn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ne.reduceDescriptors(Tn.prototype,({value:r},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(n){this[e]=n}}});ne.freezeMethods(Tn);function up(r,t){const e=this||Ss,n=t||e,a=Tn.from(n.headers);let o=n.data;return ne.forEach(r,function(l){o=l.call(e,o,a.normalize(),t?t.status:void 0)}),a.normalize(),o}function Ow(r){return!!(r&&r.__CANCEL__)}let Rs=class extends ke{constructor(t,e,n){super(t??"canceled",ke.ERR_CANCELED,e,n),this.name="CanceledError",this.__CANCEL__=!0}};function Mw(r,t,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?r(e):t(new ke("Request failed with status code "+e.status,[ke.ERR_BAD_REQUEST,ke.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function Ak(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function Tk(r,t){r=r||10;const e=new Array(r),n=new Array(r);let a=0,o=0,s;return t=t!==void 0?t:1e3,function(f){const h=Date.now(),p=n[o];s||(s=h),e[a]=f,n[a]=h;let v=o,m=0;for(;v!==a;)m+=e[v++],v=v%r;if(a=(a+1)%r,a===o&&(o=(o+1)%r),h-s<t)return;const y=p&&h-p;return y?Math.round(m*1e3/y):void 0}}function Dk(r,t){let e=0,n=1e3/t,a,o;const s=(h,p=Date.now())=>{e=p,a=null,o&&(clearTimeout(o),o=null),r(...h)};return[(...h)=>{const p=Date.now(),v=p-e;v>=n?s(h,p):(a=h,o||(o=setTimeout(()=>{o=null,s(a)},n-v)))},()=>a&&s(a)]}const Lc=(r,t,e=3)=>{let n=0;const a=Tk(50,250);return Dk(o=>{const s=o.loaded,l=o.lengthComputable?o.total:void 0,f=s-n,h=a(f),p=s<=l;n=s;const v={loaded:s,total:l,progress:l?s/l:void 0,bytes:f,rate:h||void 0,estimated:h&&l&&p?(l-s)/h:void 0,event:o,lengthComputable:l!=null,[t?"download":"upload"]:!0};r(v)},e)},g1=(r,t)=>{const e=r!=null;return[n=>t[0]({lengthComputable:e,total:r,loaded:n}),t[1]]},y1=r=>(...t)=>ne.asap(()=>r(...t)),Nk=ln.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,ln.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(ln.origin),ln.navigator&&/(msie|trident)/i.test(ln.navigator.userAgent)):()=>!0,Ok=ln.hasStandardBrowserEnv?{write(r,t,e,n,a,o,s){if(typeof document>"u")return;const l=[`${r}=${encodeURIComponent(t)}`];ne.isNumber(e)&&l.push(`expires=${new Date(e).toUTCString()}`),ne.isString(n)&&l.push(`path=${n}`),ne.isString(a)&&l.push(`domain=${a}`),o===!0&&l.push("secure"),ne.isString(s)&&l.push(`SameSite=${s}`),document.cookie=l.join("; ")},read(r){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+r+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(r){this.write(r,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Mk(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function kk(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function kw(r,t,e){let n=!Mk(t);return r&&(n||e==!1)?kk(r,t):t}const b1=r=>r instanceof Tn?{...r}:r;function ki(r,t){t=t||{};const e={};function n(h,p,v,m){return ne.isPlainObject(h)&&ne.isPlainObject(p)?ne.merge.call({caseless:m},h,p):ne.isPlainObject(p)?ne.merge({},p):ne.isArray(p)?p.slice():p}function a(h,p,v,m){if(ne.isUndefined(p)){if(!ne.isUndefined(h))return n(void 0,h,v,m)}else return n(h,p,v,m)}function o(h,p){if(!ne.isUndefined(p))return n(void 0,p)}function s(h,p){if(ne.isUndefined(p)){if(!ne.isUndefined(h))return n(void 0,h)}else return n(void 0,p)}function l(h,p,v){if(v in t)return n(h,p);if(v in r)return n(void 0,h)}const f={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:l,headers:(h,p,v)=>a(b1(h),b1(p),v,!0)};return ne.forEach(Object.keys({...r,...t}),function(p){const v=f[p]||a,m=v(r[p],t[p],p);ne.isUndefined(m)&&v!==l||(e[p]=m)}),e}const Iw=r=>{const t=ki({},r);let{data:e,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:o,headers:s,auth:l}=t;if(t.headers=s=Tn.from(s),t.url=Tw(kw(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ne.isFormData(e)){if(ln.hasStandardBrowserEnv||ln.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(ne.isFunction(e.getHeaders)){const f=e.getHeaders(),h=["content-type","content-length"];Object.entries(f).forEach(([p,v])=>{h.includes(p.toLowerCase())&&s.set(p,v)})}}if(ln.hasStandardBrowserEnv&&(n&&ne.isFunction(n)&&(n=n(t)),n||n!==!1&&Nk(t.url))){const f=a&&o&&Ok.read(o);f&&s.set(a,f)}return t},Ik=typeof XMLHttpRequest<"u",Bk=Ik&&function(r){return new Promise(function(e,n){const a=Iw(r);let o=a.data;const s=Tn.from(a.headers).normalize();let{responseType:l,onUploadProgress:f,onDownloadProgress:h}=a,p,v,m,y,x;function E(){y&&y(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let w=new XMLHttpRequest;w.open(a.method.toUpperCase(),a.url,!0),w.timeout=a.timeout;function C(){if(!w)return;const R=Tn.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),T={data:!l||l==="text"||l==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:R,config:r,request:w};Mw(function(M){e(M),E()},function(M){n(M),E()},T),w=null}"onloadend"in w?w.onloadend=C:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(C)},w.onabort=function(){w&&(n(new ke("Request aborted",ke.ECONNABORTED,r,w)),w=null)},w.onerror=function(A){const T=A&&A.message?A.message:"Network Error",N=new ke(T,ke.ERR_NETWORK,r,w);N.event=A||null,n(N),w=null},w.ontimeout=function(){let A=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const T=a.transitional||Dw;a.timeoutErrorMessage&&(A=a.timeoutErrorMessage),n(new ke(A,T.clarifyTimeoutError?ke.ETIMEDOUT:ke.ECONNABORTED,r,w)),w=null},o===void 0&&s.setContentType(null),"setRequestHeader"in w&&ne.forEach(s.toJSON(),function(A,T){w.setRequestHeader(T,A)}),ne.isUndefined(a.withCredentials)||(w.withCredentials=!!a.withCredentials),l&&l!=="json"&&(w.responseType=a.responseType),h&&([m,x]=Lc(h,!0),w.addEventListener("progress",m)),f&&w.upload&&([v,y]=Lc(f),w.upload.addEventListener("progress",v),w.upload.addEventListener("loadend",y)),(a.cancelToken||a.signal)&&(p=R=>{w&&(n(!R||R.type?new Rs(null,r,w):R),w.abort(),w=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const _=Ak(a.url);if(_&&ln.protocols.indexOf(_)===-1){n(new ke("Unsupported protocol "+_+":",ke.ERR_BAD_REQUEST,r));return}w.send(o||null)})},Fk=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let n=new AbortController,a;const o=function(h){if(!a){a=!0,l();const p=h instanceof Error?h:this.reason;n.abort(p instanceof ke?p:new Rs(p instanceof Error?p.message:p))}};let s=t&&setTimeout(()=>{s=null,o(new ke(`timeout of ${t}ms exceeded`,ke.ETIMEDOUT))},t);const l=()=>{r&&(s&&clearTimeout(s),s=null,r.forEach(h=>{h.unsubscribe?h.unsubscribe(o):h.removeEventListener("abort",o)}),r=null)};r.forEach(h=>h.addEventListener("abort",o));const{signal:f}=n;return f.unsubscribe=()=>ne.asap(l),f}},Lk=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let n=0,a;for(;n<e;)a=n+t,yield r.slice(n,a),n=a},zk=async function*(r,t){for await(const e of Uk(r))yield*Lk(e,t)},Uk=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},x1=(r,t,e,n)=>{const a=zk(r,t);let o=0,s,l=f=>{s||(s=!0,n&&n(f))};return new ReadableStream({async pull(f){try{const{done:h,value:p}=await a.next();if(h){l(),f.close();return}let v=p.byteLength;if(e){let m=o+=v;e(m)}f.enqueue(new Uint8Array(p))}catch(h){throw l(h),h}},cancel(f){return l(f),a.return()}},{highWaterMark:2})},w1=64*1024,{isFunction:ic}=ne,Pk=(({Request:r,Response:t})=>({Request:r,Response:t}))(ne.global),{ReadableStream:E1,TextEncoder:C1}=ne.global,_1=(r,...t)=>{try{return!!r(...t)}catch{return!1}},Hk=r=>{r=ne.merge.call({skipUndefined:!0},Pk,r);const{fetch:t,Request:e,Response:n}=r,a=t?ic(t):typeof fetch=="function",o=ic(e),s=ic(n);if(!a)return!1;const l=a&&ic(E1),f=a&&(typeof C1=="function"?(x=>E=>x.encode(E))(new C1):async x=>new Uint8Array(await new e(x).arrayBuffer())),h=o&&l&&_1(()=>{let x=!1;const E=new e(ln.origin,{body:new E1,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!E}),p=s&&l&&_1(()=>ne.isReadableStream(new n("").body)),v={stream:p&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!v[x]&&(v[x]=(E,w)=>{let C=E&&E[x];if(C)return C.call(E);throw new ke(`Response type '${x}' is not supported`,ke.ERR_NOT_SUPPORT,w)})});const m=async x=>{if(x==null)return 0;if(ne.isBlob(x))return x.size;if(ne.isSpecCompliantForm(x))return(await new e(ln.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(ne.isArrayBufferView(x)||ne.isArrayBuffer(x))return x.byteLength;if(ne.isURLSearchParams(x)&&(x=x+""),ne.isString(x))return(await f(x)).byteLength},y=async(x,E)=>{const w=ne.toFiniteNumber(x.getContentLength());return w??m(E)};return async x=>{let{url:E,method:w,data:C,signal:_,cancelToken:R,timeout:A,onDownloadProgress:T,onUploadProgress:N,responseType:M,headers:I,withCredentials:k="same-origin",fetchOptions:F}=Iw(x),W=t||fetch;M=M?(M+"").toLowerCase():"text";let P=Fk([_,R&&R.toAbortSignal()],A),oe=null;const ee=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let ae;try{if(N&&h&&w!=="get"&&w!=="head"&&(ae=await y(I,C))!==0){let L=new e(E,{method:"POST",body:C,duplex:"half"}),q;if(ne.isFormData(C)&&(q=L.headers.get("content-type"))&&I.setContentType(q),L.body){const[ue,pe]=g1(ae,Lc(y1(N)));C=x1(L.body,w1,ue,pe)}}ne.isString(k)||(k=k?"include":"omit");const z=o&&"credentials"in e.prototype,G={...F,signal:P,method:w.toUpperCase(),headers:I.normalize().toJSON(),body:C,duplex:"half",credentials:z?k:void 0};oe=o&&new e(E,G);let K=await(o?W(oe,F):W(E,G));const ie=p&&(M==="stream"||M==="response");if(p&&(T||ie&&ee)){const L={};["status","statusText","headers"].forEach(me=>{L[me]=K[me]});const q=ne.toFiniteNumber(K.headers.get("content-length")),[ue,pe]=T&&g1(q,Lc(y1(T),!0))||[];K=new n(x1(K.body,w1,ue,()=>{pe&&pe(),ee&&ee()}),L)}M=M||"text";let se=await v[ne.findKey(v,M)||"text"](K,x);return!ie&&ee&&ee(),await new Promise((L,q)=>{Mw(L,q,{data:se,headers:Tn.from(K.headers),status:K.status,statusText:K.statusText,config:x,request:oe})})}catch(z){throw ee&&ee(),z&&z.name==="TypeError"&&/Load failed|fetch/i.test(z.message)?Object.assign(new ke("Network Error",ke.ERR_NETWORK,x,oe),{cause:z.cause||z}):ke.from(z,z&&z.code,x,oe)}}},Vk=new Map,Bw=r=>{let t=r&&r.env||{};const{fetch:e,Request:n,Response:a}=t,o=[n,a,e];let s=o.length,l=s,f,h,p=Vk;for(;l--;)f=o[l],h=p.get(f),h===void 0&&p.set(f,h=l?new Map:Hk(t)),p=h;return h};Bw();const Zv={http:ik,xhr:Bk,fetch:{get:Bw}};ne.forEach(Zv,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const S1=r=>`- ${r}`,Wk=r=>ne.isFunction(r)||r===null||r===!1;function jk(r,t){r=ne.isArray(r)?r:[r];const{length:e}=r;let n,a;const o={};for(let s=0;s<e;s++){n=r[s];let l;if(a=n,!Wk(n)&&(a=Zv[(l=String(n)).toLowerCase()],a===void 0))throw new ke(`Unknown adapter '${l}'`);if(a&&(ne.isFunction(a)||(a=a.get(t))))break;o[l||"#"+s]=a}if(!a){const s=Object.entries(o).map(([f,h])=>`adapter ${f} `+(h===!1?"is not supported by the environment":"is not available in the build"));let l=e?s.length>1?`since :
`+s.map(S1).join(`
`):" "+S1(s[0]):"as no adapter specified";throw new ke("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a}const Fw={getAdapter:jk,adapters:Zv};function sp(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Rs(null,r)}function R1(r){return sp(r),r.headers=Tn.from(r.headers),r.data=up.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Fw.getAdapter(r.adapter||Ss.adapter,r)(r).then(function(n){return sp(r),n.data=up.call(r,r.transformResponse,n),n.headers=Tn.from(n.headers),n},function(n){return Ow(n)||(sp(r),n&&n.response&&(n.response.data=up.call(r,r.transformResponse,n.response),n.response.headers=Tn.from(n.response.headers))),Promise.reject(n)})}const Lw="1.13.4",uf={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{uf[r]=function(n){return typeof n===r||"a"+(t<1?"n ":" ")+r}});const A1={};uf.transitional=function(t,e,n){function a(o,s){return"[Axios v"+Lw+"] Transitional option '"+o+"'"+s+(n?". "+n:"")}return(o,s,l)=>{if(t===!1)throw new ke(a(s," has been removed"+(e?" in "+e:"")),ke.ERR_DEPRECATED);return e&&!A1[s]&&(A1[s]=!0,console.warn(a(s," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(o,s,l):!0}};uf.spelling=function(t){return(e,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function Gk(r,t,e){if(typeof r!="object")throw new ke("options must be an object",ke.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let a=n.length;for(;a-- >0;){const o=n[a],s=t[o];if(s){const l=r[o],f=l===void 0||s(l,o,r);if(f!==!0)throw new ke("option "+o+" must be "+f,ke.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new ke("Unknown option "+o,ke.ERR_BAD_OPTION)}}const hc={assertOptions:Gk,validators:uf},Tr=hc.validators;let Ni=class{constructor(t){this.defaults=t||{},this.interceptors={request:new v1,response:new v1}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=ki(this.defaults,e);const{transitional:n,paramsSerializer:a,headers:o}=e;n!==void 0&&hc.assertOptions(n,{silentJSONParsing:Tr.transitional(Tr.boolean),forcedJSONParsing:Tr.transitional(Tr.boolean),clarifyTimeoutError:Tr.transitional(Tr.boolean)},!1),a!=null&&(ne.isFunction(a)?e.paramsSerializer={serialize:a}:hc.assertOptions(a,{encode:Tr.function,serialize:Tr.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),hc.assertOptions(e,{baseUrl:Tr.spelling("baseURL"),withXsrfToken:Tr.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=o&&ne.merge(o.common,o[e.method]);o&&ne.forEach(["delete","get","head","post","put","patch","common"],x=>{delete o[x]}),e.headers=Tn.concat(s,o);const l=[];let f=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(e)===!1||(f=f&&E.synchronous,l.unshift(E.fulfilled,E.rejected))});const h=[];this.interceptors.response.forEach(function(E){h.push(E.fulfilled,E.rejected)});let p,v=0,m;if(!f){const x=[R1.bind(this),void 0];for(x.unshift(...l),x.push(...h),m=x.length,p=Promise.resolve(e);v<m;)p=p.then(x[v++],x[v++]);return p}m=l.length;let y=e;for(;v<m;){const x=l[v++],E=l[v++];try{y=x(y)}catch(w){E.call(this,w);break}}try{p=R1.call(this,y)}catch(x){return Promise.reject(x)}for(v=0,m=h.length;v<m;)p=p.then(h[v++],h[v++]);return p}getUri(t){t=ki(this.defaults,t);const e=kw(t.baseURL,t.url,t.allowAbsoluteUrls);return Tw(e,t.params,t.paramsSerializer)}};ne.forEach(["delete","get","head","options"],function(t){Ni.prototype[t]=function(e,n){return this.request(ki(n||{},{method:t,url:e,data:(n||{}).data}))}});ne.forEach(["post","put","patch"],function(t){function e(n){return function(o,s,l){return this.request(ki(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}Ni.prototype[t]=e(),Ni.prototype[t+"Form"]=e(!0)});let qk=class zw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(o){e=o});const n=this;this.promise.then(a=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](a);n._listeners=null}),this.promise.then=a=>{let o;const s=new Promise(l=>{n.subscribe(l),o=l}).then(a);return s.cancel=function(){n.unsubscribe(o)},s},t(function(o,s,l){n.reason||(n.reason=new Rs(o,s,l),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=n=>{t.abort(n)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new zw(function(a){t=a}),cancel:t}}};function Xk(r){return function(e){return r.apply(null,e)}}function Kk(r){return ne.isObject(r)&&r.isAxiosError===!0}const zp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(zp).forEach(([r,t])=>{zp[t]=r});function Uw(r){const t=new Ni(r),e=gw(Ni.prototype.request,t);return ne.extend(e,Ni.prototype,t,{allOwnKeys:!0}),ne.extend(e,t,null,{allOwnKeys:!0}),e.create=function(a){return Uw(ki(r,a))},e}const Tt=Uw(Ss);Tt.Axios=Ni;Tt.CanceledError=Rs;Tt.CancelToken=qk;Tt.isCancel=Ow;Tt.VERSION=Lw;Tt.toFormData=of;Tt.AxiosError=ke;Tt.Cancel=Tt.CanceledError;Tt.all=function(t){return Promise.all(t)};Tt.spread=Xk;Tt.isAxiosError=Kk;Tt.mergeConfig=ki;Tt.AxiosHeaders=Tn;Tt.formToJSON=r=>Nw(ne.isHTMLForm(r)?new FormData(r):r);Tt.getAdapter=Fw.getAdapter;Tt.HttpStatusCode=zp;Tt.default=Tt;const{Axios:FI,AxiosError:LI,CanceledError:zI,isCancel:UI,CancelToken:PI,VERSION:HI,all:VI,Cancel:WI,isAxiosError:jI,spread:GI,toFormData:qI,AxiosHeaders:XI,HttpStatusCode:KI,formToJSON:YI,getAdapter:QI,mergeConfig:ZI}=Tt,Yk=Tt.create({baseURL:lc.baseUrl}),Qk={searchVideos:async r=>{try{if(!lc.apiKey||lc.apiKey.includes("your_youtube_api_key"))return console.warn("YouTube API Key is missing or invalid"),[];const t=await Yk.get("/search",{params:{part:"snippet",maxResults:12,q:r,key:lc.apiKey,type:"video",videoEmbeddable:"true",videoCategoryId:"10"}});return console.log("YouTube API Response:",t.data),t.data.items}catch(t){return console.error("Error fetching YouTube videos:",t.response?.data||t.message),[]}}},T1={happy:["happy music","upbeat songs","feel good music","dance hits"],sad:["sad songs","melancholic music","emotional piano","broken heart songs"],angry:["aggressive rock","heavy metal","workout music","intense music"],surprised:["experimental music","electronic drops","viral hits","trending music"],neutral:["lo-fi beats","chill background music","study music","acoustic relax"],fearful:["calming music for anxiety","ambient soundscapes","gentle piano","meditation music"],disgusted:["heavy bass music","grunge rock","alternative rock","industrial music"]},Zk=r=>{const t=T1[r]||T1.neutral;return t[Math.floor(Math.random()*t.length)]},Pw=$.createContext(void 0),Jk=({children:r})=>{const[t,e]=$.useState([]),[n,a]=$.useState(null),[o,s]=$.useState(!1),[l,f]=$.useState(!1),h=async m=>{s(!0),f(!1);try{const y=Zk(m);console.log(`Searching YouTube for: ${y}`);const x=await Qk.searchVideos(y);x&&x.length>0?e(x):(console.warn("YouTube returned 0 videos. Triggering fallback or error state."),f(!0))}catch(y){console.error("Error fetching recommendations:",y),f(!0)}finally{s(!1)}},p=m=>{a(m)},v=()=>{a(null)};return ve.jsx(Pw.Provider,{value:{videos:t,currentVideo:n,fetchRecommendations:h,isLoading:o,hasError:l,playVideo:p,closeVideo:v},children:r})},sf=()=>{const r=$.useContext(Pw);if(r===void 0)throw new Error("useMusic must be used within a MusicProvider");return r};const Hw=(...r)=>r.filter((t,e,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===e).join(" ").trim();const $k=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const eI=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,n)=>n?n.toUpperCase():e.toLowerCase());const D1=r=>{const t=eI(r);return t.charAt(0).toUpperCase()+t.slice(1)};var tI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const nI=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const rI=$.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:s,...l},f)=>$.createElement("svg",{ref:f,...tI,width:t,height:t,stroke:r,strokeWidth:n?Number(e)*24/Number(t):e,className:Hw("lucide",a),...!o&&!nI(l)&&{"aria-hidden":"true"},...l},[...s.map(([h,p])=>$.createElement(h,p)),...Array.isArray(o)?o:[o]]));const Wr=(r,t)=>{const e=$.forwardRef(({className:n,...a},o)=>$.createElement(rI,{ref:o,iconNode:t,className:Hw(`lucide-${$k(D1(r))}`,`lucide-${r}`,n),...a}));return e.displayName=D1(r),e};const aI=[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]],iI=Wr("camera-off",aI);const oI=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],uI=Wr("camera",oI);const sI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],lI=Wr("circle-alert",sI);const cI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fI=Wr("circle-question-mark",cI);const hI=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],dI=Wr("music",hI);const pI=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],vI=Wr("play",pI);const mI=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 9h.01",key:"x1ddxp"}]],gI=Wr("scan-face",mI);const yI=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],bI=Wr("sparkles",yI);const xI=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],wI=Wr("triangle-alert",xI);const EI=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],CI=Wr("x",EI),_I=()=>ve.jsxs("header",{className:"flex items-center justify-between px-6 py-4 bg-dark-card border-b border-gray-800",children:[ve.jsxs("div",{className:"flex items-center gap-2",children:[ve.jsx(dI,{className:"w-8 h-8 text-primary"}),ve.jsx("h1",{className:"text-xl font-bold text-white tracking-tight",children:"MoodyPlayer"})]}),ve.jsx("div",{children:ve.jsx("span",{className:"text-xs text-gray-400 border border-gray-700 rounded-full px-3 py-1",children:"YouTube Integrated"})})]}),SI=2,RI=()=>{const{videoRef:r,isCameraActive:t,startCamera:e,stopCamera:n,currentEmotion:a,status:o,error:s}=mw(),{fetchRecommendations:l}=sf(),f=$.useRef(null),h=$.useRef(0),p=$.useRef(null);return $.useEffect(()=>{console.log(" [DEBUG-VIEW] CameraFeed Instance Mounted")},[]),$.useEffect(()=>{if(!a){h.current=0;return}const v=a.emotion;p.current===v?h.current+=1:(p.current=v,h.current=1),h.current>=SI&&f.current!==v&&a.confidence>.3&&(console.warn(` [DEBUG-VIEW]  TRIGGER MUSIC FETCH: ${v}`),f.current=v,l(v))},[a,l]),ve.jsxs("div",{className:"relative w-full max-w-md mx-auto aspect-video bg-black rounded-2xl overflow-hidden shadow-2xl border border-gray-800",children:[ve.jsx("video",{ref:r,autoPlay:!0,muted:!0,playsInline:!0,className:`w-full h-full object-cover transform scale-x-[-1] transition-opacity duration-500 ${t?"opacity-100":"opacity-0"}`}),!t&&ve.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-dark-card/90 z-10",children:[ve.jsx("div",{className:"p-4 rounded-full bg-gray-800/50 mb-4",children:ve.jsx(uI,{className:"w-8 h-8 text-gray-400"})}),ve.jsx("p",{className:"text-gray-400 mb-6",children:"Enable camera to detect your mood"}),ve.jsx("button",{onClick:()=>{console.log(" [DEBUG-VIEW] Start Button Clicked"),e()},className:"px-6 py-2 bg-primary hover:bg-primary-dark text-black font-medium rounded-full transition-all hover:scale-105",children:"Start Camera"})]}),t&&o==="scanning"&&!a&&ve.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[ve.jsx("div",{className:"w-48 h-48 border-2 border-primary/30 rounded-full animate-ping absolute"}),ve.jsxs("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full flex items-center gap-2",children:[ve.jsx(gI,{className:"w-5 h-5 text-primary animate-pulse"}),ve.jsx("span",{className:"text-white text-sm font-medium",children:"Scanning face..."})]})]}),t&&ve.jsx("div",{className:"absolute top-4 right-4 z-20",children:ve.jsx("button",{onClick:n,className:"p-2 bg-black/50 hover:bg-red-500/80 backdrop-blur-sm rounded-full text-white transition-all",children:ve.jsx(iI,{className:"w-5 h-5"})})}),t&&a&&ve.jsx("div",{className:"absolute bottom-4 left-4 right-4 bg-black/60 backdrop-blur-md rounded-xl p-3 border border-white/10 z-20",children:ve.jsx("div",{className:"flex items-center justify-between",children:ve.jsxs("div",{children:[ve.jsx("p",{className:"text-xs text-gray-400 uppercase tracking-wider font-semibold",children:"Detected Mood"}),ve.jsxs("p",{className:"text-xl font-bold text-white capitalize flex items-center gap-2",children:[a.emotion,ve.jsxs("span",{className:"text-xs font-normal text-primary bg-primary/20 px-2 py-0.5 rounded-full",children:[Math.round(a.confidence*100),"%"]})]})]})})}),s&&ve.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-dark-bg/95 z-30 p-6 text-center",children:[ve.jsx(lI,{className:"w-10 h-10 text-red-500 mb-2"}),ve.jsx("p",{className:"text-white font-medium",children:s}),ve.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm",children:"Retry"})]})]})},AI=({video:r})=>{const{playVideo:t,currentVideo:e}=sf(),n=e?.id.videoId===r.id.videoId,a=()=>{t(r)},o=s=>{const l=document.createElement("textarea");return l.innerHTML=s,l.value};return ve.jsxs("div",{className:`group relative flex flex-col md:flex-row items-start md:items-center gap-4 p-3 rounded-xl transition-all hover:bg-white/5 border border-transparent hover:border-white/10 ${n?"bg-white/10 border-primary/50":""}`,children:[ve.jsxs("div",{className:"relative aspect-video w-full md:w-40 rounded-lg overflow-hidden shadow-lg bg-gray-800",children:[ve.jsx("img",{src:r.snippet.thumbnails.medium.url,alt:r.snippet.title,className:"h-full w-full object-cover"}),ve.jsx("button",{onClick:a,className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:ve.jsx(vI,{className:"w-8 h-8 text-white fill-white"})})]}),ve.jsxs("div",{className:"flex-1 min-w-0",children:[ve.jsx("h3",{className:`font-semibold line-clamp-2 md:truncate ${n?"text-primary":"text-white"}`,children:o(r.snippet.title)}),ve.jsx("p",{className:"text-sm text-gray-400 mt-1",children:r.snippet.channelTitle}),ve.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:r.snippet.description})]})]})},TI=()=>{const{currentVideo:r,closeVideo:t}=sf();return r?ve.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4",children:ve.jsxs("div",{className:"relative w-full max-w-4xl bg-black rounded-2xl overflow-hidden shadow-2xl border border-white/10",children:[ve.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10 bg-dark-card",children:[ve.jsx("h3",{className:"font-semibold text-white truncate pr-4",children:r.snippet.title}),ve.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",children:ve.jsx(CI,{className:"w-5 h-5"})})]}),ve.jsx("div",{className:"relative aspect-video w-full bg-black",children:ve.jsx("iframe",{src:`https://www.youtube.com/embed/${r.id.videoId}?autoplay=1&rel=0`,title:"YouTube video player",className:"absolute inset-0 w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})})]})}):null},DI=()=>{const{videos:r,isLoading:t,hasError:e}=sf(),{currentEmotion:n,status:a}=mw();return ve.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-dark-bg via-[#1a1a1a] to-black text-white",children:[ve.jsx(_I,{}),ve.jsx(TI,{}),ve.jsx("main",{className:"container mx-auto px-4 py-8",children:ve.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 lg:gap-12 items-start",children:[ve.jsxs("div",{className:"space-y-6 lg:sticky lg:top-8",children:[ve.jsx("div",{className:"bg-dark-card rounded-2xl p-1 shadow-xl shadow-black/50 border border-white/5",children:ve.jsx(RI,{})}),ve.jsxs("div",{className:"bg-dark-card/50 rounded-xl p-6 border border-white/5",children:[ve.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[ve.jsx(fI,{className:"w-5 h-5 text-gray-500"}),"How it works"]}),ve.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:"Enable your camera to let our AI analyze your facial expressions correctly."}),ve.jsxs("div",{className:"mt-4 text-xs text-gray-500 space-y-1",children:[ve.jsxs("p",{children:[" Status: ",ve.jsx("span",{className:"text-primary",children:a})]}),n&&ve.jsxs("p",{children:[" Raw: ",n.emotion," (",(n.confidence*100).toFixed(0),"%)"]})]})]})]}),ve.jsxs("div",{className:"space-y-6",children:[ve.jsx("div",{className:"flex items-center justify-between",children:ve.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[ve.jsx(bI,{className:"w-6 h-6 text-yellow-500"}),n?`Mood: ${n.emotion}`:"Recommendations"]})}),e?ve.jsxs("div",{className:"flex flex-col items-center justify-center p-12 bg-red-500/10 rounded-2xl border border-red-500/20 text-center",children:[ve.jsx(wI,{className:"w-12 h-12 text-red-500 mb-4"}),ve.jsx("p",{className:"text-white text-lg font-semibold",children:"Unable to fetch music"}),ve.jsx("p",{className:"text-red-200/70 mt-2 text-sm",children:"Please check your YouTube API key or internet connection."})]}):t?ve.jsx("div",{className:"grid gap-4",children:[...Array(5)].map((o,s)=>ve.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"},s))}):r.length>0?ve.jsx("div",{className:"grid gap-3",children:r.map(o=>ve.jsx(AI,{video:o},o.id.videoId))}):ve.jsxs("div",{className:"flex flex-col items-center justify-center p-12 bg-white/5 rounded-2xl border border-white/5 text-center",children:[ve.jsx("p",{className:"text-gray-400 text-lg mb-2",children:a==="scanning"?"Scanning your face...":a==="detected"?"Found you! Fetching music...":"Start the camera to get recommendations"}),a==="scanning"&&ve.jsx("p",{className:"text-xs text-gray-500 animate-pulse mt-2",children:"Look at the camera clearly..."})]})]})]})})]})},NI=()=>ve.jsx(LS,{children:ve.jsx(KS,{children:ve.jsx(bM,{children:ve.jsx(Jk,{children:ve.jsx(dS,{children:ve.jsx(G1,{path:"/",element:ve.jsx(DI,{})})})})})})});console.log("%c[CRITICAL] MAIN.TSX LOADED","background:red;color:white;font-size:20px");console.log("[CRITICAL] JS Execution started at:",new Date().toISOString());v_.createRoot(document.getElementById("root")).render(ve.jsx($.StrictMode,{children:ve.jsx(NI,{})}))});export default OI();
